!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)}function toByteArray(b64){var i,j,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0,j=0;i<l;i+=4,j+=3)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],2:[function(require,module,exports){(function(Buffer){module.exports=function(blob,cb){function onLoadEnd(e){reader.removeEventListener("loadend",onLoadEnd,!1),e.error?cb(e.error):cb(null,new Buffer(reader.result))}if("undefined"==typeof Blob||!(blob instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof cb)throw new Error("second argument must be a function");var reader=new FileReader;reader.addEventListener("loadend",onLoadEnd,!1),reader.readAsArrayBuffer(blob)}}).call(this,require("buffer").Buffer)},{buffer:15}],3:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function ascendingComparator(f){return function(d,x){return ascending(f(d),x)}}function tickStep(start,stop,count){var step0=Math.abs(stop-start)/Math.max(0,count),step1=Math.pow(10,Math.floor(Math.log(step0)/Math.LN10)),error=step0/step1;return error>=e10?step1*=10:error>=e5?step1*=5:error>=e2&&(step1*=2),stop<start?-step1:step1}function length(d){return d.length}function translateX(scale0,scale1,d){var x=scale0(d);return"translate("+(isFinite(x)?x:scale1(d))+",0)"}function translateY(scale0,scale1,d){var y=scale0(d);return"translate(0,"+(isFinite(y)?y:scale1(d))+")"}function center(scale){var offset=scale.bandwidth()/2;return scale.round()&&(offset=Math.round(offset)),function(d){return scale(d)+offset}}function entering(){return!this.__axis}function axis(orient,scale){function axis(context){var x,values=null==tickValues?scale.ticks?scale.ticks.apply(scale,tickArguments):scale.domain():tickValues,format=null==tickFormat?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments):identity$1:tickFormat,spacing=Math.max(tickSizeInner,0)+tickPadding,transform=orient===top||orient===bottom?translateX:translateY,range=scale.range(),range0=range[0]+.5,range1=range[range.length-1]+.5,position=(scale.bandwidth?center:identity$1)(scale.copy()),selection=context.selection?context.selection():context,path=selection.selectAll(".domain").data([null]),tick=selection.selectAll(".tick").data(values,scale).order(),tickExit=tick.exit(),tickEnter=tick.enter().append("g").attr("class","tick"),line=tick.select("line"),text=tick.select("text"),k=orient===top||orient===left?-1:1,y=orient===left||orient===right?(x="x","y"):(x="y","x");path=path.merge(path.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),tick=tick.merge(tickEnter),line=line.merge(tickEnter.append("line").attr("stroke","#000").attr(x+"2",k*tickSizeInner).attr(y+"1",.5).attr(y+"2",.5)),text=text.merge(tickEnter.append("text").attr("fill","#000").attr(x,k*spacing).attr(y,.5).attr("dy",orient===top?"0em":orient===bottom?"0.71em":"0.32em")),context!==selection&&(path=path.transition(context),tick=tick.transition(context),line=line.transition(context),text=text.transition(context),tickExit=tickExit.transition(context).attr("opacity",epsilon).attr("transform",function(d){return transform(position,this.parentNode.__axis||position,d)}),tickEnter.attr("opacity",epsilon).attr("transform",function(d){return transform(this.parentNode.__axis||position,position,d)})),tickExit.remove(),path.attr("d",orient===left||orient==right?"M"+k*tickSizeOuter+","+range0+"H0.5V"+range1+"H"+k*tickSizeOuter:"M"+range0+","+k*tickSizeOuter+"V0.5H"+range1+"V"+k*tickSizeOuter),tick.attr("opacity",1).attr("transform",function(d){return transform(position,position,d)}),line.attr(x+"2",k*tickSizeInner),text.attr(x,k*spacing).text(format),selection.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",orient===right?"start":orient===left?"end":"middle"),selection.each(function(){this.__axis=position})}var tickArguments=[],tickValues=null,tickFormat=null,tickSizeInner=6,tickSizeOuter=6,tickPadding=3;return axis.scale=function(_){return arguments.length?(scale=_,axis):scale},axis.ticks=function(){return tickArguments=slice$1.call(arguments),axis},axis.tickArguments=function(_){return arguments.length?(tickArguments=null==_?[]:slice$1.call(_),axis):tickArguments.slice()},axis.tickValues=function(_){return arguments.length?(tickValues=null==_?null:slice$1.call(_),axis):tickValues&&tickValues.slice()},axis.tickFormat=function(_){return arguments.length?(tickFormat=_,axis):tickFormat},axis.tickSize=function(_){return arguments.length?(tickSizeInner=tickSizeOuter=+_,axis):tickSizeInner},axis.tickSizeInner=function(_){return arguments.length?(tickSizeInner=+_,axis):tickSizeInner},axis.tickSizeOuter=function(_){return arguments.length?(tickSizeOuter=+_,axis):tickSizeOuter},axis.tickPadding=function(_){return arguments.length?(tickPadding=+_,axis):tickPadding},axis}function axisTop(scale){return axis(top,scale)}function axisRight(scale){return axis(right,scale)}function axisBottom(scale){return axis(bottom,scale)}function axisLeft(scale){return axis(left,scale)}function dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _)throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:name}})}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name:name,value:callback}),type}function creatorInherit(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}}function creatorFixed(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}function local$1(){return new Local}function Local(){this._="@"+(++nextId).toString(36)}function filterContextListener(listener,index,group){return listener=contextListener(listener,index,group),function(event){var related=event.relatedTarget;related&&(related===this||8&related.compareDocumentPosition(this))||listener.call(this,event)}}function contextListener(listener,index,group){return function(event1){var event0=exports.event;exports.event=event1;try{listener.call(this,this.__data__,index,group)}finally{exports.event=event0}}}function parseTypenames$1(typenames){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name:name}})}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.capture);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,capture){var wrap=filterEvents.hasOwnProperty(typename.type)?filterContextListener:contextListener;return function(d,i,group){var o,on=this.__on,listener=wrap(value,i,group);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=listener,o.capture=capture),void(o.value=value);this.addEventListener(typename.type,listener,capture),o={type:typename.type,name:typename.name,value:value,listener:listener,capture:capture},on?on.push(o):this.__on=[o]}}function customEvent(event1,listener,that,args){var event0=exports.event;event1.sourceEvent=exports.event,exports.event=event1;try{return listener.apply(that,args)}finally{exports.event=event0}}function none(){}function empty$1(){return[]}function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue={},groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=keyPrefix+key.call(node,node.__data__,i,group),keyValue in nodeByKeyValue?exit[i]=node:nodeByKeyValue[keyValue]=node);for(i=0;i<dataLength;++i)keyValue=keyPrefix+key.call(parent,data[i],i,data),(node=nodeByKeyValue[keyValue])?(update[i]=node,node.__data__=data[i],nodeByKeyValue[keyValue]=null):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue[keyValues[i]]===node&&(exit[i]=node)}function ascending$1(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function attrRemove(name){return function(){this.removeAttribute(name)}}function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant(name,value){return function(){this.setAttribute(name,value)}}function attrConstantNS(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}function attrFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}function attrFunctionNS(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}function styleRemove(name){return function(){this.style.removeProperty(name)}}function styleConstant(name,value,priority){return function(){this.style.setProperty(name,value,priority)}}function styleFunction(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}function propertyRemove(name){return function(){delete this[name]}}function propertyConstant(name,value){return function(){this[name]=value}}function propertyFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}function classedTrue(names){return function(){classedAdd(this,names)}}function classedFalse(names){return function(){classedRemove(this,names)}}function classedFunction(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}function textRemove(){this.textContent=""}function textConstant(value){return function(){this.textContent=value}}function textFunction(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}function htmlRemove(){this.innerHTML=""}function htmlConstant(value){return function(){this.innerHTML=value}}function htmlFunction(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function constantNull(){return null}function remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function dispatchEvent(node,type,params){var window$$1=window(node),event=window$$1.CustomEvent;event?event=new event(type,params):(event=window$$1.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}function dispatchConstant(type,params){return function(){return dispatchEvent(this,type,params)}}function dispatchFunction(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}function Selection(groups,parents){this._groups=groups,this._parents=parents}function selection(){return new Selection([[document.documentElement]],root)}function nopropagation(){exports.event.stopImmediatePropagation()}function yesdrag(view,noclick){var root=view.document.documentElement,selection$$1=select(view).on("dragstart.drag",null);noclick&&(selection$$1.on("click.drag",noevent,!0),setTimeout(function(){selection$$1.on("click.drag",null)},0)),"onselectstart"in root?selection$$1.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}function DragEvent(target,type,subject,id,active,x,y,dx,dy,dispatch){this.target=target,this.type=type,this.subject=subject,this.identifier=id,this.active=active,this.x=x,this.y=y,this.dx=dx,this.dy=dy,this._=dispatch}function defaultFilter$1(){return!exports.event.button}function defaultContainer(){return this.parentNode}function defaultSubject(d){return null==d?{x:exports.event.x,y:exports.event.y}:d}function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}function color(format){var m;return format=(format+"").trim().toLowerCase(),(m=reHex3.exec(format))?(m=parseInt(m[1],16),new Rgb(m>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1)):(m=reHex6.exec(format))?rgbn(parseInt(m[1],16)):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function rgbConvert(o){return o instanceof Color||(o=color(o)),o?(o=o.rgb(),new Rgb(o.r,o.g,o.b,o.opacity)):new Rgb}function rgb(r,g,b,opacity){return 1===arguments.length?rgbConvert(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;o=o.rgb();var r=o.r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}function hsl(h,s,l,opacity){return 1===arguments.length?hslConvert(h):new Hsl(h,s,l,null==opacity?1:opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}function labConvert(o){if(o instanceof Lab)return new Lab(o.l,o.a,o.b,o.opacity);if(o instanceof Hcl){var h=o.h*deg2rad;return new Lab(o.l,Math.cos(h)*o.c,Math.sin(h)*o.c,o.opacity)}o instanceof Rgb||(o=rgbConvert(o));var b=rgb2xyz(o.r),a=rgb2xyz(o.g),l=rgb2xyz(o.b),x=xyz2lab((.4124564*b+.3575761*a+.1804375*l)/Xn),y=xyz2lab((.2126729*b+.7151522*a+.072175*l)/Yn);return new Lab(116*y-16,500*(x-y),200*(y-xyz2lab((.0193339*b+.119192*a+.9503041*l)/Zn)),o.opacity)}function lab(l,a,b,opacity){return 1===arguments.length?labConvert(l):new Lab(l,a,b,null==opacity?1:opacity)}function Lab(l,a,b,opacity){this.l=+l,this.a=+a,this.b=+b,this.opacity=+opacity}function xyz2lab(t){return t>t3?Math.pow(t,1/3):t/t2+t0}function lab2xyz(t){return t>t1?t*t*t:t2*(t-t0)}function xyz2rgb(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function rgb2xyz(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function hclConvert(o){if(o instanceof Hcl)return new Hcl(o.h,o.c,o.l,o.opacity);o instanceof Lab||(o=labConvert(o));var h=Math.atan2(o.b,o.a)*rad2deg;return new Hcl(h<0?h+360:h,Math.sqrt(o.a*o.a+o.b*o.b),o.l,o.opacity)}function hcl(h,c,l,opacity){return 1===arguments.length?hclConvert(h):new Hcl(h,c,l,null==opacity?1:opacity)}function Hcl(h,c,l,opacity){this.h=+h,this.c=+c,this.l=+l,this.opacity=+opacity}function cubehelixConvert(o){if(o instanceof Cubehelix)return new Cubehelix(o.h,o.s,o.l,o.opacity);o instanceof Rgb||(o=rgbConvert(o));var r=o.r/255,g=o.g/255,b=o.b/255,l=(BC_DA*b+ED*r-EB*g)/(BC_DA+ED-EB),bl=b-l,k=(E*(g-l)-C*bl)/D,s=Math.sqrt(k*k+bl*bl)/(E*l*(1-l)),h=s?Math.atan2(k,bl)*rad2deg-120:NaN;return new Cubehelix(h<0?h+360:h,s,l,o.opacity)}function cubehelix(h,s,l,opacity){return 1===arguments.length?cubehelixConvert(h):new Cubehelix(h,s,l,null==opacity?1:opacity)}function Cubehelix(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}function linear(a,d){return function(t){return a+t*d}}function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}function hue(a,b){var d=b-a;return d?linear(a,d>180||d<-180?d-360*Math.round(d/360):d):constant$3(isNaN(a)?b:a)}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?exponential(a,b,y):constant$3(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):constant$3(isNaN(a)?b:a)}function rgbSpline(spline){return function(colors){var i,color$$1,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color$$1=rgb(colors[i]),r[i]=color$$1.r||0,g[i]=color$$1.g||0,b[i]=color$$1.b||0;return r=spline(r),g=spline(g),b=spline(b),color$$1.opacity=1,function(t){return color$$1.r=r(t),color$$1.g=g(t),color$$1.b=b(t),color$$1+""}}}function zero(b){return function(){return b}}function one(b){return function(t){return b(t)+""}}function parseCss(value){return"none"===value?identity$2:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=value,value=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),value=value.slice(7,-1).split(","),decompose(+value[0],+value[1],+value[2],+value[3],+value[4],+value[5]))}function parseSvg(value){return null==value?identity$2:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?(value=value.matrix,decompose(value.a,value.b,value.c,value.d,value.e,value.f)):identity$2)}function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:reinterpolate(xa,xb)},{i:i-2,x:reinterpolate(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:reinterpolate(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:reinterpolate(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:reinterpolate(xa,xb)},{i:i-2,x:reinterpolate(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),translate(a.translateX,a.translateY,b.translateX,b.translateY,s,q),rotate(a.rotate,b.rotate,s,q),skewX(a.skewX,b.skewX,s,q),scale(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}function cosh(x){return((x=Math.exp(x))+1/x)/2}function sinh(x){return((x=Math.exp(x))-1/x)/2}function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}function hsl$1(hue$$1){return function(start,end){var h=hue$$1((start=hsl(start)).h,(end=hsl(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(t),start.opacity=opacity(t),start+""}}}function lab$1(start,end){var l=nogamma((start=lab(start)).l,(end=lab(end)).l),a=nogamma(start.a,end.a),b=nogamma(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.l=l(t),start.a=a(t),start.b=b(t),start.opacity=opacity(t),start+""}}function hcl$1(hue$$1){return function(start,end){var h=hue$$1((start=hcl(start)).h,(end=hcl(end)).h),c=nogamma(start.c,end.c),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.c=c(t),start.l=l(t),start.opacity=opacity(t),start+""}}}function cubehelix$1(hue$$1){return function cubehelixGamma(y){function cubehelix$$1(start,end){var h=hue$$1((start=cubehelix(start)).h,(end=cubehelix(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(Math.pow(t,y)),start.opacity=opacity(t),start+""}}return y=+y,cubehelix$$1.gamma=cubehelixGamma,cubehelix$$1}(1)}function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function nap(){for(var t0,t2,t1=taskHead,time=1/0;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}function sleep(time){if(!frame){timeout&&(timeout=clearTimeout(timeout));var delay=time-clockNow;delay>24?(time<1/0&&(timeout=setTimeout(wake,delay)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clockNow,interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function init(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id])||schedule.state>CREATED)throw new Error("too late");return schedule}function set$1(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id])||schedule.state>STARTING)throw new Error("too late");return schedule}function get$1(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("too late");return schedule}function create(node,id,self){function schedule(elapsed){self.state=SCHEDULED,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)}function start(elapsed){var i,j,n,o;if(self.state!==SCHEDULED)return stop();for(i in schedules)if(o=schedules[i],o.name===self.name){if(o.state===STARTED)return timeout$1(start);o.state===RUNNING?(o.state=ENDED,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=ENDED,o.timer.stop(),delete schedules[i])}if(timeout$1(function(){self.state===STARTED&&(self.state=RUNNING,self.timer.restart(tick,self.delay,self.time),tick(elapsed))}),self.state=STARTING,self.on.call("start",node,node.__data__,self.index,self.group),self.state===STARTING){for(self.state=STARTED,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=ENDING,1),i=-1,n=tween.length;++i<n;)tween[i].call(null,t);self.state===ENDING&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){self.state=ENDED,self.timer.stop(),delete schedules[id];for(var i in schedules)return;delete node.__transition}var tween,schedules=node.__transition;schedules[id]=self,self.timer=timer(schedule,0,self.time)}function tweenRemove(id,name){var tween0,tween1;return function(){var schedule=set$1(this,id),tween=schedule.tween;if(tween!==tween0){tween1=tween0=tween;for(var i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1=tween1.slice(),tween1.splice(i,1);break}}schedule.tween=tween1}}function tweenFunction(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=set$1(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name:name,value:value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}}function tweenValue(transition,name,value){var id=transition._id;return transition.each(function(){var schedule=set$1(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)}),function(node){return get$1(node,id).value[name]}}function attrRemove$1(name){return function(){this.removeAttribute(name)}}function attrRemoveNS$1(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant$1(name,interpolate$$1,value1){var value00,interpolate0;return function(){var value0=this.getAttribute(name);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate$$1(value00=value0,value1)}}function attrConstantNS$1(fullname,interpolate$$1,value1){var value00,interpolate0;return function(){var value0=this.getAttributeNS(fullname.space,fullname.local);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate$$1(value00=value0,value1)}}function attrFunction$1(name,interpolate$$1,value){var value00,value10,interpolate0;return function(){var value0,value1=value(this);return null==value1?void this.removeAttribute(name):(value0=this.getAttribute(name),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$1(value00=value0,value10=value1))}}function attrFunctionNS$1(fullname,interpolate$$1,value){var value00,value10,interpolate0;return function(){var value0,value1=value(this);return null==value1?void this.removeAttributeNS(fullname.space,fullname.local):(value0=this.getAttributeNS(fullname.space,fullname.local),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$1(value00=value0,value10=value1))}}function attrTweenNS(fullname,value){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.setAttributeNS(fullname.space,fullname.local,i(t))}}return tween._value=value,tween}function attrTween(name,value){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.setAttribute(name,i(t))}}return tween._value=value,tween}function delayFunction(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}function delayConstant(id,value){return value=+value,function(){init(this,id).delay=value}}function durationFunction(id,value){return function(){set$1(this,id).duration=+value.apply(this,arguments)}}function durationConstant(id,value){return value=+value,function(){set$1(this,id).duration=value}}function easeConstant(id,value){if("function"!=typeof value)throw new Error;return function(){set$1(this,id).ease=value}}function start(name){return(name+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t})}function onFunction(id,name,listener){var on0,on1,sit=start(name)?init:set$1;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}function removeFunction(id){return function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}}function styleRemove$1(name,interpolate$$2){var value00,value10,interpolate0;return function(){var style=window(this).getComputedStyle(this,null),value0=style.getPropertyValue(name),value1=(this.style.removeProperty(name),style.getPropertyValue(name));return value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$2(value00=value0,value10=value1)}}function styleRemoveEnd(name){return function(){this.style.removeProperty(name)}}function styleConstant$1(name,interpolate$$2,value1){var value00,interpolate0;return function(){
var value0=window(this).getComputedStyle(this,null).getPropertyValue(name);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate$$2(value00=value0,value1)}}function styleFunction$1(name,interpolate$$2,value){var value00,value10,interpolate0;return function(){var style=window(this).getComputedStyle(this,null),value0=style.getPropertyValue(name),value1=value(this);return null==value1&&(this.style.removeProperty(name),value1=style.getPropertyValue(name)),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$2(value00=value0,value10=value1)}}function styleTween(name,value,priority){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.style.setProperty(name,i(t),priority)}}return tween._value=value,tween}function textConstant$1(value){return function(){this.textContent=value}}function textFunction$1(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function transition(name){return selection().transition(name)}function newId(){return++id}function linear$1(t){return+t}function quadIn(t){return t*t}function quadOut(t){return t*(2-t)}function quadInOut(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function cubicIn(t){return t*t*t}function cubicOut(t){return--t*t*t+1}function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function sinIn(t){return 1-Math.cos(t*halfPi)}function sinOut(t){return Math.sin(t*halfPi)}function sinInOut(t){return(1-Math.cos(pi*t))/2}function expIn(t){return Math.pow(2,10*t-10)}function expOut(t){return 1-Math.pow(2,-10*t)}function expInOut(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function circleIn(t){return 1-Math.sqrt(1-t*t)}function circleOut(t){return Math.sqrt(1- --t*t)}function circleInOut(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function bounceIn(t){return 1-bounceOut(1-t)}function bounceOut(t){return(t=+t)<b1?b0*t*t:t<b3?b0*(t-=b2)*t+b4:t<b6?b0*(t-=b5)*t+b7:b0*(t-=b8)*t+b9}function bounceInOut(t){return((t*=2)<=1?1-bounceOut(1-t):bounceOut(t-1)+1)/2}function inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))return defaultTiming.time=now(),defaultTiming;return timing}function nopropagation$1(){exports.event.stopImmediatePropagation()}function type(t){return{type:t}}function defaultFilter(){return!exports.event.button}function defaultExtent(){var svg=this.ownerSVGElement||this;return[[0,0],[svg.width.baseVal.value,svg.height.baseVal.value]]}function local$$1(node){for(;!node.__brush;)if(!(node=node.parentNode))return;return node.__brush}function empty(extent){return extent[0][0]===extent[1][0]||extent[0][1]===extent[1][1]}function brushSelection(node){var state=node.__brush;return state?state.dim.output(state.selection):null}function brushX(){return brush$1(X)}function brushY(){return brush$1(Y)}function brush$1(dim){function brush(group){var overlay=group.property("__brush",initialize).selectAll(".overlay").data([type("overlay")]);overlay.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",cursors.overlay).merge(overlay).each(function(){var extent=local$$1(this).extent;select(this).attr("x",extent[0][0]).attr("y",extent[0][1]).attr("width",extent[1][0]-extent[0][0]).attr("height",extent[1][1]-extent[0][1])}),group.selectAll(".selection").data([type("selection")]).enter().append("rect").attr("class","selection").attr("cursor",cursors.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var handle=group.selectAll(".handle").data(dim.handles,function(d){return d.type});handle.exit().remove(),handle.enter().append("rect").attr("class",function(d){return"handle handle--"+d.type}).attr("cursor",function(d){return cursors[d.type]}),group.each(redraw).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",started)}function redraw(){var group=select(this),selection$$1=local$$1(this).selection;selection$$1?(group.selectAll(".selection").style("display",null).attr("x",selection$$1[0][0]).attr("y",selection$$1[0][1]).attr("width",selection$$1[1][0]-selection$$1[0][0]).attr("height",selection$$1[1][1]-selection$$1[0][1]),group.selectAll(".handle").style("display",null).attr("x",function(d){return"e"===d.type[d.type.length-1]?selection$$1[1][0]-handleSize/2:selection$$1[0][0]-handleSize/2}).attr("y",function(d){return"s"===d.type[0]?selection$$1[1][1]-handleSize/2:selection$$1[0][1]-handleSize/2}).attr("width",function(d){return"n"===d.type||"s"===d.type?selection$$1[1][0]-selection$$1[0][0]+handleSize:handleSize}).attr("height",function(d){return"e"===d.type||"w"===d.type?selection$$1[1][1]-selection$$1[0][1]+handleSize:handleSize})):group.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function emitter(that,args){return that.__brush.emitter||new Emitter(that,args)}function Emitter(that,args){this.that=that,this.args=args,this.state=that.__brush,this.active=0}function started(){function moved(){var point1=mouse(that);!shifting||lockX||lockY||(Math.abs(point1[0]-point[0])>Math.abs(point1[1]-point[1])?lockY=!0:lockX=!0),point=point1,moving=!0,noevent$1(),move()}function move(){var t;switch(dx=point[0]-point0[0],dy=point[1]-point0[1],mode){case MODE_SPACE:case MODE_DRAG:signX&&(dx=Math.max(W-w0,Math.min(E-e0,dx)),w1=w0+dx,e1=e0+dx),signY&&(dy=Math.max(N-n0,Math.min(S-s0,dy)),n1=n0+dy,s1=s0+dy);break;case MODE_HANDLE:signX<0?(dx=Math.max(W-w0,Math.min(E-w0,dx)),w1=w0+dx,e1=e0):signX>0&&(dx=Math.max(W-e0,Math.min(E-e0,dx)),w1=w0,e1=e0+dx),signY<0?(dy=Math.max(N-n0,Math.min(S-n0,dy)),n1=n0+dy,s1=s0):signY>0&&(dy=Math.max(N-s0,Math.min(S-s0,dy)),n1=n0,s1=s0+dy);break;case MODE_CENTER:signX&&(w1=Math.max(W,Math.min(E,w0-dx*signX)),e1=Math.max(W,Math.min(E,e0+dx*signX))),signY&&(n1=Math.max(N,Math.min(S,n0-dy*signY)),s1=Math.max(N,Math.min(S,s0+dy*signY)))}e1<w1&&(signX*=-1,t=w0,w0=e0,e0=t,t=w1,w1=e1,e1=t,type in flipX&&overlay.attr("cursor",cursors[type=flipX[type]])),s1<n1&&(signY*=-1,t=n0,n0=s0,s0=t,t=n1,n1=s1,s1=t,type in flipY&&overlay.attr("cursor",cursors[type=flipY[type]])),state.selection&&(selection$$1=state.selection),lockX&&(w1=selection$$1[0][0],e1=selection$$1[1][0]),lockY&&(n1=selection$$1[0][1],s1=selection$$1[1][1]),selection$$1[0][0]===w1&&selection$$1[0][1]===n1&&selection$$1[1][0]===e1&&selection$$1[1][1]===s1||(state.selection=[[w1,n1],[e1,s1]],redraw.call(that),emit.brush())}function ended(){if(nopropagation$1(),exports.event.touches){if(exports.event.touches.length)return;touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),group.on("touchmove.brush touchend.brush touchcancel.brush",null)}else yesdrag(exports.event.view,moving),view.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);group.attr("pointer-events","all"),overlay.attr("cursor",cursors.overlay),state.selection&&(selection$$1=state.selection),empty(selection$$1)&&(state.selection=null,redraw.call(that)),emit.end()}function keydowned(){switch(exports.event.keyCode){case 16:shifting=signX&&signY;break;case 18:mode===MODE_HANDLE&&(signX&&(e0=e1-dx*signX,w0=w1+dx*signX),signY&&(s0=s1-dy*signY,n0=n1+dy*signY),mode=MODE_CENTER,move());break;case 32:mode!==MODE_HANDLE&&mode!==MODE_CENTER||(signX<0?e0=e1-dx:signX>0&&(w0=w1-dx),signY<0?s0=s1-dy:signY>0&&(n0=n1-dy),mode=MODE_SPACE,overlay.attr("cursor",cursors.selection),move());break;default:return}noevent$1()}function keyupped(){switch(exports.event.keyCode){case 16:shifting&&(lockX=lockY=shifting=!1,move());break;case 18:mode===MODE_CENTER&&(signX<0?e0=e1:signX>0&&(w0=w1),signY<0?s0=s1:signY>0&&(n0=n1),mode=MODE_HANDLE,move());break;case 32:mode===MODE_SPACE&&(exports.event.altKey?(signX&&(e0=e1-dx*signX,w0=w1+dx*signX),signY&&(s0=s1-dy*signY,n0=n1+dy*signY),mode=MODE_CENTER):(signX<0?e0=e1:signX>0&&(w0=w1),signY<0?s0=s1:signY>0&&(n0=n1),mode=MODE_HANDLE),overlay.attr("cursor",cursors[type]),move());break;default:return}noevent$1()}if(exports.event.touches){if(exports.event.changedTouches.length<exports.event.touches.length)return noevent$1()}else if(touchending)return;if(filter.apply(this,arguments)){var w0,w1,n0,n1,e0,e1,s0,s1,dx,dy,moving,lockX,lockY,that=this,type=exports.event.target.__data__.type,mode="selection"===(exports.event.metaKey?type="overlay":type)?MODE_DRAG:exports.event.altKey?MODE_CENTER:MODE_HANDLE,signX=dim===Y?null:signsX[type],signY=dim===X?null:signsY[type],state=local$$1(that),extent=state.extent,selection$$1=state.selection,W=extent[0][0],N=extent[0][1],E=extent[1][0],S=extent[1][1],shifting=signX&&signY&&exports.event.shiftKey,point0=mouse(that),point=point0,emit=emitter(that,arguments).beforestart();"overlay"===type?state.selection=selection$$1=[[w0=dim===Y?W:point0[0],n0=dim===X?N:point0[1]],[e0=dim===Y?E:w0,s0=dim===X?S:n0]]:(w0=selection$$1[0][0],n0=selection$$1[0][1],e0=selection$$1[1][0],s0=selection$$1[1][1]),w1=w0,n1=n0,e1=e0,s1=s0;var group=select(that).attr("pointer-events","none"),overlay=group.selectAll(".overlay").attr("cursor",cursors[type]);if(exports.event.touches)group.on("touchmove.brush",moved,!0).on("touchend.brush touchcancel.brush",ended,!0);else{var view=select(exports.event.view).on("keydown.brush",keydowned,!0).on("keyup.brush",keyupped,!0).on("mousemove.brush",moved,!0).on("mouseup.brush",ended,!0);dragDisable(exports.event.view)}nopropagation$1(),interrupt(that),redraw.call(that),emit.start()}}function initialize(){var state=this.__brush||{selection:null};return state.extent=extent.apply(this,arguments),state.dim=dim,state}var touchending,extent=defaultExtent,filter=defaultFilter,listeners=dispatch(brush,"start","brush","end"),handleSize=6;return brush.move=function(group,selection$$1){group.selection?group.on("start.brush",function(){emitter(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){emitter(this,arguments).end()}).tween("brush",function(){function tween(t){state.selection=1===t&&empty(selection1)?null:i(t),redraw.call(that),emit.brush()}var that=this,state=that.__brush,emit=emitter(that,arguments),selection0=state.selection,selection1=dim.input("function"==typeof selection$$1?selection$$1.apply(this,arguments):selection$$1,state.extent),i=interpolateValue(selection0,selection1);return selection0&&selection1?tween:tween(1)}):group.each(function(){var that=this,args=arguments,state=that.__brush,selection1=dim.input("function"==typeof selection$$1?selection$$1.apply(that,args):selection$$1,state.extent),emit=emitter(that,args).beforestart();interrupt(that),state.selection=null==selection1||empty(selection1)?null:selection1,redraw.call(that),emit.start().brush().end()})},Emitter.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(type){customEvent(new BrushEvent(brush,type,dim.output(this.state.selection)),listeners.apply,listeners,[type,this.that,this.args])}},brush.extent=function(_){return arguments.length?(extent="function"==typeof _?_:constant$4([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),brush):extent},brush.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant$4(!!_),brush):filter},brush.handleSize=function(_){return arguments.length?(handleSize=+_,brush):handleSize},brush.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?brush:value},brush}function compareValue(compare){return function(a,b){return compare(a.source.value+a.target.value,b.source.value+b.target.value)}}function Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path(){return new Path}function defaultSource(d){return d.source}function defaultTarget(d){return d.target}function defaultRadius(d){return d.radius}function defaultStartAngle(d){return d.startAngle}function defaultEndAngle(d){return d.endAngle}function Map(){}function map$1(object,f){var map=new Map;if(object instanceof Map)object.each(function(value,key){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(null==f)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f(o=object[i],i,object),o)}else if(object)for(var key in object)map.set(key,object[key]);return map}function createObject(){return{}}function setObject(object,key,value){object[key]=value}function createMap(){return map$1()}function setMap(map,key,value){map.set(key,value)}function Set(){}function set$2(object,f){var set=new Set;if(object instanceof Set)object.each(function(value){set.add(value)});else if(object){var i=-1,n=object.length;if(null==f)for(;++i<n;)set.add(object[i]);else for(;++i<n;)set.add(f(object[i],i,object))}return set}function objectConverter(columns){return new Function("d","return {"+columns.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}")}function customConverter(columns,f){var object=objectConverter(columns);return function(row,i){return f(object(row),i,columns)}}function inferColumns(rows){var columnSet=Object.create(null),columns=[];return rows.forEach(function(row){for(var column in row)column in columnSet||columns.push(columnSet[column]=column)}),columns}function add(tree,x,y,d){if(isNaN(x)||isNaN(y))return tree;var parent,xm,ym,xp,yp,right,bottom,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,x1=tree._x1,y1=tree._y1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),x===xp&&y===yp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(4):tree._root=new Array(4),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym}while((i=bottom<<1|right)==(j=(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function addAll(data){var d,i,x,y,n=data.length,xz=new Array(n),yz=new Array(n),x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||(xz[i]=x,yz[i]=y,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y));for(x1<x0&&(x0=this._x0,x1=this._x1),y1<y0&&(y0=this._y0,y1=this._y1),this.cover(x0,y0).cover(x1,y1),i=0;i<n;++i)add(this,xz[i],yz[i],data[i]);return this}function removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this}function defaultX(d){return d[0]}function defaultY(d){return d[1]}function quadtree(nodes,x,y){var tree=new Quadtree(null==x?defaultX:x,null==y?defaultY:y,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Quadtree(x,y,x0,y0,x1,y1){this._x=x,this._y=y,this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}function x(d){return d.x+d.vx}function y(d){return d.y+d.vy}function index(d){return d.index}function find(nodeById,nodeId){var node=nodeById.get(nodeId);if(!node)throw new Error("missing: "+nodeId);return node}function x$1(d){return d.x}function y$1(d){return d.y}function FormatSpecifier(specifier){if(!(match=re.exec(specifier)))throw new Error("invalid format: "+specifier);var match,fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zero=!!match[5],width=match[6]&&+match[6],comma=!!match[7],precision=match[8]&&+match[8].slice(1),type=match[9]||"";"n"===type?(comma=!0,type="g"):formatTypes[type]||(type=""),(zero||"0"===fill&&"="===align)&&(zero=!0,fill="0",align="="),this.fill=fill,this.align=align,this.sign=sign,this.symbol=symbol,this.zero=zero,this.width=width,this.comma=comma,this.precision=precision,this.type=type}function identity$3(x){return x}function defaultLocale(definition){return locale$1=formatLocale(definition),exports.format=locale$1.format,exports.formatPrefix=locale$1.formatPrefix,locale$1}function Adder(){this.reset()}function add$1(adder,a,b){var x=adder.s=a+b,bv=x-a,av=x-bv;adder.t=a-av+(b-bv)}function acos(x){return x>1?0:x<-1?pi$3:Math.acos(x)}function asin(x){return x>1?halfPi$2:x<-1?-halfPi$2:Math.asin(x)}function haversin(x){return(x=sin$1(x/2))*x}function noop$1(){}function streamGeometry(geometry,stream){geometry&&streamGeometryType.hasOwnProperty(geometry.type)&&streamGeometryType[geometry.type](geometry,stream)}function streamLine(coordinates,stream,closed){var coordinate,i=-1,n=coordinates.length-closed;for(stream.lineStart();++i<n;)coordinate=coordinates[i],stream.point(coordinate[0],coordinate[1],coordinate[2]);stream.lineEnd()}function streamPolygon(coordinates,stream){var i=-1,n=coordinates.length;for(stream.polygonStart();++i<n;)streamLine(coordinates[i],stream,1);stream.polygonEnd()}function areaRingStart(){areaStream.point=areaPointFirst}function areaRingEnd(){areaPoint(lambda00,phi00)}function areaPointFirst(lambda,phi){areaStream.point=areaPoint,lambda00=lambda,phi00=phi,lambda*=radians,phi*=radians,lambda0=lambda,cosPhi0=cos$1(phi=phi/2+quarterPi),sinPhi0=sin$1(phi)}function areaPoint(lambda,phi){lambda*=radians,phi*=radians,phi=phi/2+quarterPi;var dLambda=lambda-lambda0,sdLambda=dLambda>=0?1:-1,adLambda=sdLambda*dLambda,cosPhi=cos$1(phi),sinPhi=sin$1(phi),k=sinPhi0*sinPhi,u=cosPhi0*cosPhi+k*cos$1(adLambda),v=k*sdLambda*sin$1(adLambda);areaRingSum.add(atan2(v,u)),lambda0=lambda,cosPhi0=cosPhi,sinPhi0=sinPhi}function spherical(cartesian){return[atan2(cartesian[1],cartesian[0]),asin(cartesian[2])]}function cartesian(spherical){var lambda=spherical[0],phi=spherical[1],cosPhi=cos$1(phi);return[cosPhi*cos$1(lambda),cosPhi*sin$1(lambda),sin$1(phi)]}function cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function cartesianAddInPlace(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function cartesianNormalizeInPlace(d){var l=sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l,d[1]/=l,d[2]/=l}function boundsPoint(lambda,phi){ranges.push(range=[lambda0$1=lambda,lambda1=lambda]),phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi)}function linePoint(lambda,phi){var p=cartesian([lambda*radians,phi*radians]);if(p0){var normal=cartesianCross(p0,p),equatorial=[normal[1],-normal[0],0],inflection=cartesianCross(equatorial,normal);cartesianNormalizeInPlace(inflection),inflection=spherical(inflection);var phii,delta=lambda-lambda2,sign$$1=delta>0?1:-1,lambdai=inflection[0]*degrees$1*sign$$1,antimeridian=abs(delta)>180;antimeridian^(sign$$1*lambda2<lambdai&&lambdai<sign$$1*lambda)?(phii=inflection[1]*degrees$1)>phi1&&(phi1=phii):(lambdai=(lambdai+360)%360-180,antimeridian^(sign$$1*lambda2<lambdai&&lambdai<sign$$1*lambda)?(phii=-inflection[1]*degrees$1)<phi0&&(phi0=phii):(phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi))),antimeridian?lambda<lambda2?angle(lambda0$1,lambda)>angle(lambda0$1,lambda1)&&(lambda1=lambda):angle(lambda,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=lambda):lambda1>=lambda0$1?(lambda<lambda0$1&&(lambda0$1=lambda),lambda>lambda1&&(lambda1=lambda)):lambda>lambda2?angle(lambda0$1,lambda)>angle(lambda0$1,lambda1)&&(lambda1=lambda):angle(lambda,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=lambda)}else ranges.push(range=[lambda0$1=lambda,lambda1=lambda]);phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi),p0=p,lambda2=lambda}function boundsLineStart(){boundsStream.point=linePoint}function boundsLineEnd(){range[0]=lambda0$1,range[1]=lambda1,boundsStream.point=boundsPoint,p0=null}function boundsRingPoint(lambda,phi){if(p0){var delta=lambda-lambda2;deltaSum.add(abs(delta)>180?delta+(delta>0?360:-360):delta)}else lambda00$1=lambda,phi00$1=phi;areaStream.point(lambda,phi),linePoint(lambda,phi)}function boundsRingStart(){areaStream.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream.lineEnd(),abs(deltaSum)>epsilon$2&&(lambda0$1=-(lambda1=180)),range[0]=lambda0$1,range[1]=lambda1,p0=null}function angle(lambda0,lambda1){return(lambda1-=lambda0)<0?lambda1+360:lambda1}function rangeCompare(a,b){return a[0]-b[0]}function rangeContains(range,x){return range[0]<=range[1]?range[0]<=x&&x<=range[1]:x<range[0]||range[1]<x}function centroidPoint(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos$1(phi);centroidPointCartesian(cosPhi*cos$1(lambda),cosPhi*sin$1(lambda),sin$1(phi))}function centroidPointCartesian(x,y,z){++W0,X0+=(x-X0)/W0,Y0+=(y-Y0)/W0,Z0+=(z-Z0)/W0}function centroidLineStart(){centroidStream.point=centroidLinePointFirst}function centroidLinePointFirst(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos$1(phi);x0=cosPhi*cos$1(lambda),y0=cosPhi*sin$1(lambda),z0=sin$1(phi),centroidStream.point=centroidLinePoint,centroidPointCartesian(x0,y0,z0)}function centroidLinePoint(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos$1(phi),x=cosPhi*cos$1(lambda),y=cosPhi*sin$1(lambda),z=sin$1(phi),w=atan2(sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);W1+=w,X1+=w*(x0+(x0=x)),Y1+=w*(y0+(y0=y)),Z1+=w*(z0+(z0=z)),centroidPointCartesian(x0,y0,z0)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidRingPointFirst}function centroidRingEnd(){centroidRingPoint(lambda00$2,phi00$2),centroidStream.point=centroidPoint}function centroidRingPointFirst(lambda,phi){lambda00$2=lambda,phi00$2=phi,lambda*=radians,phi*=radians,centroidStream.point=centroidRingPoint;var cosPhi=cos$1(phi);x0=cosPhi*cos$1(lambda),y0=cosPhi*sin$1(lambda),z0=sin$1(phi),centroidPointCartesian(x0,y0,z0)}function centroidRingPoint(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos$1(phi),x=cosPhi*cos$1(lambda),y=cosPhi*sin$1(lambda),z=sin$1(phi),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=sqrt(cx*cx+cy*cy+cz*cz),u=x0*x+y0*y+z0*z,v=m&&-asin(m)/m,w=atan2(m,u);X2+=v*cx,Y2+=v*cy,Z2+=v*cz,W1+=w,X1+=w*(x0+(x0=x)),Y1+=w*(y0+(y0=y)),Z1+=w*(z0+(z0=z)),centroidPointCartesian(x0,y0,z0)}function rotationIdentity(lambda,phi){return[lambda>pi$3?lambda-tau$3:lambda<-pi$3?lambda+tau$3:lambda,phi]}function rotateRadians(deltaLambda,deltaPhi,deltaGamma){return(deltaLambda%=tau$3)?deltaPhi||deltaGamma?compose(rotationLambda(deltaLambda),rotationPhiGamma(deltaPhi,deltaGamma)):rotationLambda(deltaLambda):deltaPhi||deltaGamma?rotationPhiGamma(deltaPhi,deltaGamma):rotationIdentity}function forwardRotationLambda(deltaLambda){return function(lambda,phi){return lambda+=deltaLambda,[lambda>pi$3?lambda-tau$3:lambda<-pi$3?lambda+tau$3:lambda,phi]}}function rotationLambda(deltaLambda){var rotation=forwardRotationLambda(deltaLambda);return rotation.invert=forwardRotationLambda(-deltaLambda),rotation}function rotationPhiGamma(deltaPhi,deltaGamma){function rotation(lambda,phi){var cosPhi=cos$1(phi),x=cos$1(lambda)*cosPhi,y=sin$1(lambda)*cosPhi,z=sin$1(phi),k=z*cosDeltaPhi+x*sinDeltaPhi;return[atan2(y*cosDeltaGamma-k*sinDeltaGamma,x*cosDeltaPhi-z*sinDeltaPhi),asin(k*cosDeltaGamma+y*sinDeltaGamma)]}var cosDeltaPhi=cos$1(deltaPhi),sinDeltaPhi=sin$1(deltaPhi),cosDeltaGamma=cos$1(deltaGamma),sinDeltaGamma=sin$1(deltaGamma);return rotation.invert=function(lambda,phi){var cosPhi=cos$1(phi),x=cos$1(lambda)*cosPhi,y=sin$1(lambda)*cosPhi,z=sin$1(phi),k=z*cosDeltaGamma-y*sinDeltaGamma;return[atan2(y*cosDeltaGamma+z*sinDeltaGamma,x*cosDeltaPhi+k*sinDeltaPhi),asin(k*cosDeltaPhi-x*sinDeltaPhi)]},rotation}function circleStream(stream,radius,delta,direction,t0,t1){if(delta){var cosRadius=cos$1(radius),sinRadius=sin$1(radius),step=direction*delta;null==t0?(t0=radius+direction*tau$3,t1=radius-step/2):(t0=circleRadius(cosRadius,t0),t1=circleRadius(cosRadius,t1),(direction>0?t0<t1:t0>t1)&&(t0+=direction*tau$3));for(var point,t=t0;direction>0?t>t1:t<t1;t-=step)point=spherical([cosRadius,-sinRadius*cos$1(t),-sinRadius*sin$1(t)]),stream.point(point[0],point[1])}}function circleRadius(cosRadius,point){point=cartesian(point),point[0]-=cosRadius,cartesianNormalizeInPlace(point);var radius=acos(-point[1]);return((-point[2]<0?-radius:radius)+tau$3-epsilon$2)%tau$3}function Intersection(point,points,other,entry){this.x=point,this.z=points,this.o=other,this.e=entry,this.v=!1,this.n=this.p=null}function link$1(array){if(n=array.length){for(var n,b,i=0,a=array[0];++i<n;)a.n=b=array[i],b.p=a,a=b;a.n=b=array[0],b.p=a}}function clipExtent(x0,y0,x1,y1){function visible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function interpolate(from,to,direction,stream){var a=0,a1=0;if(null==from||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoint(from,to)<0^direction>0)do{stream.point(0===a||3===a?x0:x1,a>1?y1:y0)}while((a=(a+direction+4)%4)!==a1);else stream.point(to[0],to[1])}function corner(p,direction){return abs(p[0]-x0)<epsilon$2?direction>0?0:3:abs(p[0]-x1)<epsilon$2?direction>0?2:1:abs(p[1]-y0)<epsilon$2?direction>0?1:0:direction>0?3:2}function compareIntersection(a,b){return comparePoint(a.x,b.x)}function comparePoint(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:0===ca?b[1]-a[1]:1===ca?a[0]-b[0]:2===ca?a[1]-b[1]:b[0]-a[0]}return function(stream){function point(x,y){visible(x,y)&&activeStream.point(x,y)}function polygonInside(){for(var winding=0,i=0,n=polygon.length;i<n;++i)for(var a0,a1,ring=polygon[i],j=1,m=ring.length,point=ring[0],b0=point[0],b1=point[1];j<m;++j)a0=b0,a1=b1,point=ring[j],b0=point[0],b1=point[1],a1<=y1?b1>y1&&(b0-a0)*(y1-a1)>(b1-a1)*(x0-a0)&&++winding:b1<=y1&&(b0-a0)*(y1-a1)<(b1-a1)*(x0-a0)&&--winding;return winding}function polygonStart(){activeStream=bufferStream,segments=[],polygon=[],clean=!0}function polygonEnd(){var startInside=polygonInside(),cleanInside=clean&&startInside,visible=(segments=merge(segments)).length;(cleanInside||visible)&&(stream.polygonStart(),cleanInside&&(stream.lineStart(),interpolate(null,null,1,stream),stream.lineEnd()),visible&&clipPolygon(segments,compareIntersection,startInside,interpolate,stream),stream.polygonEnd()),activeStream=stream,segments=polygon=ring=null}function lineStart(){clipStream.point=linePoint,polygon&&polygon.push(ring=[]),first=!0,v_=!1,x_=y_=NaN}function lineEnd(){segments&&(linePoint(x__,y__),v__&&v_&&bufferStream.rejoin(),segments.push(bufferStream.result())),clipStream.point=point,v_&&activeStream.lineEnd()}function linePoint(x,y){var v=visible(x,y);if(polygon&&ring.push([x,y]),first)x__=x,y__=y,v__=v,first=!1,v&&(activeStream.lineStart(),activeStream.point(x,y));else if(v&&v_)activeStream.point(x,y);else{var a=[x_=Math.max(clipMin,Math.min(clipMax,x_)),y_=Math.max(clipMin,Math.min(clipMax,y_))],b=[x=Math.max(clipMin,Math.min(clipMax,x)),y=Math.max(clipMin,Math.min(clipMax,y))];clipLine(a,b,x0,y0,x1,y1)?(v_||(activeStream.lineStart(),activeStream.point(a[0],a[1])),activeStream.point(b[0],b[1]),v||activeStream.lineEnd(),clean=!1):v&&(activeStream.lineStart(),activeStream.point(x,y),clean=!1)}x_=x,y_=y,v_=v}var segments,polygon,ring,x__,y__,v__,x_,y_,v_,first,clean,activeStream=stream,bufferStream=clipBuffer(),clipStream={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:polygonStart,polygonEnd:polygonEnd};return clipStream}}function lengthLineStart(){lengthStream.point=lengthPointFirst,lengthStream.lineEnd=lengthLineEnd}function lengthLineEnd(){lengthStream.point=lengthStream.lineEnd=noop$1}function lengthPointFirst(lambda,phi){lambda*=radians,phi*=radians,lambda0$2=lambda,sinPhi0$1=sin$1(phi),cosPhi0$1=cos$1(phi),lengthStream.point=lengthPoint}function lengthPoint(lambda,phi){lambda*=radians,phi*=radians;var sinPhi=sin$1(phi),cosPhi=cos$1(phi),delta=abs(lambda-lambda0$2),cosDelta=cos$1(delta),sinDelta=sin$1(delta),x=cosPhi*sinDelta,y=cosPhi0$1*sinPhi-sinPhi0$1*cosPhi*cosDelta,z=sinPhi0$1*sinPhi+cosPhi0$1*cosPhi*cosDelta;lengthSum.add(atan2(sqrt(x*x+y*y),z)),lambda0$2=lambda,sinPhi0$1=sinPhi,cosPhi0$1=cosPhi}function graticuleX(y0,y1,dy){var y=sequence(y0,y1-epsilon$2,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function graticuleY(x0,x1,dx){var x=sequence(x0,x1-epsilon$2,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function graticule(){function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return sequence(ceil(X0/DX)*DX,X1,DX).map(X).concat(sequence(ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(sequence(ceil(x0/dx)*dx,x1,dx).filter(function(x){return abs(x%DX)>epsilon$2}).map(x)).concat(sequence(ceil(y0/dy)*dy,y1,dy).filter(function(y){return abs(y%DY)>epsilon$2}).map(y))}var x1,x0,X1,X0,y1,y0,Y1,Y0,x,y,X,Y,dx=10,dy=dx,DX=90,DY=360,precision=2.5;return graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})},graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}},graticule.extent=function(_){return arguments.length?graticule.extentMajor(_).extentMinor(_):graticule.extentMinor()},graticule.extentMajor=function(_){return arguments.length?(X0=+_[0][0],X1=+_[1][0],Y0=+_[0][1],Y1=+_[1][1],X0>X1&&(_=X0,X0=X1,X1=_),Y0>Y1&&(_=Y0,Y0=Y1,Y1=_),graticule.precision(precision)):[[X0,Y0],[X1,Y1]]},graticule.extentMinor=function(_){return arguments.length?(x0=+_[0][0],x1=+_[1][0],y0=+_[0][1],y1=+_[1][1],x0>x1&&(_=x0,x0=x1,x1=_),y0>y1&&(_=y0,y0=y1,y1=_),graticule.precision(precision)):[[x0,y0],[x1,y1]]},graticule.step=function(_){return arguments.length?graticule.stepMajor(_).stepMinor(_):graticule.stepMinor()},graticule.stepMajor=function(_){return arguments.length?(DX=+_[0],DY=+_[1],graticule):[DX,DY]},graticule.stepMinor=function(_){return arguments.length?(dx=+_[0],dy=+_[1],graticule):[dx,dy]},graticule.precision=function(_){return arguments.length?(precision=+_,x=graticuleX(y0,y1,90),y=graticuleY(x0,x1,precision),X=graticuleX(Y0,Y1,90),Y=graticuleY(X0,X1,precision),graticule):precision},graticule.extentMajor([[-180,-90+epsilon$2],[180,90-epsilon$2]]).extentMinor([[-180,-80-epsilon$2],[180,80+epsilon$2]])}function graticule10(){return graticule()()}function areaRingStart$1(){areaStream$1.point=areaPointFirst$1}function areaPointFirst$1(x,y){areaStream$1.point=areaPoint$1,x00=x0$1=x,y00=y0$1=y}function areaPoint$1(x,y){areaRingSum$1.add(y0$1*x-x0$1*y),x0$1=x,y0$1=y}function areaRingEnd$1(){areaPoint$1(x00,y00)}function boundsPoint$1(x,y){x<x0$2&&(x0$2=x),x>x1&&(x1=x),y<y0$2&&(y0$2=y),y>y1&&(y1=y)}function centroidPoint$1(x,y){X0$1+=x,Y0$1+=y,++Z0$1}function centroidLineStart$1(){centroidStream$1.point=centroidPointFirstLine}function centroidPointFirstLine(x,y){centroidStream$1.point=centroidPointLine,centroidPoint$1(x0$3=x,y0$3=y)}function centroidPointLine(x,y){var dx=x-x0$3,dy=y-y0$3,z=sqrt(dx*dx+dy*dy);X1$1+=z*(x0$3+x)/2,Y1$1+=z*(y0$3+y)/2,Z1$1+=z,centroidPoint$1(x0$3=x,y0$3=y)}function centroidLineEnd$1(){centroidStream$1.point=centroidPoint$1}function centroidRingStart$1(){centroidStream$1.point=centroidPointFirstRing}function centroidRingEnd$1(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(x,y){centroidStream$1.point=centroidPointRing,centroidPoint$1(x00$1=x0$3=x,y00$1=y0$3=y)}function centroidPointRing(x,y){var dx=x-x0$3,dy=y-y0$3,z=sqrt(dx*dx+dy*dy);X1$1+=z*(x0$3+x)/2,Y1$1+=z*(y0$3+y)/2,Z1$1+=z,z=y0$3*x-x0$3*y,X2$1+=z*(x0$3+x),Y2$1+=z*(y0$3+y),Z2$1+=3*z,centroidPoint$1(x0$3=x,y0$3=y)}function PathContext(context){this._context=context}function lengthPointFirst$1(x,y){lengthStream$1.point=lengthPoint$1,x00$2=x0$4=x,y00$2=y0$4=y}function lengthPoint$1(x,y){x0$4-=x,y0$4-=y,lengthSum$1.add(sqrt(x0$4*x0$4+y0$4*y0$4)),x0$4=x,y0$4=y
}function PathString(){this._string=[]}function circle$1(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}function validSegment(segment){return segment.length>1}function compareIntersection(a,b){return((a=a.x)[0]<0?a[1]-halfPi$2-epsilon$2:halfPi$2-a[1])-((b=b.x)[0]<0?b[1]-halfPi$2-epsilon$2:halfPi$2-b[1])}function clipAntimeridianLine(stream){var clean,lambda0=NaN,phi0=NaN,sign0=NaN;return{lineStart:function(){stream.lineStart(),clean=1},point:function(lambda1,phi1){var sign1=lambda1>0?pi$3:-pi$3,delta=abs(lambda1-lambda0);abs(delta-pi$3)<epsilon$2?(stream.point(lambda0,phi0=(phi0+phi1)/2>0?halfPi$2:-halfPi$2),stream.point(sign0,phi0),stream.lineEnd(),stream.lineStart(),stream.point(sign1,phi0),stream.point(lambda1,phi0),clean=0):sign0!==sign1&&delta>=pi$3&&(abs(lambda0-sign0)<epsilon$2&&(lambda0-=sign0*epsilon$2),abs(lambda1-sign1)<epsilon$2&&(lambda1-=sign1*epsilon$2),phi0=clipAntimeridianIntersect(lambda0,phi0,lambda1,phi1),stream.point(sign0,phi0),stream.lineEnd(),stream.lineStart(),stream.point(sign1,phi0),clean=0),stream.point(lambda0=lambda1,phi0=phi1),sign0=sign1},lineEnd:function(){stream.lineEnd(),lambda0=phi0=NaN},clean:function(){return 2-clean}}}function clipAntimeridianIntersect(lambda0,phi0,lambda1,phi1){var cosPhi0,cosPhi1,sinLambda0Lambda1=sin$1(lambda0-lambda1);return abs(sinLambda0Lambda1)>epsilon$2?atan((sin$1(phi0)*(cosPhi1=cos$1(phi1))*sin$1(lambda1)-sin$1(phi1)*(cosPhi0=cos$1(phi0))*sin$1(lambda0))/(cosPhi0*cosPhi1*sinLambda0Lambda1)):(phi0+phi1)/2}function clipAntimeridianInterpolate(from,to,direction,stream){var phi;if(null==from)phi=direction*halfPi$2,stream.point(-pi$3,phi),stream.point(0,phi),stream.point(pi$3,phi),stream.point(pi$3,0),stream.point(pi$3,-phi),stream.point(0,-phi),stream.point(-pi$3,-phi),stream.point(-pi$3,0),stream.point(-pi$3,phi);else if(abs(from[0]-to[0])>epsilon$2){var lambda=from[0]<to[0]?pi$3:-pi$3;phi=direction*lambda/2,stream.point(-lambda,phi),stream.point(0,phi),stream.point(lambda,phi)}else stream.point(to[0],to[1])}function transformer(methods){return function(stream){var s=new TransformStream;for(var key in methods)s[key]=methods[key];return s.stream=stream,s}}function TransformStream(){}function fitExtent(projection,extent,object){var w=extent[1][0]-extent[0][0],h=extent[1][1]-extent[0][1],clip=projection.clipExtent&&projection.clipExtent();projection.scale(150).translate([0,0]),null!=clip&&projection.clipExtent(null),geoStream(object,projection.stream(boundsStream$1));var b=boundsStream$1.result(),k=Math.min(w/(b[1][0]-b[0][0]),h/(b[1][1]-b[0][1])),x=+extent[0][0]+(w-k*(b[1][0]+b[0][0]))/2,y=+extent[0][1]+(h-k*(b[1][1]+b[0][1]))/2;return null!=clip&&projection.clipExtent(clip),projection.scale(150*k).translate([x,y])}function fitSize(projection,size,object){return fitExtent(projection,[[0,0],size],object)}function resampleNone(project){return transformer({point:function(x,y){x=project(x,y),this.stream.point(x[0],x[1])}})}function resample$1(project,delta2){function resampleLineTo(x0,y0,lambda0,a0,b0,c0,x1,y1,lambda1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*delta2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=sqrt(a*a+b*b+c*c),phi2=asin(c/=m),lambda2=abs(abs(c)-1)<epsilon$2||abs(lambda0-lambda1)<epsilon$2?(lambda0+lambda1)/2:atan2(b,a),p=project(lambda2,phi2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;(dz*dz/d2>delta2||abs((dx*dx2+dy*dy2)/d2-.5)>.3||a0*a1+b0*b1+c0*c1<cosMinDistance)&&(resampleLineTo(x0,y0,lambda0,a0,b0,c0,x2,y2,lambda2,a/=m,b/=m,c,depth,stream),stream.point(x2,y2),resampleLineTo(x2,y2,lambda2,a,b,c,x1,y1,lambda1,a1,b1,c1,depth,stream))}}return function(stream){function point(x,y){x=project(x,y),stream.point(x[0],x[1])}function lineStart(){x0=NaN,resampleStream.point=linePoint,stream.lineStart()}function linePoint(lambda,phi){var c=cartesian([lambda,phi]),p=project(lambda,phi);resampleLineTo(x0,y0,lambda0,a0,b0,c0,x0=p[0],y0=p[1],lambda0=lambda,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream),stream.point(x0,y0)}function lineEnd(){resampleStream.point=point,stream.lineEnd()}function ringStart(){lineStart(),resampleStream.point=ringPoint,resampleStream.lineEnd=ringEnd}function ringPoint(lambda,phi){linePoint(lambda00=lambda,phi),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0,resampleStream.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,lambda0,a0,b0,c0,x00,y00,lambda00,a00,b00,c00,maxDepth,stream),resampleStream.lineEnd=lineEnd,lineEnd()}var lambda00,x00,y00,a00,b00,c00,lambda0,x0,y0,a0,b0,c0,resampleStream={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart(),resampleStream.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd(),resampleStream.lineStart=lineStart}};return resampleStream}}function projection(project){return projectionMutator(function(){return project})()}function projectionMutator(projectAt){function projection(point){return point=projectRotate(point[0]*radians,point[1]*radians),[point[0]*k+dx,dy-point[1]*k]}function invert(point){return(point=projectRotate.invert((point[0]-dx)/k,(dy-point[1])/k))&&[point[0]*degrees$1,point[1]*degrees$1]}function projectTransform(x,y){return x=project(x,y),[x[0]*k+dx,dy-x[1]*k]}function recenter(){projectRotate=compose(rotate=rotateRadians(deltaLambda,deltaPhi,deltaGamma),project);var center=project(lambda,phi);return dx=x-center[0]*k,dy=y+center[1]*k,reset()}function reset(){return cache=cacheStream=null,projection}var project,dx,dy,rotate,projectRotate,y0,x1,y1,cache,cacheStream,k=150,x=480,y=250,lambda=0,phi=0,deltaLambda=0,deltaPhi=0,deltaGamma=0,theta=null,preclip=clipAntimeridian,x0=null,postclip=identity$4,delta2=.5,projectResample=resample(projectTransform,delta2);return projection.stream=function(stream){return cache&&cacheStream===stream?cache:cache=transformRadians(preclip(rotate,projectResample(postclip(cacheStream=stream))))},projection.clipAngle=function(_){return arguments.length?(preclip=+_?clipCircle(theta=_*radians,6*radians):(theta=null,clipAntimeridian),reset()):theta*degrees$1},projection.clipExtent=function(_){return arguments.length?(postclip=null==_?(x0=y0=x1=y1=null,identity$4):clipExtent(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reset()):null==x0?null:[[x0,y0],[x1,y1]]},projection.scale=function(_){return arguments.length?(k=+_,recenter()):k},projection.translate=function(_){return arguments.length?(x=+_[0],y=+_[1],recenter()):[x,y]},projection.center=function(_){return arguments.length?(lambda=_[0]%360*radians,phi=_[1]%360*radians,recenter()):[lambda*degrees$1,phi*degrees$1]},projection.rotate=function(_){return arguments.length?(deltaLambda=_[0]%360*radians,deltaPhi=_[1]%360*radians,deltaGamma=_.length>2?_[2]%360*radians:0,recenter()):[deltaLambda*degrees$1,deltaPhi*degrees$1,deltaGamma*degrees$1]},projection.precision=function(_){return arguments.length?(projectResample=resample(projectTransform,delta2=_*_),reset()):sqrt(delta2)},projection.fitExtent=function(extent,object){return fitExtent(projection,extent,object)},projection.fitSize=function(size,object){return fitSize(projection,size,object)},function(){return project=projectAt.apply(this,arguments),projection.invert=project.invert&&invert,recenter()}}function conicProjection(projectAt){var phi0=0,phi1=pi$3/3,m=projectionMutator(projectAt),p=m(phi0,phi1);return p.parallels=function(_){return arguments.length?m(phi0=_[0]*radians,phi1=_[1]*radians):[phi0*degrees$1,phi1*degrees$1]},p}function cylindricalEqualAreaRaw(phi0){function forward(lambda,phi){return[lambda*cosPhi0,sin$1(phi)/cosPhi0]}var cosPhi0=cos$1(phi0);return forward.invert=function(x,y){return[x/cosPhi0,asin(y*cosPhi0)]},forward}function conicEqualAreaRaw(y0,y1){function project(x,y){var r=sqrt(c-2*n*sin$1(y))/n;return[r*sin$1(x*=n),r0-r*cos$1(x)]}var sy0=sin$1(y0),n=(sy0+sin$1(y1))/2;if(abs(n)<epsilon$2)return cylindricalEqualAreaRaw(y0);var c=1+sy0*(2*n-sy0),r0=sqrt(c)/n;return project.invert=function(x,y){var r0y=r0-y;return[atan2(x,abs(r0y))/n*sign(r0y),asin((c-(x*x+r0y*r0y)*n*n)/(2*n))]},project}function multiplex(streams){var n=streams.length;return{point:function(x,y){for(var i=-1;++i<n;)streams[i].point(x,y)},sphere:function(){for(var i=-1;++i<n;)streams[i].sphere()},lineStart:function(){for(var i=-1;++i<n;)streams[i].lineStart()},lineEnd:function(){for(var i=-1;++i<n;)streams[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<n;)streams[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<n;)streams[i].polygonEnd()}}}function azimuthalRaw(scale){return function(x,y){var cx=cos$1(x),cy=cos$1(y),k=scale(cx*cy);return[k*cy*sin$1(x),k*sin$1(y)]}}function azimuthalInvert(angle){return function(x,y){var z=sqrt(x*x+y*y),c=angle(z),sc=sin$1(c),cc=cos$1(c);return[atan2(x*sc,z*cc),asin(z&&y*sc/z)]}}function mercatorRaw(lambda,phi){return[lambda,log(tan((halfPi$2+phi)/2))]}function mercatorProjection(project){var clipAuto,m=projection(project),scale=m.scale,translate=m.translate,clipExtent=m.clipExtent;return m.scale=function(_){return arguments.length?(scale(_),clipAuto&&m.clipExtent(null),m):scale()},m.translate=function(_){return arguments.length?(translate(_),clipAuto&&m.clipExtent(null),m):translate()},m.clipExtent=function(_){if(!arguments.length)return clipAuto?null:clipExtent();if(clipAuto=null==_){var k=pi$3*scale(),t=translate();_=[[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]]}return clipExtent(_),m},m.clipExtent(null)}function tany(y){return tan((halfPi$2+y)/2)}function conicConformalRaw(y0,y1){function project(x,y){f>0?y<-halfPi$2+epsilon$2&&(y=-halfPi$2+epsilon$2):y>halfPi$2-epsilon$2&&(y=halfPi$2-epsilon$2);var r=f/pow(tany(y),n);return[r*sin$1(n*x),f-r*cos$1(n*x)]}var cy0=cos$1(y0),n=y0===y1?sin$1(y0):log(cy0/cos$1(y1))/log(tany(y1)/tany(y0)),f=cy0*pow(tany(y0),n)/n;return n?(project.invert=function(x,y){var fy=f-y,r=sign(n)*sqrt(x*x+fy*fy);return[atan2(x,abs(fy))/n*sign(fy),2*atan(pow(f/r,1/n))-halfPi$2]},project):mercatorRaw}function equirectangularRaw(lambda,phi){return[lambda,phi]}function conicEquidistantRaw(y0,y1){function project(x,y){var gy=g-y,nx=n*x;return[gy*sin$1(nx),g-gy*cos$1(nx)]}var cy0=cos$1(y0),n=y0===y1?sin$1(y0):(cy0-cos$1(y1))/(y1-y0),g=cy0/n+y0;return abs(n)<epsilon$2?equirectangularRaw:(project.invert=function(x,y){var gy=g-y;return[atan2(x,abs(gy))/n*sign(gy),g-sign(n)*sqrt(x*x+gy*gy)]},project)}function gnomonicRaw(x,y){var cy=cos$1(y),k=cos$1(x)*cy;return[cy*sin$1(x)/k,sin$1(y)/k]}function scaleTranslate(kx,ky,tx,ty){return 1===kx&&1===ky&&0===tx&&0===ty?identity$4:transformer({point:function(x,y){this.stream.point(x*kx+tx,y*ky+ty)}})}function orthographicRaw(x,y){return[cos$1(y)*sin$1(x),sin$1(y)]}function stereographicRaw(x,y){var cy=cos$1(y),k=1+cos$1(x)*cy;return[cy*sin$1(x)/k,sin$1(y)/k]}function transverseMercatorRaw(lambda,phi){return[log(tan((halfPi$2+phi)/2)),-lambda]}function defaultSeparation(a,b){return a.parent===b.parent?1:2}function meanX(children){return children.reduce(meanXReduce,0)/children.length}function meanXReduce(x,c){return x+c.x}function maxY(children){return 1+children.reduce(maxYReduce,0)}function maxYReduce(y,c){return Math.max(y,c.y)}function leafLeft(node){for(var children;children=node.children;)node=children[0];return node}function leafRight(node){for(var children;children=node.children;)node=children[children.length-1];return node}function count(node){var sum=0,children=node.children,i=children&&children.length;if(i)for(;--i>=0;)sum+=children[i].value;else sum=1;node.value=sum}function leastCommonAncestor(a,b){if(a===b)return a;var aNodes=a.ancestors(),bNodes=b.ancestors(),c=null;for(a=aNodes.pop(),b=bNodes.pop();a===b;)c=a,a=aNodes.pop(),b=bNodes.pop();return c}function hierarchy(data,children){var node,child,childs,i,n,root=new Node(data),valued=+data.value&&(root.value=data.value),nodes=[root];for(null==children&&(children=defaultChildren);node=nodes.pop();)if(valued&&(node.value=+node.data.value),(childs=children(node.data))&&(n=childs.length))for(node.children=new Array(n),i=n-1;i>=0;--i)nodes.push(child=node.children[i]=new Node(childs[i])),child.parent=node,child.depth=node.depth+1;return root.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function defaultChildren(d){return d.children}function copyData(node){node.data=node.data.data}function computeHeight(node){var height=0;do{node.height=height}while((node=node.parent)&&node.height<++height)}function Node(data){this.data=data,this.depth=this.height=0,this.parent=null}function Node$2(value){this._=value,this.next=null}function encloses(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r-b.r;return dr*dr+1e-6>dx*dx+dy*dy}function encloseN(L,B){var circle,l2,p1,l0=null,l1=L.head;switch(B.length){case 1:circle=enclose1(B[0]);break;case 2:circle=enclose2(B[0],B[1]);break;case 3:circle=enclose3(B[0],B[1],B[2])}for(;l1;)p1=l1._,l2=l1.next,circle&&encloses(circle,p1)?l0=l1:(l0?(L.tail=l0,l0.next=null):L.head=L.tail=null,B.push(p1),circle=encloseN(L,B),B.pop(),L.head?(l1.next=L.head,L.head=l1):(l1.next=null,L.head=L.tail=l1),l0=L.tail,l0.next=l2),l1=l2;return L.tail=l0,circle}function enclose1(a){return{x:a.x,y:a.y,r:a.r}}function enclose2(a,b){var x1=a.x,y1=a.y,r1=a.r,x2=b.x,y2=b.y,r2=b.r,x21=x2-x1,y21=y2-y1,r21=r2-r1,l=Math.sqrt(x21*x21+y21*y21);return{x:(x1+x2+x21/l*r21)/2,y:(y1+y2+y21/l*r21)/2,r:(l+r1+r2)/2}}function enclose3(a,b,c){var x1=a.x,y1=a.y,r1=a.r,x2=b.x,y2=b.y,r2=b.r,x3=c.x,y3=c.y,r3=c.r,a2=2*(x1-x2),b2=2*(y1-y2),c2=2*(r2-r1),d2=x1*x1+y1*y1-r1*r1-x2*x2-y2*y2+r2*r2,a3=2*(x1-x3),b3=2*(y1-y3),c3=2*(r3-r1),d3=x1*x1+y1*y1-r1*r1-x3*x3-y3*y3+r3*r3,ab=a3*b2-a2*b3,xa=(b2*d3-b3*d2)/ab-x1,xb=(b3*c2-b2*c3)/ab,ya=(a3*d2-a2*d3)/ab-y1,yb=(a2*c3-a3*c2)/ab,A=xb*xb+yb*yb-1,B=2*(xa*xb+ya*yb+r1),C=xa*xa+ya*ya-r1*r1,r=(-B-Math.sqrt(B*B-4*A*C))/(2*A);return{x:xa+xb*r+x1,y:ya+yb*r+y1,r:r}}function place(a,b,c){var ax=a.x,ay=a.y,da=b.r+c.r,db=a.r+c.r,dx=b.x-ax,dy=b.y-ay,dc=dx*dx+dy*dy;if(dc){var x=.5+((db*=db)-(da*=da))/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=ax+x*dx+y*dy,c.y=ay+x*dy-y*dx}else c.x=ax+db,c.y=ay}function intersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return dr*dr-1e-6>dx*dx+dy*dy}function distance1(a,b){for(var l=a._.r;a!==b;)l+=2*(a=a.next)._.r;return l-b._.r}function distance2(node,x,y){var a=node._,b=node.next._,ab=a.r+b.r,dx=(a.x*b.r+b.x*a.r)/ab-x,dy=(a.y*b.r+b.y*a.r)/ab-y;return dx*dx+dy*dy}function Node$1(circle){this._=circle,this.next=null,this.previous=null}function packEnclose(circles){if(!(n=circles.length))return 0;var a,b,c,n;if(a=circles[0],a.x=0,a.y=0,!(n>1))return a.r;if(b=circles[1],a.x=-b.r,b.x=a.r,b.y=0,!(n>2))return a.r+b.r;place(b,a,c=circles[2]);var cx,cy,i,j,k,sj,sk,aa=a.r*a.r,ba=b.r*b.r,ca=c.r*c.r,oa=aa+ba+ca,ox=aa*a.x+ba*b.x+ca*c.x,oy=aa*a.y+ba*b.y+ca*c.y;a=new Node$1(a),b=new Node$1(b),c=new Node$1(c),a.next=c.previous=b,b.next=a.previous=c,c.next=b.previous=a;pack:for(i=3;i<n;++i){place(a._,b._,c=circles[i]),c=new Node$1(c),j=b.next,k=a.previous,sj=b._.r,sk=a._.r;do{if(sj<=sk){if(intersects(j._,c._)){sj+a._.r+b._.r>distance1(j,b)?a=j:b=j,a.next=b,b.previous=a,--i;continue pack}sj+=j._.r,j=j.next}else{if(intersects(k._,c._)){distance1(a,k)>sk+a._.r+b._.r?a=k:b=k,a.next=b,b.previous=a,--i;continue pack}sk+=k._.r,k=k.previous}}while(j!==k.next);for(c.previous=a,c.next=b,a.next=b.previous=b=c,oa+=ca=c._.r*c._.r,ox+=ca*c._.x,oy+=ca*c._.y,aa=distance2(a,cx=ox/oa,cy=oy/oa);(c=c.next)!==b;)(ca=distance2(c,cx,cy))<aa&&(a=c,aa=ca);b=a.next}for(a=[b._],c=b;(c=c.next)!==b;)a.push(c._);for(c=enclose(a),i=0;i<n;++i)a=circles[i],a.x-=c.x,a.y-=c.y;return c.r}function optional(f){return null==f?null:required(f)}function required(f){if("function"!=typeof f)throw new Error;return f}function constantZero(){return 0}function defaultRadius$1(d){return Math.sqrt(d.value)}function radiusLeaf(radius){return function(node){node.children||(node.r=Math.max(0,+radius(node)||0))}}function packChildren(padding,k){return function(node){if(children=node.children){var children,i,e,n=children.length,r=padding(node)*k||0;if(r)for(i=0;i<n;++i)children[i].r+=r;if(e=packEnclose(children),r)for(i=0;i<n;++i)children[i].r-=r;node.r=e+r}}}function translateChild(k){return function(node){var parent=node.parent;node.r*=k,parent&&(node.x=parent.x+k*node.x,node.y=parent.y+k*node.y)}}function defaultId(d){return d.id}function defaultParentId(d){return d.parentId}function defaultSeparation$1(a,b){return a.parent===b.parent?1:2}function nextLeft(v){var children=v.children;return children?children[0]:v.t}function nextRight(v){var children=v.children;return children?children[children.length-1]:v.t}function moveSubtree(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change,wp.s+=shift,wm.c+=change,wp.z+=shift,wp.m+=shift}function executeShifts(v){for(var w,shift=0,change=0,children=v.children,i=children.length;--i>=0;)w=children[i],w.z+=shift,w.m+=shift,shift+=w.s+(change+=w.c)}function nextAncestor(vim,v,ancestor){return vim.a.parent===v.parent?vim.a:ancestor}function TreeNode(node,i){this._=node,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}function treeRoot(root){for(var node,child,children,i,n,tree=new TreeNode(root,0),nodes=[tree];node=nodes.pop();)if(children=node._.children)for(node.children=new Array(n=children.length),i=n-1;i>=0;--i)nodes.push(child=node.children[i]=new TreeNode(children[i],i)),child.parent=node;return(tree.parent=new TreeNode(null,0)).children=[tree],tree}function squarifyRatio(ratio,parent,x0,y0,x1,y1){for(var row,nodeValue,dx,dy,sumValue,minValue,maxValue,newRatio,minRatio,alpha,beta,rows=[],nodes=parent.children,i0=0,i1=0,n=nodes.length,value=parent.value;i0<n;){dx=x1-x0,dy=y1-y0;do{sumValue=nodes[i1++].value}while(!sumValue&&i1<n);for(minValue=maxValue=sumValue,alpha=Math.max(dy/dx,dx/dy)/(value*ratio),beta=sumValue*sumValue*alpha,minRatio=Math.max(maxValue/beta,beta/minValue);i1<n;++i1){if(sumValue+=nodeValue=nodes[i1].value,nodeValue<minValue&&(minValue=nodeValue),nodeValue>maxValue&&(maxValue=nodeValue),beta=sumValue*sumValue*alpha,(newRatio=Math.max(maxValue/beta,beta/minValue))>minRatio){sumValue-=nodeValue;break}minRatio=newRatio}rows.push(row={value:sumValue,dice:dx<dy,children:nodes.slice(i0,i1)}),row.dice?treemapDice(row,x0,y0,x1,value?y0+=dy*sumValue/value:y1):treemapSlice(row,x0,y0,value?x0+=dx*sumValue/value:x1,y1),value-=sumValue,i0=i1}return rows}function lexicographicOrder(a,b){return a[0]-b[0]||a[1]-b[1]}function computeUpperHullIndexes(points){for(var n=points.length,indexes=[0,1],size=2,i=2;i<n;++i){for(;size>1&&cross(points[indexes[size-2]],points[indexes[size-1]],points[i])<=0;)--size;indexes[size++]=i}return indexes.slice(0,size)}function Queue(size){if(!(size>=1))throw new Error;this._size=size,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function poke$1(q){if(!q._start)try{start$1(q)}catch(e){if(q._tasks[q._ended+q._active-1])abort(q,e);else if(!q._data)throw e}}function start$1(q){for(;q._start=q._waiting&&q._active<q._size;){var i=q._ended+q._active,t=q._tasks[i],j=t.length-1,c=t[j];t[j]=end(q,i),--q._waiting,++q._active,t=c.apply(null,t),q._tasks[i]&&(q._tasks[i]=t||noabort)}}function end(q,i){return function(e,r){q._tasks[i]&&(--q._active,++q._ended,q._tasks[i]=null,null==q._error&&(null!=e?abort(q,e):(q._data[i]=r,q._waiting?poke$1(q):maybeNotify(q))))}}function abort(q,e){var t,i=q._tasks.length;for(q._error=e,q._data=void 0,q._waiting=NaN;--i>=0;)if((t=q._tasks[i])&&(q._tasks[i]=null,t.abort))try{t.abort()}catch(e){}q._active=NaN,maybeNotify(q)}function maybeNotify(q){if(!q._active&&q._call){var d=q._data;q._data=void 0,q._call(q._error,d)}}function queue(concurrency){return new Queue(arguments.length?+concurrency:1/0)}function fixCallback(callback){return function(error,xhr){callback(null==error?xhr:null)}}function hasResponse(xhr){var type=xhr.responseType;return type&&"text"!==type?xhr.response:xhr.responseText}function responseOf(parse,row){return function(request$$1){return parse(request$$1.responseText,row)}}function ordinal(range){function scale(d){var key=d+"",i=index.get(key);if(!i){if(unknown!==implicit)return unknown;index.set(key,i=domain.push(d))}return range[(i-1)%range.length]}var index=map$1(),domain=[],unknown=implicit;return range=null==range?[]:slice$4.call(range),scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=map$1();for(var d,key,i=-1,n=_.length;++i<n;)index.has(key=(d=_[i])+"")||index.set(key,domain.push(d));return scale},scale.range=function(_){return arguments.length?(range=slice$4.call(_),scale):range.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal().domain(domain).range(range).unknown(unknown)},scale}function band(){function rescale(){var n=domain().length,reverse=range$$1[1]<range$$1[0],start=range$$1[reverse-0],stop=range$$1[1-reverse];step=(stop-start)/Math.max(1,n-paddingInner+2*paddingOuter),round&&(step=Math.floor(step)),start+=(stop-start-step*(n-paddingInner))*align,bandwidth=step*(1-paddingInner),round&&(start=Math.round(start),bandwidth=Math.round(bandwidth));var values=sequence(n).map(function(i){return start+step*i});return ordinalRange(reverse?values.reverse():values)}var step,bandwidth,scale=ordinal().unknown(void 0),domain=scale.domain,ordinalRange=scale.range,range$$1=[0,1],round=!1,paddingInner=0,paddingOuter=0,align=.5;return delete scale.unknown,scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.range=function(_){return arguments.length?(range$$1=[+_[0],+_[1]],rescale()):range$$1.slice()},scale.rangeRound=function(_){return range$$1=[+_[0],+_[1]],round=!0,rescale()},scale.bandwidth=function(){return bandwidth},scale.step=function(){return step},scale.round=function(_){return arguments.length?(round=!!_,rescale()):round},scale.padding=function(_){return arguments.length?(paddingInner=paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingInner=function(_){return arguments.length?(paddingInner=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingOuter=function(_){return arguments.length?(paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingOuter},scale.align=function(_){return arguments.length?(align=Math.max(0,Math.min(1,_)),rescale()):align},scale.copy=function(){return band().domain(domain()).range(range$$1).round(round).paddingInner(paddingInner).paddingOuter(paddingOuter).align(align)},rescale()}function pointish(scale){var copy=scale.copy;return scale.padding=scale.paddingOuter,delete scale.paddingInner,delete scale.paddingOuter,scale.copy=function(){return pointish(copy())},scale}function point$1(){return pointish(band().paddingInner(1))}function deinterpolateLinear(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:constant$9(b)}function deinterpolateClamp(deinterpolate){return function(a,b){var d=deinterpolate(a=+a,b=+b);return function(x){return x<=a?0:x>=b?1:d(x)}}}function reinterpolateClamp(reinterpolate){return function(a,b){var r=reinterpolate(a=+a,b=+b);return function(t){return t<=0?a:t>=1?b:r(t)}}}function bimap(domain,range$$1,deinterpolate,reinterpolate){var d0=domain[0],d1=domain[1],r0=range$$1[0],r1=range$$1[1];return d1<d0?(d0=deinterpolate(d1,d0),r0=reinterpolate(r1,r0)):(d0=deinterpolate(d0,d1),r0=reinterpolate(r0,r1)),function(x){return r0(d0(x))}}function polymap(domain,range$$1,deinterpolate,reinterpolate){var j=Math.min(domain.length,range$$1.length)-1,d=new Array(j),r=new Array(j),i=-1;for(domain[j]<domain[0]&&(domain=domain.slice().reverse(),range$$1=range$$1.slice().reverse());++i<j;)d[i]=deinterpolate(domain[i],domain[i+1]),r[i]=reinterpolate(range$$1[i],range$$1[i+1]);return function(x){var i=bisectRight(domain,x,1,j)-1;return r[i](d[i](x))}}function copy(source,target){return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp())}function continuous(deinterpolate,reinterpolate){function rescale(){return piecewise=Math.min(domain.length,range$$1.length)>2?polymap:bimap,output=input=null,scale}function scale(x){return(output||(output=piecewise(domain,range$$1,clamp?deinterpolateClamp(deinterpolate):deinterpolate,interpolate$$1)))(+x)}var piecewise,output,input,domain=unit,range$$1=unit,interpolate$$1=interpolateValue,clamp=!1;return scale.invert=function(y){return(input||(input=piecewise(range$$1,domain,deinterpolateLinear,clamp?reinterpolateClamp(reinterpolate):reinterpolate)))(+y)},scale.domain=function(_){return arguments.length?(domain=map$3.call(_,number$1),rescale()):domain.slice()},scale.range=function(_){return arguments.length?(range$$1=slice$4.call(_),rescale()):range$$1.slice()},scale.rangeRound=function(_){return range$$1=slice$4.call(_),interpolate$$1=interpolateRound,rescale()},scale.clamp=function(_){return arguments.length?(clamp=!!_,rescale()):clamp},scale.interpolate=function(_){return arguments.length?(interpolate$$1=_,rescale()):interpolate$$1},rescale()}function linearish(scale){var domain=scale.domain;return scale.ticks=function(count){var d=domain();return ticks(d[0],d[d.length-1],null==count?10:count)},scale.tickFormat=function(count,specifier){return tickFormat(domain(),count,specifier)},scale.nice=function(count){var d=domain(),i=d.length-1,n=null==count?10:count,start=d[0],stop=d[i],step=tickStep(start,stop,n);return step&&(step=tickStep(Math.floor(start/step)*step,Math.ceil(stop/step)*step,n),d[0]=Math.floor(start/step)*step,d[i]=Math.ceil(stop/step)*step,domain(d)),scale},scale}function linear$2(){var scale=continuous(deinterpolateLinear,reinterpolate);return scale.copy=function(){return copy(scale,linear$2())},linearish(scale)}function identity$6(){function scale(x){return+x}var domain=[0,1];return scale.invert=scale,scale.domain=scale.range=function(_){return arguments.length?(domain=map$3.call(_,number$1),scale):domain.slice()},scale.copy=function(){return identity$6().domain(domain)},linearish(scale)}function deinterpolate(a,b){return(b=Math.log(b/a))?function(x){return Math.log(x/a)/b}:constant$9(b)}function reinterpolate$1(a,b){return a<0?function(t){return-Math.pow(-b,t)*Math.pow(-a,1-t)}:function(t){return Math.pow(b,t)*Math.pow(a,1-t)}}function pow10(x){return isFinite(x)?+("1e"+x):x<0?0:x}function powp(base){return 10===base?pow10:base===Math.E?Math.exp:function(x){return Math.pow(base,x)}}function logp(base){return base===Math.E?Math.log:10===base&&Math.log10||2===base&&Math.log2||(base=Math.log(base),function(x){return Math.log(x)/base})}function reflect(f){return function(x){return-f(-x)}}function log$1(){function rescale(){return logs=logp(base),pows=powp(base),domain()[0]<0&&(logs=reflect(logs),pows=reflect(pows)),scale}var scale=continuous(deinterpolate,reinterpolate$1).domain([1,10]),domain=scale.domain,base=10,logs=logp(10),pows=powp(10);return scale.base=function(_){return arguments.length?(base=+_,rescale()):base},scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.ticks=function(count){var r,d=domain(),u=d[0],v=d[d.length-1];(r=v<u)&&(i=u,u=v,v=i);var p,k,t,i=logs(u),j=logs(v),n=null==count?10:+count,z=[];if(!(base%1)&&j-i<n){if(i=Math.round(i)-1,j=Math.round(j)+1,u>0){for(;i<j;++i)for(k=1,p=pows(i);k<base;++k)if(!((t=p*k)<u)){if(t>v)break;z.push(t)}}else for(;i<j;++i)for(k=base-1,p=pows(i);k>=1;--k)if(!((t=p*k)<u)){if(t>v)break;z.push(t)}}else z=ticks(i,j,Math.min(j-i,n)).map(pows);return r?z.reverse():z},scale.tickFormat=function(count,specifier){if(null==specifier&&(specifier=10===base?".0e":","),"function"!=typeof specifier&&(specifier=exports.format(specifier)),count===1/0)return specifier;null==count&&(count=10);var k=Math.max(1,base*count/scale.ticks().length);return function(d){var i=d/pows(Math.round(logs(d)));return i*base<base-.5&&(i*=base),i<=k?specifier(d):""}},scale.nice=function(){return domain(nice(domain(),{floor:function(x){return pows(Math.floor(logs(x)))},ceil:function(x){return pows(Math.ceil(logs(x)))}}))},scale.copy=function(){return copy(scale,log$1().base(base))},scale}function raise$1(x,exponent){return x<0?-Math.pow(-x,exponent):Math.pow(x,exponent)}function pow$1(){function deinterpolate(a,b){return(b=raise$1(b,exponent)-(a=raise$1(a,exponent)))?function(x){return(raise$1(x,exponent)-a)/b}:constant$9(b)}function reinterpolate(a,b){return b=raise$1(b,exponent)-(a=raise$1(a,exponent)),function(t){return raise$1(a+b*t,1/exponent)}}var exponent=1,scale=continuous(deinterpolate,reinterpolate),domain=scale.domain;return scale.exponent=function(_){return arguments.length?(exponent=+_,domain(domain())):exponent},scale.copy=function(){return copy(scale,pow$1().exponent(exponent))},linearish(scale)}function sqrt$1(){return pow$1().exponent(.5)}function quantile$$1(){function rescale(){var i=0,n=Math.max(1,range$$1.length);for(thresholds=new Array(n-1);++i<n;)thresholds[i-1]=threshold(domain,i/n);return scale}function scale(x){if(!isNaN(x=+x))return range$$1[bisectRight(thresholds,x)]}var domain=[],range$$1=[],thresholds=[];return scale.invertExtent=function(y){var i=range$$1.indexOf(y);return i<0?[NaN,NaN]:[i>0?thresholds[i-1]:domain[0],i<thresholds.length?thresholds[i]:domain[domain.length-1]]},scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[];for(var d,i=0,n=_.length;i<n;++i)null==(d=_[i])||isNaN(d=+d)||domain.push(d);return domain.sort(ascending),rescale()},scale.range=function(_){return arguments.length?(range$$1=slice$4.call(_),rescale()):range$$1.slice()},scale.quantiles=function(){return thresholds.slice()},scale.copy=function(){return quantile$$1().domain(domain).range(range$$1)},scale}function quantize$1(){function scale(x){if(x<=x)return range$$1[bisectRight(domain,x,0,n)]}function rescale(){var i=-1;for(domain=new Array(n);++i<n;)domain[i]=((i+1)*x1-(i-n)*x0)/(n+1);return scale}var x0=0,x1=1,n=1,domain=[.5],range$$1=[0,1];return scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],rescale()):[x0,x1]},scale.range=function(_){return arguments.length?(n=(range$$1=slice$4.call(_)).length-1,rescale()):range$$1.slice()},scale.invertExtent=function(y){var i=range$$1.indexOf(y);return i<0?[NaN,NaN]:i<1?[x0,domain[0]]:i>=n?[domain[n-1],x1]:[domain[i-1],domain[i]]},scale.copy=function(){return quantize$1().domain([x0,x1]).range(range$$1)},linearish(scale)}function threshold$1(){function scale(x){if(x<=x)return range$$1[bisectRight(domain,x,0,n)]}var domain=[.5],range$$1=[0,1],n=1;return scale.domain=function(_){return arguments.length?(domain=slice$4.call(_),n=Math.min(domain.length,range$$1.length-1),scale):domain.slice()},scale.range=function(_){return arguments.length?(range$$1=slice$4.call(_),n=Math.min(domain.length,range$$1.length-1),scale):range$$1.slice()},scale.invertExtent=function(y){var i=range$$1.indexOf(y);return[domain[i-1],domain[i]]},scale.copy=function(){return threshold$1().domain(domain).range(range$$1)},scale}function newInterval(floori,offseti,count,field){function interval(date){return floori(date=new Date(+date)),date}return interval.floor=interval,interval.ceil=function(date){return floori(date=new Date(date-1)),offseti(date,1),floori(date),date},interval.round=function(date){var d0=interval(date),d1=interval.ceil(date);return date-d0<d1-date?d0:d1},interval.offset=function(date,step){return offseti(date=new Date(+date),null==step?1:Math.floor(step)),date},interval.range=function(start,stop,step){var range=[];if(start=interval.ceil(start),step=null==step?1:Math.floor(step),!(start<stop&&step>0))return range;do{range.push(new Date(+start))}while(offseti(start,step),floori(start),start<stop);return range},interval.filter=function(test){return newInterval(function(date){if(date>=date)for(;floori(date),!test(date);)date.setTime(date-1)},function(date,step){if(date>=date)for(;--step>=0;)for(;offseti(date,1),!test(date););})},count&&(interval.count=function(start,end){return t0$1.setTime(+start),t1$1.setTime(+end),floori(t0$1),floori(t1$1),
Math.floor(count(t0$1,t1$1))},interval.every=function(step){return step=Math.floor(step),isFinite(step)&&step>0?step>1?interval.filter(field?function(d){return field(d)%step==0}:function(d){return interval.count(0,d)%step==0}):interval:null}),interval}function weekday(i){return newInterval(function(date){date.setDate(date.getDate()-(date.getDay()+7-i)%7),date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+7*step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute$1)/durationWeek$1})}function utcWeekday(i){return newInterval(function(date){date.setUTCDate(date.getUTCDate()-(date.getUTCDay()+7-i)%7),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+7*step)},function(start,end){return(end-start)/durationWeek$1})}function localDate(d){if(0<=d.y&&d.y<100){var date=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return date.setFullYear(d.y),date}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function utcDate(d){if(0<=d.y&&d.y<100){var date=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return date.setUTCFullYear(d.y),date}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function newYear(y){return{y:y,m:0,d:1,H:0,M:0,S:0,L:0}}function formatLocale$1(locale){function newFormat(specifier,formats){return function(date){var c,pad,format,string=[],i=-1,j=0,n=specifier.length;for(date instanceof Date||(date=new Date(+date));++i<n;)37===specifier.charCodeAt(i)&&(string.push(specifier.slice(j,i)),null!=(pad=pads[c=specifier.charAt(++i)])?c=specifier.charAt(++i):pad="e"===c?" ":"0",(format=formats[c])&&(c=format(date,pad)),string.push(c),j=i+1);return string.push(specifier.slice(j,i)),string.join("")}}function newParse(specifier,newDate){return function(string){var d=newYear(1900);if(parseSpecifier(d,specifier,string+="",0)!=string.length)return null;if("p"in d&&(d.H=d.H%12+12*d.p),"W"in d||"U"in d){"w"in d||(d.w="W"in d?1:0);var day$$1="Z"in d?utcDate(newYear(d.y)).getUTCDay():newDate(newYear(d.y)).getDay();d.m=0,d.d="W"in d?(d.w+6)%7+7*d.W-(day$$1+5)%7:d.w+7*d.U-(day$$1+6)%7}return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,utcDate(d)):newDate(d)}}function parseSpecifier(d,specifier,string,j){for(var c,parse,i=0,n=specifier.length,m=string.length;i<n;){if(j>=m)return-1;if(37===(c=specifier.charCodeAt(i++))){if(c=specifier.charAt(i++),!(parse=parses[c in pads?specifier.charAt(i++):c])||(j=parse(d,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}function parsePeriod(d,string,i){var n=periodRe.exec(string.slice(i));return n?(d.p=periodLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseShortWeekday(d,string,i){var n=shortWeekdayRe.exec(string.slice(i));return n?(d.w=shortWeekdayLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseWeekday(d,string,i){var n=weekdayRe.exec(string.slice(i));return n?(d.w=weekdayLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseShortMonth(d,string,i){var n=shortMonthRe.exec(string.slice(i));return n?(d.m=shortMonthLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseMonth(d,string,i){var n=monthRe.exec(string.slice(i));return n?(d.m=monthLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseLocaleDateTime(d,string,i){return parseSpecifier(d,locale_dateTime,string,i)}function parseLocaleDate(d,string,i){return parseSpecifier(d,locale_date,string,i)}function parseLocaleTime(d,string,i){return parseSpecifier(d,locale_time,string,i)}function formatShortWeekday(d){return locale_shortWeekdays[d.getDay()]}function formatWeekday(d){return locale_weekdays[d.getDay()]}function formatShortMonth(d){return locale_shortMonths[d.getMonth()]}function formatMonth(d){return locale_months[d.getMonth()]}function formatPeriod(d){return locale_periods[+(d.getHours()>=12)]}function formatUTCShortWeekday(d){return locale_shortWeekdays[d.getUTCDay()]}function formatUTCWeekday(d){return locale_weekdays[d.getUTCDay()]}function formatUTCShortMonth(d){return locale_shortMonths[d.getUTCMonth()]}function formatUTCMonth(d){return locale_months[d.getUTCMonth()]}function formatUTCPeriod(d){return locale_periods[+(d.getUTCHours()>=12)]}var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_weekdays=locale.days,locale_shortWeekdays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths,periodRe=formatRe(locale_periods),periodLookup=formatLookup(locale_periods),weekdayRe=formatRe(locale_weekdays),weekdayLookup=formatLookup(locale_weekdays),shortWeekdayRe=formatRe(locale_shortWeekdays),shortWeekdayLookup=formatLookup(locale_shortWeekdays),monthRe=formatRe(locale_months),monthLookup=formatLookup(locale_months),shortMonthRe=formatRe(locale_shortMonths),shortMonthLookup=formatLookup(locale_shortMonths),formats={a:formatShortWeekday,A:formatWeekday,b:formatShortMonth,B:formatMonth,c:null,d:formatDayOfMonth,e:formatDayOfMonth,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:formatPeriod,S:formatSeconds,U:formatWeekNumberSunday,w:formatWeekdayNumber,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},utcFormats={a:formatUTCShortWeekday,A:formatUTCWeekday,b:formatUTCShortMonth,B:formatUTCMonth,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:formatUTCPeriod,S:formatUTCSeconds,U:formatUTCWeekNumberSunday,w:formatUTCWeekdayNumber,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},parses={a:parseShortWeekday,A:parseWeekday,b:parseShortMonth,B:parseMonth,c:parseLocaleDateTime,d:parseDayOfMonth,e:parseDayOfMonth,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:parsePeriod,S:parseSeconds,U:parseWeekNumberSunday,w:parseWeekdayNumber,W:parseWeekNumberMonday,x:parseLocaleDate,X:parseLocaleTime,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};return formats.x=newFormat(locale_date,formats),formats.X=newFormat(locale_time,formats),formats.c=newFormat(locale_dateTime,formats),utcFormats.x=newFormat(locale_date,utcFormats),utcFormats.X=newFormat(locale_time,utcFormats),utcFormats.c=newFormat(locale_dateTime,utcFormats),{format:function(specifier){var f=newFormat(specifier+="",formats);return f.toString=function(){return specifier},f},parse:function(specifier){var p=newParse(specifier+="",localDate);return p.toString=function(){return specifier},p},utcFormat:function(specifier){var f=newFormat(specifier+="",utcFormats);return f.toString=function(){return specifier},f},utcParse:function(specifier){var p=newParse(specifier,utcDate);return p.toString=function(){return specifier},p}}}function pad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function requote(s){return s.replace(requoteRe,"\\$&")}function formatRe(names){return new RegExp("^(?:"+names.map(requote).join("|")+")","i")}function formatLookup(names){for(var map={},i=-1,n=names.length;++i<n;)map[names[i].toLowerCase()]=i;return map}function parseWeekdayNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.w=+n[0],i+n[0].length):-1}function parseWeekNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.U=+n[0],i+n[0].length):-1}function parseWeekNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.W=+n[0],i+n[0].length):-1}function parseFullYear(d,string,i){var n=numberRe.exec(string.slice(i,i+4));return n?(d.y=+n[0],i+n[0].length):-1}function parseYear(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function parseZone(d,string,i){var n=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(string.slice(i,i+6));return n?(d.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function parseMonthNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.m=n[0]-1,i+n[0].length):-1}function parseDayOfMonth(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.d=+n[0],i+n[0].length):-1}function parseDayOfYear(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.m=0,d.d=+n[0],i+n[0].length):-1}function parseHour24(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.H=+n[0],i+n[0].length):-1}function parseMinutes(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.M=+n[0],i+n[0].length):-1}function parseSeconds(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.S=+n[0],i+n[0].length):-1}function parseMilliseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.L=+n[0],i+n[0].length):-1}function parseLiteralPercent(d,string,i){var n=percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function formatDayOfMonth(d,p){return pad(d.getDate(),p,2)}function formatHour24(d,p){return pad(d.getHours(),p,2)}function formatHour12(d,p){return pad(d.getHours()%12||12,p,2)}function formatDayOfYear(d,p){return pad(1+day.count(year(d),d),p,3)}function formatMilliseconds(d,p){return pad(d.getMilliseconds(),p,3)}function formatMonthNumber(d,p){return pad(d.getMonth()+1,p,2)}function formatMinutes(d,p){return pad(d.getMinutes(),p,2)}function formatSeconds(d,p){return pad(d.getSeconds(),p,2)}function formatWeekNumberSunday(d,p){return pad(sunday.count(year(d),d),p,2)}function formatWeekdayNumber(d){return d.getDay()}function formatWeekNumberMonday(d,p){return pad(monday.count(year(d),d),p,2)}function formatYear(d,p){return pad(d.getFullYear()%100,p,2)}function formatFullYear(d,p){return pad(d.getFullYear()%1e4,p,4)}function formatZone(d){var z=d.getTimezoneOffset();return(z>0?"-":(z*=-1,"+"))+pad(z/60|0,"0",2)+pad(z%60,"0",2)}function formatUTCDayOfMonth(d,p){return pad(d.getUTCDate(),p,2)}function formatUTCHour24(d,p){return pad(d.getUTCHours(),p,2)}function formatUTCHour12(d,p){return pad(d.getUTCHours()%12||12,p,2)}function formatUTCDayOfYear(d,p){return pad(1+utcDay.count(utcYear(d),d),p,3)}function formatUTCMilliseconds(d,p){return pad(d.getUTCMilliseconds(),p,3)}function formatUTCMonthNumber(d,p){return pad(d.getUTCMonth()+1,p,2)}function formatUTCMinutes(d,p){return pad(d.getUTCMinutes(),p,2)}function formatUTCSeconds(d,p){return pad(d.getUTCSeconds(),p,2)}function formatUTCWeekNumberSunday(d,p){return pad(utcSunday.count(utcYear(d),d),p,2)}function formatUTCWeekdayNumber(d){return d.getUTCDay()}function formatUTCWeekNumberMonday(d,p){return pad(utcMonday.count(utcYear(d),d),p,2)}function formatUTCYear(d,p){return pad(d.getUTCFullYear()%100,p,2)}function formatUTCFullYear(d,p){return pad(d.getUTCFullYear()%1e4,p,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function defaultLocale$1(definition){return locale$2=formatLocale$1(definition),exports.timeFormat=locale$2.format,exports.timeParse=locale$2.parse,exports.utcFormat=locale$2.utcFormat,exports.utcParse=locale$2.utcParse,locale$2}function formatIsoNative(date){return date.toISOString()}function parseIsoNative(string){var date=new Date(string);return isNaN(date)?null:date}function date$1(t){return new Date(t)}function number$2(t){return t instanceof Date?+t:+new Date(+t)}function calendar(year$$1,month$$1,week,day$$1,hour$$1,minute$$1,second$$1,millisecond$$1,format){function tickFormat(date){return(second$$1(date)<date?formatMillisecond:minute$$1(date)<date?formatSecond:hour$$1(date)<date?formatMinute:day$$1(date)<date?formatHour:month$$1(date)<date?week(date)<date?formatDay:formatWeek:year$$1(date)<date?formatMonth:formatYear)(date)}function tickInterval(interval,start,stop,step){if(null==interval&&(interval=10),"number"==typeof interval){var target=Math.abs(stop-start)/interval,i=bisector(function(i){return i[2]}).right(tickIntervals,target);i===tickIntervals.length?(step=tickStep(start/durationYear,stop/durationYear,interval),interval=year$$1):i?(i=tickIntervals[target/tickIntervals[i-1][2]<tickIntervals[i][2]/target?i-1:i],step=i[1],interval=i[0]):(step=tickStep(start,stop,interval),interval=millisecond$$1)}return null==step?interval:interval.every(step)}var scale=continuous(deinterpolateLinear,reinterpolate),invert=scale.invert,domain=scale.domain,formatMillisecond=format(".%L"),formatSecond=format(":%S"),formatMinute=format("%I:%M"),formatHour=format("%I %p"),formatDay=format("%a %d"),formatWeek=format("%b %d"),formatMonth=format("%B"),formatYear=format("%Y"),tickIntervals=[[second$$1,1,durationSecond],[second$$1,5,5*durationSecond],[second$$1,15,15*durationSecond],[second$$1,30,30*durationSecond],[minute$$1,1,durationMinute],[minute$$1,5,5*durationMinute],[minute$$1,15,15*durationMinute],[minute$$1,30,30*durationMinute],[hour$$1,1,durationHour],[hour$$1,3,3*durationHour],[hour$$1,6,6*durationHour],[hour$$1,12,12*durationHour],[day$$1,1,durationDay],[day$$1,2,2*durationDay],[week,1,durationWeek],[month$$1,1,durationMonth],[month$$1,3,3*durationMonth],[year$$1,1,durationYear]];return scale.invert=function(y){return new Date(invert(y))},scale.domain=function(_){return arguments.length?domain(map$3.call(_,number$2)):domain().map(date$1)},scale.ticks=function(interval,step){var t,d=domain(),t0=d[0],t1=d[d.length-1],r=t1<t0;return r&&(t=t0,t0=t1,t1=t),t=tickInterval(interval,t0,t1,step),t=t?t.range(t0,t1+1):[],r?t.reverse():t},scale.tickFormat=function(count,specifier){return null==specifier?tickFormat:format(specifier)},scale.nice=function(interval,step){var d=domain();return(interval=tickInterval(interval,d[0],d[d.length-1],step))?domain(nice(d,interval)):scale},scale.copy=function(){return copy(scale,calendar(year$$1,month$$1,week,day$$1,hour$$1,minute$$1,second$$1,millisecond$$1,format))},scale}function ramp(range){var n=range.length;return function(t){return range[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}function sequential(interpolator){function scale(x){var t=(x-x0)/(x1-x0);return interpolator(clamp?Math.max(0,Math.min(1,t)):t)}var x0=0,x1=1,clamp=!1;return scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],scale):[x0,x1]},scale.clamp=function(_){return arguments.length?(clamp=!!_,scale):clamp},scale.interpolator=function(_){return arguments.length?(interpolator=_,scale):interpolator},scale.copy=function(){return sequential(interpolator).domain([x0,x1]).clamp(clamp)},linearish(scale)}function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function asin$1(x){return x>=1?halfPi$3:x<=-1?-halfPi$3:Math.asin(x)}function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=(x32*(y0-y2)-y32*(x0-x2))/(y32*x10-x32*y10);return[x0+t*x10,y0+t*y10]}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/Math.sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(dy<0?-1:1)*Math.sqrt(Math.max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}function Linear(context){this._context=context}function x$3(p){return p[0]}function y$3(p){return p[1]}function Radial(curve){this._curve=curve}function curveRadial(curve){function radial(context){return new Radial(curve(context))}return radial._curve=curve,radial}function radialLine(l){var c=l.curve;return l.angle=l.x,delete l.x,l.radius=l.y,delete l.y,l.curve=function(_){return arguments.length?c(curveRadial(_)):c()._curve},l}function point$2(that,x,y){that._context.bezierCurveTo((2*that._x0+that._x1)/3,(2*that._y0+that._y1)/3,(that._x0+2*that._x1)/3,(that._y0+2*that._y1)/3,(that._x0+4*that._x1+x)/6,(that._y0+4*that._y1+y)/6)}function Basis(context){this._context=context}function BasisClosed(context){this._context=context}function BasisOpen(context){this._context=context}function Bundle(context,beta){this._basis=new Basis(context),this._beta=beta}function point$3(that,x,y){that._context.bezierCurveTo(that._x1+that._k*(that._x2-that._x0),that._y1+that._k*(that._y2-that._y0),that._x2+that._k*(that._x1-x),that._y2+that._k*(that._y1-y),that._x2,that._y2)}function Cardinal(context,tension){this._context=context,this._k=(1-tension)/6}function CardinalClosed(context,tension){this._context=context,this._k=(1-tension)/6}function CardinalOpen(context,tension){this._context=context,this._k=(1-tension)/6}function point$4(that,x,y){var x1=that._x1,y1=that._y1,x2=that._x2,y2=that._y2;if(that._l01_a>epsilon$3){var a=2*that._l01_2a+3*that._l01_a*that._l12_a+that._l12_2a,n=3*that._l01_a*(that._l01_a+that._l12_a);x1=(x1*a-that._x0*that._l12_2a+that._x2*that._l01_2a)/n,y1=(y1*a-that._y0*that._l12_2a+that._y2*that._l01_2a)/n}if(that._l23_a>epsilon$3){var b=2*that._l23_2a+3*that._l23_a*that._l12_a+that._l12_2a,m=3*that._l23_a*(that._l23_a+that._l12_a);x2=(x2*b+that._x1*that._l23_2a-x*that._l12_2a)/m,y2=(y2*b+that._y1*that._l23_2a-y*that._l12_2a)/m}that._context.bezierCurveTo(x1,y1,x2,y2,that._x2,that._y2)}function CatmullRom(context,alpha){this._context=context,this._alpha=alpha}function CatmullRomClosed(context,alpha){this._context=context,this._alpha=alpha}function CatmullRomOpen(context,alpha){this._context=context,this._alpha=alpha}function LinearClosed(context){this._context=context}function sign$1(x){return x<0?-1:1}function slope3(that,x2,y2){var h0=that._x1-that._x0,h1=x2-that._x1,s0=(that._y1-that._y0)/(h0||h1<0&&-0),s1=(y2-that._y1)/(h1||h0<0&&-0),p=(s0*h1+s1*h0)/(h0+h1);return(sign$1(s0)+sign$1(s1))*Math.min(Math.abs(s0),Math.abs(s1),.5*Math.abs(p))||0}function slope2(that,t){var h=that._x1-that._x0;return h?(3*(that._y1-that._y0)/h-t)/2:t}function point$5(that,t0,t1){var x0=that._x0,y0=that._y0,x1=that._x1,y1=that._y1,dx=(x1-x0)/3;that._context.bezierCurveTo(x0+dx,y0+dx*t0,x1-dx,y1-dx*t1,x1,y1)}function MonotoneX(context){this._context=context}function MonotoneY(context){this._context=new ReflectContext(context)}function ReflectContext(context){this._context=context}function monotoneX(context){return new MonotoneX(context)}function monotoneY(context){return new MonotoneY(context)}function Natural(context){this._context=context}function controlPoints(x){var i,m,n=x.length-1,a=new Array(n),b=new Array(n),r=new Array(n);for(a[0]=0,b[0]=2,r[0]=x[0]+2*x[1],i=1;i<n-1;++i)a[i]=1,b[i]=4,r[i]=4*x[i]+2*x[i+1];for(a[n-1]=2,b[n-1]=7,r[n-1]=8*x[n-1]+x[n],i=1;i<n;++i)m=a[i]/b[i-1],b[i]-=m,r[i]-=m*r[i-1];for(a[n-1]=r[n-1]/b[n-1],i=n-2;i>=0;--i)a[i]=(r[i]-a[i+1])/b[i];for(b[n-1]=(x[n]+a[n-1])/2,i=0;i<n-1;++i)b[i]=2*x[i+1]-a[i+1];return[a,b]}function Step(context,t){this._context=context,this._t=t}function stepBefore(context){return new Step(context,0)}function stepAfter(context){return new Step(context,1)}function stackValue(d,key){return d[key]}function sum$2(series){for(var v,s=0,i=-1,n=series.length;++i<n;)(v=+series[i][1])&&(s+=v);return s}function x$4(d){return d[0]}function y$4(d){return d[1]}function RedBlackTree(){this._=null}function RedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=null}function RedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.R=q.L,p.R&&(p.R.U=p),q.L=p}function RedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.L=q.R,p.L&&(p.L.U=p),q.R=p}function RedBlackFirst(node){for(;node.L;)node=node.L;return node}function createEdge(left,right,v0,v1){var edge=[null,null],index=edges.push(edge)-1;return edge.left=left,edge.right=right,v0&&setEdgeEnd(edge,left,right,v0),v1&&setEdgeEnd(edge,right,left,v1),cells[left.index].halfedges.push(index),cells[right.index].halfedges.push(index),edge}function createBorderEdge(left,v0,v1){var edge=[v0,v1];return edge.left=left,edge}function setEdgeEnd(edge,left,right,vertex){edge[0]||edge[1]?edge.left===right?edge[1]=vertex:edge[0]=vertex:(edge[0]=vertex,edge.left=left,edge.right=right)}function clipEdge(edge,x0,y0,x1,y1){var r,a=edge[0],b=edge[1],ax=a[0],ay=a[1],bx=b[0],by=b[1],t0=0,t1=1,dx=bx-ax,dy=by-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return!(t0>0||t1<1)||(t0>0&&(edge[0]=[ax+t0*dx,ay+t0*dy]),t1<1&&(edge[1]=[ax+t1*dx,ay+t1*dy]),!0)}}}}}function connectEdge(edge,x0,y0,x1,y1){var v1=edge[1];if(v1)return!0;var fm,fb,v0=edge[0],left=edge.left,right=edge.right,lx=left[0],ly=left[1],rx=right[0],ry=right[1],fx=(lx+rx)/2,fy=(ly+ry)/2;if(ry===ly){if(fx<x0||fx>=x1)return;if(lx>rx){if(v0){if(v0[1]>=y1)return}else v0=[fx,y0];v1=[fx,y1]}else{if(v0){if(v0[1]<y0)return}else v0=[fx,y1];v1=[fx,y0]}}else if(fm=(lx-rx)/(ry-ly),fb=fy-fm*fx,fm<-1||fm>1)if(lx>rx){if(v0){if(v0[1]>=y1)return}else v0=[(y0-fb)/fm,y0];v1=[(y1-fb)/fm,y1]}else{if(v0){if(v0[1]<y0)return}else v0=[(y1-fb)/fm,y1];v1=[(y0-fb)/fm,y0]}else if(ly<ry){if(v0){if(v0[0]>=x1)return}else v0=[x0,fm*x0+fb];v1=[x1,fm*x1+fb]}else{if(v0){if(v0[0]<x0)return}else v0=[x1,fm*x1+fb];v1=[x0,fm*x0+fb]}return edge[0]=v0,edge[1]=v1,!0}function clipEdges(x0,y0,x1,y1){for(var edge,i=edges.length;i--;)connectEdge(edge=edges[i],x0,y0,x1,y1)&&clipEdge(edge,x0,y0,x1,y1)&&(Math.abs(edge[0][0]-edge[1][0])>epsilon$4||Math.abs(edge[0][1]-edge[1][1])>epsilon$4)||delete edges[i]}function createCell(site){return cells[site.index]={site:site,halfedges:[]}}function cellHalfedgeAngle(cell,edge){var site=cell.site,va=edge.left,vb=edge.right;return site===vb&&(vb=va,va=site),vb?Math.atan2(vb[1]-va[1],vb[0]-va[0]):(site===va?(va=edge[1],vb=edge[0]):(va=edge[0],vb=edge[1]),Math.atan2(va[0]-vb[0],vb[1]-va[1]))}function cellHalfedgeStart(cell,edge){return edge[+(edge.left!==cell.site)]}function cellHalfedgeEnd(cell,edge){return edge[+(edge.left===cell.site)]}function sortCellHalfedges(){for(var cell,halfedges,j,m,i=0,n=cells.length;i<n;++i)if((cell=cells[i])&&(m=(halfedges=cell.halfedges).length)){var index=new Array(m),array=new Array(m);for(j=0;j<m;++j)index[j]=j,array[j]=cellHalfedgeAngle(cell,edges[halfedges[j]]);for(index.sort(function(i,j){return array[j]-array[i]}),j=0;j<m;++j)array[j]=halfedges[index[j]];for(j=0;j<m;++j)halfedges[j]=array[j]}}function clipCells(x0,y0,x1,y1){var iCell,cell,site,iHalfedge,halfedges,nHalfedges,start,startX,startY,end,endX,endY,nCells=cells.length,cover=!0;for(iCell=0;iCell<nCells;++iCell)if(cell=cells[iCell]){for(site=cell.site,halfedges=cell.halfedges,iHalfedge=halfedges.length;iHalfedge--;)edges[halfedges[iHalfedge]]||halfedges.splice(iHalfedge,1);for(iHalfedge=0,nHalfedges=halfedges.length;iHalfedge<nHalfedges;)end=cellHalfedgeEnd(cell,edges[halfedges[iHalfedge]]),endX=end[0],endY=end[1],start=cellHalfedgeStart(cell,edges[halfedges[++iHalfedge%nHalfedges]]),startX=start[0],startY=start[1],(Math.abs(endX-startX)>epsilon$4||Math.abs(endY-startY)>epsilon$4)&&(halfedges.splice(iHalfedge,0,edges.push(createBorderEdge(site,end,Math.abs(endX-x0)<epsilon$4&&y1-endY>epsilon$4?[x0,Math.abs(startX-x0)<epsilon$4?startY:y1]:Math.abs(endY-y1)<epsilon$4&&x1-endX>epsilon$4?[Math.abs(startY-y1)<epsilon$4?startX:x1,y1]:Math.abs(endX-x1)<epsilon$4&&endY-y0>epsilon$4?[x1,Math.abs(startX-x1)<epsilon$4?startY:y0]:Math.abs(endY-y0)<epsilon$4&&endX-x0>epsilon$4?[Math.abs(startY-y0)<epsilon$4?startX:x0,y0]:null))-1),++nHalfedges);nHalfedges&&(cover=!1)}if(cover){var dx,dy,d2,dc=1/0;for(iCell=0,cover=null;iCell<nCells;++iCell)(cell=cells[iCell])&&(site=cell.site,dx=site[0]-x0,dy=site[1]-y0,(d2=dx*dx+dy*dy)<dc&&(dc=d2,cover=cell));if(cover){var v00=[x0,y0],v01=[x0,y1],v11=[x1,y1],v10=[x1,y0];cover.halfedges.push(edges.push(createBorderEdge(site=cover.site,v00,v01))-1,edges.push(createBorderEdge(site,v01,v11))-1,edges.push(createBorderEdge(site,v11,v10))-1,edges.push(createBorderEdge(site,v10,v00))-1)}}for(iCell=0;iCell<nCells;++iCell)(cell=cells[iCell])&&(cell.halfedges.length||delete cells[iCell])}function Circle(){RedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null}function attachCircle(arc){var lArc=arc.P,rArc=arc.N;if(lArc&&rArc){var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite!==rSite){var bx=cSite[0],by=cSite[1],ax=lSite[0]-bx,ay=lSite[1]-by,cx=rSite[0]-bx,cy=rSite[1]-by,d=2*(ax*cy-ay*cx);if(!(d>=-epsilon2$2)){var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,circle=circlePool.pop()||new Circle;circle.arc=arc,circle.site=cSite,circle.x=x+bx,circle.y=(circle.cy=y+by)+Math.sqrt(x*x+y*y),arc.circle=circle;for(var before=null,node=circles._;node;)if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x){if(!node.L){before=node.P;break}node=node.L}else{if(!node.R){before=node;break}node=node.R}circles.insert(before,circle),before||(firstCircle=circle)}}}}function detachCircle(arc){var circle=arc.circle;circle&&(circle.P||(firstCircle=circle.N),circles.remove(circle),circlePool.push(circle),RedBlackNode(circle),arc.circle=null)}function Beach(){RedBlackNode(this),this.edge=this.site=this.circle=null}function createBeach(site){var beach=beachPool.pop()||new Beach;return beach.site=site,beach}function detachBeach(beach){detachCircle(beach),beaches.remove(beach),beachPool.push(beach),RedBlackNode(beach)}function removeBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex=[x,y],previous=beach.P,next=beach.N,disappearing=[beach];detachBeach(beach);for(var lArc=previous;lArc.circle&&Math.abs(x-lArc.circle.x)<epsilon$4&&Math.abs(y-lArc.circle.cy)<epsilon$4;)previous=lArc.P,disappearing.unshift(lArc),detachBeach(lArc),lArc=previous;disappearing.unshift(lArc),detachCircle(lArc);for(var rArc=next;rArc.circle&&Math.abs(x-rArc.circle.x)<epsilon$4&&Math.abs(y-rArc.circle.cy)<epsilon$4;)next=rArc.N,disappearing.push(rArc),detachBeach(rArc),rArc=next;disappearing.push(rArc),detachCircle(rArc);var iArc,nArcs=disappearing.length;for(iArc=1;iArc<nArcs;++iArc)rArc=disappearing[iArc],lArc=disappearing[iArc-1],setEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex);lArc=disappearing[0],rArc=disappearing[nArcs-1],rArc.edge=createEdge(lArc.site,rArc.site,null,vertex),attachCircle(lArc),attachCircle(rArc)}function addBeach(site){for(var lArc,rArc,dxl,dxr,x=site[0],directrix=site[1],node=beaches._;node;)if((dxl=leftBreakPoint(node,directrix)-x)>epsilon$4)node=node.L;else{if(!((dxr=x-rightBreakPoint(node,directrix))>epsilon$4)){dxl>-epsilon$4?(lArc=node.P,rArc=node):dxr>-epsilon$4?(lArc=node,rArc=node.N):lArc=rArc=node;break}if(!node.R){lArc=node;break}node=node.R}createCell(site);var newArc=createBeach(site);if(beaches.insert(lArc,newArc),lArc||rArc){if(lArc===rArc)return detachCircle(lArc),rArc=createBeach(lArc.site),beaches.insert(newArc,rArc),newArc.edge=rArc.edge=createEdge(lArc.site,newArc.site),attachCircle(lArc),void attachCircle(rArc);if(!rArc)return void(newArc.edge=createEdge(lArc.site,newArc.site));detachCircle(lArc),detachCircle(rArc);var lSite=lArc.site,ax=lSite[0],ay=lSite[1],bx=site[0]-ax,by=site[1]-ay,rSite=rArc.site,cx=rSite[0]-ax,cy=rSite[1]-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex=[(cy*hb-by*hc)/d+ax,(bx*hc-cx*hb)/d+ay];setEdgeEnd(rArc.edge,lSite,rSite,vertex),newArc.edge=createEdge(lSite,site,null,vertex),rArc.edge=createEdge(site,rSite,null,vertex),attachCircle(lArc),attachCircle(rArc)}}function leftBreakPoint(arc,directrix){var site=arc.site,rfocx=site[0],rfocy=site[1],pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-1/0;site=lArc.site;var lfocx=site[0],lfocy=site[1],plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;return aby2?(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx:(rfocx+lfocx)/2}function rightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return leftBreakPoint(rArc,directrix);var site=arc.site;return site[1]===directrix?site[0]:1/0}function triangleArea(a,b,c){return(a[0]-c[0])*(b[1]-a[1])-(a[0]-b[0])*(c[1]-a[1])}function lexicographic(a,b){return b[1]-a[1]||b[0]-a[0]}function Diagram(sites,extent){var x,y,circle,site=sites.sort(lexicographic).pop();for(edges=[],cells=new Array(sites.length),beaches=new RedBlackTree,circles=new RedBlackTree;;)if(circle=firstCircle,site&&(!circle||site[1]<circle.y||site[1]===circle.y&&site[0]<circle.x))site[0]===x&&site[1]===y||(addBeach(site),x=site[0],y=site[1]),site=sites.pop();else{if(!circle)break;removeBeach(circle.arc)}if(sortCellHalfedges(),extent){var x0=+extent[0][0],y0=+extent[0][1],x1=+extent[1][0],y1=+extent[1][1];clipEdges(x0,y0,x1,y1),clipCells(x0,y0,x1,y1)}this.edges=edges,this.cells=cells,beaches=circles=edges=cells=null}function ZoomEvent(target,type,transform){this.target=target,this.type=type,this.transform=transform}function Transform(k,x,y){this.k=k,this.x=x,this.y=y}function transform$1(node){return node.__zoom||identity$8}function nopropagation$2(){exports.event.stopImmediatePropagation()}function defaultFilter$2(){return!exports.event.button}function defaultExtent$1(){var w,h,e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,w=e.width.baseVal.value,h=e.height.baseVal.value):(w=e.clientWidth,h=e.clientHeight),[[0,0],[w,h]]}function defaultTransform(){return this.__zoom||identity$8}var ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},bisector=function(compare){return 1===compare.length&&(compare=ascendingComparator(compare)),{left:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}},ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left,descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},number=function(x){return null===x?NaN:+x},variance=function(array,f){var a,d,n=array.length,m=0,s=0,i=-1,j=0;if(null==f)for(;++i<n;)isNaN(a=number(array[i]))||(d=a-m,m+=d/++j,s+=d*(a-m));else for(;++i<n;)isNaN(a=number(f(array[i],i,array)))||(d=a-m,m+=d/++j,s+=d*(a-m));if(j>1)return s/(j-1)},deviation=function(array,f){var v=variance(array,f);return v?Math.sqrt(v):v},extent=function(array,f){var a,b,c,i=-1,n=array.length;if(null==f){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=c=b;break}for(;++i<n;)null!=(b=array[i])&&(a>b&&(a=b),c<b&&(c=b))}else{for(;++i<n;)if(null!=(b=f(array[i],i,array))&&b>=b){a=c=b;break}for(;++i<n;)null!=(b=f(array[i],i,array))&&(a>b&&(a=b),c<b&&(c=b))}return[a,c]},array=Array.prototype,slice=array.slice,map=array.map,constant=function(x){return function(){return x}},identity=function(x){return x},sequence=function(start,stop,step){start=+start,stop=+stop,step=(n=arguments.length)<2?(stop=start,start=0,1):n<3?1:+step;for(var i=-1,n=0|Math.max(0,Math.ceil((stop-start)/step)),range=new Array(n);++i<n;)range[i]=start+i*step;return range},e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2),ticks=function(start,stop,count){var step=tickStep(start,stop,count);return sequence(Math.ceil(start/step)*step,Math.floor(stop/step)*step+step/2,step)},sturges=function(values){return Math.ceil(Math.log(values.length)/Math.LN2)+1},histogram=function(){function histogram(data){var i,x,n=data.length,values=new Array(n);for(i=0;i<n;++i)values[i]=value(data[i],i,data);var xz=domain(values),x0=xz[0],x1=xz[1],tz=threshold(values,x0,x1)
;Array.isArray(tz)||(tz=ticks(x0,x1,tz));for(var m=tz.length;tz[0]<=x0;)tz.shift(),--m;for(;tz[m-1]>=x1;)tz.pop(),--m;var bin,bins=new Array(m+1);for(i=0;i<=m;++i)bin=bins[i]=[],bin.x0=i>0?tz[i-1]:x0,bin.x1=i<m?tz[i]:x1;for(i=0;i<n;++i)x=values[i],x0<=x&&x<=x1&&bins[bisectRight(tz,x,0,m)].push(data[i]);return bins}var value=identity,domain=extent,threshold=sturges;return histogram.value=function(_){return arguments.length?(value="function"==typeof _?_:constant(_),histogram):value},histogram.domain=function(_){return arguments.length?(domain="function"==typeof _?_:constant([_[0],_[1]]),histogram):domain},histogram.thresholds=function(_){return arguments.length?(threshold="function"==typeof _?_:constant(Array.isArray(_)?slice.call(_):_),histogram):threshold},histogram},threshold=function(array,p,f){if(null==f&&(f=number),n=array.length){if((p=+p)<=0||n<2)return+f(array[0],0,array);if(p>=1)return+f(array[n-1],n-1,array);var n,h=(n-1)*p,i=Math.floor(h),a=+f(array[i],i,array);return a+(+f(array[i+1],i+1,array)-a)*(h-i)}},freedmanDiaconis=function(values,min,max){return values=map.call(values,number).sort(ascending),Math.ceil((max-min)/(2*(threshold(values,.75)-threshold(values,.25))*Math.pow(values.length,-1/3)))},scott=function(values,min,max){return Math.ceil((max-min)/(3.5*deviation(values)*Math.pow(values.length,-1/3)))},max=function(array,f){var a,b,i=-1,n=array.length;if(null==f){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=b;break}for(;++i<n;)null!=(b=array[i])&&b>a&&(a=b)}else{for(;++i<n;)if(null!=(b=f(array[i],i,array))&&b>=b){a=b;break}for(;++i<n;)null!=(b=f(array[i],i,array))&&b>a&&(a=b)}return a},mean=function(array,f){var a,s=0,n=array.length,i=-1,j=n;if(null==f)for(;++i<n;)isNaN(a=number(array[i]))?--j:s+=a;else for(;++i<n;)isNaN(a=number(f(array[i],i,array)))?--j:s+=a;if(j)return s/j},median=function(array,f){var a,numbers=[],n=array.length,i=-1;if(null==f)for(;++i<n;)isNaN(a=number(array[i]))||numbers.push(a);else for(;++i<n;)isNaN(a=number(f(array[i],i,array)))||numbers.push(a);return threshold(numbers.sort(ascending),.5)},merge=function(arrays){for(var m,merged,array,n=arrays.length,i=-1,j=0;++i<n;)j+=arrays[i].length;for(merged=new Array(j);--n>=0;)for(array=arrays[n],m=array.length;--m>=0;)merged[--j]=array[m];return merged},min=function(array,f){var a,b,i=-1,n=array.length;if(null==f){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=b;break}for(;++i<n;)null!=(b=array[i])&&a>b&&(a=b)}else{for(;++i<n;)if(null!=(b=f(array[i],i,array))&&b>=b){a=b;break}for(;++i<n;)null!=(b=f(array[i],i,array))&&a>b&&(a=b)}return a},pairs=function(array){for(var i=0,n=array.length-1,p=array[0],pairs=new Array(n<0?0:n);i<n;)pairs[i]=[p,p=array[++i]];return pairs},permute=function(array,indexes){for(var i=indexes.length,permutes=new Array(i);i--;)permutes[i]=array[indexes[i]];return permutes},scan=function(array,compare){if(n=array.length){var n,xi,i=0,j=0,xj=array[j];for(compare||(compare=ascending);++i<n;)(compare(xi=array[i],xj)<0||0!==compare(xj,xj))&&(xj=xi,j=i);return 0===compare(xj,xj)?j:void 0}},shuffle=function(array,i0,i1){for(var t,i,m=(null==i1?array.length:i1)-(i0=null==i0?0:+i0);m;)i=Math.random()*m--|0,t=array[m+i0],array[m+i0]=array[i+i0],array[i+i0]=t;return array},sum=function(array,f){var a,s=0,n=array.length,i=-1;if(null==f)for(;++i<n;)(a=+array[i])&&(s+=a);else for(;++i<n;)(a=+f(array[i],i,array))&&(s+=a);return s},transpose=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=min(matrix,length),transpose=new Array(m);++i<m;)for(var n,j=-1,row=transpose[i]=new Array(n);++j<n;)row[j]=matrix[j][i];return transpose},zip=function(){return transpose(arguments)},slice$1=Array.prototype.slice,identity$1=function(x){return x},top=1,right=2,bottom=3,left=4,epsilon=1e-6,noop={value:function(){}};Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=parseTypenames(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml:xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},namespace=function(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),namespaces.hasOwnProperty(prefix)?{space:namespaces[prefix],local:name}:name},creator=function(name){var fullname=namespace(name);return(fullname.local?creatorFixed:creatorInherit)(fullname)},nextId=0;Local.prototype=local$1.prototype={constructor:Local,get:function(node){for(var id=this._;!(id in node);)if(!(node=node.parentNode))return;return node[id]},set:function(node,value){return node[this._]=value},remove:function(node){return this._ in node&&delete node[this._]},toString:function(){return this._}};var matcher=function(selector){return function(){return this.matches(selector)}};if("undefined"!=typeof document){var element=document.documentElement;if(!element.matches){var vendorMatches=element.webkitMatchesSelector||element.msMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector;matcher=function(selector){return function(){return vendorMatches.call(this,selector)}}}}var matcher$1=matcher,filterEvents={};if(exports.event=null,"undefined"!=typeof document){"onmouseenter"in document.documentElement||(filterEvents={mouseenter:"mouseover",mouseleave:"mouseout"})}var selection_on=function(typename,value,capture){var i,t,typenames=parseTypenames$1(typename+""),n=typenames.length;if(!(arguments.length<2)){for(on=value?onAdd:onRemove,null==capture&&(capture=!1),i=0;i<n;++i)this.each(on(typenames[i],value,capture));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value},sourceEvent=function(){for(var source,current=exports.event;source=current.sourceEvent;)current=source;return current},point=function(node,event){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,point=point.matrixTransform(node.getScreenCTM().inverse()),[point.x,point.y]}var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]},mouse=function(node){var event=sourceEvent();return event.changedTouches&&(event=event.changedTouches[0]),point(node,event)},selector=function(selector){return null==selector?none:function(){return this.querySelector(selector)}},selection_select=function(select){"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new Selection(subgroups,this._parents)},selectorAll=function(selector){return null==selector?empty$1:function(){return this.querySelectorAll(selector)}},selection_selectAll=function(select){"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new Selection(subgroups,parents)},selection_filter=function(match){"function"!=typeof match&&(match=matcher$1(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Selection(subgroups,this._parents)},sparse=function(update){return new Array(update.length)},selection_enter=function(){return new Selection(this._enter||this._groups.map(sparse),this._parents)};EnterNode.prototype={constructor:EnterNode,appendChild:function(child){return this._parent.insertBefore(child,this._next)},insertBefore:function(child,next){return this._parent.insertBefore(child,next)},querySelector:function(selector){return this._parent.querySelector(selector)},querySelectorAll:function(selector){return this._parent.querySelectorAll(selector)}};var constant$1=function(x){return function(){return x}},keyPrefix="$",selection_data=function(value,key){if(!value)return data=new Array(this.size()),j=-1,this.each(function(d){data[++j]=d}),data;var bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(value=constant$1(value));for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=value.call(parent,parent&&parent.__data__,j,parents),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return update=new Selection(update,parents),update._enter=enter,update._exit=exit,update},selection_exit=function(){return new Selection(this._exit||this._groups.map(sparse),this._parents)},selection_merge=function(selection){for(var groups0=this._groups,groups1=selection._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Selection(merges,this._parents)},selection_order=function(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&next!==node.nextSibling&&next.parentNode.insertBefore(node,next),next=node);return this},selection_sort=function(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=ascending$1);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new Selection(sortgroups,this._parents).order()},selection_call=function(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this},selection_nodes=function(){var nodes=new Array(this.size()),i=-1;return this.each(function(){nodes[++i]=this}),nodes},selection_node=function(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null},selection_size=function(){var size=0;return this.each(function(){++size}),size},selection_empty=function(){return!this.node()},selection_each=function(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this},selection_attr=function(name,value){var fullname=namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?attrRemoveNS:attrRemove:"function"==typeof value?fullname.local?attrFunctionNS:attrFunction:fullname.local?attrConstantNS:attrConstant)(fullname,value))},window=function(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView},selection_style=function(name,value,priority){var node;return arguments.length>1?this.each((null==value?styleRemove:"function"==typeof value?styleFunction:styleConstant)(name,value,null==priority?"":priority)):window(node=this.node()).getComputedStyle(node,null).getPropertyValue(name)},selection_property=function(name,value){return arguments.length>1?this.each((null==value?propertyRemove:"function"==typeof value?propertyFunction:propertyConstant)(name,value)):this.node()[name]};ClassList.prototype={add:function(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(name){return this._names.indexOf(name)>=0}};var selection_classed=function(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?classedFunction:value?classedTrue:classedFalse)(names,value))},selection_text=function(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?textFunction:textConstant)(value)):this.node().textContent},selection_html=function(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?htmlFunction:htmlConstant)(value)):this.node().innerHTML},selection_raise=function(){return this.each(raise)},selection_lower=function(){return this.each(lower)},selection_append=function(name){var create="function"==typeof name?name:creator(name);return this.select(function(){return this.appendChild(create.apply(this,arguments))})},selection_insert=function(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:selector(before);return this.select(function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)})},selection_remove=function(){return this.each(remove)},selection_datum=function(value){return arguments.length?this.property("__data__",value):this.node().__data__},selection_dispatch=function(type,params){return this.each(("function"==typeof params?dispatchFunction:dispatchConstant)(type,params))},root=[null];Selection.prototype=selection.prototype={constructor:Selection,select:selection_select,selectAll:selection_selectAll,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,merge:selection_merge,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,datum:selection_datum,on:selection_on,dispatch:selection_dispatch};var select=function(selector){return"string"==typeof selector?new Selection([[document.querySelector(selector)]],[document.documentElement]):new Selection([[selector]],root)},selectAll=function(selector){return"string"==typeof selector?new Selection([document.querySelectorAll(selector)],[document.documentElement]):new Selection([null==selector?[]:selector],root)},touch=function(node,touches,identifier){arguments.length<3&&(identifier=touches,touches=sourceEvent().changedTouches);for(var touch,i=0,n=touches?touches.length:0;i<n;++i)if((touch=touches[i]).identifier===identifier)return point(node,touch);return null},touches=function(node,touches){null==touches&&(touches=sourceEvent().touches);for(var i=0,n=touches?touches.length:0,points=new Array(n);i<n;++i)points[i]=point(node,touches[i]);return points},noevent=function(){exports.event.preventDefault(),exports.event.stopImmediatePropagation()},dragDisable=function(view){var root=view.document.documentElement,selection$$1=select(view).on("dragstart.drag",noevent,!0);"onselectstart"in root?selection$$1.on("selectstart.drag",noevent,!0):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")},constant$2=function(x){return function(){return x}};DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};var drag=function(){function drag(selection$$1){selection$$1.on("mousedown.drag",mousedowned).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved).on("touchend.drag touchcancel.drag",touchended).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(){if(!touchending&&filter.apply(this,arguments)){var gesture=beforestart("mouse",container.apply(this,arguments),mouse,this,arguments);gesture&&(select(exports.event.view).on("mousemove.drag",mousemoved,!0).on("mouseup.drag",mouseupped,!0),dragDisable(exports.event.view),nopropagation(),mousemoving=!1,gesture("start"))}}function mousemoved(){noevent(),mousemoving=!0,gestures.mouse("drag")}function mouseupped(){select(exports.event.view).on("mousemove.drag mouseup.drag",null),yesdrag(exports.event.view,mousemoving),noevent(),gestures.mouse("end")}function touchstarted(){if(filter.apply(this,arguments)){var i,gesture,touches$$1=exports.event.changedTouches,c=container.apply(this,arguments),n=touches$$1.length;for(i=0;i<n;++i)(gesture=beforestart(touches$$1[i].identifier,c,touch,this,arguments))&&(nopropagation(),gesture("start"))}}function touchmoved(){var i,gesture,touches$$1=exports.event.changedTouches,n=touches$$1.length;for(i=0;i<n;++i)(gesture=gestures[touches$$1[i].identifier])&&(noevent(),gesture("drag"))}function touchended(){var i,gesture,touches$$1=exports.event.changedTouches,n=touches$$1.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),i=0;i<n;++i)(gesture=gestures[touches$$1[i].identifier])&&(nopropagation(),gesture("end"))}function beforestart(id,container,point,that,args){var s,dx,dy,p=point(container,id),sublisteners=listeners.copy();if(customEvent(new DragEvent(drag,"beforestart",s,id,active,p[0],p[1],0,0,sublisteners),function(){return null!=(exports.event.subject=s=subject.apply(that,args))&&(dx=s.x-p[0]||0,dy=s.y-p[1]||0,!0)}))return function gesture(type){var n,p0=p;switch(type){case"start":gestures[id]=gesture,n=active++;break;case"end":delete gestures[id],--active;case"drag":p=point(container,id),n=active}customEvent(new DragEvent(drag,type,s,id,n,p[0]+dx,p[1]+dy,p[0]-p0[0],p[1]-p0[1],sublisteners),sublisteners.apply,sublisteners,[type,that,args])}}var mousemoving,touchending,filter=defaultFilter$1,container=defaultContainer,subject=defaultSubject,gestures={},listeners=dispatch("start","drag","end"),active=0;return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant$2(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:constant$2(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:constant$2(_),drag):subject},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag},define=function(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor},reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex3=/^#([0-9a-f]{3})$/,reHex6=/^#([0-9a-f]{6})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),define(Rgb,rgb,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(1===a?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),define(Hsl,hsl,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var deg2rad=Math.PI/180,rad2deg=180/Math.PI,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;define(Lab,lab,extend(Color,{brighter:function(k){return new Lab(this.l+18*(null==k?1:k),this.a,this.b,this.opacity)},darker:function(k){return new Lab(this.l-18*(null==k?1:k),this.a,this.b,this.opacity)},rgb:function(){var y=(this.l+16)/116,x=isNaN(this.a)?y:y+this.a/500,z=isNaN(this.b)?y:y-this.b/200;return y=Yn*lab2xyz(y),x=Xn*lab2xyz(x),z=Zn*lab2xyz(z),new Rgb(xyz2rgb(3.2404542*x-1.5371385*y-.4985314*z),xyz2rgb(-.969266*x+1.8760108*y+.041556*z),xyz2rgb(.0556434*x-.2040259*y+1.0572252*z),this.opacity)}})),define(Hcl,hcl,extend(Color,{brighter:function(k){return new Hcl(this.h,this.c,this.l+18*(null==k?1:k),this.opacity)},darker:function(k){return new Hcl(this.h,this.c,this.l-18*(null==k?1:k),this.opacity)},rgb:function(){return labConvert(this).rgb()}}));var A=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;define(Cubehelix,cubehelix,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=isNaN(this.h)?0:(this.h+120)*deg2rad,l=+this.l,a=isNaN(this.s)?0:this.s*l*(1-l),cosh=Math.cos(h),sinh=Math.sin(h);return new Rgb(255*(l+a*(A*cosh+B*sinh)),255*(l+a*(C*cosh+D*sinh)),255*(l+a*(E*cosh)),this.opacity)}}));var cssNode,cssRoot,cssView,svgNode,taskHead,taskTail,basis$1=function(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}},basisClosed=function(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}},constant$3=function(x){return function(){return x}},interpolateRgb=function rgbGamma(y){function rgb$$1(start,end){var r=color$$1((start=rgb(start)).r,(end=rgb(end)).r),g=color$$1(start.g,end.g),b=color$$1(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}var color$$1=gamma(y);return rgb$$1.gamma=rgbGamma,rgb$$1}(1),rgbBasis=rgbSpline(basis$1),rgbBasisClosed=rgbSpline(basisClosed),array$1=function(a,b){var i,nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(nb),c=new Array(nb);for(i=0;i<na;++i)x[i]=interpolateValue(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}},date=function(a,b){var d=new Date;return a=+a,b-=a,function(t){return d.setTime(a+b*t),d}},reinterpolate=function(a,b){return a=+a,b-=a,function(t){return a+b*t}},object=function(a,b){var k,i={},c={};null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={});for(k in b)k in a?i[k]=interpolateValue(a[k],b[k]):c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}},reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g"),interpolateString=function(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:reinterpolate(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?one(q[0].x):zero(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})},interpolateValue=function(a,b){var c,t=typeof b;return null==b||"boolean"===t?constant$3(b):("number"===t?reinterpolate:"string"===t?(c=color(b))?(b=c,interpolateRgb):interpolateString:b instanceof color?interpolateRgb:b instanceof Date?date:Array.isArray(b)?array$1:isNaN(b)?object:reinterpolate)(a,b)},interpolateRound=function(a,b){return a=+a,b-=a,function(t){return Math.round(a+b*t)}},degrees=180/Math.PI,identity$2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},decompose=function(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX:scaleX,scaleY:scaleY}},interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),rho=Math.SQRT2,interpolateZoom=function(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<1e-12)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+4*d2)/(2*w0*2*d1),b1=(w1*w1-w0*w0-4*d2)/(2*w1*2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(2*d1)*(coshr0*tanh(rho*s+r0)-sinh(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S,i},hsl$2=hsl$1(hue),hslLong=hsl$1(nogamma),hcl$2=hcl$1(hue),hclLong=hcl$1(nogamma),cubehelix$2=cubehelix$1(hue),cubehelixLong=cubehelix$1(nogamma),quantize=function(interpolator,n){for(var samples=new Array(n),i=0;i<n;++i)samples[i]=interpolator(i/(n-1));return samples},frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="function"==typeof requestAnimationFrame?requestAnimationFrame:function(f){setTimeout(f,17)};Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var timeout$1=function(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart(function(elapsed){t.stop(),callback(elapsed+delay)},delay,time),t},interval$1=function(callback,delay,time){var t=new Timer,total=delay;return null==delay?(t.restart(callback,delay,time),t):(delay=+delay,time=null==time?now():+time,t.restart(function tick(elapsed){elapsed+=total,t.restart(tick,total+=delay,time),callback(elapsed)},delay,time),t)},emptyOn=dispatch("start","end","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6,schedule=function(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};create(node,id,{name:name,index:index,group:group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:CREATED})},interrupt=function(node,name){
var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){name=null==name?null:name+"";for(i in schedules)(schedule=schedules[i]).name===name?(active=schedule.state>STARTING&&schedule.state<ENDING,schedule.state=ENDED,schedule.timer.stop(),active&&schedule.on.call("interrupt",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}},selection_interrupt=function(name){return this.each(function(){interrupt(this,name)})},transition_tween=function(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=get$1(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?tweenRemove:tweenFunction)(id,name,value))},interpolate$$1=function(a,b){var c;return("number"==typeof b?reinterpolate:b instanceof color?interpolateRgb:(c=color(b))?(b=c,interpolateRgb):interpolateString)(a,b)},transition_attr=function(name,value){var fullname=namespace(name),i="transform"===fullname?interpolateTransformSvg:interpolate$$1;return this.attrTween(name,"function"==typeof value?(fullname.local?attrFunctionNS$1:attrFunction$1)(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?attrRemoveNS$1:attrRemove$1)(fullname):(fullname.local?attrConstantNS$1:attrConstant$1)(fullname,i,value))},transition_attrTween=function(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=namespace(name);return this.tween(key,(fullname.local?attrTweenNS:attrTween)(fullname,value))},transition_delay=function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?delayFunction:delayConstant)(id,value)):get$1(this.node(),id).delay},transition_duration=function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?durationFunction:durationConstant)(id,value)):get$1(this.node(),id).duration},transition_ease=function(value){var id=this._id;return arguments.length?this.each(easeConstant(id,value)):get$1(this.node(),id).ease},transition_filter=function(match){"function"!=typeof match&&(match=matcher$1(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},transition_merge=function(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},transition_on=function(name,listener){var id=this._id;return arguments.length<2?get$1(this.node(),id).on.on(name):this.each(onFunction(id,name,listener))},transition_remove=function(){return this.on("end.remove",removeFunction(this._id))},transition_select=function(select$$1){var name=this._name,id=this._id;"function"!=typeof select$$1&&(select$$1=selector(select$$1));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select$$1.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,schedule(subgroup[i],name,id,i,subgroup,get$1(node,id)));return new Transition(subgroups,this._parents,name,id)},transition_selectAll=function(select$$1){var name=this._name,id=this._id;"function"!=typeof select$$1&&(select$$1=selectorAll(select$$1));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select$$1.call(node,node.__data__,i,group),inherit=get$1(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},Selection$1=selection.prototype.constructor,transition_selection=function(){return new Selection$1(this._groups,this._parents)},transition_style=function(name,value,priority){var i="transform"==(name+="")?interpolateTransformCss:interpolate$$1;return null==value?this.styleTween(name,styleRemove$1(name,i)).on("end.style."+name,styleRemoveEnd(name)):this.styleTween(name,"function"==typeof value?styleFunction$1(name,i,tweenValue(this,"style."+name,value)):styleConstant$1(name,i,value),priority)},transition_styleTween=function(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,styleTween(name,value,null==priority?"":priority))},transition_text=function(value){return this.tween("text","function"==typeof value?textFunction$1(tweenValue(this,"text",value)):textConstant$1(null==value?"":value+""))},transition_transition=function(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=get$1(node,id0);schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},id=0,selection_prototype=selection.prototype;Transition.prototype=transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease};var polyIn=function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn}(3),polyOut=function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3),polyInOut=function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3),pi=Math.PI,halfPi=pi/2,b1=4/11,b2=6/11,b3=8/11,b4=.75,b5=9/11,b6=10/11,b7=.9375,b8=21/22,b9=63/64,b0=1/b1/b1,backIn=function custom(s){function backIn(t){return t*t*((s+1)*t-s)}return s=+s,backIn.overshoot=custom,backIn}(1.70158),backOut=function custom(s){function backOut(t){return--t*t*((s+1)*t+s)+1}return s=+s,backOut.overshoot=custom,backOut}(1.70158),backInOut=function custom(s){function backInOut(t){return((t*=2)<1?t*t*((s+1)*t-s):(t-=2)*t*((s+1)*t+s)+2)/2}return s=+s,backInOut.overshoot=custom,backInOut}(1.70158),tau=2*Math.PI,elasticIn=function custom(a,p){function elasticIn(t){return a*Math.pow(2,10*--t)*Math.sin((s-t)/p)}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticIn.amplitude=function(a){return custom(a,p*tau)},elasticIn.period=function(p){return custom(a,p)},elasticIn}(1,.3),elasticOut=function custom(a,p){function elasticOut(t){return 1-a*Math.pow(2,-10*(t=+t))*Math.sin((t+s)/p)}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticOut.amplitude=function(a){return custom(a,p*tau)},elasticOut.period=function(p){return custom(a,p)},elasticOut}(1,.3),elasticInOut=function custom(a,p){function elasticInOut(t){return((t=2*t-1)<0?a*Math.pow(2,10*t)*Math.sin((s-t)/p):2-a*Math.pow(2,-10*t)*Math.sin((s+t)/p))/2}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticInOut.amplitude=function(a){return custom(a,p*tau)},elasticInOut.period=function(p){return custom(a,p)},elasticInOut}(1,.3),defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut},selection_transition=function(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&schedule(node,name,id,i,group,timing||inherit(node,id));return new Transition(groups,this._parents,name,id)};selection.prototype.interrupt=selection_interrupt,selection.prototype.transition=selection_transition;var root$1=[null],active=function(node,name){var schedule,i,schedules=node.__transition;if(schedules){name=null==name?null:name+"";for(i in schedules)if((schedule=schedules[i]).state>SCHEDULED&&schedule.name===name)return new Transition([[node]],root$1,name,+i)}return null},constant$4=function(x){return function(){return x}},BrushEvent=function(target,type,selection){this.target=target,this.type=type,this.selection=selection},noevent$1=function(){exports.event.preventDefault(),exports.event.stopImmediatePropagation()},MODE_DRAG={name:"drag"},MODE_SPACE={name:"space"},MODE_HANDLE={name:"handle"},MODE_CENTER={name:"center"},X={name:"x",handles:["e","w"].map(type),input:function(x,e){return x&&[[x[0],e[0][1]],[x[1],e[1][1]]]},output:function(xy){return xy&&[xy[0][0],xy[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(y,e){return y&&[[e[0][0],y[0]],[e[1][0],y[1]]]},output:function(xy){return xy&&[xy[0][1],xy[1][1]]}},XY={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(type),input:function(xy){return xy},output:function(xy){return xy}},cursors={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},flipX={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},flipY={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},signsX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},signsY={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},brush=function(){return brush$1(XY)},cos=Math.cos,sin=Math.sin,pi$1=Math.PI,halfPi$1=pi$1/2,tau$1=2*pi$1,max$1=Math.max,chord=function(){function chord(matrix){var k,x,x0,dx,i,j,n=matrix.length,groupSums=[],groupIndex=sequence(n),subgroupIndex=[],chords=[],groups=chords.groups=new Array(n),subgroups=new Array(n*n);for(k=0,i=-1;++i<n;){for(x=0,j=-1;++j<n;)x+=matrix[i][j];groupSums.push(x),subgroupIndex.push(sequence(n)),k+=x}for(sortGroups&&groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])}),sortSubgroups&&subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})}),k=max$1(0,tau$1-padAngle*n)/k,dx=k?padAngle:tau$1/n,x=0,i=-1;++i<n;){for(x0=x,j=-1;++j<n;){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[dj*n+di]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:groupSums[di]},x+=dx}for(i=-1;++i<n;)for(j=i-1;++j<n;){var source=subgroups[j*n+i],target=subgroups[i*n+j];(source.value||target.value)&&chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}return sortChords?chords.sort(sortChords):chords}var padAngle=0,sortGroups=null,sortSubgroups=null,sortChords=null;return chord.padAngle=function(_){return arguments.length?(padAngle=max$1(0,_),chord):padAngle},chord.sortGroups=function(_){return arguments.length?(sortGroups=_,chord):sortGroups},chord.sortSubgroups=function(_){return arguments.length?(sortSubgroups=_,chord):sortSubgroups},chord.sortChords=function(_){return arguments.length?(null==_?sortChords=null:(sortChords=compareValue(_))._=_,chord):sortChords&&sortChords._},chord},slice$2=Array.prototype.slice,constant$5=function(x){return function(){return x}},pi$2=Math.PI,tau$2=2*pi$2,tauEpsilon=tau$2-1e-6;Path.prototype=path.prototype={constructor:Path,moveTo:function(x,y){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(x,y){this._+="L"+(this._x1=+x)+","+(this._y1=+y)},quadraticCurveTo:function(x1,y1,x,y){this._+="Q"+ +x1+","+ +y1+","+(this._x1=+x)+","+(this._y1=+y)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._+="C"+ +x1+","+ +y1+","+ +x2+","+ +y2+","+(this._x1=+x)+","+(this._y1=+y)},arcTo:function(x1,y1,x2,y2,r){x1=+x1,y1=+y1,x2=+x2,y2=+y2,r=+r;var x0=this._x1,y0=this._y1,x21=x2-x1,y21=y2-y1,x01=x0-x1,y01=y0-y1,l01_2=x01*x01+y01*y01;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=x1)+","+(this._y1=y1);else if(l01_2>1e-6)if(Math.abs(y01*x21-y21*x01)>1e-6&&r){var x20=x2-x0,y20=y2-y0,l21_2=x21*x21+y21*y21,l20_2=x20*x20+y20*y20,l21=Math.sqrt(l21_2),l01=Math.sqrt(l01_2),l=r*Math.tan((pi$2-Math.acos((l21_2+l01_2-l20_2)/(2*l21*l01)))/2),t01=l/l01,t21=l/l21;Math.abs(t01-1)>1e-6&&(this._+="L"+(x1+t01*x01)+","+(y1+t01*y01)),this._+="A"+r+","+r+",0,0,"+ +(y01*x20>x01*y20)+","+(this._x1=x1+t21*x21)+","+(this._y1=y1+t21*y21)}else this._+="L"+(this._x1=x1)+","+(this._y1=y1);else;},arc:function(x,y,r,a0,a1,ccw){x=+x,y=+y,r=+r;var dx=r*Math.cos(a0),dy=r*Math.sin(a0),x0=x+dx,y0=y+dy,cw=1^ccw,da=ccw?a0-a1:a1-a0;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+x0+","+y0:(Math.abs(this._x1-x0)>1e-6||Math.abs(this._y1-y0)>1e-6)&&(this._+="L"+x0+","+y0),r&&(da>tauEpsilon?this._+="A"+r+","+r+",0,1,"+cw+","+(x-dx)+","+(y-dy)+"A"+r+","+r+",0,1,"+cw+","+(this._x1=x0)+","+(this._y1=y0):(da<0&&(da=da%tau$2+tau$2),this._+="A"+r+","+r+",0,"+ +(da>=pi$2)+","+cw+","+(this._x1=x+r*Math.cos(a1))+","+(this._y1=y+r*Math.sin(a1))))},rect:function(x,y,w,h){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)+"h"+ +w+"v"+ +h+"h"+-w+"Z"},toString:function(){return this._}};var ribbon=function(){function ribbon(){var buffer,argv=slice$2.call(arguments),s=source.apply(this,argv),t=target.apply(this,argv),sr=+radius.apply(this,(argv[0]=s,argv)),sa0=startAngle.apply(this,argv)-halfPi$1,sa1=endAngle.apply(this,argv)-halfPi$1,sx0=sr*cos(sa0),sy0=sr*sin(sa0),tr=+radius.apply(this,(argv[0]=t,argv)),ta0=startAngle.apply(this,argv)-halfPi$1,ta1=endAngle.apply(this,argv)-halfPi$1;if(context||(context=buffer=path()),context.moveTo(sx0,sy0),context.arc(0,0,sr,sa0,sa1),sa0===ta0&&sa1===ta1||(context.quadraticCurveTo(0,0,tr*cos(ta0),tr*sin(ta0)),context.arc(0,0,tr,ta0,ta1)),context.quadraticCurveTo(0,0,sx0,sy0),context.closePath(),buffer)return context=null,buffer+""||null}var source=defaultSource,target=defaultTarget,radius=defaultRadius,startAngle=defaultStartAngle,endAngle=defaultEndAngle,context=null;return ribbon.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant$5(+_),ribbon):radius},ribbon.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant$5(+_),ribbon):startAngle},ribbon.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant$5(+_),ribbon):endAngle},ribbon.source=function(_){return arguments.length?(source=_,ribbon):source},ribbon.target=function(_){return arguments.length?(target=_,ribbon):target},ribbon.context=function(_){return arguments.length?(context=null==_?null:_,ribbon):context},ribbon};Map.prototype=map$1.prototype={constructor:Map,has:function(key){return"$"+key in this},get:function(key){return this["$"+key]},set:function(key,value){return this["$"+key]=value,this},remove:function(key){var property="$"+key;return property in this&&delete this[property]},clear:function(){for(var property in this)"$"===property[0]&&delete this[property]},keys:function(){var keys=[];for(var property in this)"$"===property[0]&&keys.push(property.slice(1));return keys},values:function(){var values=[];for(var property in this)"$"===property[0]&&values.push(this[property]);return values},entries:function(){var entries=[];for(var property in this)"$"===property[0]&&entries.push({key:property.slice(1),value:this[property]});return entries},size:function(){var size=0;for(var property in this)"$"===property[0]&&++size;return size},empty:function(){for(var property in this)if("$"===property[0])return!1;return!0},each:function(f){for(var property in this)"$"===property[0]&&f(this[property],property.slice(1),this)}};var nest=function(){function apply(array,depth,createResult,setResult){if(depth>=keys.length)return null!=rollup?rollup(array):null!=sortValues?array.sort(sortValues):array;for(var keyValue,value,values,i=-1,n=array.length,key=keys[depth++],valuesByKey=map$1(),result=createResult();++i<n;)(values=valuesByKey.get(keyValue=key(value=array[i])+""))?values.push(value):valuesByKey.set(keyValue,[value]);return valuesByKey.each(function(values,key){setResult(result,key,apply(values,depth,createResult,setResult))}),result}function entries(map,depth){if(++depth>keys.length)return map;var array,sortKey=sortKeys[depth-1];return null!=rollup&&depth>=keys.length?array=map.entries():(array=[],map.each(function(v,k){array.push({key:k,values:entries(v,depth)})})),null!=sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}var sortValues,rollup,nest,keys=[],sortKeys=[];return nest={object:function(array){return apply(array,0,createObject,setObject)},map:function(array){return apply(array,0,createMap,setMap)},entries:function(array){return entries(apply(array,0,createMap,setMap),0)},key:function(d){return keys.push(d),nest},sortKeys:function(order){return sortKeys[keys.length-1]=order,nest},sortValues:function(order){return sortValues=order,nest},rollup:function(f){return rollup=f,nest}}},proto=map$1.prototype;Set.prototype=set$2.prototype={constructor:Set,has:proto.has,add:function(value){return value+="",this["$"+value]=value,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};var keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys},values=function(map){var values=[];for(var key in map)values.push(map[key]);return values},entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries},dsv=function(delimiter){function parse(text,f){var convert,columns,rows=parseRows(text,function(row,i){if(convert)return convert(row,i-1);columns=row,convert=f?customConverter(row,f):objectConverter(row)});return rows.columns=columns,rows}function parseRows(text,f){function token(){if(I>=N)return EOF;if(eol)return eol=!1,EOL;var c,j=I;if(34===text.charCodeAt(j)){for(var i=j;i++<N;)if(34===text.charCodeAt(i)){if(34!==text.charCodeAt(i+1))break;++i}return I=i+2,c=text.charCodeAt(i+1),13===c?(eol=!0,10===text.charCodeAt(i+2)&&++I):10===c&&(eol=!0),text.slice(j+1,i).replace(/""/g,'"')}for(;I<N;){var k=1;if(10===(c=text.charCodeAt(I++)))eol=!0;else if(13===c)eol=!0,10===text.charCodeAt(I)&&(++I,++k);else if(c!==delimiterCode)continue;return text.slice(j,I-k)}return text.slice(j)}for(var t,eol,EOL={},EOF={},rows=[],N=text.length,I=0,n=0;(t=token())!==EOF;){for(var a=[];t!==EOL&&t!==EOF;)a.push(t),t=token();f&&null==(a=f(a,n++))||rows.push(a)}return rows}function format(rows,columns){return null==columns&&(columns=inferColumns(rows)),[columns.map(formatValue).join(delimiter)].concat(rows.map(function(row){return columns.map(function(column){return formatValue(row[column])}).join(delimiter)})).join("\n")}function formatRows(rows){return rows.map(formatRow).join("\n")}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return null==text?"":reFormat.test(text+="")?'"'+text.replace(/\"/g,'""')+'"':text}var reFormat=new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);return{parse:parse,parseRows:parseRows,format:format,formatRows:formatRows}},csv=dsv(","),csvParse=csv.parse,csvParseRows=csv.parseRows,csvFormat=csv.format,csvFormatRows=csv.formatRows,tsv=dsv("\t"),tsvParse=tsv.parse,tsvParseRows=tsv.parseRows,tsvFormat=tsv.format,tsvFormatRows=tsv.formatRows,center$1=function(x,y){function force(){var i,node,n=nodes.length,sx=0,sy=0;for(i=0;i<n;++i)node=nodes[i],sx+=node.x,sy+=node.y;for(sx=sx/n-x,sy=sy/n-y,i=0;i<n;++i)node=nodes[i],node.x-=sx,node.y-=sy}var nodes;return null==x&&(x=0),null==y&&(y=0),force.initialize=function(_){nodes=_},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force},constant$6=function(x){return function(){return x}},jiggle=function(){return 1e-6*(Math.random()-.5)},tree_add=function(d){var x=+this._x.call(null,d),y=+this._y.call(null,d);return add(this.cover(x,y),x,y,d)},tree_cover=function(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1;else{if(!(x0>x||x>x1||y0>y||y>y1))return this;var parent,i,z=x1-x0,node=this._root;switch(i=(y<(y0+y1)/2)<<1|x<(x0+x1)/2){case 0:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x1=x0+z,y1=y0+z,x>x1||y>y1);break;case 1:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x0=x1-z,y1=y0+z,x0>x||y>y1);break;case 2:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x1=x0+z,y0=y1-z,x>x1||y0>y);break;case 3:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x0=x1-z,y0=y1-z,x0>x||y0>y)}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this},tree_data=function(){var data=[];return this.visit(function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)}),data},tree_extent=function(_){return arguments.length?this.cover(+_[0][0],+_[0][1]).cover(+_[1][0],+_[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Quad=function(node,x0,y0,x1,y1){this.node=node,this.x0=x0,this.y0=y0,this.x1=x1,this.y1=y1},tree_find=function(x,y,radius){var data,x1,y1,x2,y2,q,i,x0=this._x0,y0=this._y0,x3=this._x1,y3=this._y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,x0,y0,x3,y3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,x3=x+radius,y3=y+radius,radius*=radius);q=quads.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(x2=q.x1)<x0||(y2=q.y1)<y0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2;quads.push(new Quad(node[3],xm,ym,x2,y2),new Quad(node[2],x1,ym,xm,y2),new Quad(node[1],xm,y1,x2,ym),new Quad(node[0],x1,y1,xm,ym)),(i=(y>=ym)<<1|x>=xm)&&(q=quads[quads.length-1],quads[quads.length-1]=quads[quads.length-1-i],quads[quads.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),d2=dx*dx+dy*dy;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,x3=x+d,y3=y+d,data=node.data}}return data},tree_remove=function(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var parent,retainer,previous,next,x,y,xm,ym,right,bottom,i,j,node=this._root,x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&3]||parent[i+2&3]||parent[i+3&3])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3])&&node===(parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},tree_root=function(){return this._root},tree_size=function(){var size=0;return this.visit(function(node){if(!node.length)do{++size}while(node=node.next)}),size},tree_visit=function(callback){var q,child,x0,y0,x1,y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,this._x0,this._y0,this._x1,this._y1));q=quads.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym))}return this},tree_visitAfter=function(callback){var q,quads=[],next=[];for(this._root&&quads.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));q=quads.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1,xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.x1,q.y1);return this},tree_x=function(_){return arguments.length?(this._x=_,this):this._x},tree_y=function(_){return arguments.length?(this._y=_,this):this._y},treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var nodes,child,copy=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(4)}];node=nodes.pop();)for(var i=0;i<4;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(4)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=tree_add,treeProto.addAll=addAll,treeProto.cover=tree_cover,treeProto.data=tree_data,treeProto.extent=tree_extent,treeProto.find=tree_find,treeProto.remove=tree_remove,treeProto.removeAll=removeAll,treeProto.root=tree_root,treeProto.size=tree_size,treeProto.visit=tree_visit,treeProto.visitAfter=tree_visitAfter,treeProto.x=tree_x,treeProto.y=tree_y;var prefixExponent,collide=function(radius){function force(){function apply(quad,x0,y0,x1,y1){var data=quad.data,rj=quad.r,r=ri+rj;if(!data)return x0>xi+r||x1<xi-r||y0>yi+r||y1<yi-r;if(data.index>node.index){var x=xi-data.x-data.vx,y=yi-data.y-data.vy,l=x*x+y*y;l<r*r&&(0===x&&(x=jiggle(),l+=x*x),0===y&&(y=jiggle(),l+=y*y),l=(r-(l=Math.sqrt(l)))/l*strength,node.vx+=(x*=l)*(r=(rj*=rj)/(ri2+rj)),node.vy+=(y*=l)*r,data.vx-=x*(r=1-r),data.vy-=y*r)}}for(var i,tree,node,xi,yi,ri,ri2,n=nodes.length,k=0;k<iterations;++k)for(tree=quadtree(nodes,x,y).visitAfter(prepare),i=0;i<n;++i)node=nodes[i],ri=radii[node.index],ri2=ri*ri,xi=node.x+node.vx,yi=node.y+node.vy,tree.visit(apply)}function prepare(quad){if(quad.data)return quad.r=radii[quad.data.index];for(var i=quad.r=0;i<4;++i)quad[i]&&quad[i].r>quad.r&&(quad.r=quad[i].r)}function initialize(){if(nodes){var i,node,n=nodes.length;for(radii=new Array(n),i=0;i<n;++i)node=nodes[i],radii[node.index]=+radius(node,i,nodes)}}var nodes,radii,strength=1,iterations=1;return"function"!=typeof radius&&(radius=constant$6(null==radius?1:+radius)),force.initialize=function(_){nodes=_,initialize()},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength=+_,force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant$6(+_),initialize(),force):radius},force},link=function(links){function defaultStrength(link){return 1/Math.min(count[link.source.index],count[link.target.index])}function force(alpha){for(var k=0,n=links.length;k<iterations;++k)for(var link,source,target,x,y,l,b,i=0;i<n;++i)link=links[i],source=link.source,target=link.target,x=target.x+target.vx-source.x-source.vx||jiggle(),y=target.y+target.vy-source.y-source.vy||jiggle(),l=Math.sqrt(x*x+y*y),l=(l-distances[i])/l*alpha*strengths[i],x*=l,y*=l,target.vx-=x*(b=bias[i]),target.vy-=y*b,source.vx+=x*(b=1-b),source.vy+=y*b}function initialize(){if(nodes){var i,link,n=nodes.length,m=links.length,nodeById=map$1(nodes,id);for(i=0,count=new Array(n);i<m;++i)link=links[i],link.index=i,"object"!=typeof link.source&&(link.source=find(nodeById,link.source)),"object"!=typeof link.target&&(link.target=find(nodeById,link.target)),count[link.source.index]=(count[link.source.index]||0)+1,count[link.target.index]=(count[link.target.index]||0)+1;for(i=0,bias=new Array(m);i<m;++i)link=links[i],bias[i]=count[link.source.index]/(count[link.source.index]+count[link.target.index]);strengths=new Array(m),initializeStrength(),distances=new Array(m),initializeDistance()}}function initializeStrength(){if(nodes)for(var i=0,n=links.length;i<n;++i)strengths[i]=+strength(links[i],i,links)}function initializeDistance(){if(nodes)for(var i=0,n=links.length;i<n;++i)distances[i]=+distance(links[i],i,links)}var strengths,distances,nodes,count,bias,id=index,strength=defaultStrength,distance=constant$6(30),iterations=1;return null==links&&(links=[]),force.initialize=function(_){nodes=_,initialize()},force.links=function(_){return arguments.length?(links=_,initialize(),force):links},force.id=function(_){return arguments.length?(id=_,force):id},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant$6(+_),initializeStrength(),force):strength},force.distance=function(_){return arguments.length?(distance="function"==typeof _?_:constant$6(+_),initializeDistance(),force):distance},force},initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5)),simulation=function(nodes){function step(){tick(),event.call("tick",simulation),alpha<alphaMin&&(stepper.stop(),event.call("end",simulation))}function tick(){var i,node,n=nodes.length;for(alpha+=(alphaTarget-alpha)*alphaDecay,forces.each(function(force){force(alpha)}),i=0;i<n;++i)node=nodes[i],null==node.fx?node.x+=node.vx*=velocityDecay:(node.x=node.fx,node.vx=0),null==node.fy?node.y+=node.vy*=velocityDecay:(node.y=node.fy,node.vy=0)}function initializeNodes(){for(var node,i=0,n=nodes.length;i<n;++i){if(node=nodes[i],node.index=i,isNaN(node.x)||isNaN(node.y)){var radius=initialRadius*Math.sqrt(i),angle=i*initialAngle;node.x=radius*Math.cos(angle),node.y=radius*Math.sin(angle)}(isNaN(node.vx)||isNaN(node.vy))&&(node.vx=node.vy=0)}}function initializeForce(force){return force.initialize&&force.initialize(nodes),force}var simulation,alpha=1,alphaMin=.001,alphaDecay=1-Math.pow(alphaMin,1/300),alphaTarget=0,velocityDecay=.6,forces=map$1(),stepper=timer(step),event=dispatch("tick","end");return null==nodes&&(nodes=[]),initializeNodes(),simulation={tick:tick,restart:function(){return stepper.restart(step),simulation},stop:function(){return stepper.stop(),simulation},nodes:function(_){return arguments.length?(nodes=_,initializeNodes(),forces.each(initializeForce),simulation):nodes},alpha:function(_){return arguments.length?(alpha=+_,simulation):alpha},alphaMin:function(_){return arguments.length?(alphaMin=+_,simulation):alphaMin},alphaDecay:function(_){return arguments.length?(alphaDecay=+_,simulation):+alphaDecay},alphaTarget:function(_){return arguments.length?(alphaTarget=+_,simulation):alphaTarget},velocityDecay:function(_){return arguments.length?(velocityDecay=1-_,simulation):1-velocityDecay},force:function(name,_){return arguments.length>1?(null==_?forces.remove(name):forces.set(name,initializeForce(_)),simulation):forces.get(name)},find:function(x,y,radius){var dx,dy,d2,node,closest,i=0,n=nodes.length;for(null==radius?radius=1/0:radius*=radius,i=0;i<n;++i)node=nodes[i],dx=x-node.x,dy=y-node.y,(d2=dx*dx+dy*dy)<radius&&(closest=node,radius=d2);return closest},on:function(name,_){
return arguments.length>1?(event.on(name,_),simulation):event.on(name)}}},manyBody=function(){function force(_){var i,n=nodes.length,tree=quadtree(nodes,x$1,y$1).visitAfter(accumulate);for(alpha=_,i=0;i<n;++i)node=nodes[i],tree.visit(apply)}function initialize(){if(nodes){var i,node,n=nodes.length;for(strengths=new Array(n),i=0;i<n;++i)node=nodes[i],strengths[node.index]=+strength(node,i,nodes)}}function accumulate(quad){var q,c,x$$1,y$$1,i,strength=0;if(quad.length){for(x$$1=y$$1=i=0;i<4;++i)(q=quad[i])&&(c=q.value)&&(strength+=c,x$$1+=c*q.x,y$$1+=c*q.y);quad.x=x$$1/strength,quad.y=y$$1/strength}else{q=quad,q.x=q.data.x,q.y=q.data.y;do{strength+=strengths[q.data.index]}while(q=q.next)}quad.value=strength}function apply(quad,x1,_,x2){if(!quad.value)return!0;var x$$1=quad.x-node.x,y$$1=quad.y-node.y,w=x2-x1,l=x$$1*x$$1+y$$1*y$$1;if(w*w/theta2<l)return l<distanceMax2&&(0===x$$1&&(x$$1=jiggle(),l+=x$$1*x$$1),0===y$$1&&(y$$1=jiggle(),l+=y$$1*y$$1),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)),node.vx+=x$$1*quad.value*alpha/l,node.vy+=y$$1*quad.value*alpha/l),!0;if(!(quad.length||l>=distanceMax2)){(quad.data!==node||quad.next)&&(0===x$$1&&(x$$1=jiggle(),l+=x$$1*x$$1),0===y$$1&&(y$$1=jiggle(),l+=y$$1*y$$1),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)));do{quad.data!==node&&(w=strengths[quad.data.index]*alpha/l,node.vx+=x$$1*w,node.vy+=y$$1*w)}while(quad=quad.next)}}var nodes,node,alpha,strengths,strength=constant$6(-30),distanceMin2=1,distanceMax2=1/0,theta2=.81;return force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant$6(+_),initialize(),force):strength},force.distanceMin=function(_){return arguments.length?(distanceMin2=_*_,force):Math.sqrt(distanceMin2)},force.distanceMax=function(_){return arguments.length?(distanceMax2=_*_,force):Math.sqrt(distanceMax2)},force.theta=function(_){return arguments.length?(theta2=_*_,force):Math.sqrt(theta2)},force},x$2=function(x){function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)node=nodes[i],node.vx+=(xz[i]-node.x)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),xz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(xz[i]=+x(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}var nodes,strengths,xz,strength=constant$6(.1);return"function"!=typeof x&&(x=constant$6(null==x?0:+x)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant$6(+_),initialize(),force):strength},force.x=function(_){return arguments.length?(x="function"==typeof _?_:constant$6(+_),initialize(),force):x},force},y$2=function(y){function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)node=nodes[i],node.vy+=(yz[i]-node.y)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),yz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(yz[i]=+y(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}var nodes,strengths,yz,strength=constant$6(.1);return"function"!=typeof y&&(y=constant$6(null==y?0:+y)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant$6(+_),initialize(),force):strength},force.y=function(_){return arguments.length?(y="function"==typeof _?_:constant$6(+_),initialize(),force):y},force},formatDecimal=function(x,p){if((i=(x=p?x.toExponential(p-1):x.toExponential()).indexOf("e"))<0)return null;var i,coefficient=x.slice(0,i);return[coefficient.length>1?coefficient[0]+coefficient.slice(2):coefficient,+x.slice(i+1)]},exponent$1=function(x){return x=formatDecimal(Math.abs(x)),x?x[1]:NaN},formatGroup=function(grouping,thousands){return function(value,width){for(var i=value.length,t=[],j=0,g=grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=grouping[j=(j+1)%grouping.length];return t.reverse().join(thousands)}},formatDefault=function(x,p){x=x.toPrecision(p);out:for(var i1,n=x.length,i=1,i0=-1;i<n;++i)switch(x[i]){case".":i0=i1=i;break;case"0":0===i0&&(i0=i),i1=i;break;case"e":break out;default:i0>0&&(i0=0)}return i0>0?x.slice(0,i0)+x.slice(i1+1):x},formatPrefixAuto=function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1],i=exponent-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(exponent/3))))+1,n=coefficient.length;return i===n?coefficient:i>n?coefficient+new Array(i-n+1).join("0"):i>0?coefficient.slice(0,i)+"."+coefficient.slice(i):"0."+new Array(1-i).join("0")+formatDecimal(x,Math.max(0,p+i-1))[0]},formatRounded=function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1];return exponent<0?"0."+new Array(-exponent).join("0")+coefficient:coefficient.length>exponent+1?coefficient.slice(0,exponent+1)+"."+coefficient.slice(exponent+1):coefficient+new Array(exponent-coefficient.length+2).join("0")},formatTypes={"":formatDefault,"%":function(x,p){return(100*x).toFixed(p)},b:function(x){return Math.round(x).toString(2)},c:function(x){return x+""},d:function(x){return Math.round(x).toString(10)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},g:function(x,p){return x.toPrecision(p)},o:function(x){return Math.round(x).toString(8)},p:function(x,p){return formatRounded(100*x,p)},r:formatRounded,s:formatPrefixAuto,X:function(x){return Math.round(x).toString(16).toUpperCase()},x:function(x){return Math.round(x).toString(16)}},re=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,formatSpecifier=function(specifier){return new FormatSpecifier(specifier)};FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var locale$1,prefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],formatLocale=function(locale){function newFormat(specifier){function format(value){var i,n,c,valuePrefix=prefix,valueSuffix=suffix;if("c"===type)valueSuffix=formatType(value)+valueSuffix,value="";else{value=+value;var valueNegative=(value<0||1/value<0)&&(value*=-1,!0);if(value=formatType(value,precision),valueNegative)for(i=-1,n=value.length,valueNegative=!1;++i<n;)if(48<(c=value.charCodeAt(i))&&c<58||"x"===type&&96<c&&c<103||"X"===type&&64<c&&c<71){valueNegative=!0;break}if(valuePrefix=(valueNegative?"("===sign?sign:"-":"-"===sign||"("===sign?"":sign)+valuePrefix,valueSuffix=valueSuffix+("s"===type?prefixes[8+prefixExponent/3]:"")+(valueNegative&&"("===sign?")":""),maybeSuffix)for(i=-1,n=value.length;++i<n;)if(48>(c=value.charCodeAt(i))||c>57){valueSuffix=(46===c?decimal+value.slice(i+1):value.slice(i))+valueSuffix,value=value.slice(0,i);break}}comma&&!zero&&(value=group(value,1/0));var length=valuePrefix.length+value.length+valueSuffix.length,padding=length<width?new Array(width-length+1).join(fill):"";switch(comma&&zero&&(value=group(padding+value,padding.length?width-valueSuffix.length:1/0),padding=""),align){case"<":return valuePrefix+value+valueSuffix+padding;case"=":return valuePrefix+padding+value+valueSuffix;case"^":return padding.slice(0,length=padding.length>>1)+valuePrefix+value+valueSuffix+padding.slice(length)}return padding+valuePrefix+value+valueSuffix}specifier=formatSpecifier(specifier);var fill=specifier.fill,align=specifier.align,sign=specifier.sign,symbol=specifier.symbol,zero=specifier.zero,width=specifier.width,comma=specifier.comma,precision=specifier.precision,type=specifier.type,prefix="$"===symbol?currency[0]:"#"===symbol&&/[boxX]/.test(type)?"0"+type.toLowerCase():"",suffix="$"===symbol?currency[1]:/[%p]/.test(type)?"%":"",formatType=formatTypes[type],maybeSuffix=!type||/[defgprs%]/.test(type);return precision=null==precision?type?6:12:/[gprs]/.test(type)?Math.max(1,Math.min(21,precision)):Math.max(0,Math.min(20,precision)),format.toString=function(){return specifier+""},format}function formatPrefix(specifier,value){var f=newFormat((specifier=formatSpecifier(specifier),specifier.type="f",specifier)),e=3*Math.max(-8,Math.min(8,Math.floor(exponent$1(value)/3))),k=Math.pow(10,-e),prefix=prefixes[8+e/3];return function(value){return f(k*value)+prefix}}var group=locale.grouping&&locale.thousands?formatGroup(locale.grouping,locale.thousands):identity$3,currency=locale.currency,decimal=locale.decimal;return{format:newFormat,formatPrefix:formatPrefix}};defaultLocale({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var precisionFixed=function(step){return Math.max(0,-exponent$1(Math.abs(step)))},precisionPrefix=function(step,value){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent$1(value)/3)))-exponent$1(Math.abs(step)))},precisionRound=function(step,max){return step=Math.abs(step),max=Math.abs(max)-step,Math.max(0,exponent$1(max)-exponent$1(step))+1},adder=function(){return new Adder};Adder.prototype={constructor:Adder,reset:function(){this.s=this.t=0},add:function(y){add$1(temp,y,this.t),add$1(this,temp.s,this.s),this.s?this.t+=temp.t:this.s=temp.t},valueOf:function(){return this.s}};var lambda00,phi00,lambda0,cosPhi0,sinPhi0,lambda0$1,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,ranges,range,W0,W1,X0,Y0,Z0,X1,Y1,Z1,X2,Y2,Z2,lambda00$2,phi00$2,x0,y0,z0,temp=new Adder,epsilon$2=1e-6,pi$3=Math.PI,halfPi$2=pi$3/2,quarterPi=pi$3/4,tau$3=2*pi$3,degrees$1=180/pi$3,radians=pi$3/180,abs=Math.abs,atan=Math.atan,atan2=Math.atan2,cos$1=Math.cos,ceil=Math.ceil,exp=Math.exp,log=Math.log,pow=Math.pow,sin$1=Math.sin,sign=Math.sign||function(x){return x>0?1:x<0?-1:0},sqrt=Math.sqrt,tan=Math.tan,streamObjectType={Feature:function(feature,stream){streamGeometry(feature.geometry,stream)},FeatureCollection:function(object,stream){for(var features=object.features,i=-1,n=features.length;++i<n;)streamGeometry(features[i].geometry,stream)}},streamGeometryType={Sphere:function(object,stream){stream.sphere()},Point:function(object,stream){object=object.coordinates,stream.point(object[0],object[1],object[2])},MultiPoint:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)object=coordinates[i],stream.point(object[0],object[1],object[2])},LineString:function(object,stream){streamLine(object.coordinates,stream,0)},MultiLineString:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)streamLine(coordinates[i],stream,0)},Polygon:function(object,stream){streamPolygon(object.coordinates,stream)},MultiPolygon:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)streamPolygon(coordinates[i],stream)},GeometryCollection:function(object,stream){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)streamGeometry(geometries[i],stream)}},geoStream=function(object,stream){object&&streamObjectType.hasOwnProperty(object.type)?streamObjectType[object.type](object,stream):streamGeometry(object,stream)},areaRingSum=adder(),areaSum=adder(),areaStream={point:noop$1,lineStart:noop$1,lineEnd:noop$1,polygonStart:function(){areaRingSum.reset(),areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){var areaRing=+areaRingSum;areaSum.add(areaRing<0?tau$3+areaRing:areaRing),this.lineStart=this.lineEnd=this.point=noop$1},sphere:function(){areaSum.add(tau$3)}},area=function(object){return areaSum.reset(),geoStream(object,areaStream),2*areaSum},deltaSum=adder(),boundsStream={point:boundsPoint,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream.point=boundsRingPoint,boundsStream.lineStart=boundsRingStart,boundsStream.lineEnd=boundsRingEnd,deltaSum.reset(),areaStream.polygonStart()},polygonEnd:function(){areaStream.polygonEnd(),boundsStream.point=boundsPoint,boundsStream.lineStart=boundsLineStart,boundsStream.lineEnd=boundsLineEnd,areaRingSum<0?(lambda0$1=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon$2?phi1=90:deltaSum<-epsilon$2&&(phi0=-90),range[0]=lambda0$1,range[1]=lambda1}},bounds=function(feature){var i,n,a,b,merged,deltaMax,delta;if(phi1=lambda1=-(lambda0$1=phi0=1/0),ranges=[],geoStream(feature,boundsStream),n=ranges.length){for(ranges.sort(rangeCompare),i=1,a=ranges[0],merged=[a];i<n;++i)b=ranges[i],rangeContains(a,b[0])||rangeContains(a,b[1])?(angle(a[0],b[1])>angle(a[0],a[1])&&(a[1]=b[1]),angle(b[0],a[1])>angle(a[0],a[1])&&(a[0]=b[0])):merged.push(a=b);for(deltaMax=-1/0,n=merged.length-1,i=0,a=merged[n];i<=n;a=b,++i)b=merged[i],(delta=angle(a[1],b[0]))>deltaMax&&(deltaMax=delta,lambda0$1=b[0],lambda1=a[1])}return ranges=range=null,lambda0$1===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0$1,phi0],[lambda1,phi1]]},centroidStream={sphere:noop$1,point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd}},centroid=function(object){W0=W1=X0=Y0=Z0=X1=Y1=Z1=X2=Y2=Z2=0,geoStream(object,centroidStream);var x=X2,y=Y2,z=Z2,m=x*x+y*y+z*z;return m<1e-12&&(x=X1,y=Y1,z=Z1,W1<epsilon$2&&(x=X0,y=Y0,z=Z0),(m=x*x+y*y+z*z)<1e-12)?[NaN,NaN]:[atan2(y,x)*degrees$1,asin(z/sqrt(m))*degrees$1]},constant$7=function(x){return function(){return x}},compose=function(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}return a.invert&&b.invert&&(compose.invert=function(x,y){return(x=b.invert(x,y))&&a.invert(x[0],x[1])}),compose};rotationIdentity.invert=rotationIdentity;var lambda0$2,sinPhi0$1,cosPhi0$1,x00,y00,x0$1,y0$1,x00$1,y00$1,x0$3,y0$3,rotation=function(rotate){function forward(coordinates){return coordinates=rotate(coordinates[0]*radians,coordinates[1]*radians),coordinates[0]*=degrees$1,coordinates[1]*=degrees$1,coordinates}return rotate=rotateRadians(rotate[0]*radians,rotate[1]*radians,rotate.length>2?rotate[2]*radians:0),forward.invert=function(coordinates){return coordinates=rotate.invert(coordinates[0]*radians,coordinates[1]*radians),coordinates[0]*=degrees$1,coordinates[1]*=degrees$1,coordinates},forward},circle=function(){function point(x,y){ring.push(x=rotate(x,y)),x[0]*=degrees$1,x[1]*=degrees$1}function circle(){var c=center.apply(this,arguments),r=radius.apply(this,arguments)*radians,p=precision.apply(this,arguments)*radians;return ring=[],rotate=rotateRadians(-c[0]*radians,-c[1]*radians,0).invert,circleStream(stream,r,p,1),c={type:"Polygon",coordinates:[ring]},ring=rotate=null,c}var ring,rotate,center=constant$7([0,0]),radius=constant$7(90),precision=constant$7(6),stream={point:point};return circle.center=function(_){return arguments.length?(center="function"==typeof _?_:constant$7([+_[0],+_[1]]),circle):center},circle.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant$7(+_),circle):radius},circle.precision=function(_){return arguments.length?(precision="function"==typeof _?_:constant$7(+_),circle):precision},circle},clipBuffer=function(){var line,lines=[];return{point:function(x,y){line.push([x,y])},lineStart:function(){lines.push(line=[])},lineEnd:noop$1,rejoin:function(){lines.length>1&&lines.push(lines.pop().concat(lines.shift()))},result:function(){var result=lines;return lines=[],line=null,result}}},clipLine=function(a,b,x0,y0,x1,y1){var r,ax=a[0],ay=a[1],bx=b[0],by=b[1],t0=0,t1=1,dx=bx-ax,dy=by-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return t0>0&&(a[0]=ax+t0*dx,a[1]=ay+t0*dy),t1<1&&(b[0]=ax+t1*dx,b[1]=ay+t1*dy),!0}}}}},pointEqual=function(a,b){return abs(a[0]-b[0])<epsilon$2&&abs(a[1]-b[1])<epsilon$2},clipPolygon=function(segments,compareIntersection,startInside,interpolate,stream){var i,n,subject=[],clip=[];if(segments.forEach(function(segment){if(!((n=segment.length-1)<=0)){var n,x,p0=segment[0],p1=segment[n];if(pointEqual(p0,p1)){for(stream.lineStart(),i=0;i<n;++i)stream.point((p0=segment[i])[0],p0[1]);return void stream.lineEnd()}subject.push(x=new Intersection(p0,segment,null,!0)),clip.push(x.o=new Intersection(p0,null,x,!1)),subject.push(x=new Intersection(p1,segment,null,!1)),clip.push(x.o=new Intersection(p1,null,x,!0))}}),subject.length){for(clip.sort(compareIntersection),link$1(subject),link$1(clip),i=0,n=clip.length;i<n;++i)clip[i].e=startInside=!startInside;for(var points,point,start=subject[0];;){for(var current=start,isSubject=!0;current.v;)if((current=current.n)===start)return;points=current.z,stream.lineStart();do{if(current.v=current.o.v=!0,current.e){if(isSubject)for(i=0,n=points.length;i<n;++i)stream.point((point=points[i])[0],point[1]);else interpolate(current.x,current.n.x,1,stream);current=current.n}else{if(isSubject)for(points=current.p.z,i=points.length-1;i>=0;--i)stream.point((point=points[i])[0],point[1]);else interpolate(current.x,current.p.x,-1,stream);current=current.p}current=current.o,points=current.z,isSubject=!isSubject}while(!current.v);stream.lineEnd()}}},clipMax=1e9,clipMin=-clipMax,extent$1=function(){var cache,cacheStream,clip,x0=0,y0=0,x1=960,y1=500;return clip={stream:function(stream){return cache&&cacheStream===stream?cache:cache=clipExtent(x0,y0,x1,y1)(cacheStream=stream)},extent:function(_){return arguments.length?(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1],cache=cacheStream=null,clip):[[x0,y0],[x1,y1]]}}},lengthSum=adder(),lengthStream={sphere:noop$1,point:noop$1,lineStart:lengthLineStart,lineEnd:noop$1,polygonStart:noop$1,polygonEnd:noop$1},length$1=function(object){return lengthSum.reset(),geoStream(object,lengthStream),+lengthSum},coordinates=[null,null],object$1={type:"LineString",coordinates:coordinates},distance=function(a,b){return coordinates[0]=a,coordinates[1]=b,length$1(object$1)},interpolate$1=function(a,b){var x0=a[0]*radians,y0=a[1]*radians,x1=b[0]*radians,y1=b[1]*radians,cy0=cos$1(y0),sy0=sin$1(y0),cy1=cos$1(y1),sy1=sin$1(y1),kx0=cy0*cos$1(x0),ky0=cy0*sin$1(x0),kx1=cy1*cos$1(x1),ky1=cy1*sin$1(x1),d=2*asin(sqrt(haversin(y1-y0)+cy0*cy1*haversin(x1-x0))),k=sin$1(d),interpolate=d?function(t){var B=sin$1(t*=d)/k,A=sin$1(d-t)/k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[atan2(y,x)*degrees$1,atan2(z,sqrt(x*x+y*y))*degrees$1]}:function(){return[x0*degrees$1,y0*degrees$1]};return interpolate.distance=d,interpolate},identity$4=function(x){return x},areaSum$1=adder(),areaRingSum$1=adder(),areaStream$1={point:noop$1,lineStart:noop$1,lineEnd:noop$1,polygonStart:function(){areaStream$1.lineStart=areaRingStart$1,areaStream$1.lineEnd=areaRingEnd$1},polygonEnd:function(){areaStream$1.lineStart=areaStream$1.lineEnd=areaStream$1.point=noop$1,areaSum$1.add(abs(areaRingSum$1)),areaRingSum$1.reset()},result:function(){var area=areaSum$1/2;return areaSum$1.reset(),area}},x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream$1={point:boundsPoint$1,lineStart:noop$1,lineEnd:noop$1,polygonStart:noop$1,polygonEnd:noop$1,result:function(){var bounds=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),bounds}},X0$1=0,Y0$1=0,Z0$1=0,X1$1=0,Y1$1=0,Z1$1=0,X2$1=0,Y2$1=0,Z2$1=0,centroidStream$1={point:centroidPoint$1,lineStart:centroidLineStart$1,lineEnd:centroidLineEnd$1,polygonStart:function(){centroidStream$1.lineStart=centroidRingStart$1,centroidStream$1.lineEnd=centroidRingEnd$1},polygonEnd:function(){centroidStream$1.point=centroidPoint$1,centroidStream$1.lineStart=centroidLineStart$1,centroidStream$1.lineEnd=centroidLineEnd$1},result:function(){var centroid=Z2$1?[X2$1/Z2$1,Y2$1/Z2$1]:Z1$1?[X1$1/Z1$1,Y1$1/Z1$1]:Z0$1?[X0$1/Z0$1,Y0$1/Z0$1]:[NaN,NaN];return X0$1=Y0$1=Z0$1=X1$1=Y1$1=Z1$1=X2$1=Y2$1=Z2$1=0,centroid}};PathContext.prototype={_radius:4.5,pointRadius:function(_){return this._radius=_,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._context.moveTo(x,y),this._point=1;break;case 1:this._context.lineTo(x,y);break;default:this._context.moveTo(x+this._radius,y),this._context.arc(x,y,this._radius,0,tau$3)}},result:noop$1};var lengthRing,x00$2,y00$2,x0$4,y0$4,lengthSum$1=adder(),lengthStream$1={point:noop$1,lineStart:function(){lengthStream$1.point=lengthPointFirst$1},lineEnd:function(){lengthRing&&lengthPoint$1(x00$2,y00$2),lengthStream$1.point=noop$1},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var length=+lengthSum$1;return lengthSum$1.reset(),length}};PathString.prototype={_circle:circle$1(4.5),pointRadius:function(_){return this._circle=circle$1(_),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._string.push("M",x,",",y),this._point=1;break;case 1:this._string.push("L",x,",",y);break;default:this._string.push("M",x,",",y,this._circle)}},result:function(){if(this._string.length){var result=this._string.join("");return this._string=[],result}}};var index$1=function(projection,context){function path(object){return object&&("function"==typeof pointRadius&&contextStream.pointRadius(+pointRadius.apply(this,arguments)),geoStream(object,projectionStream(contextStream))),contextStream.result()}var projectionStream,contextStream,pointRadius=4.5;return path.area=function(object){return geoStream(object,projectionStream(areaStream$1)),areaStream$1.result()},path.measure=function(object){return geoStream(object,projectionStream(lengthStream$1)),lengthStream$1.result()},path.bounds=function(object){return geoStream(object,projectionStream(boundsStream$1)),boundsStream$1.result()},path.centroid=function(object){return geoStream(object,projectionStream(centroidStream$1)),centroidStream$1.result()},path.projection=function(_){return arguments.length?(projectionStream=null==_?(projection=null,identity$4):(projection=_).stream,path):projection},path.context=function(_){return arguments.length?(contextStream=null==_?(context=null,new PathString):new PathContext(context=_),"function"!=typeof pointRadius&&contextStream.pointRadius(pointRadius),path):context},path.pointRadius=function(_){return arguments.length?(pointRadius="function"==typeof _?_:(contextStream.pointRadius(+_),+_),path):pointRadius},path.projection(projection).context(context)},sum$1=adder(),polygonContains=function(polygon,point){var lambda=point[0],phi=point[1],normal=[sin$1(lambda),-cos$1(lambda),0],angle=0,winding=0;sum$1.reset();for(var i=0,n=polygon.length;i<n;++i)if(m=(ring=polygon[i]).length)for(var ring,m,point0=ring[m-1],lambda0=point0[0],phi0=point0[1]/2+quarterPi,sinPhi0=sin$1(phi0),cosPhi0=cos$1(phi0),j=0;j<m;++j,lambda0=lambda1,sinPhi0=sinPhi1,cosPhi0=cosPhi1,point0=point1){var point1=ring[j],lambda1=point1[0],phi1=point1[1]/2+quarterPi,sinPhi1=sin$1(phi1),cosPhi1=cos$1(phi1),delta=lambda1-lambda0,sign$$1=delta>=0?1:-1,absDelta=sign$$1*delta,antimeridian=absDelta>pi$3,k=sinPhi0*sinPhi1;if(sum$1.add(atan2(k*sign$$1*sin$1(absDelta),cosPhi0*cosPhi1+k*cos$1(absDelta))),angle+=antimeridian?delta+sign$$1*tau$3:delta,antimeridian^lambda0>=lambda^lambda1>=lambda){var arc=cartesianCross(cartesian(point0),cartesian(point1));cartesianNormalizeInPlace(arc);var intersection=cartesianCross(normal,arc);cartesianNormalizeInPlace(intersection);var phiArc=(antimeridian^delta>=0?-1:1)*asin(intersection[2]);(phi>phiArc||phi===phiArc&&(arc[0]||arc[1]))&&(winding+=antimeridian^delta>=0?1:-1)}}return(angle<-epsilon$2||angle<epsilon$2&&sum$1<-epsilon$2)^1&winding},clip=function(pointVisible,clipLine,interpolate,start){return function(rotate,sink){function point(lambda,phi){var point=rotate(lambda,phi);pointVisible(lambda=point[0],phi=point[1])&&sink.point(lambda,phi)}function pointLine(lambda,phi){var point=rotate(lambda,phi);line.point(point[0],point[1])}function lineStart(){clip.point=pointLine,line.lineStart()}function lineEnd(){clip.point=point,line.lineEnd()}function pointRing(lambda,phi){ring.push([lambda,phi]);var point=rotate(lambda,phi);ringSink.point(point[0],point[1])}function ringStart(){ringSink.lineStart(),ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]),ringSink.lineEnd();var i,m,segment,point,clean=ringSink.clean(),ringSegments=ringBuffer.result(),n=ringSegments.length;if(ring.pop(),polygon.push(ring),ring=null,n)if(1&clean){if(segment=ringSegments[0],(m=segment.length-1)>0){for(polygonStarted||(sink.polygonStart(),polygonStarted=!0),sink.lineStart(),i=0;i<m;++i)sink.point((point=segment[i])[0],point[1]);sink.lineEnd()}}else n>1&&2&clean&&ringSegments.push(ringSegments.pop().concat(ringSegments.shift())),segments.push(ringSegments.filter(validSegment))}var polygon,segments,ring,line=clipLine(sink),rotatedStart=rotate.invert(start[0],start[1]),ringBuffer=clipBuffer(),ringSink=clipLine(ringBuffer),polygonStarted=!1,clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing,clip.lineStart=ringStart,clip.lineEnd=ringEnd,segments=[],polygon=[]},polygonEnd:function(){clip.point=point,clip.lineStart=lineStart,clip.lineEnd=lineEnd,segments=merge(segments);var startInside=polygonContains(polygon,rotatedStart);segments.length?(polygonStarted||(sink.polygonStart(),polygonStarted=!0),clipPolygon(segments,compareIntersection,startInside,interpolate,sink)):startInside&&(polygonStarted||(sink.polygonStart(),polygonStarted=!0),sink.lineStart(),interpolate(null,null,1,sink),sink.lineEnd()),polygonStarted&&(sink.polygonEnd(),polygonStarted=!1),segments=polygon=null},sphere:function(){sink.polygonStart(),sink.lineStart(),interpolate(null,null,1,sink),sink.lineEnd(),sink.polygonEnd()}};return clip}},clipAntimeridian=clip(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi$3,-halfPi$2]),clipCircle=function(radius,delta){function interpolate(from,to,direction,stream){circleStream(stream,radius,delta,direction,from,to)}function visible(lambda,phi){return cos$1(lambda)*cos$1(phi)>cr}function clipLine(stream){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=!1,clean=1},point:function(lambda,phi){var point2,point1=[lambda,phi],v=visible(lambda,phi),c=smallRadius?v?0:code(lambda,phi):v?code(lambda+(lambda<0?pi$3:-pi$3),phi):0;if(!point0&&(v00=v0=v)&&stream.lineStart(),v!==v0&&(point2=intersect(point0,point1),(pointEqual(point0,point2)||pointEqual(point1,point2))&&(point1[0]+=epsilon$2,point1[1]+=epsilon$2,v=visible(point1[0],point1[1]))),v!==v0)clean=0,v?(stream.lineStart(),point2=intersect(point1,point0),stream.point(point2[0],point2[1])):(point2=intersect(point0,point1),stream.point(point2[0],point2[1]),stream.lineEnd()),point0=point2;else if(notHemisphere&&point0&&smallRadius^v){var t;c&c0||!(t=intersect(point1,point0,!0))||(clean=0,smallRadius?(stream.lineStart(),stream.point(t[0][0],t[0][1]),stream.point(t[1][0],t[1][1]),stream.lineEnd()):(stream.point(t[1][0],t[1][1]),stream.lineEnd(),stream.lineStart(),stream.point(t[0][0],t[0][1])))}!v||point0&&pointEqual(point0,point1)||stream.point(point1[0],point1[1]),point0=point1,v0=v,c0=c},lineEnd:function(){v0&&stream.lineEnd(),point0=null},clean:function(){return clean|(v00&&v0)<<1}}}function intersect(a,b,two){var pa=cartesian(a),pb=cartesian(b),n1=[1,0,0],n2=cartesianCross(pa,pb),n2n2=cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=cartesianCross(n1,n2),A=cartesianScale(n1,c1);cartesianAddInPlace(A,cartesianScale(n2,c2));var u=n1xn2,w=cartesianDot(A,u),uu=cartesianDot(u,u),t2=w*w-uu*(cartesianDot(A,A)-1);if(!(t2<0)){var t=sqrt(t2),q=cartesianScale(u,(-w-t)/uu);if(cartesianAddInPlace(q,A),q=spherical(q),!two)return q;var z,lambda0=a[0],lambda1=b[0],phi0=a[1],phi1=b[1];lambda1<lambda0&&(z=lambda0,lambda0=lambda1,lambda1=z);var delta=lambda1-lambda0,polar=abs(delta-pi$3)<epsilon$2,meridian=polar||delta<epsilon$2;if(!polar&&phi1<phi0&&(z=phi0,phi0=phi1,phi1=z),meridian?polar?phi0+phi1>0^q[1]<(abs(q[0]-lambda0)<epsilon$2?phi0:phi1):phi0<=q[1]&&q[1]<=phi1:delta>pi$3^(lambda0<=q[0]&&q[0]<=lambda1)){var q1=cartesianScale(u,(-w+t)/uu);return cartesianAddInPlace(q1,A),[q,spherical(q1)]}}}function code(lambda,phi){var r=smallRadius?radius:pi$3-radius,code=0;return lambda<-r?code|=1:lambda>r&&(code|=2),phi<-r?code|=4:phi>r&&(code|=8),code}var cr=cos$1(radius),smallRadius=cr>0,notHemisphere=abs(cr)>epsilon$2;return clip(visible,clipLine,interpolate,smallRadius?[0,-radius]:[-pi$3,radius-pi$3])},transform=function(methods){return{stream:transformer(methods)}};TransformStream.prototype={constructor:TransformStream,point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var maxDepth=16,cosMinDistance=cos$1(30*radians),resample=function(project,delta2){return+delta2?resample$1(project,delta2):resampleNone(project)},transformRadians=transformer({point:function(x,y){this.stream.point(x*radians,y*radians)}}),conicEqualArea=function(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])},albers=function(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},albersUsa=function(){function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];return point=null,lower48Point.point(x,y),point||(alaskaPoint.point(x,y),point)||(hawaiiPoint.point(x,y),point)}function reset(){return cache=cacheStream=null,albersUsa}var cache,cacheStream,lower48Point,alaskaPoint,hawaiiPoint,point,lower48=albers(),alaska=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),hawaii=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),pointStream={point:function(x,y){point=[x,y]}};return albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?alaska:y>=.166&&y<.234&&x>=-.214&&x<-.115?hawaii:lower48).invert(coordinates)},albersUsa.stream=function(stream){return cache&&cacheStream===stream?cache:cache=multiplex([lower48.stream(cacheStream=stream),alaska.stream(stream),hawaii.stream(stream)])},albersUsa.precision=function(_){return arguments.length?(lower48.precision(_),alaska.precision(_),hawaii.precision(_),reset()):lower48.precision()},albersUsa.scale=function(_){return arguments.length?(lower48.scale(_),alaska.scale(.35*_),hawaii.scale(_),albersUsa.translate(lower48.translate())):lower48.scale()},albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];return lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream),alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+epsilon$2,y+.12*k+epsilon$2],[x-.214*k-epsilon$2,y+.234*k-epsilon$2]]).stream(pointStream),hawaiiPoint=hawaii.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+epsilon$2,y+.166*k+epsilon$2],[x-.115*k-epsilon$2,y+.234*k-epsilon$2]]).stream(pointStream),reset()},albersUsa.fitExtent=function(extent,object){return fitExtent(albersUsa,extent,object)},albersUsa.fitSize=function(size,object){return fitSize(albersUsa,size,object)},albersUsa.scale(1070)},azimuthalEqualAreaRaw=azimuthalRaw(function(cxcy){return sqrt(2/(1+cxcy))})
;azimuthalEqualAreaRaw.invert=azimuthalInvert(function(z){return 2*asin(z/2)});var azimuthalEqualArea=function(){return projection(azimuthalEqualAreaRaw).scale(124.75).clipAngle(179.999)},azimuthalEquidistantRaw=azimuthalRaw(function(c){return(c=acos(c))&&c/sin$1(c)});azimuthalEquidistantRaw.invert=azimuthalInvert(function(z){return z});var azimuthalEquidistant=function(){return projection(azimuthalEquidistantRaw).scale(79.4188).clipAngle(179.999)};mercatorRaw.invert=function(x,y){return[x,2*atan(exp(y))-halfPi$2]};var mercator=function(){return mercatorProjection(mercatorRaw).scale(961/tau$3)},conicConformal=function(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])};equirectangularRaw.invert=equirectangularRaw;var equirectangular=function(){return projection(equirectangularRaw).scale(152.63)},conicEquidistant=function(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])};gnomonicRaw.invert=azimuthalInvert(atan);var gnomonic=function(){return projection(gnomonicRaw).scale(144.049).clipAngle(60)},identity$5=function(){function reset(){return cache=cacheStream=null,projection}var y0,x1,y1,cache,cacheStream,projection,k=1,tx=0,ty=0,sx=1,sy=1,transform=identity$4,x0=null,clip=identity$4;return projection={stream:function(stream){return cache&&cacheStream===stream?cache:cache=transform(clip(cacheStream=stream))},clipExtent:function(_){return arguments.length?(clip=null==_?(x0=y0=x1=y1=null,identity$4):clipExtent(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reset()):null==x0?null:[[x0,y0],[x1,y1]]},scale:function(_){return arguments.length?(transform=scaleTranslate((k=+_)*sx,k*sy,tx,ty),reset()):k},translate:function(_){return arguments.length?(transform=scaleTranslate(k*sx,k*sy,tx=+_[0],ty=+_[1]),reset()):[tx,ty]},reflectX:function(_){return arguments.length?(transform=scaleTranslate(k*(sx=_?-1:1),k*sy,tx,ty),reset()):sx<0},reflectY:function(_){return arguments.length?(transform=scaleTranslate(k*sx,k*(sy=_?-1:1),tx,ty),reset()):sy<0},fitExtent:function(extent,object){return fitExtent(projection,extent,object)},fitSize:function(size,object){return fitSize(projection,size,object)}}};orthographicRaw.invert=azimuthalInvert(asin);var orthographic=function(){return projection(orthographicRaw).scale(249.5).clipAngle(90+epsilon$2)};stereographicRaw.invert=azimuthalInvert(function(z){return 2*atan(z)});var stereographic=function(){return projection(stereographicRaw).scale(250).clipAngle(142)};transverseMercatorRaw.invert=function(x,y){return[-y,2*atan(exp(x))-halfPi$2]};var transverseMercator=function(){var m=mercatorProjection(transverseMercatorRaw),center=m.center,rotate=m.rotate;return m.center=function(_){return arguments.length?center([-_[1],_[0]]):(_=center(),[_[1],-_[0]])},m.rotate=function(_){return arguments.length?rotate([_[0],_[1],_.length>2?_[2]+90:90]):(_=rotate(),[_[0],_[1],_[2]-90])},rotate([0,0,90]).scale(159.155)},cluster=function(){function cluster(root){var previousNode,x=0;root.eachAfter(function(node){var children=node.children;children?(node.x=meanX(children),node.y=maxY(children)):(node.x=previousNode?x+=separation(node,previousNode):0,node.y=0,previousNode=node)});var left=leafLeft(root),right=leafRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;return root.eachAfter(nodeSize?function(node){node.x=(node.x-root.x)*dx,node.y=(root.y-node.y)*dy}:function(node){node.x=(node.x-x0)/(x1-x0)*dx,node.y=(1-(root.y?node.y/root.y:1))*dy})}var separation=defaultSeparation,dx=1,dy=1,nodeSize=!1;return cluster.separation=function(x){return arguments.length?(separation=x,cluster):separation},cluster.size=function(x){return arguments.length?(nodeSize=!1,dx=+x[0],dy=+x[1],cluster):nodeSize?null:[dx,dy]},cluster.nodeSize=function(x){return arguments.length?(nodeSize=!0,dx=+x[0],dy=+x[1],cluster):nodeSize?[dx,dy]:null},cluster},node_count=function(){return this.eachAfter(count)},node_each=function(callback){var current,children,i,n,node=this,next=[node];do{for(current=next.reverse(),next=[];node=current.pop();)if(callback(node),children=node.children)for(i=0,n=children.length;i<n;++i)next.push(children[i])}while(next.length);return this},node_eachBefore=function(callback){for(var children,i,node=this,nodes=[node];node=nodes.pop();)if(callback(node),children=node.children)for(i=children.length-1;i>=0;--i)nodes.push(children[i]);return this},node_eachAfter=function(callback){for(var children,i,n,node=this,nodes=[node],next=[];node=nodes.pop();)if(next.push(node),children=node.children)for(i=0,n=children.length;i<n;++i)nodes.push(children[i]);for(;node=next.pop();)callback(node);return this},node_sum=function(value){return this.eachAfter(function(node){for(var sum=+value(node.data)||0,children=node.children,i=children&&children.length;--i>=0;)sum+=children[i].value;node.value=sum})},node_sort=function(compare){return this.eachBefore(function(node){node.children&&node.children.sort(compare)})},node_path=function(end){for(var start=this,ancestor=leastCommonAncestor(start,end),nodes=[start];start!==ancestor;)start=start.parent,nodes.push(start);for(var k=nodes.length;end!==ancestor;)nodes.splice(k,0,end),end=end.parent;return nodes},node_ancestors=function(){for(var node=this,nodes=[node];node=node.parent;)nodes.push(node);return nodes},node_descendants=function(){var nodes=[];return this.each(function(node){nodes.push(node)}),nodes},node_leaves=function(){var leaves=[];return this.eachBefore(function(node){node.children||leaves.push(node)}),leaves},node_links=function(){var root=this,links=[];return root.each(function(node){node!==root&&links.push({source:node.parent,target:node})}),links};Node.prototype=hierarchy.prototype={constructor:Node,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var shuffle$1=function(array){for(var n=(array=array.slice()).length,head=null,node=head;n;){var next=new Node$2(array[n-1]);node=node?node.next=next:head=next,array[void 0]=array[--n]}return{head:head,tail:node}},enclose=function(circles){return encloseN(shuffle$1(circles),[])},siblings=function(circles){return packEnclose(circles),circles},constant$8=function(x){return function(){return x}},index$2=function(){function pack(root){return root.x=dx/2,root.y=dy/2,radius?root.eachBefore(radiusLeaf(radius)).eachAfter(packChildren(padding,.5)).eachBefore(translateChild(1)):root.eachBefore(radiusLeaf(defaultRadius$1)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(padding,root.r/Math.min(dx,dy))).eachBefore(translateChild(Math.min(dx,dy)/(2*root.r))),root}var radius=null,dx=1,dy=1,padding=constantZero;return pack.radius=function(x){return arguments.length?(radius=optional(x),pack):radius},pack.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],pack):[dx,dy]},pack.padding=function(x){return arguments.length?(padding="function"==typeof x?x:constant$8(+x),pack):padding},pack},roundNode=function(node){node.x0=Math.round(node.x0),node.y0=Math.round(node.y0),node.x1=Math.round(node.x1),node.y1=Math.round(node.y1)},treemapDice=function(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(x1-x0)/parent.value;++i<n;)node=nodes[i],node.y0=y0,node.y1=y1,node.x0=x0,node.x1=x0+=node.value*k},partition=function(){function partition(root){var n=root.height+1;return root.x0=root.y0=padding,root.x1=dx,root.y1=dy/n,root.eachBefore(positionNode(dy,n)),round&&root.eachBefore(roundNode),root}function positionNode(dy,n){return function(node){node.children&&treemapDice(node,node.x0,dy*(node.depth+1)/n,node.x1,dy*(node.depth+2)/n);var x0=node.x0,y0=node.y0,x1=node.x1-padding,y1=node.y1-padding;x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1}}var dx=1,dy=1,padding=0,round=!1;return partition.round=function(x){return arguments.length?(round=!!x,partition):round},partition.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],partition):[dx,dy]},partition.padding=function(x){return arguments.length?(padding=+x,partition):padding},partition},keyPrefix$1="$",preroot={depth:-1},ambiguous={},stratify=function(){function stratify(data){var d,i,root,parent,node,nodeId,nodeKey,n=data.length,nodes=new Array(n),nodeByKey={};for(i=0;i<n;++i)d=data[i],node=nodes[i]=new Node(d),null!=(nodeId=id(d,i,data))&&(nodeId+="")&&(nodeKey=keyPrefix$1+(node.id=nodeId),nodeByKey[nodeKey]=nodeKey in nodeByKey?ambiguous:node);for(i=0;i<n;++i)if(node=nodes[i],null!=(nodeId=parentId(data[i],i,data))&&(nodeId+="")){if(!(parent=nodeByKey[keyPrefix$1+nodeId]))throw new Error("missing: "+nodeId);if(parent===ambiguous)throw new Error("ambiguous: "+nodeId);parent.children?parent.children.push(node):parent.children=[node],node.parent=parent}else{if(root)throw new Error("multiple roots");root=node}if(!root)throw new Error("no root");if(root.parent=preroot,root.eachBefore(function(node){node.depth=node.parent.depth+1,--n}).eachBefore(computeHeight),root.parent=null,n>0)throw new Error("cycle");return root}var id=defaultId,parentId=defaultParentId;return stratify.id=function(x){return arguments.length?(id=required(x),stratify):id},stratify.parentId=function(x){return arguments.length?(parentId=required(x),stratify):parentId},stratify};TreeNode.prototype=Object.create(Node.prototype);var tree=function(){function tree(root){var t=treeRoot(root);if(t.eachAfter(firstWalk),t.parent.m=-t.z,t.eachBefore(secondWalk),nodeSize)root.eachBefore(sizeNode);else{var left=root,right=root,bottom=root;root.eachBefore(function(node){node.x<left.x&&(left=node),node.x>right.x&&(right=node),node.depth>bottom.depth&&(bottom=node)});var s=left===right?1:separation(left,right)/2,tx=s-left.x,kx=dx/(right.x+s+tx),ky=dy/(bottom.depth||1);root.eachBefore(function(node){node.x=(node.x+tx)*kx,node.y=node.depth*ky})}return root}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-1]:null;if(children){executeShifts(v);var midpoint=(children[0].z+children[children.length-1].z)/2;w?(v.z=w.z+separation(v._,w._),v.m=v.z-midpoint):v.z=midpoint}else w&&(v.z=w.z+separation(v._,w._));v.parent.A=apportion(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m,v.m+=v.parent.m}function apportion(v,w,ancestor){if(w){for(var shift,vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m;vim=nextRight(vim),vip=nextLeft(vip),vim&&vip;)vom=nextLeft(vom),vop=nextRight(vop),vop.a=v,shift=vim.z+sim-vip.z-sip+separation(vim._,vip._),shift>0&&(moveSubtree(nextAncestor(vim,v,ancestor),v,shift),sip+=shift,sop+=shift),sim+=vim.m,sip+=vip.m,som+=vom.m,sop+=vop.m;vim&&!nextRight(vop)&&(vop.t=vim,vop.m+=sim-sop),vip&&!nextLeft(vom)&&(vom.t=vip,vom.m+=sip-som,ancestor=v)}return ancestor}function sizeNode(node){node.x*=dx,node.y=node.depth*dy}var separation=defaultSeparation$1,dx=1,dy=1,nodeSize=null;return tree.separation=function(x){return arguments.length?(separation=x,tree):separation},tree.size=function(x){return arguments.length?(nodeSize=!1,dx=+x[0],dy=+x[1],tree):nodeSize?null:[dx,dy]},tree.nodeSize=function(x){return arguments.length?(nodeSize=!0,dx=+x[0],dy=+x[1],tree):nodeSize?[dx,dy]:null},tree},treemapSlice=function(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(y1-y0)/parent.value;++i<n;)node=nodes[i],node.x0=x0,node.x1=x1,node.y0=y0,node.y1=y0+=node.value*k},phi=(1+Math.sqrt(5))/2,squarify=function custom(ratio){function squarify(parent,x0,y0,x1,y1){squarifyRatio(ratio,parent,x0,y0,x1,y1)}return squarify.ratio=function(x){return custom((x=+x)>1?x:1)},squarify}(phi),index$3=function(){function treemap(root){return root.x0=root.y0=0,root.x1=dx,root.y1=dy,root.eachBefore(positionNode),paddingStack=[0],round&&root.eachBefore(roundNode),root}function positionNode(node){var p=paddingStack[node.depth],x0=node.x0+p,y0=node.y0+p,x1=node.x1-p,y1=node.y1-p;x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1,node.children&&(p=paddingStack[node.depth+1]=paddingInner(node)/2,x0+=paddingLeft(node)-p,y0+=paddingTop(node)-p,x1-=paddingRight(node)-p,y1-=paddingBottom(node)-p,x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),tile(node,x0,y0,x1,y1))}var tile=squarify,round=!1,dx=1,dy=1,paddingStack=[0],paddingInner=constantZero,paddingTop=constantZero,paddingRight=constantZero,paddingBottom=constantZero,paddingLeft=constantZero;return treemap.round=function(x){return arguments.length?(round=!!x,treemap):round},treemap.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],treemap):[dx,dy]},treemap.tile=function(x){return arguments.length?(tile=required(x),treemap):tile},treemap.padding=function(x){return arguments.length?treemap.paddingInner(x).paddingOuter(x):treemap.paddingInner()},treemap.paddingInner=function(x){return arguments.length?(paddingInner="function"==typeof x?x:constant$8(+x),treemap):paddingInner},treemap.paddingOuter=function(x){return arguments.length?treemap.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x):treemap.paddingTop()},treemap.paddingTop=function(x){return arguments.length?(paddingTop="function"==typeof x?x:constant$8(+x),treemap):paddingTop},treemap.paddingRight=function(x){return arguments.length?(paddingRight="function"==typeof x?x:constant$8(+x),treemap):paddingRight},treemap.paddingBottom=function(x){return arguments.length?(paddingBottom="function"==typeof x?x:constant$8(+x),treemap):paddingBottom},treemap.paddingLeft=function(x){return arguments.length?(paddingLeft="function"==typeof x?x:constant$8(+x),treemap):paddingLeft},treemap},binary=function(parent,x0,y0,x1,y1){function partition(i,j,value,x0,y0,x1,y1){if(i>=j-1){var node=nodes[i];return node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1,void 0}for(var valueOffset=sums[i],valueTarget=value/2+valueOffset,k=i+1,hi=j-1;k<hi;){var mid=k+hi>>>1;sums[mid]<valueTarget?k=mid+1:hi=mid}var valueLeft=sums[k]-valueOffset,valueRight=value-valueLeft;if(y1-y0>x1-x0){var yk=(y0*valueRight+y1*valueLeft)/value;partition(i,k,valueLeft,x0,y0,x1,yk),partition(k,j,valueRight,x0,yk,x1,y1)}else{var xk=(x0*valueRight+x1*valueLeft)/value;partition(i,k,valueLeft,x0,y0,xk,y1),partition(k,j,valueRight,xk,y0,x1,y1)}}var i,sum,nodes=parent.children,n=nodes.length,sums=new Array(n+1);for(sums[0]=sum=i=0;i<n;++i)sums[i+1]=sum+=nodes[i].value;partition(0,n,parent.value,x0,y0,x1,y1)},sliceDice=function(parent,x0,y0,x1,y1){(1&parent.depth?treemapSlice:treemapDice)(parent,x0,y0,x1,y1)},resquarify=function custom(ratio){function resquarify(parent,x0,y0,x1,y1){if((rows=parent._squarify)&&rows.ratio===ratio)for(var rows,row,nodes,i,n,j=-1,m=rows.length,value=parent.value;++j<m;){for(row=rows[j],nodes=row.children,i=row.value=0,n=nodes.length;i<n;++i)row.value+=nodes[i].value;row.dice?treemapDice(row,x0,y0,x1,y0+=(y1-y0)*row.value/value):treemapSlice(row,x0,y0,x0+=(x1-x0)*row.value/value,y1),value-=row.value}else parent._squarify=rows=squarifyRatio(ratio,parent,x0,y0,x1,y1),rows.ratio=ratio}return resquarify.ratio=function(x){return custom((x=+x)>1?x:1)},resquarify}(phi),area$1=function(polygon){for(var a,i=-1,n=polygon.length,b=polygon[n-1],area=0;++i<n;)a=b,b=polygon[i],area+=a[1]*b[0]-a[0]*b[1];return area/2},centroid$1=function(polygon){for(var a,c,i=-1,n=polygon.length,x=0,y=0,b=polygon[n-1],k=0;++i<n;)a=b,b=polygon[i],k+=c=a[0]*b[1]-b[0]*a[1],x+=(a[0]+b[0])*c,y+=(a[1]+b[1])*c;return k*=3,[x/k,y/k]},cross=function(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])},hull=function(points){if((n=points.length)<3)return null;var i,n,sortedPoints=new Array(n),flippedPoints=new Array(n);for(i=0;i<n;++i)sortedPoints[i]=[+points[i][0],+points[i][1],i];for(sortedPoints.sort(lexicographicOrder),i=0;i<n;++i)flippedPoints[i]=[sortedPoints[i][0],-sortedPoints[i][1]];var upperIndexes=computeUpperHullIndexes(sortedPoints),lowerIndexes=computeUpperHullIndexes(flippedPoints),skipLeft=lowerIndexes[0]===upperIndexes[0],skipRight=lowerIndexes[lowerIndexes.length-1]===upperIndexes[upperIndexes.length-1],hull=[];for(i=upperIndexes.length-1;i>=0;--i)hull.push(points[sortedPoints[upperIndexes[i]][2]]);for(i=+skipLeft;i<lowerIndexes.length-skipRight;++i)hull.push(points[sortedPoints[lowerIndexes[i]][2]]);return hull},contains=function(polygon,point){for(var x1,y1,n=polygon.length,p=polygon[n-1],x=point[0],y=point[1],x0=p[0],y0=p[1],inside=!1,i=0;i<n;++i)p=polygon[i],x1=p[0],y1=p[1],y1>y!=y0>y&&x<(x0-x1)*(y-y1)/(y0-y1)+x1&&(inside=!inside),x0=x1,y0=y1;return inside},length$2=function(polygon){for(var xa,ya,i=-1,n=polygon.length,b=polygon[n-1],xb=b[0],yb=b[1],perimeter=0;++i<n;)xa=xb,ya=yb,b=polygon[i],xb=b[0],yb=b[1],xa-=xb,ya-=yb,perimeter+=Math.sqrt(xa*xa+ya*ya);return perimeter},slice$3=[].slice,noabort={};Queue.prototype=queue.prototype={constructor:Queue,defer:function(callback){if("function"!=typeof callback||this._call)throw new Error;if(null!=this._error)return this;var t=slice$3.call(arguments,1);return t.push(callback),++this._waiting,this._tasks.push(t),poke$1(this),this},abort:function(){return null==this._error&&abort(this,new Error("abort")),this},await:function(callback){if("function"!=typeof callback||this._call)throw new Error;return this._call=function(error,results){callback.apply(null,[error].concat(results))},maybeNotify(this),this},awaitAll:function(callback){if("function"!=typeof callback||this._call)throw new Error;return this._call=callback,maybeNotify(this),this}};var uniform=function(min,max){return min=null==min?0:+min,max=null==max?1:+max,1===arguments.length?(max=min,min=0):max-=min,function(){return Math.random()*max+min}},normal=function(mu,sigma){var x,r;return mu=null==mu?0:+mu,sigma=null==sigma?1:+sigma,function(){var y;if(null!=x)y=x,x=null;else do{x=2*Math.random()-1,y=2*Math.random()-1,r=x*x+y*y}while(!r||r>1);return mu+sigma*y*Math.sqrt(-2*Math.log(r)/r)}},logNormal=function(){var randomNormal=normal.apply(this,arguments);return function(){return Math.exp(randomNormal())}},irwinHall=function(n){return function(){for(var sum=0,i=0;i<n;++i)sum+=Math.random();return sum}},bates=function(n){var randomIrwinHall=irwinHall(n);return function(){return randomIrwinHall()/n}},exponential$1=function(lambda){return function(){return-Math.log(1-Math.random())/lambda}},request=function(url,callback){function respond(o){var result,status=xhr.status;if(!status&&hasResponse(xhr)||status>=200&&status<300||304===status){if(response)try{result=response.call(request,xhr)}catch(e){return void event.call("error",request,e)}else result=xhr;event.call("load",request,result)}else event.call("error",request,o)}var request,mimeType,response,responseType,event=dispatch("beforesend","progress","load","error"),headers=map$1(),xhr=new XMLHttpRequest,user=null,password=null,timeout=0;if("undefined"==typeof XDomainRequest||"withCredentials"in xhr||!/^(http(s)?:)?\/\//.test(url)||(xhr=new XDomainRequest),"onload"in xhr?xhr.onload=xhr.onerror=xhr.ontimeout=respond:xhr.onreadystatechange=function(o){xhr.readyState>3&&respond(o)},xhr.onprogress=function(e){event.call("progress",request,e)},request={header:function(name,value){return name=(name+"").toLowerCase(),arguments.length<2?headers.get(name):(null==value?headers.remove(name):headers.set(name,value+""),request)},mimeType:function(value){return arguments.length?(mimeType=null==value?null:value+"",request):mimeType},responseType:function(value){return arguments.length?(responseType=value,request):responseType},timeout:function(value){return arguments.length?(timeout=+value,request):timeout},user:function(value){return arguments.length<1?user:(user=null==value?null:value+"",request)},password:function(value){return arguments.length<1?password:(password=null==value?null:value+"",request)},response:function(value){return response=value,request},get:function(data,callback){return request.send("GET",data,callback)},post:function(data,callback){return request.send("POST",data,callback)},send:function(method,data,callback){return xhr.open(method,url,!0,user,password),null==mimeType||headers.has("accept")||headers.set("accept",mimeType+",*/*"),xhr.setRequestHeader&&headers.each(function(value,name){xhr.setRequestHeader(name,value)}),null!=mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(mimeType),null!=responseType&&(xhr.responseType=responseType),timeout>0&&(xhr.timeout=timeout),null==callback&&"function"==typeof data&&(callback=data,data=null),null!=callback&&1===callback.length&&(callback=fixCallback(callback)),null!=callback&&request.on("error",callback).on("load",function(xhr){callback(null,xhr)}),event.call("beforesend",request,xhr),xhr.send(null==data?null:data),request},abort:function(){return xhr.abort(),request},on:function(){var value=event.on.apply(event,arguments);return value===event?request:value}},null!=callback){if("function"!=typeof callback)throw new Error("invalid callback: "+callback);return request.get(callback)}return request},type$1=function(defaultMimeType,response){return function(url,callback){var r=request(url).mimeType(defaultMimeType).response(response);if(null!=callback){if("function"!=typeof callback)throw new Error("invalid callback: "+callback);return r.get(callback)}return r}},html=type$1("text/html",function(xhr){return document.createRange().createContextualFragment(xhr.responseText)}),json=type$1("application/json",function(xhr){return JSON.parse(xhr.responseText)}),text=type$1("text/plain",function(xhr){return xhr.responseText}),xml=type$1("application/xml",function(xhr){var xml=xhr.responseXML;if(!xml)throw new Error("parse error");return xml}),dsv$1=function(defaultMimeType,parse){return function(url,row,callback){arguments.length<3&&(callback=row,row=null);var r=request(url).mimeType(defaultMimeType);return r.row=function(_){return arguments.length?r.response(responseOf(parse,row=_)):row},r.row(row),callback?r.get(callback):r}},csv$1=dsv$1("text/csv",csvParse),tsv$1=dsv$1("text/tab-separated-values",tsvParse),array$2=Array.prototype,map$3=array$2.map,slice$4=array$2.slice,implicit={name:"implicit"},constant$9=function(x){return function(){return x}},number$1=function(x){return+x},unit=[0,1],tickFormat=function(domain,count,specifier){var precision,start=domain[0],stop=domain[domain.length-1],step=tickStep(start,stop,null==count?10:count);switch(specifier=formatSpecifier(null==specifier?",f":specifier),specifier.type){case"s":var value=Math.max(Math.abs(start),Math.abs(stop));return null!=specifier.precision||isNaN(precision=precisionPrefix(step,value))||(specifier.precision=precision),exports.formatPrefix(specifier,value);case"":case"e":case"g":case"p":case"r":null!=specifier.precision||isNaN(precision=precisionRound(step,Math.max(Math.abs(start),Math.abs(stop))))||(specifier.precision=precision-("e"===specifier.type));break;case"f":case"%":null!=specifier.precision||isNaN(precision=precisionFixed(step))||(specifier.precision=precision-2*("%"===specifier.type))}return exports.format(specifier)},nice=function(domain,interval){domain=domain.slice();var t,i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1];return x1<x0&&(t=i0,i0=i1,i1=t,t=x0,x0=x1,x1=t),domain[i0]=interval.floor(x0),domain[i1]=interval.ceil(x1),domain},t0$1=new Date,t1$1=new Date,millisecond=newInterval(function(){},function(date,step){date.setTime(+date+step)},function(start,end){return end-start});millisecond.every=function(k){return k=Math.floor(k),isFinite(k)&&k>0?k>1?newInterval(function(date){date.setTime(Math.floor(date/k)*k)},function(date,step){date.setTime(+date+step*k)},function(start,end){return(end-start)/k}):millisecond:null};var milliseconds=millisecond.range,durationMinute$1=6e4,durationWeek$1=6048e5,second=newInterval(function(date){date.setTime(1e3*Math.floor(date/1e3))},function(date,step){date.setTime(+date+1e3*step)},function(start,end){return(end-start)/1e3},function(date){return date.getUTCSeconds()}),seconds=second.range,minute=newInterval(function(date){date.setTime(Math.floor(date/durationMinute$1)*durationMinute$1)},function(date,step){date.setTime(+date+step*durationMinute$1)},function(start,end){return(end-start)/durationMinute$1},function(date){return date.getMinutes()}),minutes=minute.range,hour=newInterval(function(date){var offset=date.getTimezoneOffset()*durationMinute$1%36e5;offset<0&&(offset+=36e5),date.setTime(36e5*Math.floor((+date-offset)/36e5)+offset)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getHours()}),hours=hour.range,day=newInterval(function(date){date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute$1)/864e5},function(date){return date.getDate()-1}),days=day.range,sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),sundays=sunday.range,mondays=monday.range,tuesdays=tuesday.range,wednesdays=wednesday.range,thursdays=thursday.range,fridays=friday.range,saturdays=saturday.range,month=newInterval(function(date){date.setDate(1),date.setHours(0,0,0,0)},function(date,step){date.setMonth(date.getMonth()+step)},function(start,end){return end.getMonth()-start.getMonth()+12*(end.getFullYear()-start.getFullYear())},function(date){return date.getMonth()}),months=month.range,year=newInterval(function(date){date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step)},function(start,end){return end.getFullYear()-start.getFullYear()},function(date){return date.getFullYear()});year.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setFullYear(Math.floor(date.getFullYear()/k)*k),date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step*k)}):null};var years=year.range,utcMinute=newInterval(function(date){date.setUTCSeconds(0,0)},function(date,step){date.setTime(+date+step*durationMinute$1)},function(start,end){return(end-start)/durationMinute$1},function(date){return date.getUTCMinutes()}),utcMinutes=utcMinute.range,utcHour=newInterval(function(date){date.setUTCMinutes(0,0,0)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getUTCHours()}),utcHours=utcHour.range,utcDay=newInterval(function(date){date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+step)},function(start,end){return(end-start)/864e5},function(date){return date.getUTCDate()-1}),utcDays=utcDay.range,utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,utcMonth=newInterval(function(date){date.setUTCDate(1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCMonth(date.getUTCMonth()+step)},function(start,end){return end.getUTCMonth()-start.getUTCMonth()+12*(end.getUTCFullYear()-start.getUTCFullYear())},function(date){return date.getUTCMonth()}),utcMonths=utcMonth.range,utcYear=newInterval(function(date){date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step)},function(start,end){return end.getUTCFullYear()-start.getUTCFullYear()},function(date){return date.getUTCFullYear()});utcYear.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setUTCFullYear(Math.floor(date.getUTCFullYear()/k)*k),date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step*k)}):null};var locale$2,utcYears=utcYear.range,pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;defaultLocale$1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var formatIso=Date.prototype.toISOString?formatIsoNative:exports.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),parseIso=+new Date("2000-01-01T00:00:00.000Z")?parseIsoNative:exports.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),durationSecond=1e3,durationMinute=60*durationSecond,durationHour=60*durationMinute,durationDay=24*durationHour,durationWeek=7*durationDay,durationMonth=30*durationDay,durationYear=365*durationDay,time=function(){return calendar(year,month,sunday,day,hour,minute,second,millisecond,exports.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},utcTime=function(){return calendar(utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,millisecond,exports.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},colors=function(s){return s.match(/.{6}/g).map(function(x){return"#"+x})},category10=colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),category20b=colors("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),category20c=colors("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),category20=colors("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),cubehelix$3=cubehelixLong(cubehelix(300,.5,0),cubehelix(-240,.5,1)),warm=cubehelixLong(cubehelix(-100,.75,.35),cubehelix(80,1.5,.8)),cool=cubehelixLong(cubehelix(260,.75,.35),cubehelix(80,1.5,.8)),rainbow=cubehelix(),rainbow$1=function(t){(t<0||t>1)&&(t-=Math.floor(t));var ts=Math.abs(t-.5);return rainbow.h=360*t-100,rainbow.s=1.5-1.5*ts,rainbow.l=.8-.9*ts,rainbow+""
},viridis=ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),magma=ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),inferno=ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),plasma=ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),constant$10=function(x){return function(){return x}},epsilon$3=1e-12,pi$4=Math.PI,halfPi$3=pi$4/2,tau$4=2*pi$4,arc=function(){function arc(){var buffer,r,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-halfPi$3,a1=endAngle.apply(this,arguments)-halfPi$3,da=Math.abs(a1-a0),cw=a1>a0;if(context||(context=buffer=path()),r1<r0&&(r=r1,r1=r0,r0=r),r1>epsilon$3)if(da>tau$4-epsilon$3)context.moveTo(r1*Math.cos(a0),r1*Math.sin(a0)),context.arc(0,0,r1,a0,a1,!cw),r0>epsilon$3&&(context.moveTo(r0*Math.cos(a1),r0*Math.sin(a1)),context.arc(0,0,r0,a1,a0,cw));else{var t0,t1,a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>epsilon$3&&(padRadius?+padRadius.apply(this,arguments):Math.sqrt(r0*r0+r1*r1)),rc=Math.min(Math.abs(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc;if(rp>epsilon$3){var p0=asin$1(rp/r0*Math.sin(ap)),p1=asin$1(rp/r1*Math.sin(ap));(da0-=2*p0)>epsilon$3?(p0*=cw?1:-1,a00+=p0,a10-=p0):(da0=0,a00=a10=(a0+a1)/2),(da1-=2*p1)>epsilon$3?(p1*=cw?1:-1,a01+=p1,a11-=p1):(da1=0,a01=a11=(a0+a1)/2)}var x01=r1*Math.cos(a01),y01=r1*Math.sin(a01),x10=r0*Math.cos(a10),y10=r0*Math.sin(a10);if(rc>epsilon$3){var x11=r1*Math.cos(a11),y11=r1*Math.sin(a11),x00=r0*Math.cos(a00),y00=r0*Math.sin(a00);if(da<pi$4){var oc=da0>epsilon$3?intersect(x01,y01,x00,y00,x11,y11,x10,y10):[x10,y10],ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/Math.sin(Math.acos((ax*bx+ay*by)/(Math.sqrt(ax*ax+ay*ay)*Math.sqrt(bx*bx+by*by)))/2),lc=Math.sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=Math.min(rc,(r0-lc)/(kc-1)),rc1=Math.min(rc,(r1-lc)/(kc+1))}}da1>epsilon$3?rc1>epsilon$3?(t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw),t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw),context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01),rc1<rc?context.arc(t0.cx,t0.cy,rc1,Math.atan2(t0.y01,t0.x01),Math.atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc1,Math.atan2(t0.y01,t0.x01),Math.atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r1,Math.atan2(t0.cy+t0.y11,t0.cx+t0.x11),Math.atan2(t1.cy+t1.y11,t1.cx+t1.x11),!cw),context.arc(t1.cx,t1.cy,rc1,Math.atan2(t1.y11,t1.x11),Math.atan2(t1.y01,t1.x01),!cw))):(context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw)):context.moveTo(x01,y01),r0>epsilon$3&&da0>epsilon$3?rc0>epsilon$3?(t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw),t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw),context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01),rc0<rc?context.arc(t0.cx,t0.cy,rc0,Math.atan2(t0.y01,t0.x01),Math.atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc0,Math.atan2(t0.y01,t0.x01),Math.atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r0,Math.atan2(t0.cy+t0.y11,t0.cx+t0.x11),Math.atan2(t1.cy+t1.y11,t1.cx+t1.x11),cw),context.arc(t1.cx,t1.cy,rc0,Math.atan2(t1.y11,t1.x11),Math.atan2(t1.y01,t1.x01),!cw))):context.arc(0,0,r0,a10,a00,cw):context.lineTo(x10,y10)}else context.moveTo(0,0);if(context.closePath(),buffer)return context=null,buffer+""||null}var innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=constant$10(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null;return arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-pi$4/2;return[Math.cos(a)*r,Math.sin(a)*r]},arc.innerRadius=function(_){return arguments.length?(innerRadius="function"==typeof _?_:constant$10(+_),arc):innerRadius},arc.outerRadius=function(_){return arguments.length?(outerRadius="function"==typeof _?_:constant$10(+_),arc):outerRadius},arc.cornerRadius=function(_){return arguments.length?(cornerRadius="function"==typeof _?_:constant$10(+_),arc):cornerRadius},arc.padRadius=function(_){return arguments.length?(padRadius=null==_?null:"function"==typeof _?_:constant$10(+_),arc):padRadius},arc.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant$10(+_),arc):startAngle},arc.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant$10(+_),arc):endAngle},arc.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:constant$10(+_),arc):padAngle},arc.context=function(_){return arguments.length?(context=null==_?null:_,arc):context},arc};Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y)}}};var curveLinear=function(context){return new Linear(context)},line=function(){function line(data){var i,d,buffer,n=data.length,defined0=!1;for(null==context&&(output=curve(buffer=path())),i=0;i<=n;++i)!(i<n&&defined(d=data[i],i,data))===defined0&&((defined0=!defined0)?output.lineStart():output.lineEnd()),defined0&&output.point(+x$$1(d,i,data),+y$$1(d,i,data));if(buffer)return output=null,buffer+""||null}var x$$1=x$3,y$$1=y$3,defined=constant$10(!0),context=null,curve=curveLinear,output=null;return line.x=function(_){return arguments.length?(x$$1="function"==typeof _?_:constant$10(+_),line):x$$1},line.y=function(_){return arguments.length?(y$$1="function"==typeof _?_:constant$10(+_),line):y$$1},line.defined=function(_){return arguments.length?(defined="function"==typeof _?_:constant$10(!!_),line):defined},line.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),line):curve},line.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),line):context},line},area$2=function(){function area(data){var i,j,k,d,buffer,n=data.length,defined0=!1,x0z=new Array(n),y0z=new Array(n);for(null==context&&(output=curve(buffer=path())),i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0)if(defined0=!defined0)j=i,output.areaStart(),output.lineStart();else{for(output.lineEnd(),output.lineStart(),k=i-1;k>=j;--k)output.point(x0z[k],y0z[k]);output.lineEnd(),output.areaEnd()}defined0&&(x0z[i]=+x0(d,i,data),y0z[i]=+y0(d,i,data),output.point(x1?+x1(d,i,data):x0z[i],y1?+y1(d,i,data):y0z[i]))}if(buffer)return output=null,buffer+""||null}function arealine(){return line().defined(defined).curve(curve).context(context)}var x0=x$3,x1=null,y0=constant$10(0),y1=y$3,defined=constant$10(!0),context=null,curve=curveLinear,output=null;return area.x=function(_){return arguments.length?(x0="function"==typeof _?_:constant$10(+_),x1=null,area):x0},area.x0=function(_){return arguments.length?(x0="function"==typeof _?_:constant$10(+_),area):x0},area.x1=function(_){return arguments.length?(x1=null==_?null:"function"==typeof _?_:constant$10(+_),area):x1},area.y=function(_){return arguments.length?(y0="function"==typeof _?_:constant$10(+_),y1=null,area):y0},area.y0=function(_){return arguments.length?(y0="function"==typeof _?_:constant$10(+_),area):y0},area.y1=function(_){return arguments.length?(y1=null==_?null:"function"==typeof _?_:constant$10(+_),area):y1},area.lineX0=area.lineY0=function(){return arealine().x(x0).y(y0)},area.lineY1=function(){return arealine().x(x0).y(y1)},area.lineX1=function(){return arealine().x(x1).y(y0)},area.defined=function(_){return arguments.length?(defined="function"==typeof _?_:constant$10(!!_),area):defined},area.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),area):curve},area.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),area):context},area},descending$1=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},identity$7=function(d){return d},pie=function(){function pie(data){var i,j,k,a1,v,n=data.length,sum=0,index=new Array(n),arcs=new Array(n),a0=+startAngle.apply(this,arguments),da=Math.min(tau$4,Math.max(-tau$4,endAngle.apply(this,arguments)-a0)),p=Math.min(Math.abs(da)/n,padAngle.apply(this,arguments)),pa=p*(da<0?-1:1);for(i=0;i<n;++i)(v=arcs[index[i]=i]=+value(data[i],i,data))>0&&(sum+=v);for(null!=sortValues?index.sort(function(i,j){return sortValues(arcs[i],arcs[j])}):null!=sort&&index.sort(function(i,j){return sort(data[i],data[j])}),i=0,k=sum?(da-n*pa)/sum:0;i<n;++i,a0=a1)j=index[i],v=arcs[j],a1=a0+(v>0?v*k:0)+pa,arcs[j]={data:data[j],index:i,value:v,startAngle:a0,endAngle:a1,padAngle:p};return arcs}var value=identity$7,sortValues=descending$1,sort=null,startAngle=constant$10(0),endAngle=constant$10(tau$4),padAngle=constant$10(0);return pie.value=function(_){return arguments.length?(value="function"==typeof _?_:constant$10(+_),pie):value},pie.sortValues=function(_){return arguments.length?(sortValues=_,sort=null,pie):sortValues},pie.sort=function(_){return arguments.length?(sort=_,sortValues=null,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant$10(+_),pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant$10(+_),pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:constant$10(+_),pie):padAngle},pie},curveRadialLinear=curveRadial(curveLinear);Radial.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,r){this._curve.point(r*Math.sin(a),r*-Math.cos(a))}};var radialLine$1=function(){return radialLine(line().curve(curveRadialLinear))},radialArea=function(){var a=area$2().curve(curveRadialLinear),c=a.curve,x0=a.lineX0,x1=a.lineX1,y0=a.lineY0,y1=a.lineY1;return a.angle=a.x,delete a.x,a.startAngle=a.x0,delete a.x0,a.endAngle=a.x1,delete a.x1,a.radius=a.y,delete a.y,a.innerRadius=a.y0,delete a.y0,a.outerRadius=a.y1,delete a.y1,a.lineStartAngle=function(){return radialLine(x0())},delete a.lineX0,a.lineEndAngle=function(){return radialLine(x1())},delete a.lineX1,a.lineInnerRadius=function(){return radialLine(y0())},delete a.lineY0,a.lineOuterRadius=function(){return radialLine(y1())},delete a.lineY1,a.curve=function(_){return arguments.length?c(curveRadial(_)):c()._curve},a},circle$2={draw:function(context,size){var r=Math.sqrt(size/pi$4);context.moveTo(r,0),context.arc(0,0,r,0,tau$4)}},cross$1={draw:function(context,size){var r=Math.sqrt(size/5)/2;context.moveTo(-3*r,-r),context.lineTo(-r,-r),context.lineTo(-r,-3*r),context.lineTo(r,-3*r),context.lineTo(r,-r),context.lineTo(3*r,-r),context.lineTo(3*r,r),context.lineTo(r,r),context.lineTo(r,3*r),context.lineTo(-r,3*r),context.lineTo(-r,r),context.lineTo(-3*r,r),context.closePath()}},tan30=Math.sqrt(1/3),tan30_2=2*tan30,diamond={draw:function(context,size){var y=Math.sqrt(size/tan30_2),x=y*tan30;context.moveTo(0,-y),context.lineTo(x,0),context.lineTo(0,y),context.lineTo(-x,0),context.closePath()}},kr=Math.sin(pi$4/10)/Math.sin(7*pi$4/10),kx=Math.sin(tau$4/10)*kr,ky=-Math.cos(tau$4/10)*kr,star={draw:function(context,size){var r=Math.sqrt(.8908130915292852*size),x=kx*r,y=ky*r;context.moveTo(0,-r),context.lineTo(x,y);for(var i=1;i<5;++i){var a=tau$4*i/5,c=Math.cos(a),s=Math.sin(a);context.lineTo(s*r,-c*r),context.lineTo(c*x-s*y,s*x+c*y)}context.closePath()}},square={draw:function(context,size){var w=Math.sqrt(size),x=-w/2;context.rect(x,x,w,w)}},sqrt3=Math.sqrt(3),triangle={draw:function(context,size){var y=-Math.sqrt(size/(3*sqrt3));context.moveTo(0,2*y),context.lineTo(-sqrt3*y,-y),context.lineTo(sqrt3*y,-y),context.closePath()}},c=-.5,s=Math.sqrt(3)/2,k=1/Math.sqrt(12),a=3*(k/2+1),wye={draw:function(context,size){var r=Math.sqrt(size/a),x0=r/2,y0=r*k,x1=x0,y1=r*k+r,x2=-x1,y2=y1;context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2),context.lineTo(c*x0-s*y0,s*x0+c*y0),context.lineTo(c*x1-s*y1,s*x1+c*y1),context.lineTo(c*x2-s*y2,s*x2+c*y2),context.lineTo(c*x0+s*y0,c*y0-s*x0),context.lineTo(c*x1+s*y1,c*y1-s*x1),context.lineTo(c*x2+s*y2,c*y2-s*x2),context.closePath()}},symbols=[circle$2,cross$1,diamond,square,star,triangle,wye],symbol=function(){function symbol(){var buffer;if(context||(context=buffer=path()),type.apply(this,arguments).draw(context,+size.apply(this,arguments)),buffer)return context=null,buffer+""||null}var type=constant$10(circle$2),size=constant$10(64),context=null;return symbol.type=function(_){return arguments.length?(type="function"==typeof _?_:constant$10(_),symbol):type},symbol.size=function(_){return arguments.length?(size="function"==typeof _?_:constant$10(+_),symbol):size},symbol.context=function(_){return arguments.length?(context=null==_?null:_,symbol):context},symbol},noop$2=function(){};Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$2(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}};var basis$2=function(context){return new Basis(context)};BasisClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x2=x,this._y2=y;break;case 1:this._point=2,this._x3=x,this._y3=y;break;case 2:this._point=3,this._x4=x,this._y4=y,this._context.moveTo((this._x0+4*this._x1+x)/6,(this._y0+4*this._y1+y)/6);break;default:point$2(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}};var basisClosed$1=function(context){return new BasisClosed(context)};BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var x0=(this._x0+4*this._x1+x)/6,y0=(this._y0+4*this._y1+y)/6;this._line?this._context.lineTo(x0,y0):this._context.moveTo(x0,y0);break;case 3:this._point=4;default:point$2(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}};var basisOpen=function(context){return new BasisOpen(context)};Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var x=this._x,y=this._y,j=x.length-1;if(j>0)for(var t,x0=x[0],y0=y[0],dx=x[j]-x0,dy=y[j]-y0,i=-1;++i<=j;)t=i/j,this._basis.point(this._beta*x[i]+(1-this._beta)*(x0+t*dx),this._beta*y[i]+(1-this._beta)*(y0+t*dy));this._x=this._y=null,this._basis.lineEnd()},point:function(x,y){this._x.push(+x),this._y.push(+y)}};var bundle=function custom(beta){function bundle(context){return 1===beta?new Basis(context):new Bundle(context,beta)}return bundle.beta=function(beta){return custom(+beta)},bundle}(.85);Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$3(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2,this._x1=x,this._y1=y;break;case 2:this._point=3;default:point$3(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinal=function custom(tension){function cardinal(context){return new Cardinal(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);CardinalClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:point$3(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinalClosed=function custom(tension){function cardinal(context){return new CardinalClosed(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$3(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinalOpen=function custom(tension){function cardinal(context){return new CardinalOpen(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;default:point$4(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var catmullRom=function custom(alpha){function catmullRom(context){return alpha?new CatmullRom(context,alpha):new Cardinal(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);CatmullRomClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:point$4(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var catmullRomClosed=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomClosed(context,alpha):new CardinalClosed(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$4(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var catmullRomOpen=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomOpen(context,alpha):new CardinalOpen(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);LinearClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(x,y){x=+x,y=+y,this._point?this._context.lineTo(x,y):(this._point=1,this._context.moveTo(x,y))}};var linearClosed=function(context){return new LinearClosed(context)};MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$5(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){var t1=NaN;if(x=+x,y=+y,x!==this._x1||y!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,point$5(this,slope2(this,t1=slope3(this,x,y)),t1);break;default:point$5(this,this._t0,t1=slope3(this,x,y))}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y,this._t0=t1}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(x,y){MonotoneX.prototype.point.call(this,y,x)},ReflectContext.prototype={moveTo:function(x,y){this._context.moveTo(y,x)},closePath:function(){this._context.closePath()},lineTo:function(x,y){this._context.lineTo(y,x)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._context.bezierCurveTo(y1,x1,y2,x2,y,x)}},Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var x=this._x,y=this._y,n=x.length;if(n)if(this._line?this._context.lineTo(x[0],y[0]):this._context.moveTo(x[0],y[0]),2===n)this._context.lineTo(x[1],y[1]);else for(var px=controlPoints(x),py=controlPoints(y),i0=0,i1=1;i1<n;++i0,++i1)this._context.bezierCurveTo(px[0][i0],py[0][i0],px[1][i0],py[1][i0],x[i1],y[i1]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(x,y){this._x.push(+x),this._y.push(+y)}};var natural=function(context){return new Natural(context)};Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,y),this._context.lineTo(x,y);else{var x1=this._x*(1-this._t)+x*this._t;this._context.lineTo(x1,this._y),this._context.lineTo(x1,y)}}this._x=x,this._y=y}};var step=function(context){return new Step(context,.5)},slice$5=Array.prototype.slice,none$1=function(series,order){if((n=series.length)>1)for(var s0,n,i=1,s1=series[order[0]],m=s1.length;i<n;++i){s0=s1,s1=series[order[i]];for(var j=0;j<m;++j)s1[j][1]+=s1[j][0]=isNaN(s0[j][1])?s0[j][0]:s0[j][1]}},none$2=function(series){
for(var n=series.length,o=new Array(n);--n>=0;)o[n]=n;return o},stack=function(){function stack(data){var i,oz,kz=keys.apply(this,arguments),m=data.length,n=kz.length,sz=new Array(n);for(i=0;i<n;++i){for(var sij,ki=kz[i],si=sz[i]=new Array(m),j=0;j<m;++j)si[j]=sij=[0,+value(data[j],ki,j,data)],sij.data=data[j];si.key=ki}for(i=0,oz=order(sz);i<n;++i)sz[oz[i]].index=i;return offset(sz,oz),sz}var keys=constant$10([]),order=none$2,offset=none$1,value=stackValue;return stack.keys=function(_){return arguments.length?(keys="function"==typeof _?_:constant$10(slice$5.call(_)),stack):keys},stack.value=function(_){return arguments.length?(value="function"==typeof _?_:constant$10(+_),stack):value},stack.order=function(_){return arguments.length?(order=null==_?none$2:"function"==typeof _?_:constant$10(slice$5.call(_)),stack):order},stack.offset=function(_){return arguments.length?(offset=null==_?none$1:_,stack):offset},stack},expand=function(series,order){if((n=series.length)>0){for(var i,n,y,j=0,m=series[0].length;j<m;++j){for(y=i=0;i<n;++i)y+=series[i][j][1]||0;if(y)for(i=0;i<n;++i)series[i][j][1]/=y}none$1(series,order)}},silhouette=function(series,order){if((n=series.length)>0){for(var n,j=0,s0=series[order[0]],m=s0.length;j<m;++j){for(var i=0,y=0;i<n;++i)y+=series[i][j][1]||0;s0[j][1]+=s0[j][0]=-y/2}none$1(series,order)}},wiggle=function(series,order){if((n=series.length)>0&&(m=(s0=series[order[0]]).length)>0){for(var s0,m,n,y=0,j=1;j<m;++j){for(var i=0,s1=0,s2=0;i<n;++i){for(var si=series[order[i]],sij0=si[j][1]||0,sij1=si[j-1][1]||0,s3=(sij0-sij1)/2,k=0;k<i;++k){var sk=series[order[k]];s3+=(sk[j][1]||0)-(sk[j-1][1]||0)}s1+=sij0,s2+=s3*sij0}s0[j-1][1]+=s0[j-1][0]=y,s1&&(y-=s2/s1)}s0[j-1][1]+=s0[j-1][0]=y,none$1(series,order)}},ascending$2=function(series){var sums=series.map(sum$2);return none$2(series).sort(function(a,b){return sums[a]-sums[b]})},descending$2=function(series){return ascending$2(series).reverse()},insideOut=function(series){var i,j,n=series.length,sums=series.map(sum$2),order=none$2(series).sort(function(a,b){return sums[b]-sums[a]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i)j=order[i],top<bottom?(top+=sums[j],tops.push(j)):(bottom+=sums[j],bottoms.push(j));return bottoms.reverse().concat(tops)},reverse=function(series){return none$2(series).reverse()},constant$11=function(x){return function(){return x}};RedBlackTree.prototype={constructor:RedBlackTree,insert:function(after,node){var parent,grandpa,uncle;if(after){if(node.P=after,node.N=after.N,after.N&&(after.N.P=node),after.N=node,after.R){for(after=after.R;after.L;)after=after.L;after.L=node}else after.R=node;parent=after}else this._?(after=RedBlackFirst(this._),node.P=null,node.N=after,after.P=after.L=node,parent=after):(node.P=node.N=null,this._=node,parent=null);for(node.L=node.R=null,node.U=parent,node.C=!0,after=node;parent&&parent.C;)grandpa=parent.U,parent===grandpa.L?(uncle=grandpa.R,uncle&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.R&&(RedBlackRotateLeft(this,parent),after=parent,parent=after.U),parent.C=!1,grandpa.C=!0,RedBlackRotateRight(this,grandpa))):(uncle=grandpa.L,uncle&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.L&&(RedBlackRotateRight(this,parent),after=parent,parent=after.U),parent.C=!1,grandpa.C=!0,RedBlackRotateLeft(this,grandpa))),parent=after.U;this._.C=!1},remove:function(node){node.N&&(node.N.P=node.P),node.P&&(node.P.N=node.N),node.N=node.P=null;var sibling,next,red,parent=node.U,left=node.L,right=node.R;if(next=left?right?RedBlackFirst(right):left:right,parent?parent.L===node?parent.L=next:parent.R=next:this._=next,left&&right?(red=next.C,next.C=node.C,next.L=left,left.U=next,next!==right?(parent=next.U,next.U=node.U,node=next.R,parent.L=node,next.R=right,right.U=next):(next.U=parent,parent=next,node=next.R)):(red=node.C,node=next),node&&(node.U=parent),!red){if(node&&node.C)return void(node.C=!1);do{if(node===this._)break;if(node===parent.L){if(sibling=parent.R,sibling.C&&(sibling.C=!1,parent.C=!0,RedBlackRotateLeft(this,parent),sibling=parent.R),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.R&&sibling.R.C||(sibling.L.C=!1,sibling.C=!0,RedBlackRotateRight(this,sibling),sibling=parent.R),sibling.C=parent.C,parent.C=sibling.R.C=!1,RedBlackRotateLeft(this,parent),node=this._;break}}else if(sibling=parent.L,sibling.C&&(sibling.C=!1,parent.C=!0,RedBlackRotateRight(this,parent),sibling=parent.L),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.L&&sibling.L.C||(sibling.R.C=!1,sibling.C=!0,RedBlackRotateLeft(this,sibling),sibling=parent.L),sibling.C=parent.C,parent.C=sibling.L.C=!1,RedBlackRotateRight(this,parent),node=this._;break}sibling.C=!0,node=parent,parent=parent.U}while(!node.C);node&&(node.C=!1)}}};var firstCircle,beaches,cells,circles,edges,circlePool=[],beachPool=[],epsilon$4=1e-6,epsilon2$2=1e-12;Diagram.prototype={constructor:Diagram,polygons:function(){var edges=this.edges;return this.cells.map(function(cell){var polygon=cell.halfedges.map(function(i){return cellHalfedgeStart(cell,edges[i])});return polygon.data=cell.site.data,polygon})},triangles:function(){var triangles=[],edges=this.edges;return this.cells.forEach(function(cell,i){if(m=(halfedges=cell.halfedges).length)for(var halfedges,m,s0,site=cell.site,j=-1,e1=edges[halfedges[m-1]],s1=e1.left===site?e1.right:e1.left;++j<m;)s0=s1,e1=edges[halfedges[j]],s1=e1.left===site?e1.right:e1.left,s0&&s1&&i<s0.index&&i<s1.index&&triangleArea(site,s0,s1)<0&&triangles.push([site.data,s0.data,s1.data])}),triangles},links:function(){return this.edges.filter(function(edge){return edge.right}).map(function(edge){return{source:edge.left.data,target:edge.right.data}})},find:function(x,y,radius){for(var i0,cell,that=this,i1=that._found||0,n=that.cells.length;!(cell=that.cells[i1]);)if(++i1>=n)return null;var dx=x-cell.site[0],dy=y-cell.site[1],d2=dx*dx+dy*dy;do{cell=that.cells[i0=i1],i1=null,cell.halfedges.forEach(function(e){var edge=that.edges[e],v=edge.left;if(v!==cell.site&&v||(v=edge.right)){var vx=x-v[0],vy=y-v[1],v2=vx*vx+vy*vy;v2<d2&&(d2=v2,i1=v.index)}})}while(null!==i1);return that._found=i0,null==radius||d2<=radius*radius?cell.site:null}};var voronoi=function(){function voronoi(data){return new Diagram(data.map(function(d,i){var s=[Math.round(x$$1(d,i,data)/epsilon$4)*epsilon$4,Math.round(y$$1(d,i,data)/epsilon$4)*epsilon$4];return s.index=i,s.data=d,s}),extent)}var x$$1=x$4,y$$1=y$4,extent=null;return voronoi.polygons=function(data){return voronoi(data).polygons()},voronoi.links=function(data){return voronoi(data).links()},voronoi.triangles=function(data){return voronoi(data).triangles()},voronoi.x=function(_){return arguments.length?(x$$1="function"==typeof _?_:constant$11(+_),voronoi):x$$1},voronoi.y=function(_){return arguments.length?(y$$1="function"==typeof _?_:constant$11(+_),voronoi):y$$1},voronoi.extent=function(_){return arguments.length?(extent=null==_?null:[[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]],voronoi):extent&&[[extent[0][0],extent[0][1]],[extent[1][0],extent[1][1]]]},voronoi.size=function(_){return arguments.length?(extent=null==_?null:[[0,0],[+_[0],+_[1]]],voronoi):extent&&[extent[1][0]-extent[0][0],extent[1][1]-extent[0][1]]},voronoi},constant$12=function(x){return function(){return x}};Transform.prototype={constructor:Transform,scale:function(k){return 1===k?this:new Transform(this.k*k,this.x,this.y)},translate:function(x,y){return 0===x&0===y?this:new Transform(this.k,this.x+this.k*x,this.y+this.k*y)},apply:function(point){return[point[0]*this.k+this.x,point[1]*this.k+this.y]},applyX:function(x){return x*this.k+this.x},applyY:function(y){return y*this.k+this.y},invert:function(location){return[(location[0]-this.x)/this.k,(location[1]-this.y)/this.k]},invertX:function(x){return(x-this.x)/this.k},invertY:function(y){return(y-this.y)/this.k},rescaleX:function(x){return x.copy().domain(x.range().map(this.invertX,this).map(x.invert,x))},rescaleY:function(y){return y.copy().domain(y.range().map(this.invertY,this).map(y.invert,y))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity$8=new Transform(1,0,0);transform$1.prototype=Transform.prototype;var noevent$2=function(){exports.event.preventDefault(),exports.event.stopImmediatePropagation()},zoom=function(){function zoom(selection$$1){selection$$1.on("wheel.zoom",wheeled).on("mousedown.zoom",mousedowned).on("dblclick.zoom",dblclicked).on("touchstart.zoom",touchstarted).on("touchmove.zoom",touchmoved).on("touchend.zoom touchcancel.zoom",touchended).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",defaultTransform)}function scale(transform,k){return k=Math.max(k0,Math.min(k1,k)),k===transform.k?transform:new Transform(k,transform.x,transform.y)}function translate(transform,p0,p1){var x=p0[0]-p1[0]*transform.k,y=p0[1]-p1[1]*transform.k;return x===transform.x&&y===transform.y?transform:new Transform(transform.k,x,y)}function constrain(transform,extent){var dx0=transform.invertX(extent[0][0])-x0,dx1=transform.invertX(extent[1][0])-x1,dy0=transform.invertY(extent[0][1])-y0,dy1=transform.invertY(extent[1][1])-y1;return transform.translate(dx1>dx0?(dx0+dx1)/2:Math.min(0,dx0)||Math.max(0,dx1),dy1>dy0?(dy0+dy1)/2:Math.min(0,dy0)||Math.max(0,dy1))}function centroid(extent){return[(+extent[0][0]+ +extent[1][0])/2,(+extent[0][1]+ +extent[1][1])/2]}function schedule(transition$$1,transform,center){transition$$1.on("start.zoom",function(){gesture(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){gesture(this,arguments).end()}).tween("zoom",function(){var that=this,args=arguments,g=gesture(that,args),e=extent.apply(that,args),p=center||centroid(e),w=Math.max(e[1][0]-e[0][0],e[1][1]-e[0][1]),a=that.__zoom,b="function"==typeof transform?transform.apply(that,args):transform,i=interpolate$$1(a.invert(p).concat(w/a.k),b.invert(p).concat(w/b.k));return function(t){if(1===t)t=b;else{var l=i(t),k=w/l[2];t=new Transform(k,p[0]-l[0]*k,p[1]-l[1]*k)}g.zoom(null,t)}})}function gesture(that,args){for(var g,i=0,n=gestures.length;i<n;++i)if((g=gestures[i]).that===that)return g;return new Gesture(that,args)}function Gesture(that,args){this.that=that,this.args=args,this.index=-1,this.active=0,this.extent=extent.apply(that,args)}function wheeled(){function wheelidled(){g.wheel=null,g.end()}if(filter.apply(this,arguments)){var g=gesture(this,arguments),t=this.__zoom,k=Math.max(k0,Math.min(k1,t.k*Math.pow(2,-exports.event.deltaY*(exports.event.deltaMode?120:1)/500))),p=mouse(this);if(g.wheel)g.mouse[0][0]===p[0]&&g.mouse[0][1]===p[1]||(g.mouse[1]=t.invert(g.mouse[0]=p)),clearTimeout(g.wheel);else{if(t.k===k)return;g.mouse=[p,t.invert(p)],interrupt(this),g.start()}noevent$2(),g.wheel=setTimeout(wheelidled,wheelDelay),g.zoom("mouse",constrain(translate(scale(t,k),g.mouse[0],g.mouse[1]),g.extent))}}function mousedowned(){function mousemoved(){noevent$2(),g.moved=!0,g.zoom("mouse",constrain(translate(g.that.__zoom,g.mouse[0]=mouse(g.that),g.mouse[1]),g.extent))}function mouseupped(){v.on("mousemove.zoom mouseup.zoom",null),yesdrag(exports.event.view,g.moved),noevent$2(),g.end()}if(!touchending&&filter.apply(this,arguments)){var g=gesture(this,arguments),v=select(exports.event.view).on("mousemove.zoom",mousemoved,!0).on("mouseup.zoom",mouseupped,!0),p=mouse(this);dragDisable(exports.event.view),nopropagation$2(),g.mouse=[p,this.__zoom.invert(p)],interrupt(this),g.start()}}function dblclicked(){if(filter.apply(this,arguments)){var t0=this.__zoom,p0=mouse(this),p1=t0.invert(p0),k1=t0.k*(exports.event.shiftKey?.5:2),t1=constrain(translate(scale(t0,k1),p0,p1),extent.apply(this,arguments));noevent$2(),duration>0?select(this).transition().duration(duration).call(schedule,t1,p0):select(this).call(zoom.transform,t1)}}function touchstarted(){if(filter.apply(this,arguments)){var started,i,t,p,g=gesture(this,arguments),touches$$1=exports.event.changedTouches,n=touches$$1.length;for(nopropagation$2(),i=0;i<n;++i)t=touches$$1[i],p=touch(this,touches$$1,t.identifier),p=[p,this.__zoom.invert(p),t.identifier],g.touch0?g.touch1||(g.touch1=p):(g.touch0=p,started=!0);if(touchstarting&&(touchstarting=clearTimeout(touchstarting),!g.touch1))return g.end(),void((p=select(this).on("dblclick.zoom"))&&p.apply(this,arguments));started&&(touchstarting=setTimeout(function(){touchstarting=null},touchDelay),interrupt(this),g.start())}}function touchmoved(){var i,t,p,l,g=gesture(this,arguments),touches$$1=exports.event.changedTouches,n=touches$$1.length;for(noevent$2(),touchstarting&&(touchstarting=clearTimeout(touchstarting)),i=0;i<n;++i)t=touches$$1[i],p=touch(this,touches$$1,t.identifier),g.touch0&&g.touch0[2]===t.identifier?g.touch0[0]=p:g.touch1&&g.touch1[2]===t.identifier&&(g.touch1[0]=p);if(t=g.that.__zoom,g.touch1){var p0=g.touch0[0],l0=g.touch0[1],p1=g.touch1[0],l1=g.touch1[1],dp=(dp=p1[0]-p0[0])*dp+(dp=p1[1]-p0[1])*dp,dl=(dl=l1[0]-l0[0])*dl+(dl=l1[1]-l0[1])*dl;t=scale(t,Math.sqrt(dp/dl)),p=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2]}else{if(!g.touch0)return;p=g.touch0[0],l=g.touch0[1]}g.zoom("touch",constrain(translate(t,p,l),g.extent))}function touchended(){var i,t,g=gesture(this,arguments),touches$$1=exports.event.changedTouches,n=touches$$1.length;for(nopropagation$2(),touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},touchDelay),i=0;i<n;++i)t=touches$$1[i],g.touch0&&g.touch0[2]===t.identifier?delete g.touch0:g.touch1&&g.touch1[2]===t.identifier&&delete g.touch1;g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0||g.end()}var touchstarting,touchending,filter=defaultFilter$2,extent=defaultExtent$1,k0=0,k1=1/0,x0=-k1,x1=k1,y0=x0,y1=x1,duration=250,interpolate$$1=interpolateZoom,gestures=[],listeners=dispatch("start","zoom","end"),touchDelay=500,wheelDelay=150;return zoom.transform=function(collection,transform){var selection$$1=collection.selection?collection.selection():collection;selection$$1.property("__zoom",defaultTransform),collection!==selection$$1?schedule(collection,transform):selection$$1.interrupt().each(function(){gesture(this,arguments).start().zoom(null,"function"==typeof transform?transform.apply(this,arguments):transform).end()})},zoom.scaleBy=function(selection$$1,k){zoom.scaleTo(selection$$1,function(){return this.__zoom.k*("function"==typeof k?k.apply(this,arguments):k)})},zoom.scaleTo=function(selection$$1,k){zoom.transform(selection$$1,function(){var e=extent.apply(this,arguments),t0=this.__zoom,p0=centroid(e),p1=t0.invert(p0);return constrain(translate(scale(t0,"function"==typeof k?k.apply(this,arguments):k),p0,p1),e)})},zoom.translateBy=function(selection$$1,x,y){zoom.transform(selection$$1,function(){return constrain(this.__zoom.translate("function"==typeof x?x.apply(this,arguments):x,"function"==typeof y?y.apply(this,arguments):y),extent.apply(this,arguments))})},Gesture.prototype={start:function(){return 1==++this.active&&(this.index=gestures.push(this)-1,this.emit("start")),this},zoom:function(key,transform){return this.mouse&&"mouse"!==key&&(this.mouse[1]=transform.invert(this.mouse[0])),this.touch0&&"touch"!==key&&(this.touch0[1]=transform.invert(this.touch0[0])),this.touch1&&"touch"!==key&&(this.touch1[1]=transform.invert(this.touch1[0])),this.that.__zoom=transform,this.emit("zoom"),this},end:function(){return 0==--this.active&&(gestures.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(type){customEvent(new ZoomEvent(zoom,type,this.that.__zoom),listeners.apply,listeners,[type,this.that,this.args])}},zoom.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant$12(!!_),zoom):filter},zoom.extent=function(_){return arguments.length?(extent="function"==typeof _?_:constant$12([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),zoom):extent},zoom.scaleExtent=function(_){return arguments.length?(k0=+_[0],k1=+_[1],zoom):[k0,k1]},zoom.translateExtent=function(_){return arguments.length?(x0=+_[0][0],x1=+_[1][0],y0=+_[0][1],y1=+_[1][1],zoom):[[x0,y0],[x1,y1]]},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.interpolate=function(_){return arguments.length?(interpolate$$1=_,zoom):interpolate$$1},zoom.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?zoom:value},zoom};exports.version="4.6.0",exports.bisect=bisectRight,exports.bisectRight=bisectRight,exports.bisectLeft=bisectLeft,exports.ascending=ascending,exports.bisector=bisector,exports.descending=descending,exports.deviation=deviation,exports.extent=extent,exports.histogram=histogram,exports.thresholdFreedmanDiaconis=freedmanDiaconis,exports.thresholdScott=scott,exports.thresholdSturges=sturges,exports.max=max,exports.mean=mean,exports.median=median,exports.merge=merge,exports.min=min,exports.pairs=pairs,exports.permute=permute,exports.quantile=threshold,exports.range=sequence,exports.scan=scan,exports.shuffle=shuffle,exports.sum=sum,exports.ticks=ticks,exports.tickStep=tickStep,exports.transpose=transpose,exports.variance=variance,exports.zip=zip,exports.axisTop=axisTop,exports.axisRight=axisRight,exports.axisBottom=axisBottom,exports.axisLeft=axisLeft,exports.brush=brush,exports.brushX=brushX,exports.brushY=brushY,exports.brushSelection=brushSelection,exports.chord=chord,exports.ribbon=ribbon,exports.nest=nest,exports.set=set$2,exports.map=map$1,exports.keys=keys,exports.values=values,exports.entries=entries,exports.color=color,exports.rgb=rgb,exports.hsl=hsl,exports.lab=lab,exports.hcl=hcl,exports.cubehelix=cubehelix,exports.dispatch=dispatch,exports.drag=drag,exports.dragDisable=dragDisable,exports.dragEnable=yesdrag,exports.dsvFormat=dsv,exports.csvParse=csvParse,exports.csvParseRows=csvParseRows,exports.csvFormat=csvFormat,exports.csvFormatRows=csvFormatRows,exports.tsvParse=tsvParse,exports.tsvParseRows=tsvParseRows,exports.tsvFormat=tsvFormat,exports.tsvFormatRows=tsvFormatRows,exports.easeLinear=linear$1,exports.easeQuad=quadInOut,exports.easeQuadIn=quadIn,exports.easeQuadOut=quadOut,exports.easeQuadInOut=quadInOut,exports.easeCubic=cubicInOut,exports.easeCubicIn=cubicIn,exports.easeCubicOut=cubicOut,exports.easeCubicInOut=cubicInOut,exports.easePoly=polyInOut,exports.easePolyIn=polyIn,exports.easePolyOut=polyOut,exports.easePolyInOut=polyInOut,exports.easeSin=sinInOut,exports.easeSinIn=sinIn,exports.easeSinOut=sinOut,exports.easeSinInOut=sinInOut,exports.easeExp=expInOut,exports.easeExpIn=expIn,exports.easeExpOut=expOut,exports.easeExpInOut=expInOut,exports.easeCircle=circleInOut,exports.easeCircleIn=circleIn,exports.easeCircleOut=circleOut,exports.easeCircleInOut=circleInOut,exports.easeBounce=bounceOut,exports.easeBounceIn=bounceIn,exports.easeBounceOut=bounceOut,exports.easeBounceInOut=bounceInOut,exports.easeBack=backInOut,exports.easeBackIn=backIn,exports.easeBackOut=backOut,exports.easeBackInOut=backInOut,exports.easeElastic=elasticOut,exports.easeElasticIn=elasticIn,exports.easeElasticOut=elasticOut,exports.easeElasticInOut=elasticInOut,exports.forceCenter=center$1,exports.forceCollide=collide,exports.forceLink=link,exports.forceManyBody=manyBody,exports.forceSimulation=simulation,exports.forceX=x$2,exports.forceY=y$2,exports.formatDefaultLocale=defaultLocale,exports.formatLocale=formatLocale,exports.formatSpecifier=formatSpecifier,exports.precisionFixed=precisionFixed,exports.precisionPrefix=precisionPrefix,exports.precisionRound=precisionRound,exports.geoArea=area,exports.geoBounds=bounds,exports.geoCentroid=centroid,exports.geoCircle=circle,exports.geoClipExtent=extent$1,exports.geoDistance=distance,exports.geoGraticule=graticule,exports.geoGraticule10=graticule10,exports.geoInterpolate=interpolate$1,exports.geoLength=length$1,exports.geoPath=index$1,exports.geoAlbers=albers,exports.geoAlbersUsa=albersUsa,exports.geoAzimuthalEqualArea=azimuthalEqualArea,exports.geoAzimuthalEqualAreaRaw=azimuthalEqualAreaRaw,exports.geoAzimuthalEquidistant=azimuthalEquidistant,exports.geoAzimuthalEquidistantRaw=azimuthalEquidistantRaw,exports.geoConicConformal=conicConformal,exports.geoConicConformalRaw=conicConformalRaw,exports.geoConicEqualArea=conicEqualArea,exports.geoConicEqualAreaRaw=conicEqualAreaRaw,exports.geoConicEquidistant=conicEquidistant,exports.geoConicEquidistantRaw=conicEquidistantRaw,exports.geoEquirectangular=equirectangular,exports.geoEquirectangularRaw=equirectangularRaw,exports.geoGnomonic=gnomonic,exports.geoGnomonicRaw=gnomonicRaw,exports.geoIdentity=identity$5,exports.geoProjection=projection,exports.geoProjectionMutator=projectionMutator,exports.geoMercator=mercator,exports.geoMercatorRaw=mercatorRaw,exports.geoOrthographic=orthographic,exports.geoOrthographicRaw=orthographicRaw,exports.geoStereographic=stereographic,exports.geoStereographicRaw=stereographicRaw,exports.geoTransverseMercator=transverseMercator,exports.geoTransverseMercatorRaw=transverseMercatorRaw,exports.geoRotation=rotation,exports.geoStream=geoStream,exports.geoTransform=transform,exports.cluster=cluster,exports.hierarchy=hierarchy,exports.pack=index$2,exports.packSiblings=siblings,exports.packEnclose=enclose,exports.partition=partition,exports.stratify=stratify,exports.tree=tree,exports.treemap=index$3,exports.treemapBinary=binary,exports.treemapDice=treemapDice,exports.treemapSlice=treemapSlice,exports.treemapSliceDice=sliceDice,exports.treemapSquarify=squarify,exports.treemapResquarify=resquarify,exports.interpolate=interpolateValue,exports.interpolateArray=array$1,exports.interpolateBasis=basis$1,exports.interpolateBasisClosed=basisClosed,exports.interpolateDate=date,exports.interpolateNumber=reinterpolate,exports.interpolateObject=object,exports.interpolateRound=interpolateRound,exports.interpolateString=interpolateString,exports.interpolateTransformCss=interpolateTransformCss,exports.interpolateTransformSvg=interpolateTransformSvg,exports.interpolateZoom=interpolateZoom,exports.interpolateRgb=interpolateRgb,exports.interpolateRgbBasis=rgbBasis,exports.interpolateRgbBasisClosed=rgbBasisClosed,exports.interpolateHsl=hsl$2,exports.interpolateHslLong=hslLong,exports.interpolateLab=lab$1,exports.interpolateHcl=hcl$2,exports.interpolateHclLong=hclLong,exports.interpolateCubehelix=cubehelix$2,exports.interpolateCubehelixLong=cubehelixLong,exports.quantize=quantize,exports.path=path,exports.polygonArea=area$1,exports.polygonCentroid=centroid$1,exports.polygonHull=hull,exports.polygonContains=contains,exports.polygonLength=length$2;exports.quadtree=quadtree,exports.queue=queue,exports.randomUniform=uniform,exports.randomNormal=normal,exports.randomLogNormal=logNormal,exports.randomBates=bates,exports.randomIrwinHall=irwinHall,exports.randomExponential=exponential$1,exports.request=request,exports.html=html,exports.json=json,exports.text=text,exports.xml=xml,exports.csv=csv$1,exports.tsv=tsv$1,exports.scaleBand=band,exports.scalePoint=point$1,exports.scaleIdentity=identity$6,exports.scaleLinear=linear$2,exports.scaleLog=log$1,exports.scaleOrdinal=ordinal,exports.scaleImplicit=implicit,exports.scalePow=pow$1,exports.scaleSqrt=sqrt$1,exports.scaleQuantile=quantile$$1,exports.scaleQuantize=quantize$1,exports.scaleThreshold=threshold$1,exports.scaleTime=time,exports.scaleUtc=utcTime,exports.schemeCategory10=category10,exports.schemeCategory20b=category20b,exports.schemeCategory20c=category20c,exports.schemeCategory20=category20,exports.interpolateCubehelixDefault=cubehelix$3,exports.interpolateRainbow=rainbow$1,exports.interpolateWarm=warm,exports.interpolateCool=cool,exports.interpolateViridis=viridis,exports.interpolateMagma=magma,exports.interpolateInferno=inferno,exports.interpolatePlasma=plasma,exports.scaleSequential=sequential,exports.creator=creator,exports.local=local$1,exports.matcher=matcher$1,exports.mouse=mouse,exports.namespace=namespace,exports.namespaces=namespaces,exports.select=select,exports.selectAll=selectAll,exports.selection=selection,exports.selector=selector,exports.selectorAll=selectorAll,exports.touch=touch,exports.touches=touches,exports.window=window,exports.customEvent=customEvent,exports.arc=arc,exports.area=area$2,exports.line=line,exports.pie=pie,exports.radialArea=radialArea,exports.radialLine=radialLine$1,exports.symbol=symbol,exports.symbols=symbols,exports.symbolCircle=circle$2,exports.symbolCross=cross$1,exports.symbolDiamond=diamond,exports.symbolSquare=square,exports.symbolStar=star,exports.symbolTriangle=triangle,exports.symbolWye=wye,exports.curveBasisClosed=basisClosed$1,exports.curveBasisOpen=basisOpen,exports.curveBasis=basis$2,exports.curveBundle=bundle,exports.curveCardinalClosed=cardinalClosed,exports.curveCardinalOpen=cardinalOpen,exports.curveCardinal=cardinal,exports.curveCatmullRomClosed=catmullRomClosed,exports.curveCatmullRomOpen=catmullRomOpen,exports.curveCatmullRom=catmullRom,exports.curveLinearClosed=linearClosed,exports.curveLinear=curveLinear,exports.curveMonotoneX=monotoneX,exports.curveMonotoneY=monotoneY,exports.curveNatural=natural,exports.curveStep=step,exports.curveStepAfter=stepAfter,exports.curveStepBefore=stepBefore,exports.stack=stack,exports.stackOffsetExpand=expand,exports.stackOffsetNone=none$1,exports.stackOffsetSilhouette=silhouette,exports.stackOffsetWiggle=wiggle,exports.stackOrderAscending=ascending$2,exports.stackOrderDescending=descending$2,exports.stackOrderInsideOut=insideOut,exports.stackOrderNone=none$2,exports.stackOrderReverse=reverse,exports.timeInterval=newInterval,exports.timeMillisecond=millisecond,exports.timeMilliseconds=milliseconds,exports.utcMillisecond=millisecond,exports.utcMilliseconds=milliseconds,exports.timeSecond=second,exports.timeSeconds=seconds,exports.utcSecond=second,exports.utcSeconds=seconds,exports.timeMinute=minute,exports.timeMinutes=minutes,exports.timeHour=hour,exports.timeHours=hours,exports.timeDay=day,exports.timeDays=days,exports.timeWeek=sunday,exports.timeWeeks=sundays,exports.timeSunday=sunday,exports.timeSundays=sundays,exports.timeMonday=monday,exports.timeMondays=mondays,exports.timeTuesday=tuesday,exports.timeTuesdays=tuesdays,exports.timeWednesday=wednesday,exports.timeWednesdays=wednesdays,exports.timeThursday=thursday,exports.timeThursdays=thursdays,exports.timeFriday=friday,exports.timeFridays=fridays,exports.timeSaturday=saturday,exports.timeSaturdays=saturdays,exports.timeMonth=month,exports.timeMonths=months,exports.timeYear=year,exports.timeYears=years,exports.utcMinute=utcMinute,exports.utcMinutes=utcMinutes,exports.utcHour=utcHour,exports.utcHours=utcHours,exports.utcDay=utcDay,exports.utcDays=utcDays,exports.utcWeek=utcSunday,exports.utcWeeks=utcSundays,exports.utcSunday=utcSunday,exports.utcSundays=utcSundays,exports.utcMonday=utcMonday,exports.utcMondays=utcMondays,exports.utcTuesday=utcTuesday,exports.utcTuesdays=utcTuesdays,exports.utcWednesday=utcWednesday,exports.utcWednesdays=utcWednesdays,exports.utcThursday=utcThursday,exports.utcThursdays=utcThursdays,exports.utcFriday=utcFriday,exports.utcFridays=utcFridays,exports.utcSaturday=utcSaturday,exports.utcSaturdays=utcSaturdays,exports.utcMonth=utcMonth,exports.utcMonths=utcMonths,exports.utcYear=utcYear,exports.utcYears=utcYears,exports.timeFormatDefaultLocale=defaultLocale$1,exports.timeFormatLocale=formatLocale$1,exports.isoFormat=formatIso,exports.isoParse=parseIso,exports.now=now,exports.timer=timer,exports.timerFlush=timerFlush,exports.timeout=timeout$1,exports.interval=interval$1,exports.transition=transition,exports.active=active,exports.interrupt=interrupt,exports.voronoi=voronoi,exports.zoom=zoom,exports.zoomTransform=transform$1,exports.zoomIdentity=identity$8,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],4:[function(require,module,exports){exports.glMatrix=require("./gl-matrix/common.js"),exports.mat2=require("./gl-matrix/mat2.js"),exports.mat2d=require("./gl-matrix/mat2d.js"),exports.mat3=require("./gl-matrix/mat3.js"),exports.mat4=require("./gl-matrix/mat4.js"),exports.quat=require("./gl-matrix/quat.js"),exports.vec2=require("./gl-matrix/vec2.js"),exports.vec3=require("./gl-matrix/vec3.js"),exports.vec4=require("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":5,"./gl-matrix/mat2.js":6,"./gl-matrix/mat2d.js":7,"./gl-matrix/mat3.js":8,"./gl-matrix/mat4.js":9,"./gl-matrix/quat.js":10,"./gl-matrix/vec2.js":11,"./gl-matrix/vec3.js":12,"./gl-matrix/vec4.js":13}],5:[function(require,module,exports){var glMatrix={};glMatrix.EPSILON=1e-6,glMatrix.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,glMatrix.RANDOM=Math.random,glMatrix.ENABLE_SIMD=!1,glMatrix.SIMD_AVAILABLE=glMatrix.ARRAY_TYPE===Float32Array&&"SIMD"in this,glMatrix.USE_SIMD=glMatrix.ENABLE_SIMD&&glMatrix.SIMD_AVAILABLE,glMatrix.setMatrixArrayType=function(type){glMatrix.ARRAY_TYPE=type};var degree=Math.PI/180;glMatrix.toRadian=function(a){return a*degree},glMatrix.equals=function(a,b){return Math.abs(a-b)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))},module.exports=glMatrix},{}],6:[function(require,module,exports){var glMatrix=require("./common.js"),mat2={};mat2.create=function(){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=1,out[1]=0,out[2]=0,out[3]=1,out},mat2.clone=function(a){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out},mat2.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out},mat2.identity=function(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=1,out},mat2.fromValues=function(m00,m01,m10,m11){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=m00,out[1]=m01,out[2]=m10,out[3]=m11,out},mat2.set=function(out,m00,m01,m10,m11){return out[0]=m00,out[1]=m01,out[2]=m10,out[3]=m11,out},mat2.transpose=function(out,a){if(out===a){var a1=a[1];out[1]=a[2],out[2]=a1}else out[0]=a[0],out[1]=a[2],out[2]=a[1],out[3]=a[3];return out},mat2.invert=function(out,a){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],det=a0*a3-a2*a1;return det?(det=1/det,out[0]=a3*det,out[1]=-a1*det,out[2]=-a2*det,out[3]=a0*det,out):null},mat2.adjoint=function(out,a){var a0=a[0];return out[0]=a[3],out[1]=-a[1],out[2]=-a[2],out[3]=a0,out},mat2.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},mat2.multiply=function(out,a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return out[0]=a0*b0+a2*b1,out[1]=a1*b0+a3*b1,out[2]=a0*b2+a2*b3,out[3]=a1*b2+a3*b3,out},mat2.mul=mat2.multiply,mat2.rotate=function(out,a,rad){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],s=Math.sin(rad),c=Math.cos(rad);return out[0]=a0*c+a2*s,out[1]=a1*c+a3*s,out[2]=a0*-s+a2*c,out[3]=a1*-s+a3*c,out},mat2.scale=function(out,a,v){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],v0=v[0],v1=v[1];return out[0]=a0*v0,out[1]=a1*v0,out[2]=a2*v1,out[3]=a3*v1,out},mat2.fromRotation=function(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=s,out[2]=-s,out[3]=c,out},mat2.fromScaling=function(out,v){return out[0]=v[0],out[1]=0,out[2]=0,out[3]=v[1],out},mat2.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},mat2.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))},mat2.LDU=function(L,D,U,a){return L[2]=a[2]/a[0],U[0]=a[0],U[1]=a[1],U[3]=a[3]-L[2]*U[1],[L,D,U]},mat2.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out},mat2.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out},mat2.sub=mat2.subtract,mat2.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]},mat2.equals=function(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=glMatrix.EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=glMatrix.EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))},mat2.multiplyScalar=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out},mat2.multiplyScalarAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,
out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out},module.exports=mat2},{"./common.js":5}],7:[function(require,module,exports){var glMatrix=require("./common.js"),mat2d={};mat2d.create=function(){var out=new glMatrix.ARRAY_TYPE(6);return out[0]=1,out[1]=0,out[2]=0,out[3]=1,out[4]=0,out[5]=0,out},mat2d.clone=function(a){var out=new glMatrix.ARRAY_TYPE(6);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out},mat2d.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out},mat2d.identity=function(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=1,out[4]=0,out[5]=0,out},mat2d.fromValues=function(a,b,c,d,tx,ty){var out=new glMatrix.ARRAY_TYPE(6);return out[0]=a,out[1]=b,out[2]=c,out[3]=d,out[4]=tx,out[5]=ty,out},mat2d.set=function(out,a,b,c,d,tx,ty){return out[0]=a,out[1]=b,out[2]=c,out[3]=d,out[4]=tx,out[5]=ty,out},mat2d.invert=function(out,a){var aa=a[0],ab=a[1],ac=a[2],ad=a[3],atx=a[4],aty=a[5],det=aa*ad-ab*ac;return det?(det=1/det,out[0]=ad*det,out[1]=-ab*det,out[2]=-ac*det,out[3]=aa*det,out[4]=(ac*aty-ad*atx)*det,out[5]=(ab*atx-aa*aty)*det,out):null},mat2d.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},mat2d.multiply=function(out,a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5];return out[0]=a0*b0+a2*b1,out[1]=a1*b0+a3*b1,out[2]=a0*b2+a2*b3,out[3]=a1*b2+a3*b3,out[4]=a0*b4+a2*b5+a4,out[5]=a1*b4+a3*b5+a5,out},mat2d.mul=mat2d.multiply,mat2d.rotate=function(out,a,rad){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],s=Math.sin(rad),c=Math.cos(rad);return out[0]=a0*c+a2*s,out[1]=a1*c+a3*s,out[2]=a0*-s+a2*c,out[3]=a1*-s+a3*c,out[4]=a4,out[5]=a5,out},mat2d.scale=function(out,a,v){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],v0=v[0],v1=v[1];return out[0]=a0*v0,out[1]=a1*v0,out[2]=a2*v1,out[3]=a3*v1,out[4]=a4,out[5]=a5,out},mat2d.translate=function(out,a,v){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],v0=v[0],v1=v[1];return out[0]=a0,out[1]=a1,out[2]=a2,out[3]=a3,out[4]=a0*v0+a2*v1+a4,out[5]=a1*v0+a3*v1+a5,out},mat2d.fromRotation=function(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=s,out[2]=-s,out[3]=c,out[4]=0,out[5]=0,out},mat2d.fromScaling=function(out,v){return out[0]=v[0],out[1]=0,out[2]=0,out[3]=v[1],out[4]=0,out[5]=0,out},mat2d.fromTranslation=function(out,v){return out[0]=1,out[1]=0,out[2]=0,out[3]=1,out[4]=v[0],out[5]=v[1],out},mat2d.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},mat2d.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)},mat2d.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out[4]=a[4]+b[4],out[5]=a[5]+b[5],out},mat2d.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out[4]=a[4]-b[4],out[5]=a[5]-b[5],out},mat2d.sub=mat2d.subtract,mat2d.multiplyScalar=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out[4]=a[4]*b,out[5]=a[5]*b,out},mat2d.multiplyScalarAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out[4]=a[4]+b[4]*scale,out[5]=a[5]+b[5]*scale,out},mat2d.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]},mat2d.equals=function(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=glMatrix.EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=glMatrix.EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))&&Math.abs(a4-b4)<=glMatrix.EPSILON*Math.max(1,Math.abs(a4),Math.abs(b4))&&Math.abs(a5-b5)<=glMatrix.EPSILON*Math.max(1,Math.abs(a5),Math.abs(b5))},module.exports=mat2d},{"./common.js":5}],8:[function(require,module,exports){var glMatrix=require("./common.js"),mat3={};mat3.create=function(){var out=new glMatrix.ARRAY_TYPE(9);return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=1,out[5]=0,out[6]=0,out[7]=0,out[8]=1,out},mat3.fromMat4=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[4],out[4]=a[5],out[5]=a[6],out[6]=a[8],out[7]=a[9],out[8]=a[10],out},mat3.clone=function(a){var out=new glMatrix.ARRAY_TYPE(9);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out},mat3.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out},mat3.fromValues=function(m00,m01,m02,m10,m11,m12,m20,m21,m22){var out=new glMatrix.ARRAY_TYPE(9);return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m10,out[4]=m11,out[5]=m12,out[6]=m20,out[7]=m21,out[8]=m22,out},mat3.set=function(out,m00,m01,m02,m10,m11,m12,m20,m21,m22){return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m10,out[4]=m11,out[5]=m12,out[6]=m20,out[7]=m21,out[8]=m22,out},mat3.identity=function(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=1,out[5]=0,out[6]=0,out[7]=0,out[8]=1,out},mat3.transpose=function(out,a){if(out===a){var a01=a[1],a02=a[2],a12=a[5];out[1]=a[3],out[2]=a[6],out[3]=a01,out[5]=a[7],out[6]=a02,out[7]=a12}else out[0]=a[0],out[1]=a[3],out[2]=a[6],out[3]=a[1],out[4]=a[4],out[5]=a[7],out[6]=a[2],out[7]=a[5],out[8]=a[8];return out},mat3.invert=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;return det?(det=1/det,out[0]=b01*det,out[1]=(-a22*a01+a02*a21)*det,out[2]=(a12*a01-a02*a11)*det,out[3]=b11*det,out[4]=(a22*a00-a02*a20)*det,out[5]=(-a12*a00+a02*a10)*det,out[6]=b21*det,out[7]=(-a21*a00+a01*a20)*det,out[8]=(a11*a00-a01*a10)*det,out):null},mat3.adjoint=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];return out[0]=a11*a22-a12*a21,out[1]=a02*a21-a01*a22,out[2]=a01*a12-a02*a11,out[3]=a12*a20-a10*a22,out[4]=a00*a22-a02*a20,out[5]=a02*a10-a00*a12,out[6]=a10*a21-a11*a20,out[7]=a01*a20-a00*a21,out[8]=a00*a11-a01*a10,out},mat3.determinant=function(a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20)},mat3.multiply=function(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b00=b[0],b01=b[1],b02=b[2],b10=b[3],b11=b[4],b12=b[5],b20=b[6],b21=b[7],b22=b[8];return out[0]=b00*a00+b01*a10+b02*a20,out[1]=b00*a01+b01*a11+b02*a21,out[2]=b00*a02+b01*a12+b02*a22,out[3]=b10*a00+b11*a10+b12*a20,out[4]=b10*a01+b11*a11+b12*a21,out[5]=b10*a02+b11*a12+b12*a22,out[6]=b20*a00+b21*a10+b22*a20,out[7]=b20*a01+b21*a11+b22*a21,out[8]=b20*a02+b21*a12+b22*a22,out},mat3.mul=mat3.multiply,mat3.translate=function(out,a,v){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],x=v[0],y=v[1];return out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a10,out[4]=a11,out[5]=a12,out[6]=x*a00+y*a10+a20,out[7]=x*a01+y*a11+a21,out[8]=x*a02+y*a12+a22,out},mat3.rotate=function(out,a,rad){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],s=Math.sin(rad),c=Math.cos(rad);return out[0]=c*a00+s*a10,out[1]=c*a01+s*a11,out[2]=c*a02+s*a12,out[3]=c*a10-s*a00,out[4]=c*a11-s*a01,out[5]=c*a12-s*a02,out[6]=a20,out[7]=a21,out[8]=a22,out},mat3.scale=function(out,a,v){var x=v[0],y=v[1];return out[0]=x*a[0],out[1]=x*a[1],out[2]=x*a[2],out[3]=y*a[3],out[4]=y*a[4],out[5]=y*a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out},mat3.fromTranslation=function(out,v){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=1,out[5]=0,out[6]=v[0],out[7]=v[1],out[8]=1,out},mat3.fromRotation=function(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=s,out[2]=0,out[3]=-s,out[4]=c,out[5]=0,out[6]=0,out[7]=0,out[8]=1,out},mat3.fromScaling=function(out,v){return out[0]=v[0],out[1]=0,out[2]=0,out[3]=0,out[4]=v[1],out[5]=0,out[6]=0,out[7]=0,out[8]=1,out},mat3.fromMat2d=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=0,out[3]=a[2],out[4]=a[3],out[5]=0,out[6]=a[4],out[7]=a[5],out[8]=1,out},mat3.fromQuat=function(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-yy-zz,out[3]=yx-wz,out[6]=zx+wy,out[1]=yx+wz,out[4]=1-xx-zz,out[7]=zy-wx,out[2]=zx-wy,out[5]=zy+wx,out[8]=1-xx-yy,out},mat3.normalFromMat4=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a12*b08-a10*b11-a13*b07)*det,out[2]=(a10*b10-a11*b08+a13*b06)*det,out[3]=(a02*b10-a01*b11-a03*b09)*det,out[4]=(a00*b11-a02*b08+a03*b07)*det,out[5]=(a01*b08-a00*b10-a03*b06)*det,out[6]=(a31*b05-a32*b04+a33*b03)*det,out[7]=(a32*b02-a30*b05-a33*b01)*det,out[8]=(a30*b04-a31*b02+a33*b00)*det,out):null},mat3.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},mat3.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))},mat3.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out[4]=a[4]+b[4],out[5]=a[5]+b[5],out[6]=a[6]+b[6],out[7]=a[7]+b[7],out[8]=a[8]+b[8],out},mat3.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out[4]=a[4]-b[4],out[5]=a[5]-b[5],out[6]=a[6]-b[6],out[7]=a[7]-b[7],out[8]=a[8]-b[8],out},mat3.sub=mat3.subtract,mat3.multiplyScalar=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out[4]=a[4]*b,out[5]=a[5]*b,out[6]=a[6]*b,out[7]=a[7]*b,out[8]=a[8]*b,out},mat3.multiplyScalarAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out[4]=a[4]+b[4]*scale,out[5]=a[5]+b[5]*scale,out[6]=a[6]+b[6]*scale,out[7]=a[7]+b[7]*scale,out[8]=a[8]+b[8]*scale,out},mat3.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]},mat3.equals=function(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],a6=a[6],a7=a[7],a8=a[8],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5],b6=a[6],b7=b[7],b8=b[8];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=glMatrix.EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=glMatrix.EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))&&Math.abs(a4-b4)<=glMatrix.EPSILON*Math.max(1,Math.abs(a4),Math.abs(b4))&&Math.abs(a5-b5)<=glMatrix.EPSILON*Math.max(1,Math.abs(a5),Math.abs(b5))&&Math.abs(a6-b6)<=glMatrix.EPSILON*Math.max(1,Math.abs(a6),Math.abs(b6))&&Math.abs(a7-b7)<=glMatrix.EPSILON*Math.max(1,Math.abs(a7),Math.abs(b7))&&Math.abs(a8-b8)<=glMatrix.EPSILON*Math.max(1,Math.abs(a8),Math.abs(b8))},module.exports=mat3},{"./common.js":5}],9:[function(require,module,exports){var glMatrix=require("./common.js"),mat4={scalar:{},SIMD:{}};mat4.create=function(){var out=new glMatrix.ARRAY_TYPE(16);return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.clone=function(a){var out=new glMatrix.ARRAY_TYPE(16);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out},mat4.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out},mat4.fromValues=function(m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33){var out=new glMatrix.ARRAY_TYPE(16);return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m03,out[4]=m10,out[5]=m11,out[6]=m12,out[7]=m13,out[8]=m20,out[9]=m21,out[10]=m22,out[11]=m23,out[12]=m30,out[13]=m31,out[14]=m32,out[15]=m33,out},mat4.set=function(out,m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33){return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m03,out[4]=m10,out[5]=m11,out[6]=m12,out[7]=m13,out[8]=m20,out[9]=m21,out[10]=m22,out[11]=m23,out[12]=m30,out[13]=m31,out[14]=m32,out[15]=m33,out},mat4.identity=function(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.scalar.transpose=function(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a01,out[6]=a[9],out[7]=a[13],out[8]=a02,out[9]=a12,out[11]=a[14],out[12]=a03,out[13]=a13,out[14]=a23}else out[0]=a[0],out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a[1],out[5]=a[5],out[6]=a[9],out[7]=a[13],out[8]=a[2],out[9]=a[6],out[10]=a[10],out[11]=a[14],out[12]=a[3],out[13]=a[7],out[14]=a[11],out[15]=a[15];return out},mat4.SIMD.transpose=function(out,a){var a0,a1,a2,a3,tmp01,tmp23,out0,out1,out2,out3;return a0=SIMD.Float32x4.load(a,0),a1=SIMD.Float32x4.load(a,4),a2=SIMD.Float32x4.load(a,8),a3=SIMD.Float32x4.load(a,12),tmp01=SIMD.Float32x4.shuffle(a0,a1,0,1,4,5),tmp23=SIMD.Float32x4.shuffle(a2,a3,0,1,4,5),out0=SIMD.Float32x4.shuffle(tmp01,tmp23,0,2,4,6),out1=SIMD.Float32x4.shuffle(tmp01,tmp23,1,3,5,7),SIMD.Float32x4.store(out,0,out0),SIMD.Float32x4.store(out,4,out1),tmp01=SIMD.Float32x4.shuffle(a0,a1,2,3,6,7),tmp23=SIMD.Float32x4.shuffle(a2,a3,2,3,6,7),out2=SIMD.Float32x4.shuffle(tmp01,tmp23,0,2,4,6),out3=SIMD.Float32x4.shuffle(tmp01,tmp23,1,3,5,7),SIMD.Float32x4.store(out,8,out2),SIMD.Float32x4.store(out,12,out3),out},mat4.transpose=glMatrix.USE_SIMD?mat4.SIMD.transpose:mat4.scalar.transpose,mat4.scalar.invert=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a02*b10-a01*b11-a03*b09)*det,out[2]=(a31*b05-a32*b04+a33*b03)*det,out[3]=(a22*b04-a21*b05-a23*b03)*det,out[4]=(a12*b08-a10*b11-a13*b07)*det,out[5]=(a00*b11-a02*b08+a03*b07)*det,out[6]=(a32*b02-a30*b05-a33*b01)*det,out[7]=(a20*b05-a22*b02+a23*b01)*det,out[8]=(a10*b10-a11*b08+a13*b06)*det,out[9]=(a01*b08-a00*b10-a03*b06)*det,out[10]=(a30*b04-a31*b02+a33*b00)*det,out[11]=(a21*b02-a20*b04-a23*b00)*det,out[12]=(a11*b07-a10*b09-a12*b06)*det,out[13]=(a00*b09-a01*b07+a02*b06)*det,out[14]=(a31*b01-a30*b03-a32*b00)*det,out[15]=(a20*b03-a21*b01+a22*b00)*det,out):null},mat4.SIMD.invert=function(out,a){var row0,row1,row2,row3,tmp1,minor0,minor1,minor2,minor3,det,a0=SIMD.Float32x4.load(a,0),a1=SIMD.Float32x4.load(a,4),a2=SIMD.Float32x4.load(a,8),a3=SIMD.Float32x4.load(a,12);return tmp1=SIMD.Float32x4.shuffle(a0,a1,0,1,4,5),row1=SIMD.Float32x4.shuffle(a2,a3,0,1,4,5),row0=SIMD.Float32x4.shuffle(tmp1,row1,0,2,4,6),row1=SIMD.Float32x4.shuffle(row1,tmp1,1,3,5,7),tmp1=SIMD.Float32x4.shuffle(a0,a1,2,3,6,7),row3=SIMD.Float32x4.shuffle(a2,a3,2,3,6,7),row2=SIMD.Float32x4.shuffle(tmp1,row3,0,2,4,6),row3=SIMD.Float32x4.shuffle(row3,tmp1,1,3,5,7),tmp1=SIMD.Float32x4.mul(row2,row3),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor0=SIMD.Float32x4.mul(row1,tmp1),minor1=SIMD.Float32x4.mul(row0,tmp1),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor0=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row1,tmp1),minor0),minor1=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0,tmp1),minor1),minor1=SIMD.Float32x4.swizzle(minor1,2,3,0,1),tmp1=SIMD.Float32x4.mul(row1,row2),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor0=SIMD.Float32x4.add(SIMD.Float32x4.mul(row3,tmp1),minor0),minor3=SIMD.Float32x4.mul(row0,tmp1),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor0=SIMD.Float32x4.sub(minor0,SIMD.Float32x4.mul(row3,tmp1)),minor3=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0,tmp1),minor3),minor3=SIMD.Float32x4.swizzle(minor3,2,3,0,1),tmp1=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(row1,2,3,0,1),row3),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),row2=SIMD.Float32x4.swizzle(row2,2,3,0,1),minor0=SIMD.Float32x4.add(SIMD.Float32x4.mul(row2,tmp1),minor0),minor2=SIMD.Float32x4.mul(row0,tmp1),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor0=SIMD.Float32x4.sub(minor0,SIMD.Float32x4.mul(row2,tmp1)),minor2=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0,tmp1),minor2),minor2=SIMD.Float32x4.swizzle(minor2,2,3,0,1),tmp1=SIMD.Float32x4.mul(row0,row1),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor2=SIMD.Float32x4.add(SIMD.Float32x4.mul(row3,tmp1),minor2),minor3=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row2,tmp1),minor3),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor2=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row3,tmp1),minor2),minor3=SIMD.Float32x4.sub(minor3,SIMD.Float32x4.mul(row2,tmp1)),tmp1=SIMD.Float32x4.mul(row0,row3),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor1=SIMD.Float32x4.sub(minor1,SIMD.Float32x4.mul(row2,tmp1)),minor2=SIMD.Float32x4.add(SIMD.Float32x4.mul(row1,tmp1),minor2),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor1=SIMD.Float32x4.add(SIMD.Float32x4.mul(row2,tmp1),minor1),minor2=SIMD.Float32x4.sub(minor2,SIMD.Float32x4.mul(row1,tmp1)),tmp1=SIMD.Float32x4.mul(row0,row2),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor1=SIMD.Float32x4.add(SIMD.Float32x4.mul(row3,tmp1),minor1),minor3=SIMD.Float32x4.sub(minor3,SIMD.Float32x4.mul(row1,tmp1)),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor1=SIMD.Float32x4.sub(minor1,SIMD.Float32x4.mul(row3,tmp1)),minor3=SIMD.Float32x4.add(SIMD.Float32x4.mul(row1,tmp1),minor3),det=SIMD.Float32x4.mul(row0,minor0),det=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(det,2,3,0,1),det),det=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(det,1,0,3,2),det),tmp1=SIMD.Float32x4.reciprocalApproximation(det),det=SIMD.Float32x4.sub(SIMD.Float32x4.add(tmp1,tmp1),SIMD.Float32x4.mul(det,SIMD.Float32x4.mul(tmp1,tmp1))),(det=SIMD.Float32x4.swizzle(det,0,0,0,0))?(SIMD.Float32x4.store(out,0,SIMD.Float32x4.mul(det,minor0)),SIMD.Float32x4.store(out,4,SIMD.Float32x4.mul(det,minor1)),SIMD.Float32x4.store(out,8,SIMD.Float32x4.mul(det,minor2)),SIMD.Float32x4.store(out,12,SIMD.Float32x4.mul(det,minor3)),out):null},mat4.invert=glMatrix.USE_SIMD?mat4.SIMD.invert:mat4.scalar.invert,mat4.scalar.adjoint=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];return out[0]=a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22),out[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22)),out[2]=a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12),out[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12)),out[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22)),out[5]=a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22),out[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12)),out[7]=a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12),out[8]=a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21),out[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21)),out[10]=a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11),out[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11)),out[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21)),out[13]=a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21),out[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11)),out[15]=a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11),out},mat4.SIMD.adjoint=function(out,a){var a0,a1,a2,a3,row0,row1,row2,row3,tmp1,minor0,minor1,minor2,minor3,a0=SIMD.Float32x4.load(a,0),a1=SIMD.Float32x4.load(a,4),a2=SIMD.Float32x4.load(a,8),a3=SIMD.Float32x4.load(a,12);return tmp1=SIMD.Float32x4.shuffle(a0,a1,0,1,4,5),row1=SIMD.Float32x4.shuffle(a2,a3,0,1,4,5),row0=SIMD.Float32x4.shuffle(tmp1,row1,0,2,4,6),row1=SIMD.Float32x4.shuffle(row1,tmp1,1,3,5,7),tmp1=SIMD.Float32x4.shuffle(a0,a1,2,3,6,7),row3=SIMD.Float32x4.shuffle(a2,a3,2,3,6,7),row2=SIMD.Float32x4.shuffle(tmp1,row3,0,2,4,6),row3=SIMD.Float32x4.shuffle(row3,tmp1,1,3,5,7),tmp1=SIMD.Float32x4.mul(row2,row3),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor0=SIMD.Float32x4.mul(row1,tmp1),minor1=SIMD.Float32x4.mul(row0,tmp1),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor0=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row1,tmp1),minor0),minor1=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0,tmp1),minor1),minor1=SIMD.Float32x4.swizzle(minor1,2,3,0,1),tmp1=SIMD.Float32x4.mul(row1,row2),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor0=SIMD.Float32x4.add(SIMD.Float32x4.mul(row3,tmp1),minor0),minor3=SIMD.Float32x4.mul(row0,tmp1),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor0=SIMD.Float32x4.sub(minor0,SIMD.Float32x4.mul(row3,tmp1)),minor3=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0,tmp1),minor3),minor3=SIMD.Float32x4.swizzle(minor3,2,3,0,1),tmp1=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(row1,2,3,0,1),row3),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),row2=SIMD.Float32x4.swizzle(row2,2,3,0,1),minor0=SIMD.Float32x4.add(SIMD.Float32x4.mul(row2,tmp1),minor0),minor2=SIMD.Float32x4.mul(row0,tmp1),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor0=SIMD.Float32x4.sub(minor0,SIMD.Float32x4.mul(row2,tmp1)),minor2=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0,tmp1),minor2),minor2=SIMD.Float32x4.swizzle(minor2,2,3,0,1),tmp1=SIMD.Float32x4.mul(row0,row1),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor2=SIMD.Float32x4.add(SIMD.Float32x4.mul(row3,tmp1),minor2),minor3=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row2,tmp1),minor3),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor2=SIMD.Float32x4.sub(SIMD.Float32x4.mul(row3,tmp1),minor2),minor3=SIMD.Float32x4.sub(minor3,SIMD.Float32x4.mul(row2,tmp1)),tmp1=SIMD.Float32x4.mul(row0,row3),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor1=SIMD.Float32x4.sub(minor1,SIMD.Float32x4.mul(row2,tmp1)),minor2=SIMD.Float32x4.add(SIMD.Float32x4.mul(row1,tmp1),minor2),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor1=SIMD.Float32x4.add(SIMD.Float32x4.mul(row2,tmp1),minor1),minor2=SIMD.Float32x4.sub(minor2,SIMD.Float32x4.mul(row1,tmp1)),tmp1=SIMD.Float32x4.mul(row0,row2),tmp1=SIMD.Float32x4.swizzle(tmp1,1,0,3,2),minor1=SIMD.Float32x4.add(SIMD.Float32x4.mul(row3,tmp1),minor1),minor3=SIMD.Float32x4.sub(minor3,SIMD.Float32x4.mul(row1,tmp1)),tmp1=SIMD.Float32x4.swizzle(tmp1,2,3,0,1),minor1=SIMD.Float32x4.sub(minor1,SIMD.Float32x4.mul(row3,tmp1)),minor3=SIMD.Float32x4.add(SIMD.Float32x4.mul(row1,tmp1),minor3),SIMD.Float32x4.store(out,0,minor0),SIMD.Float32x4.store(out,4,minor1),SIMD.Float32x4.store(out,8,minor2),SIMD.Float32x4.store(out,12,minor3),out},mat4.adjoint=glMatrix.USE_SIMD?mat4.SIMD.adjoint:mat4.scalar.adjoint,mat4.determinant=function(a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];return(a00*a11-a01*a10)*(a22*a33-a23*a32)-(a00*a12-a02*a10)*(a21*a33-a23*a31)+(a00*a13-a03*a10)*(a21*a32-a22*a31)+(a01*a12-a02*a11)*(a20*a33-a23*a30)-(a01*a13-a03*a11)*(a20*a32-a22*a30)+(a02*a13-a03*a12)*(a20*a31-a21*a30)},mat4.SIMD.multiply=function(out,a,b){var a0=SIMD.Float32x4.load(a,0),a1=SIMD.Float32x4.load(a,4),a2=SIMD.Float32x4.load(a,8),a3=SIMD.Float32x4.load(a,12),b0=SIMD.Float32x4.load(b,0),out0=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0,0,0,0,0),a0),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0,1,1,1,1),a1),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0,2,2,2,2),a2),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0,3,3,3,3),a3))));SIMD.Float32x4.store(out,0,out0);var b1=SIMD.Float32x4.load(b,4),out1=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1,0,0,0,0),a0),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1,1,1,1,1),a1),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1,2,2,2,2),a2),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1,3,3,3,3),a3))));SIMD.Float32x4.store(out,4,out1);var b2=SIMD.Float32x4.load(b,8),out2=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2,0,0,0,0),a0),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2,1,1,1,1),a1),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2,2,2,2,2),a2),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2,3,3,3,3),a3))));SIMD.Float32x4.store(out,8,out2);var b3=SIMD.Float32x4.load(b,12),out3=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3,0,0,0,0),a0),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3,1,1,1,1),a1),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3,2,2,2,2),a2),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3,3,3,3,3),a3))));return SIMD.Float32x4.store(out,12,out3),out},mat4.scalar.multiply=function(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return out[0]=b0*a00+b1*a10+b2*a20+b3*a30,out[1]=b0*a01+b1*a11+b2*a21+b3*a31,out[2]=b0*a02+b1*a12+b2*a22+b3*a32,out[3]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[4],b1=b[5],b2=b[6],b3=b[7],out[4]=b0*a00+b1*a10+b2*a20+b3*a30,out[5]=b0*a01+b1*a11+b2*a21+b3*a31,out[6]=b0*a02+b1*a12+b2*a22+b3*a32,out[7]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[8],b1=b[9],b2=b[10],b3=b[11],out[8]=b0*a00+b1*a10+b2*a20+b3*a30,out[9]=b0*a01+b1*a11+b2*a21+b3*a31,out[10]=b0*a02+b1*a12+b2*a22+b3*a32,out[11]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[12],b1=b[13],b2=b[14],b3=b[15],out[12]=b0*a00+b1*a10+b2*a20+b3*a30,out[13]=b0*a01+b1*a11+b2*a21+b3*a31,out[14]=b0*a02+b1*a12+b2*a22+b3*a32,out[15]=b0*a03+b1*a13+b2*a23+b3*a33,out},mat4.multiply=glMatrix.USE_SIMD?mat4.SIMD.multiply:mat4.scalar.multiply,mat4.mul=mat4.multiply,mat4.scalar.translate=function(out,a,v){var a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,x=v[0],y=v[1],z=v[2];return a===out?(out[12]=a[0]*x+a[4]*y+a[8]*z+a[12],out[13]=a[1]*x+a[5]*y+a[9]*z+a[13],out[14]=a[2]*x+a[6]*y+a[10]*z+a[14],out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]):(a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a03,out[4]=a10,out[5]=a11,out[6]=a12,out[7]=a13,out[8]=a20,out[9]=a21,out[10]=a22,out[11]=a23,out[12]=a00*x+a10*y+a20*z+a[12],out[13]=a01*x+a11*y+a21*z+a[13],out[14]=a02*x+a12*y+a22*z+a[14],out[15]=a03*x+a13*y+a23*z+a[15]),out},mat4.SIMD.translate=function(out,a,v){var a0=SIMD.Float32x4.load(a,0),a1=SIMD.Float32x4.load(a,4),a2=SIMD.Float32x4.load(a,8),a3=SIMD.Float32x4.load(a,12),vec=SIMD.Float32x4(v[0],v[1],v[2],0);a!==out&&(out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11]),a0=SIMD.Float32x4.mul(a0,SIMD.Float32x4.swizzle(vec,0,0,0,0)),a1=SIMD.Float32x4.mul(a1,SIMD.Float32x4.swizzle(vec,1,1,1,1)),a2=SIMD.Float32x4.mul(a2,SIMD.Float32x4.swizzle(vec,2,2,2,2));var t0=SIMD.Float32x4.add(a0,SIMD.Float32x4.add(a1,SIMD.Float32x4.add(a2,a3)));return SIMD.Float32x4.store(out,12,t0),out},mat4.translate=glMatrix.USE_SIMD?mat4.SIMD.translate:mat4.scalar.translate,mat4.scalar.scale=function(out,a,v){var x=v[0],y=v[1],z=v[2];return out[0]=a[0]*x,out[1]=a[1]*x,out[2]=a[2]*x,out[3]=a[3]*x,out[4]=a[4]*y,out[5]=a[5]*y,out[6]=a[6]*y,out[7]=a[7]*y,out[8]=a[8]*z,out[9]=a[9]*z,out[10]=a[10]*z,out[11]=a[11]*z,out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out},mat4.SIMD.scale=function(out,a,v){var a0,a1,a2,vec=SIMD.Float32x4(v[0],v[1],v[2],0);return a0=SIMD.Float32x4.load(a,0),SIMD.Float32x4.store(out,0,SIMD.Float32x4.mul(a0,SIMD.Float32x4.swizzle(vec,0,0,0,0))),a1=SIMD.Float32x4.load(a,4),SIMD.Float32x4.store(out,4,SIMD.Float32x4.mul(a1,SIMD.Float32x4.swizzle(vec,1,1,1,1))),a2=SIMD.Float32x4.load(a,8),SIMD.Float32x4.store(out,8,SIMD.Float32x4.mul(a2,SIMD.Float32x4.swizzle(vec,2,2,2,2))),out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out},mat4.scale=glMatrix.USE_SIMD?mat4.SIMD.scale:mat4.scalar.scale,mat4.rotate=function(out,a,rad,axis){var s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22,x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z);return Math.abs(len)<glMatrix.EPSILON?null:(len=1/len,x*=len,y*=len,z*=len,s=Math.sin(rad),c=Math.cos(rad),t=1-c,a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],b00=x*x*t+c,b01=y*x*t+z*s,b02=z*x*t-y*s,b10=x*y*t-z*s,b11=y*y*t+c,b12=z*y*t+x*s,b20=x*z*t+y*s,b21=y*z*t-x*s,b22=z*z*t+c,out[0]=a00*b00+a10*b01+a20*b02,out[1]=a01*b00+a11*b01+a21*b02,out[2]=a02*b00+a12*b01+a22*b02,out[3]=a03*b00+a13*b01+a23*b02,out[4]=a00*b10+a10*b11+a20*b12,out[5]=a01*b10+a11*b11+a21*b12,out[6]=a02*b10+a12*b11+a22*b12,out[7]=a03*b10+a13*b11+a23*b12,out[8]=a00*b20+a10*b21+a20*b22,out[9]=a01*b20+a11*b21+a21*b22,out[10]=a02*b20+a12*b21+a22*b22,out[11]=a03*b20+a13*b21+a23*b22,a!==out&&(out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out)},mat4.scalar.rotateX=function(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a!==out&&(out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[4]=a10*c+a20*s,out[5]=a11*c+a21*s,out[6]=a12*c+a22*s,out[7]=a13*c+a23*s,out[8]=a20*c-a10*s,out[9]=a21*c-a11*s,out[10]=a22*c-a12*s,out[11]=a23*c-a13*s,out},mat4.SIMD.rotateX=function(out,a,rad){var s=SIMD.Float32x4.splat(Math.sin(rad)),c=SIMD.Float32x4.splat(Math.cos(rad));a!==out&&(out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);var a_1=SIMD.Float32x4.load(a,4),a_2=SIMD.Float32x4.load(a,8);return SIMD.Float32x4.store(out,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(a_1,c),SIMD.Float32x4.mul(a_2,s))),SIMD.Float32x4.store(out,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a_2,c),SIMD.Float32x4.mul(a_1,s))),out},mat4.rotateX=glMatrix.USE_SIMD?mat4.SIMD.rotateX:mat4.scalar.rotateX,mat4.scalar.rotateY=function(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a!==out&&(out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[0]=a00*c-a20*s,out[1]=a01*c-a21*s,out[2]=a02*c-a22*s,out[3]=a03*c-a23*s,out[8]=a00*s+a20*c,out[9]=a01*s+a21*c,out[10]=a02*s+a22*c,out[11]=a03*s+a23*c,out},mat4.SIMD.rotateY=function(out,a,rad){var s=SIMD.Float32x4.splat(Math.sin(rad)),c=SIMD.Float32x4.splat(Math.cos(rad));a!==out&&(out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);var a_0=SIMD.Float32x4.load(a,0),a_2=SIMD.Float32x4.load(a,8);return SIMD.Float32x4.store(out,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a_0,c),SIMD.Float32x4.mul(a_2,s))),
SIMD.Float32x4.store(out,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(a_0,s),SIMD.Float32x4.mul(a_2,c))),out},mat4.rotateY=glMatrix.USE_SIMD?mat4.SIMD.rotateY:mat4.scalar.rotateY,mat4.scalar.rotateZ=function(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];return a!==out&&(out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[0]=a00*c+a10*s,out[1]=a01*c+a11*s,out[2]=a02*c+a12*s,out[3]=a03*c+a13*s,out[4]=a10*c-a00*s,out[5]=a11*c-a01*s,out[6]=a12*c-a02*s,out[7]=a13*c-a03*s,out},mat4.SIMD.rotateZ=function(out,a,rad){var s=SIMD.Float32x4.splat(Math.sin(rad)),c=SIMD.Float32x4.splat(Math.cos(rad));a!==out&&(out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);var a_0=SIMD.Float32x4.load(a,0),a_1=SIMD.Float32x4.load(a,4);return SIMD.Float32x4.store(out,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(a_0,c),SIMD.Float32x4.mul(a_1,s))),SIMD.Float32x4.store(out,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a_1,c),SIMD.Float32x4.mul(a_0,s))),out},mat4.rotateZ=glMatrix.USE_SIMD?mat4.SIMD.rotateZ:mat4.scalar.rotateZ,mat4.fromTranslation=function(out,v){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out},mat4.fromScaling=function(out,v){return out[0]=v[0],out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=v[1],out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=v[2],out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.fromRotation=function(out,rad,axis){var s,c,t,x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z);return Math.abs(len)<glMatrix.EPSILON?null:(len=1/len,x*=len,y*=len,z*=len,s=Math.sin(rad),c=Math.cos(rad),t=1-c,out[0]=x*x*t+c,out[1]=y*x*t+z*s,out[2]=z*x*t-y*s,out[3]=0,out[4]=x*y*t-z*s,out[5]=y*y*t+c,out[6]=z*y*t+x*s,out[7]=0,out[8]=x*z*t+y*s,out[9]=y*z*t-x*s,out[10]=z*z*t+c,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out)},mat4.fromXRotation=function(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=c,out[6]=s,out[7]=0,out[8]=0,out[9]=-s,out[10]=c,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.fromYRotation=function(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=0,out[2]=-s,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=s,out[9]=0,out[10]=c,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.fromZRotation=function(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=s,out[2]=0,out[3]=0,out[4]=-s,out[5]=c,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.fromRotationTranslation=function(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-(yy+zz),out[1]=xy+wz,out[2]=xz-wy,out[3]=0,out[4]=xy-wz,out[5]=1-(xx+zz),out[6]=yz+wx,out[7]=0,out[8]=xz+wy,out[9]=yz-wx,out[10]=1-(xx+yy),out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out},mat4.getTranslation=function(out,mat){return out[0]=mat[12],out[1]=mat[13],out[2]=mat[14],out},mat4.getRotation=function(out,mat){var trace=mat[0]+mat[5]+mat[10],S=0;return trace>0?(S=2*Math.sqrt(trace+1),out[3]=.25*S,out[0]=(mat[6]-mat[9])/S,out[1]=(mat[8]-mat[2])/S,out[2]=(mat[1]-mat[4])/S):mat[0]>mat[5]&mat[0]>mat[10]?(S=2*Math.sqrt(1+mat[0]-mat[5]-mat[10]),out[3]=(mat[6]-mat[9])/S,out[0]=.25*S,out[1]=(mat[1]+mat[4])/S,out[2]=(mat[8]+mat[2])/S):mat[5]>mat[10]?(S=2*Math.sqrt(1+mat[5]-mat[0]-mat[10]),out[3]=(mat[8]-mat[2])/S,out[0]=(mat[1]+mat[4])/S,out[1]=.25*S,out[2]=(mat[6]+mat[9])/S):(S=2*Math.sqrt(1+mat[10]-mat[0]-mat[5]),out[3]=(mat[1]-mat[4])/S,out[0]=(mat[8]+mat[2])/S,out[1]=(mat[6]+mat[9])/S,out[2]=.25*S),out},mat4.fromRotationTranslationScale=function(out,q,v,s){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2,sx=s[0],sy=s[1],sz=s[2];return out[0]=(1-(yy+zz))*sx,out[1]=(xy+wz)*sx,out[2]=(xz-wy)*sx,out[3]=0,out[4]=(xy-wz)*sy,out[5]=(1-(xx+zz))*sy,out[6]=(yz+wx)*sy,out[7]=0,out[8]=(xz+wy)*sz,out[9]=(yz-wx)*sz,out[10]=(1-(xx+yy))*sz,out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out},mat4.fromRotationTranslationScaleOrigin=function(out,q,v,s,o){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2,sx=s[0],sy=s[1],sz=s[2],ox=o[0],oy=o[1],oz=o[2];return out[0]=(1-(yy+zz))*sx,out[1]=(xy+wz)*sx,out[2]=(xz-wy)*sx,out[3]=0,out[4]=(xy-wz)*sy,out[5]=(1-(xx+zz))*sy,out[6]=(yz+wx)*sy,out[7]=0,out[8]=(xz+wy)*sz,out[9]=(yz-wx)*sz,out[10]=(1-(xx+yy))*sz,out[11]=0,out[12]=v[0]+ox-(out[0]*ox+out[4]*oy+out[8]*oz),out[13]=v[1]+oy-(out[1]*ox+out[5]*oy+out[9]*oz),out[14]=v[2]+oz-(out[2]*ox+out[6]*oy+out[10]*oz),out[15]=1,out},mat4.fromQuat=function(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-yy-zz,out[1]=yx+wz,out[2]=zx-wy,out[3]=0,out[4]=yx-wz,out[5]=1-xx-zz,out[6]=zy+wx,out[7]=0,out[8]=zx+wy,out[9]=zy-wx,out[10]=1-xx-yy,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out},mat4.frustum=function(out,left,right,bottom,top,near,far){var rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);return out[0]=2*near*rl,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=2*near*tb,out[6]=0,out[7]=0,out[8]=(right+left)*rl,out[9]=(top+bottom)*tb,out[10]=(far+near)*nf,out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near*2*nf,out[15]=0,out},mat4.perspective=function(out,fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);return out[0]=f/aspect,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=f,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=(far+near)*nf,out[11]=-1,out[12]=0,out[13]=0,out[14]=2*far*near*nf,out[15]=0,out},mat4.perspectiveFromFieldOfView=function(out,fov,near,far){var upTan=Math.tan(fov.upDegrees*Math.PI/180),downTan=Math.tan(fov.downDegrees*Math.PI/180),leftTan=Math.tan(fov.leftDegrees*Math.PI/180),rightTan=Math.tan(fov.rightDegrees*Math.PI/180),xScale=2/(leftTan+rightTan),yScale=2/(upTan+downTan);return out[0]=xScale,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=yScale,out[6]=0,out[7]=0,out[8]=-((leftTan-rightTan)*xScale)*.5,out[9]=(upTan-downTan)*yScale*.5,out[10]=far/(near-far),out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near/(near-far),out[15]=0,out},mat4.ortho=function(out,left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);return out[0]=-2*lr,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=-2*bt,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=2*nf,out[11]=0,out[12]=(left+right)*lr,out[13]=(top+bottom)*bt,out[14]=(far+near)*nf,out[15]=1,out},mat4.lookAt=function(out,eye,center,up){var x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];return Math.abs(eyex-centerx)<glMatrix.EPSILON&&Math.abs(eyey-centery)<glMatrix.EPSILON&&Math.abs(eyez-centerz)<glMatrix.EPSILON?mat4.identity(out):(z0=eyex-centerx,z1=eyey-centery,z2=eyez-centerz,len=1/Math.sqrt(z0*z0+z1*z1+z2*z2),z0*=len,z1*=len,z2*=len,x0=upy*z2-upz*z1,x1=upz*z0-upx*z2,x2=upx*z1-upy*z0,len=Math.sqrt(x0*x0+x1*x1+x2*x2),len?(len=1/len,x0*=len,x1*=len,x2*=len):(x0=0,x1=0,x2=0),y0=z1*x2-z2*x1,y1=z2*x0-z0*x2,y2=z0*x1-z1*x0,len=Math.sqrt(y0*y0+y1*y1+y2*y2),len?(len=1/len,y0*=len,y1*=len,y2*=len):(y0=0,y1=0,y2=0),out[0]=x0,out[1]=y0,out[2]=z0,out[3]=0,out[4]=x1,out[5]=y1,out[6]=z1,out[7]=0,out[8]=x2,out[9]=y2,out[10]=z2,out[11]=0,out[12]=-(x0*eyex+x1*eyey+x2*eyez),out[13]=-(y0*eyex+y1*eyey+y2*eyez),out[14]=-(z0*eyex+z1*eyey+z2*eyez),out[15]=1,out)},mat4.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},mat4.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))},mat4.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out[4]=a[4]+b[4],out[5]=a[5]+b[5],out[6]=a[6]+b[6],out[7]=a[7]+b[7],out[8]=a[8]+b[8],out[9]=a[9]+b[9],out[10]=a[10]+b[10],out[11]=a[11]+b[11],out[12]=a[12]+b[12],out[13]=a[13]+b[13],out[14]=a[14]+b[14],out[15]=a[15]+b[15],out},mat4.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out[4]=a[4]-b[4],out[5]=a[5]-b[5],out[6]=a[6]-b[6],out[7]=a[7]-b[7],out[8]=a[8]-b[8],out[9]=a[9]-b[9],out[10]=a[10]-b[10],out[11]=a[11]-b[11],out[12]=a[12]-b[12],out[13]=a[13]-b[13],out[14]=a[14]-b[14],out[15]=a[15]-b[15],out},mat4.sub=mat4.subtract,mat4.multiplyScalar=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out[4]=a[4]*b,out[5]=a[5]*b,out[6]=a[6]*b,out[7]=a[7]*b,out[8]=a[8]*b,out[9]=a[9]*b,out[10]=a[10]*b,out[11]=a[11]*b,out[12]=a[12]*b,out[13]=a[13]*b,out[14]=a[14]*b,out[15]=a[15]*b,out},mat4.multiplyScalarAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out[4]=a[4]+b[4]*scale,out[5]=a[5]+b[5]*scale,out[6]=a[6]+b[6]*scale,out[7]=a[7]+b[7]*scale,out[8]=a[8]+b[8]*scale,out[9]=a[9]+b[9]*scale,out[10]=a[10]+b[10]*scale,out[11]=a[11]+b[11]*scale,out[12]=a[12]+b[12]*scale,out[13]=a[13]+b[13]*scale,out[14]=a[14]+b[14]*scale,out[15]=a[15]+b[15]*scale,out},mat4.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]},mat4.equals=function(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],a6=a[6],a7=a[7],a8=a[8],a9=a[9],a10=a[10],a11=a[11],a12=a[12],a13=a[13],a14=a[14],a15=a[15],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5],b6=b[6],b7=b[7],b8=b[8],b9=b[9],b10=b[10],b11=b[11],b12=b[12],b13=b[13],b14=b[14],b15=b[15];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=glMatrix.EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=glMatrix.EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))&&Math.abs(a4-b4)<=glMatrix.EPSILON*Math.max(1,Math.abs(a4),Math.abs(b4))&&Math.abs(a5-b5)<=glMatrix.EPSILON*Math.max(1,Math.abs(a5),Math.abs(b5))&&Math.abs(a6-b6)<=glMatrix.EPSILON*Math.max(1,Math.abs(a6),Math.abs(b6))&&Math.abs(a7-b7)<=glMatrix.EPSILON*Math.max(1,Math.abs(a7),Math.abs(b7))&&Math.abs(a8-b8)<=glMatrix.EPSILON*Math.max(1,Math.abs(a8),Math.abs(b8))&&Math.abs(a9-b9)<=glMatrix.EPSILON*Math.max(1,Math.abs(a9),Math.abs(b9))&&Math.abs(a10-b10)<=glMatrix.EPSILON*Math.max(1,Math.abs(a10),Math.abs(b10))&&Math.abs(a11-b11)<=glMatrix.EPSILON*Math.max(1,Math.abs(a11),Math.abs(b11))&&Math.abs(a12-b12)<=glMatrix.EPSILON*Math.max(1,Math.abs(a12),Math.abs(b12))&&Math.abs(a13-b13)<=glMatrix.EPSILON*Math.max(1,Math.abs(a13),Math.abs(b13))&&Math.abs(a14-b14)<=glMatrix.EPSILON*Math.max(1,Math.abs(a14),Math.abs(b14))&&Math.abs(a15-b15)<=glMatrix.EPSILON*Math.max(1,Math.abs(a15),Math.abs(b15))},module.exports=mat4},{"./common.js":5}],10:[function(require,module,exports){var glMatrix=require("./common.js"),mat3=require("./mat3.js"),vec3=require("./vec3.js"),vec4=require("./vec4.js"),quat={};quat.create=function(){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=0,out[1]=0,out[2]=0,out[3]=1,out},quat.rotationTo=function(){var tmpvec3=vec3.create(),xUnitVec3=vec3.fromValues(1,0,0),yUnitVec3=vec3.fromValues(0,1,0);return function(out,a,b){var dot=vec3.dot(a,b);return dot<-.999999?(vec3.cross(tmpvec3,xUnitVec3,a),vec3.length(tmpvec3)<1e-6&&vec3.cross(tmpvec3,yUnitVec3,a),vec3.normalize(tmpvec3,tmpvec3),quat.setAxisAngle(out,tmpvec3,Math.PI),out):dot>.999999?(out[0]=0,out[1]=0,out[2]=0,out[3]=1,out):(vec3.cross(tmpvec3,a,b),out[0]=tmpvec3[0],out[1]=tmpvec3[1],out[2]=tmpvec3[2],out[3]=1+dot,quat.normalize(out,out))}}(),quat.setAxes=function(){var matr=mat3.create();return function(out,view,right,up){return matr[0]=right[0],matr[3]=right[1],matr[6]=right[2],matr[1]=up[0],matr[4]=up[1],matr[7]=up[2],matr[2]=-view[0],matr[5]=-view[1],matr[8]=-view[2],quat.normalize(out,quat.fromMat3(out,matr))}}(),quat.clone=vec4.clone,quat.fromValues=vec4.fromValues,quat.copy=vec4.copy,quat.set=vec4.set,quat.identity=function(out){return out[0]=0,out[1]=0,out[2]=0,out[3]=1,out},quat.setAxisAngle=function(out,axis,rad){rad*=.5;var s=Math.sin(rad);return out[0]=s*axis[0],out[1]=s*axis[1],out[2]=s*axis[2],out[3]=Math.cos(rad),out},quat.getAxisAngle=function(out_axis,q){var rad=2*Math.acos(q[3]),s=Math.sin(rad/2);return 0!=s?(out_axis[0]=q[0]/s,out_axis[1]=q[1]/s,out_axis[2]=q[2]/s):(out_axis[0]=1,out_axis[1]=0,out_axis[2]=0),rad},quat.add=vec4.add,quat.multiply=function(out,a,b){var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];return out[0]=ax*bw+aw*bx+ay*bz-az*by,out[1]=ay*bw+aw*by+az*bx-ax*bz,out[2]=az*bw+aw*bz+ax*by-ay*bx,out[3]=aw*bw-ax*bx-ay*by-az*bz,out},quat.mul=quat.multiply,quat.scale=vec4.scale,quat.rotateX=function(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=Math.sin(rad),bw=Math.cos(rad);return out[0]=ax*bw+aw*bx,out[1]=ay*bw+az*bx,out[2]=az*bw-ay*bx,out[3]=aw*bw-ax*bx,out},quat.rotateY=function(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],by=Math.sin(rad),bw=Math.cos(rad);return out[0]=ax*bw-az*by,out[1]=ay*bw+aw*by,out[2]=az*bw+ax*by,out[3]=aw*bw-ay*by,out},quat.rotateZ=function(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bz=Math.sin(rad),bw=Math.cos(rad);return out[0]=ax*bw+ay*bz,out[1]=ay*bw-ax*bz,out[2]=az*bw+aw*bz,out[3]=aw*bw-az*bz,out},quat.calculateW=function(out,a){var x=a[0],y=a[1],z=a[2];return out[0]=x,out[1]=y,out[2]=z,out[3]=Math.sqrt(Math.abs(1-x*x-y*y-z*z)),out},quat.dot=vec4.dot,quat.lerp=vec4.lerp,quat.slerp=function(out,a,b,t){var omega,cosom,sinom,scale0,scale1,ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];return cosom=ax*bx+ay*by+az*bz+aw*bw,cosom<0&&(cosom=-cosom,bx=-bx,by=-by,bz=-bz,bw=-bw),1-cosom>1e-6?(omega=Math.acos(cosom),sinom=Math.sin(omega),scale0=Math.sin((1-t)*omega)/sinom,scale1=Math.sin(t*omega)/sinom):(scale0=1-t,scale1=t),out[0]=scale0*ax+scale1*bx,out[1]=scale0*ay+scale1*by,out[2]=scale0*az+scale1*bz,out[3]=scale0*aw+scale1*bw,out},quat.sqlerp=function(){var temp1=quat.create(),temp2=quat.create();return function(out,a,b,c,d,t){return quat.slerp(temp1,a,d,t),quat.slerp(temp2,b,c,t),quat.slerp(out,temp1,temp2,2*t*(1-t)),out}}(),quat.invert=function(out,a){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],dot=a0*a0+a1*a1+a2*a2+a3*a3,invDot=dot?1/dot:0;return out[0]=-a0*invDot,out[1]=-a1*invDot,out[2]=-a2*invDot,out[3]=a3*invDot,out},quat.conjugate=function(out,a){return out[0]=-a[0],out[1]=-a[1],out[2]=-a[2],out[3]=a[3],out},quat.length=vec4.length,quat.len=quat.length,quat.squaredLength=vec4.squaredLength,quat.sqrLen=quat.squaredLength,quat.normalize=vec4.normalize,quat.fromMat3=function(out,m){var fRoot,fTrace=m[0]+m[4]+m[8];if(fTrace>0)fRoot=Math.sqrt(fTrace+1),out[3]=.5*fRoot,fRoot=.5/fRoot,out[0]=(m[5]-m[7])*fRoot,out[1]=(m[6]-m[2])*fRoot,out[2]=(m[1]-m[3])*fRoot;else{var i=0;m[4]>m[0]&&(i=1),m[8]>m[3*i+i]&&(i=2);var j=(i+1)%3,k=(i+2)%3;fRoot=Math.sqrt(m[3*i+i]-m[3*j+j]-m[3*k+k]+1),out[i]=.5*fRoot,fRoot=.5/fRoot,out[3]=(m[3*j+k]-m[3*k+j])*fRoot,out[j]=(m[3*j+i]+m[3*i+j])*fRoot,out[k]=(m[3*k+i]+m[3*i+k])*fRoot}return out},quat.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},quat.exactEquals=vec4.exactEquals,quat.equals=vec4.equals,module.exports=quat},{"./common.js":5,"./mat3.js":8,"./vec3.js":12,"./vec4.js":13}],11:[function(require,module,exports){var glMatrix=require("./common.js"),vec2={};vec2.create=function(){var out=new glMatrix.ARRAY_TYPE(2);return out[0]=0,out[1]=0,out},vec2.clone=function(a){var out=new glMatrix.ARRAY_TYPE(2);return out[0]=a[0],out[1]=a[1],out},vec2.fromValues=function(x,y){var out=new glMatrix.ARRAY_TYPE(2);return out[0]=x,out[1]=y,out},vec2.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out},vec2.set=function(out,x,y){return out[0]=x,out[1]=y,out},vec2.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out},vec2.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out},vec2.sub=vec2.subtract,vec2.multiply=function(out,a,b){return out[0]=a[0]*b[0],out[1]=a[1]*b[1],out},vec2.mul=vec2.multiply,vec2.divide=function(out,a,b){return out[0]=a[0]/b[0],out[1]=a[1]/b[1],out},vec2.div=vec2.divide,vec2.ceil=function(out,a){return out[0]=Math.ceil(a[0]),out[1]=Math.ceil(a[1]),out},vec2.floor=function(out,a){return out[0]=Math.floor(a[0]),out[1]=Math.floor(a[1]),out},vec2.min=function(out,a,b){return out[0]=Math.min(a[0],b[0]),out[1]=Math.min(a[1],b[1]),out},vec2.max=function(out,a,b){return out[0]=Math.max(a[0],b[0]),out[1]=Math.max(a[1],b[1]),out},vec2.round=function(out,a){return out[0]=Math.round(a[0]),out[1]=Math.round(a[1]),out},vec2.scale=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out},vec2.scaleAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out},vec2.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1];return Math.sqrt(x*x+y*y)},vec2.dist=vec2.distance,vec2.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1];return x*x+y*y},vec2.sqrDist=vec2.squaredDistance,vec2.length=function(a){var x=a[0],y=a[1];return Math.sqrt(x*x+y*y)},vec2.len=vec2.length,vec2.squaredLength=function(a){var x=a[0],y=a[1];return x*x+y*y},vec2.sqrLen=vec2.squaredLength,vec2.negate=function(out,a){return out[0]=-a[0],out[1]=-a[1],out},vec2.inverse=function(out,a){return out[0]=1/a[0],out[1]=1/a[1],out},vec2.normalize=function(out,a){var x=a[0],y=a[1],len=x*x+y*y;return len>0&&(len=1/Math.sqrt(len),out[0]=a[0]*len,out[1]=a[1]*len),out},vec2.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]},vec2.cross=function(out,a,b){var z=a[0]*b[1]-a[1]*b[0];return out[0]=out[1]=0,out[2]=z,out},vec2.lerp=function(out,a,b,t){var ax=a[0],ay=a[1];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out},vec2.random=function(out,scale){scale=scale||1;var r=2*glMatrix.RANDOM()*Math.PI;return out[0]=Math.cos(r)*scale,out[1]=Math.sin(r)*scale,out},vec2.transformMat2=function(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[2]*y,out[1]=m[1]*x+m[3]*y,out},vec2.transformMat2d=function(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[2]*y+m[4],out[1]=m[1]*x+m[3]*y+m[5],out},vec2.transformMat3=function(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[3]*y+m[6],out[1]=m[1]*x+m[4]*y+m[7],out},vec2.transformMat4=function(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[4]*y+m[12],out[1]=m[1]*x+m[5]*y+m[13],out},vec2.forEach=function(){var vec=vec2.create();return function(a,stride,offset,count,fn,arg){var i,l;for(stride||(stride=2),offset||(offset=0),l=count?Math.min(count*stride+offset,a.length):a.length,i=offset;i<l;i+=stride)vec[0]=a[i],vec[1]=a[i+1],fn(vec,vec,arg),a[i]=vec[0],a[i+1]=vec[1];return a}}(),vec2.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},vec2.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]},vec2.equals=function(a,b){var a0=a[0],a1=a[1],b0=b[0],b1=b[1];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))},module.exports=vec2},{"./common.js":5}],12:[function(require,module,exports){var glMatrix=require("./common.js"),vec3={};vec3.create=function(){var out=new glMatrix.ARRAY_TYPE(3);return out[0]=0,out[1]=0,out[2]=0,out},vec3.clone=function(a){var out=new glMatrix.ARRAY_TYPE(3);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out},vec3.fromValues=function(x,y,z){var out=new glMatrix.ARRAY_TYPE(3);return out[0]=x,out[1]=y,out[2]=z,out},vec3.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out},vec3.set=function(out,x,y,z){return out[0]=x,out[1]=y,out[2]=z,out},vec3.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out},vec3.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out},vec3.sub=vec3.subtract,vec3.multiply=function(out,a,b){return out[0]=a[0]*b[0],out[1]=a[1]*b[1],out[2]=a[2]*b[2],out},vec3.mul=vec3.multiply,vec3.divide=function(out,a,b){return out[0]=a[0]/b[0],out[1]=a[1]/b[1],out[2]=a[2]/b[2],out},vec3.div=vec3.divide,vec3.ceil=function(out,a){return out[0]=Math.ceil(a[0]),out[1]=Math.ceil(a[1]),out[2]=Math.ceil(a[2]),out},vec3.floor=function(out,a){return out[0]=Math.floor(a[0]),out[1]=Math.floor(a[1]),out[2]=Math.floor(a[2]),out},vec3.min=function(out,a,b){return out[0]=Math.min(a[0],b[0]),out[1]=Math.min(a[1],b[1]),out[2]=Math.min(a[2],b[2]),out},vec3.max=function(out,a,b){return out[0]=Math.max(a[0],b[0]),out[1]=Math.max(a[1],b[1]),out[2]=Math.max(a[2],b[2]),out},vec3.round=function(out,a){return out[0]=Math.round(a[0]),out[1]=Math.round(a[1]),out[2]=Math.round(a[2]),out},vec3.scale=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out},vec3.scaleAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out},vec3.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2];return Math.sqrt(x*x+y*y+z*z)},vec3.dist=vec3.distance,vec3.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2];return x*x+y*y+z*z},vec3.sqrDist=vec3.squaredDistance,vec3.length=function(a){var x=a[0],y=a[1],z=a[2];return Math.sqrt(x*x+y*y+z*z)},vec3.len=vec3.length,vec3.squaredLength=function(a){var x=a[0],y=a[1],z=a[2];return x*x+y*y+z*z},vec3.sqrLen=vec3.squaredLength,vec3.negate=function(out,a){return out[0]=-a[0],out[1]=-a[1],out[2]=-a[2],out},vec3.inverse=function(out,a){return out[0]=1/a[0],out[1]=1/a[1],out[2]=1/a[2],out},vec3.normalize=function(out,a){var x=a[0],y=a[1],z=a[2],len=x*x+y*y+z*z;return len>0&&(len=1/Math.sqrt(len),out[0]=a[0]*len,out[1]=a[1]*len,out[2]=a[2]*len),out},vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},vec3.cross=function(out,a,b){var ax=a[0],ay=a[1],az=a[2],bx=b[0],by=b[1],bz=b[2];return out[0]=ay*bz-az*by,out[1]=az*bx-ax*bz,out[2]=ax*by-ay*bx,out},vec3.lerp=function(out,a,b,t){var ax=a[0],ay=a[1],az=a[2];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out[2]=az+t*(b[2]-az),out},vec3.hermite=function(out,a,b,c,d,t){var factorTimes2=t*t,factor1=factorTimes2*(2*t-3)+1,factor2=factorTimes2*(t-2)+t,factor3=factorTimes2*(t-1),factor4=factorTimes2*(3-2*t);return out[0]=a[0]*factor1+b[0]*factor2+c[0]*factor3+d[0]*factor4,out[1]=a[1]*factor1+b[1]*factor2+c[1]*factor3+d[1]*factor4,out[2]=a[2]*factor1+b[2]*factor2+c[2]*factor3+d[2]*factor4,out},vec3.bezier=function(out,a,b,c,d,t){var inverseFactor=1-t,inverseFactorTimesTwo=inverseFactor*inverseFactor,factorTimes2=t*t,factor1=inverseFactorTimesTwo*inverseFactor,factor2=3*t*inverseFactorTimesTwo,factor3=3*factorTimes2*inverseFactor,factor4=factorTimes2*t;return out[0]=a[0]*factor1+b[0]*factor2+c[0]*factor3+d[0]*factor4,out[1]=a[1]*factor1+b[1]*factor2+c[1]*factor3+d[1]*factor4,out[2]=a[2]*factor1+b[2]*factor2+c[2]*factor3+d[2]*factor4,out},vec3.random=function(out,scale){scale=scale||1;var r=2*glMatrix.RANDOM()*Math.PI,z=2*glMatrix.RANDOM()-1,zScale=Math.sqrt(1-z*z)*scale;return out[0]=Math.cos(r)*zScale,out[1]=Math.sin(r)*zScale,out[2]=z*scale,out},vec3.transformMat4=function(out,a,m){var x=a[0],y=a[1],z=a[2],w=m[3]*x+m[7]*y+m[11]*z+m[15];return w=w||1,out[0]=(m[0]*x+m[4]*y+m[8]*z+m[12])/w,out[1]=(m[1]*x+m[5]*y+m[9]*z+m[13])/w,out[2]=(m[2]*x+m[6]*y+m[10]*z+m[14])/w,out},vec3.transformMat3=function(out,a,m){var x=a[0],y=a[1],z=a[2];return out[0]=x*m[0]+y*m[3]+z*m[6],out[1]=x*m[1]+y*m[4]+z*m[7],out[2]=x*m[2]+y*m[5]+z*m[8],out},vec3.transformQuat=function(out,a,q){var x=a[0],y=a[1],z=a[2],qx=q[0],qy=q[1],qz=q[2],qw=q[3],ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;return out[0]=ix*qw+iw*-qx+iy*-qz-iz*-qy,out[1]=iy*qw+iw*-qy+iz*-qx-ix*-qz,out[2]=iz*qw+iw*-qz+ix*-qy-iy*-qx,out},vec3.rotateX=function(out,a,b,c){var p=[],r=[];return p[0]=a[0]-b[0],p[1]=a[1]-b[1],p[2]=a[2]-b[2],r[0]=p[0],r[1]=p[1]*Math.cos(c)-p[2]*Math.sin(c),r[2]=p[1]*Math.sin(c)+p[2]*Math.cos(c),out[0]=r[0]+b[0],out[1]=r[1]+b[1],out[2]=r[2]+b[2],out},vec3.rotateY=function(out,a,b,c){var p=[],r=[];return p[0]=a[0]-b[0],p[1]=a[1]-b[1],p[2]=a[2]-b[2],r[0]=p[2]*Math.sin(c)+p[0]*Math.cos(c),r[1]=p[1],r[2]=p[2]*Math.cos(c)-p[0]*Math.sin(c),out[0]=r[0]+b[0],out[1]=r[1]+b[1],out[2]=r[2]+b[2],out},vec3.rotateZ=function(out,a,b,c){var p=[],r=[];return p[0]=a[0]-b[0],p[1]=a[1]-b[1],p[2]=a[2]-b[2],r[0]=p[0]*Math.cos(c)-p[1]*Math.sin(c),r[1]=p[0]*Math.sin(c)+p[1]*Math.cos(c),r[2]=p[2],out[0]=r[0]+b[0],out[1]=r[1]+b[1],out[2]=r[2]+b[2],out},vec3.forEach=function(){var vec=vec3.create();return function(a,stride,offset,count,fn,arg){var i,l;for(stride||(stride=3),offset||(offset=0),l=count?Math.min(count*stride+offset,a.length):a.length,i=offset;i<l;i+=stride)vec[0]=a[i],vec[1]=a[i+1],vec[2]=a[i+2],fn(vec,vec,arg),a[i]=vec[0],a[i+1]=vec[1],a[i+2]=vec[2];return a}}(),vec3.angle=function(a,b){var tempA=vec3.fromValues(a[0],a[1],a[2]),tempB=vec3.fromValues(b[0],b[1],b[2]);vec3.normalize(tempA,tempA),vec3.normalize(tempB,tempB);var cosine=vec3.dot(tempA,tempB);return cosine>1?0:Math.acos(cosine)},vec3.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},vec3.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]},vec3.equals=function(a,b){var a0=a[0],a1=a[1],a2=a[2],b0=b[0],b1=b[1],b2=b[2];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=glMatrix.EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))},module.exports=vec3},{"./common.js":5}],13:[function(require,module,exports){var glMatrix=require("./common.js"),vec4={};vec4.create=function(){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=0,out[1]=0,out[2]=0,out[3]=0,out},vec4.clone=function(a){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out},vec4.fromValues=function(x,y,z,w){var out=new glMatrix.ARRAY_TYPE(4);return out[0]=x,out[1]=y,out[2]=z,out[3]=w,out},vec4.copy=function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out},vec4.set=function(out,x,y,z,w){return out[0]=x,out[1]=y,out[2]=z,out[3]=w,out},vec4.add=function(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out},vec4.subtract=function(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out},vec4.sub=vec4.subtract,vec4.multiply=function(out,a,b){return out[0]=a[0]*b[0],out[1]=a[1]*b[1],out[2]=a[2]*b[2],out[3]=a[3]*b[3],out},vec4.mul=vec4.multiply,vec4.divide=function(out,a,b){return out[0]=a[0]/b[0],out[1]=a[1]/b[1],out[2]=a[2]/b[2],out[3]=a[3]/b[3],out},vec4.div=vec4.divide,vec4.ceil=function(out,a){return out[0]=Math.ceil(a[0]),out[1]=Math.ceil(a[1]),out[2]=Math.ceil(a[2]),out[3]=Math.ceil(a[3]),out},vec4.floor=function(out,a){return out[0]=Math.floor(a[0]),out[1]=Math.floor(a[1]),out[2]=Math.floor(a[2]),out[3]=Math.floor(a[3]),out},vec4.min=function(out,a,b){return out[0]=Math.min(a[0],b[0]),out[1]=Math.min(a[1],b[1]),out[2]=Math.min(a[2],b[2]),out[3]=Math.min(a[3],b[3]),out},vec4.max=function(out,a,b){return out[0]=Math.max(a[0],b[0]),out[1]=Math.max(a[1],b[1]),out[2]=Math.max(a[2],b[2]),out[3]=Math.max(a[3],b[3]),out},vec4.round=function(out,a){return out[0]=Math.round(a[0]),out[1]=Math.round(a[1]),out[2]=Math.round(a[2]),out[3]=Math.round(a[3]),out},vec4.scale=function(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out},vec4.scaleAndAdd=function(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out},vec4.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2],w=b[3]-a[3];return Math.sqrt(x*x+y*y+z*z+w*w)},vec4.dist=vec4.distance,vec4.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2],w=b[3]-a[3];return x*x+y*y+z*z+w*w},vec4.sqrDist=vec4.squaredDistance,vec4.length=function(a){var x=a[0],y=a[1],z=a[2],w=a[3];return Math.sqrt(x*x+y*y+z*z+w*w)},vec4.len=vec4.length,vec4.squaredLength=function(a){var x=a[0],y=a[1],z=a[2],w=a[3];return x*x+y*y+z*z+w*w},vec4.sqrLen=vec4.squaredLength,vec4.negate=function(out,a){return out[0]=-a[0],out[1]=-a[1],out[2]=-a[2],out[3]=-a[3],out},vec4.inverse=function(out,a){return out[0]=1/a[0],out[1]=1/a[1],out[2]=1/a[2],out[3]=1/a[3],out},vec4.normalize=function(out,a){var x=a[0],y=a[1],z=a[2],w=a[3],len=x*x+y*y+z*z+w*w;return len>0&&(len=1/Math.sqrt(len),out[0]=x*len,out[1]=y*len,out[2]=z*len,out[3]=w*len),out},vec4.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},vec4.lerp=function(out,a,b,t){var ax=a[0],ay=a[1],az=a[2],aw=a[3];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out[2]=az+t*(b[2]-az),out[3]=aw+t*(b[3]-aw),out},vec4.random=function(out,scale){return scale=scale||1,out[0]=glMatrix.RANDOM(),out[1]=glMatrix.RANDOM(),out[2]=glMatrix.RANDOM(),out[3]=glMatrix.RANDOM(),vec4.normalize(out,out),vec4.scale(out,out,scale),out},vec4.transformMat4=function(out,a,m){var x=a[0],y=a[1],z=a[2],w=a[3];return out[0]=m[0]*x+m[4]*y+m[8]*z+m[12]*w,out[1]=m[1]*x+m[5]*y+m[9]*z+m[13]*w,out[2]=m[2]*x+m[6]*y+m[10]*z+m[14]*w,out[3]=m[3]*x+m[7]*y+m[11]*z+m[15]*w,out},vec4.transformQuat=function(out,a,q){var x=a[0],y=a[1],z=a[2],qx=q[0],qy=q[1],qz=q[2],qw=q[3],ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;return out[0]=ix*qw+iw*-qx+iy*-qz-iz*-qy,out[1]=iy*qw+iw*-qy+iz*-qx-ix*-qz,out[2]=iz*qw+iw*-qz+ix*-qy-iy*-qx,out[3]=a[3],out},vec4.forEach=function(){var vec=vec4.create();return function(a,stride,offset,count,fn,arg){var i,l;for(stride||(stride=4),offset||(offset=0),l=count?Math.min(count*stride+offset,a.length):a.length,i=offset;i<l;i+=stride)vec[0]=a[i],vec[1]=a[i+1],vec[2]=a[i+2],vec[3]=a[i+3],fn(vec,vec,arg),a[i]=vec[0],a[i+1]=vec[1],a[i+2]=vec[2],a[i+3]=vec[3];return a}}(),vec4.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},vec4.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]},vec4.equals=function(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return Math.abs(a0-b0)<=glMatrix.EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=glMatrix.EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=glMatrix.EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=glMatrix.EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))},module.exports=vec4},{"./common.js":5}],14:[function(require,module,exports){module.exports=function(strings){"string"==typeof strings&&(strings=[strings]);for(var exprs=[].slice.call(arguments,1),parts=[],i=0;i<strings.length-1;i++)parts.push(strings[i],exprs[i]||"");return parts.push(strings[i]),parts.join("")}},{}],15:[function(require,module,exports){(function(global){"use strict";function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length),that.__proto__=Buffer.prototype):(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){
if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?fromArrayBuffer(that,value,encodingOrOffset,length):"string"==typeof value?fromString(that,value,encodingOrOffset):fromObject(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromString(that,string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding);that=createBuffer(that,length);var actual=that.write(string,encoding);return actual!==length&&(that=that.slice(0,actual)),that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");return array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Buffer.TYPED_ARRAY_SUPPORT?(that=array,that.__proto__=Buffer.prototype):that=fromArrayLike(that,array),that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return that=createBuffer(that,len),0===that.length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||isnan(obj.length)?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(length){return+length!=length&&(length=0),Buffer.alloc(+length)}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if(end>>>=0,start>>>=0,end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128==(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!=0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isnan(val){return val!==val}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("isarray");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return alloc(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=this.subarray(start,end),newBuf.__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,byteLength|=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,byteLength|=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0);var i;if("number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:16,isarray:17}],16:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],17:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],18:[function(require,module,exports){!function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){"use strict";function DOMEval(code,doc){doc=doc||document;var script=doc.createElement("script");script.text=code,doc.head.appendChild(script).parentNode.removeChild(script)}function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);return"function"!==type&&!jQuery.isWindow(obj)&&("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj)}function winnow(elements,qualifier,not){return jQuery.isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){
return indexOf.call(qualifier,elem)>-1!==not}):risSimple.test(qualifier)?jQuery.filter(qualifier,elements,not):(qualifier=jQuery.filter(qualifier,elements),jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not&&1===elem.nodeType}))}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject){var method;try{value&&jQuery.isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&jQuery.isFunction(method=value.then)?method.call(value,resolve,reject):resolve.call(void 0,value)}catch(value){reject.call(void 0,value)}}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function Data(){this.expando=jQuery.expando+Data.uid++}function getData(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),"string"==typeof(data=elem.getAttribute(name))){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3],valueParts=valueParts||[],initialInUnit=+initial||1;do{scale=scale||".5",initialInUnit/=scale,jQuery.style(elem,prop,initialInUnit+unit)}while(scale!==(scale=currentValue()/initial)&&1!==scale&&--maxIterations)}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display||(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;index<length;index++)elem=elements[index],elem.style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}function getAll(context,tag){var ret;return ret=void 0!==context.getElementsByTagName?context.getElementsByTagName(tag||"*"):void 0!==context.querySelectorAll?context.querySelectorAll(tag||"*"):[],void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if((elem=elems[i])||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem:elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,""),doc))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name],""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),!support.pixelMarginRight()&&rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if((name=cssPrefixes[i]+capName)in emptyStyle)return name}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i,val=0;for(i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0;i<4;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var val,valueIsBorderBox=!0,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(elem.getClientRects().length&&(val=elem.getBoundingClientRect()[name]),val<=0||null==val){if(val=curCSS(elem,name,styles),(val<0||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function raf(){timerId&&(window.requestAnimationFrame(raf),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})}));for(prop in props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if((propTween=!jQuery.isEmptyObject(props))||!jQuery.isEmptyObject(orig)){isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],restoreDisplay=dataShow&&dataShow.display,null==restoreDisplay&&(restoreDisplay=dataPriv.get(elem,"display")),display=jQuery.css(elem,"display"),"none"===display&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1;for(prop in orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){hidden||showHide([elem]),dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),(hooks=jQuery.cssHooks[name])&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return jQuery.isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result)),result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function stripAndCollapse(value){return(value.match(rnothtmlwhite)||[]).join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(!(conv=converters[prev+" "+current]||converters["* "+current]))for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],document=window.document,getProto=Object.getPrototypeOf,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:"3.1.1",constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+("3.1.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},isPlainObject:function(obj){var proto,Ctor;return!(!obj||"[object Object]"!==toString.call(obj))&&(!(proto=getProto(obj))||"function"==typeof(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor)&&fnToString.call(Ctor)===ObjectFunctionString)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){DOMEval(code)},camelCase:function(string){return string.replace(/^-ms-/,"ms-").replace(/-([a-z])/g,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},trim:function(text){return null==text?"":(text+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)!callback(elems[i],i)!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)null!=(value=callback(elems[i],i,arg))&&ret.push(value);else for(i in elems)null!=(value=callback(elems[i],i,arg))&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},now:Date.now,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando),groups=tokenize(selector),i=groups.length;i--;)groups[i]="#"+nid+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled:"label"in elem&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""
})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"�":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return!0===elem.disabled&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=void 0!==elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return void 0!==context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(void 0!==context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=function(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(!(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector))||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&(this[0]=elem,this.length=1),this}return selector.nodeType?(this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this)}).prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==jQuery.type(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if((returned=handler.apply(that,args))===deferred.promise())throw new TypeError("Thenable self-resolution")
;then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,jQuery.isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,jQuery.isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,jQuery.isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,jQuery.isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[0][2].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject),"pending"===master.state()||jQuery.isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(!0===wait?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,!0!==wait&&--jQuery.readyWait>0||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[jQuery.camelCase(data)]=value;else for(prop in data)cache[jQuery.camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][jQuery.camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){jQuery.isArray(key)?key=key.map(jQuery.camelCase):(key=jQuery.camelCase(key),key=key in cache?[key]:key.match(rnothtmlwhite)||[]),i=key.length;for(;i--;)delete cache[key[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;if(elem&&void 0===value){if(void 0!==(data=dataUser.get(elem,key)))return data;if(void 0!==(data=dataAttr(elem,key)))return data}else this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)(tmp=dataPriv.get(elements[i],type+"queueHooks"))&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHiddenWithinTree=function(elem,el){return elem=el||elem,"none"===elem.style.display||""===elem.style.display&&jQuery.contains(elem.ownerDocument,elem)&&"none"===jQuery.css(elem,"display")},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},defaultDisplayMap={};jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,rscriptType=/^$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var documentElement=document.documentElement,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return void 0!==jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&!1!==special.setup.call(elem,data,namespaces,eventHandle)||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&!1!==special.teardown.call(elem,namespaces,elemData.handle)||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,event=jQuery.event.fix(nativeEvent),args=new Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||!1!==special.preDispatch.call(this,event)){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,void 0!==(ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args))&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matchedSelectors[sel]&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:jQuery.isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){manipulationTarget(this,elem).appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)};!function(){function computeStyleTests(){if(div){div.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",div.innerHTML="",documentElement.appendChild(container);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal="2px"===divStyle.marginLeft,boxSizingReliableVal="4px"===divStyle.width,div.style.marginRight="50%",pixelMarginRightVal="4px"===divStyle.marginRight,documentElement.removeChild(container),div=null}}var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",container.appendChild(div),jQuery.extend(support,{pixelPosition:function(){return computeStyleTests(),pixelPositionVal},boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelMarginRight:function(){return computeStyleTests(),pixelMarginRightVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal}}))}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];type=typeof value,"string"===type&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value===value&&("number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]=value))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,name,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)})},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles);return subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[name]=value,value=jQuery.css(elem,name)),setPositiveNumber(elem,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0)},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return jQuery.fx.off||document.hidden?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),null!=opt.queue&&!0!==opt.queue||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){
var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&!1!==type&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)(timer=timers[i])()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=window.requestAnimationFrame?window.requestAnimationFrame(raf):window.setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){window.cancelAnimationFrame?window.cancelAnimationFrame(timerId):window.clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return void 0===elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret))},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if("string"===type)for(i=0,self=jQuery(this),classNames=value.match(rnothtmlwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||(className=getClass(this),className&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||!1===value?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1)return!0;return!1}});jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),(hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()])&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()])&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(/\r/g,""):null==ret?"":ret)}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length;for(i=index<0?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"),handle&&handle.apply(cur,data),(handle=ontype&&cur[ontype])&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),support.focusin="onfocusin"in window,support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=jQuery.now(),rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=jQuery.isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(/\r?\n/g,"\r\n")}}):{name:elem.name,value:val.replace(/\r?\n/g,"\r\n")}}).get()}});var rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),(modified=jqXHR.getResponseHeader("etag"))&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(/^\/\//,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(/#.*$/,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(/%20/g,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(/([?&])_=[^&]*/,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce+++uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(jQuery.isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;return body.innerHTML="<form></form><form></form>",2===body.childNodes.length}(),jQuery.parseHTML=function(data,context,keepScripts){if("string"!=typeof data)return[];"boolean"==typeof context&&(keepScripts=context,context=!1);var base,parsed,scripts;return context||(support.createHTMLDocument?(context=document.implementation.createHTMLDocument(""),base=context.createElement("base"),base.href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,rect,doc,elem=this[0];if(elem)return elem.getClientRects().length?(rect=elem.getBoundingClientRect(),rect.width||rect.height?(doc=elem.ownerDocument,win=getWindow(doc),docElem=doc.documentElement,{top:rect.top+win.pageYOffset-docElem.clientTop,left:rect.left+win.pageXOffset-docElem.clientLeft}):rect):{top:0,left:0}},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset={top:parentOffset.top+jQuery.css(offsetParent[0],"borderTopWidth",!0),left:parentOffset.left+jQuery.css(offsetParent[0],"borderLeftWidth",!0)}),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem)
;if(void 0===val)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}}),jQuery.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery})},{}],19:[function(require,module,exports){!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("jquery")):factory(jQuery)}(function($,undefined){"use strict";function paletteTemplate(p,color,className,opts){for(var html=[],i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current),c=tiny.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(color,current)?" sp-thumb-active":"";var formattedString=tiny.toString(opts.preferredFormat||"rgb"),swatchStyle=rgbaSupport?"background-color:"+tiny.toRgbString():"filter:"+tiny.toFilter();html.push('<span title="'+formattedString+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>')}else{html.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",opts.noColorSelectedText)).html())}}return"<div class='sp-cf "+className+"'>"+html.join("")+"</div>"}function hideAll(){for(var i=0;i<spectrums.length;i++)spectrums[i]&&spectrums[i].hide()}function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);return opts.callbacks={move:bind(opts.move,callbackContext),change:bind(opts.change,callbackContext),show:bind(opts.show,callbackContext),hide:bind(opts.hide,callbackContext),beforeShow:bind(opts.beforeShow,callbackContext)},opts}function spectrum(element,o){function applyOptions(){if(opts.showPaletteOnly&&(opts.showPalette=!0),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),opts.palette){palette=opts.palette.slice(0),paletteArray=$.isArray(palette[0])?palette:[palette],paletteLookup={};for(var i=0;i<paletteArray.length;i++)for(var j=0;j<paletteArray[i].length;j++){var rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=!0}}container.toggleClass("sp-flat",flat),container.toggleClass("sp-input-disabled",!opts.showInput),container.toggleClass("sp-alpha-enabled",opts.showAlpha),container.toggleClass("sp-clear-enabled",allowEmpty),container.toggleClass("sp-buttons-disabled",!opts.showButtons),container.toggleClass("sp-palette-buttons-disabled",!opts.togglePaletteOnly),container.toggleClass("sp-palette-disabled",!opts.showPalette),container.toggleClass("sp-palette-only",opts.showPaletteOnly),container.toggleClass("sp-initial-disabled",!opts.showInitial),container.addClass(opts.className).addClass(opts.containerClassName),reflow()}function updateSelectionPaletteFromStorage(){if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");oldPalette.length>1&&(delete window.localStorage[localStorageKey],$.each(oldPalette,function(i,c){addColorToSelectionPalette(c)}))}catch(e){}try{selectionPalette=window.localStorage[localStorageKey].split(";")}catch(e){}}}function addColorToSelectionPalette(color){if(showSelectionPalette){var rgb=tinycolor(color).toRgbString();if(!paletteLookup[rgb]&&-1===$.inArray(rgb,selectionPalette))for(selectionPalette.push(rgb);selectionPalette.length>maxSelectionSize;)selectionPalette.shift();if(localStorageKey&&window.localStorage)try{window.localStorage[localStorageKey]=selectionPalette.join(";")}catch(e){}}}function getUniqueSelectionPalette(){var unique=[];if(opts.showPalette)for(var i=0;i<selectionPalette.length;i++){var rgb=tinycolor(selectionPalette[i]).toRgbString();paletteLookup[rgb]||unique.push(selectionPalette[i])}return unique.reverse().slice(0,opts.maxSelectionSize)}function drawPalette(){var currentColor=get(),html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i,opts)});updateSelectionPaletteFromStorage(),selectionPalette&&html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection",opts)),paletteContainer.html(html.join(""))}function drawInitial(){if(opts.showInitial){var initial=colorOnShow,current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial",opts))}}function dragStart(){(dragHeight<=0||dragWidth<=0||slideHeight<=0)&&reflow(),isDragging=!0,container.addClass(draggingClass),shiftMovementDirection=null,boundElement.trigger("dragstart.spectrum",[get()])}function dragStop(){isDragging=!1,container.removeClass(draggingClass),boundElement.trigger("dragstop.spectrum",[get()])}function setFromTextInput(){var value=textInput.val();if(null!==value&&""!==value||!allowEmpty){var tiny=tinycolor(value);tiny.isValid()?(set(tiny),updateOriginalInput(!0)):textInput.addClass("sp-validation-error")}else set(null),updateOriginalInput(!0)}function toggle(){visible?hide():show()}function show(){var event=$.Event("beforeShow.spectrum");if(visible)return void reflow();boundElement.trigger(event,[get()]),!1===callbacks.beforeShow(get())||event.isDefaultPrevented()||(hideAll(),visible=!0,$(doc).bind("keydown.spectrum",onkeydown),$(doc).bind("click.spectrum",clickout),$(window).bind("resize.spectrum",resize),replacer.addClass("sp-active"),container.removeClass("sp-hidden"),reflow(),updateUI(),colorOnShow=get(),drawInitial(),callbacks.show(colorOnShow),boundElement.trigger("show.spectrum",[colorOnShow]))}function onkeydown(e){27===e.keyCode&&hide()}function clickout(e){2!=e.button&&(isDragging||(clickoutFiresChange?updateOriginalInput(!0):revert(),hide()))}function hide(){visible&&!flat&&(visible=!1,$(doc).unbind("keydown.spectrum",onkeydown),$(doc).unbind("click.spectrum",clickout),$(window).unbind("resize.spectrum",resize),replacer.removeClass("sp-active"),container.addClass("sp-hidden"),callbacks.hide(get()),boundElement.trigger("hide.spectrum",[get()]))}function revert(){set(colorOnShow,!0)}function set(color,ignoreFormatChange){if(tinycolor.equals(color,get()))return void updateUI();var newColor,newHsv;!color&&allowEmpty?isEmpty=!0:(isEmpty=!1,newColor=tinycolor(color),newHsv=newColor.toHsv(),currentHue=newHsv.h%360/360,currentSaturation=newHsv.s,currentValue=newHsv.v,currentAlpha=newHsv.a),updateUI(),newColor&&newColor.isValid()&&!ignoreFormatChange&&(currentPreferredFormat=opts.preferredFormat||newColor.getFormat())}function get(opts){return opts=opts||{},allowEmpty&&isEmpty?null:tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(100*currentAlpha)/100},{format:opts.format||currentPreferredFormat})}function isValid(){return!textInput.hasClass("sp-validation-error")}function move(){updateUI(),callbacks.move(get()),boundElement.trigger("move.spectrum",[get()])}function updateUI(){textInput.removeClass("sp-validation-error"),updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;currentAlpha<1&&(0!==currentAlpha||"name"!==format)&&("hex"!==format&&"hex3"!==format&&"hex6"!==format&&"name"!==format||(format="rgb"));var realColor=get({format:format}),displayColor="";if(previewElement.removeClass("sp-clear-display"),previewElement.css("background-color","transparent"),!realColor&&allowEmpty)previewElement.addClass("sp-clear-display");else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||1===realColor.alpha?previewElement.css("background-color",realRgb):(previewElement.css("background-color","transparent"),previewElement.css("filter",realColor.toFilter())),opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString(),gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";IE?alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex)):(alphaSliderInner.css("background","-webkit-"+gradient),alphaSliderInner.css("background","-moz-"+gradient),alphaSliderInner.css("background","-ms-"+gradient),alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")"))}displayColor=realColor.toString(format)}opts.showInput&&textInput.val(displayColor),opts.showPalette&&drawPalette(),drawInitial()}function updateHelperLocations(){var s=currentSaturation,v=currentValue;if(allowEmpty&&isEmpty)alphaSlideHelper.hide(),slideHelper.hide(),dragHelper.hide();else{alphaSlideHelper.show(),slideHelper.show(),dragHelper.show();var dragX=s*dragWidth,dragY=dragHeight-v*dragHeight;dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight)),dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight)),dragHelper.css({top:dragY+"px",left:dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({left:alphaX-alphaSlideHelperWidth/2+"px"});var slideY=currentHue*slideHeight;slideHelper.css({top:slideY-slideHelperHeight+"px"})}}function updateOriginalInput(fireCallback){var color=get(),displayColor="",hasChanged=!tinycolor.equals(color,colorOnShow);color&&(displayColor=color.toString(currentPreferredFormat),addColorToSelectionPalette(color)),isInput&&boundElement.val(displayColor),fireCallback&&hasChanged&&(callbacks.change(color),boundElement.trigger("change",[color]))}function reflow(){visible&&(dragWidth=dragger.width(),dragHeight=dragger.height(),dragHelperHeight=dragHelper.height(),slideWidth=slider.width(),slideHeight=slider.height(),slideHelperHeight=slideHelper.height(),alphaWidth=alphaSlider.width(),alphaSlideHelperWidth=alphaSlideHelper.width(),flat||(container.css("position","absolute"),opts.offset?container.offset(opts.offset):container.offset(getOffset(container,offsetElement))),updateHelperLocations(),opts.showPalette&&drawPalette(),boundElement.trigger("reflow.spectrum"))}function destroy(){boundElement.show(),offsetElement.unbind("click.spectrum touchstart.spectrum"),container.remove(),replacer.remove(),spectrums[spect.id]=null}function option(optionName,optionValue){return optionName===undefined?$.extend({},opts):optionValue===undefined?opts[optionName]:(opts[optionName]=optionValue,"preferredFormat"===optionName&&(currentPreferredFormat=opts.preferredFormat),void applyOptions())}function enable(){disabled=!1,boundElement.attr("disabled",!1),offsetElement.removeClass("sp-disabled")}function disable(){hide(),disabled=!0,boundElement.attr("disabled",!0),offsetElement.addClass("sp-disabled")}function setOffset(coord){opts.offset=coord,reflow()}var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=!1,isDragging=!1,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],paletteLookup={},selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null,doc=element.ownerDocument,boundElement=(doc.body,$(element)),disabled=!1,container=$(markup,doc).addClass(theme),pickerContainer=container.find(".sp-picker-container"),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),toggleButton=container.find(".sp-palette-toggle"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&"color"===boundElement.attr("type")&&inputTypeColorSupport(),shouldReplace=isInput&&!flat,replacer=shouldReplace?$(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName):$([]),offsetElement=shouldReplace?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||isInput&&boundElement.val(),colorOnShow=!1,currentPreferredFormat=opts.preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;!function(){function paletteElementClick(e){return e.data&&e.data.ignore?(set($(e.target).closest(".sp-thumb-el").data("color")),move()):(set($(e.target).closest(".sp-thumb-el").data("color")),move(),updateOriginalInput(!0),opts.hideAfterPaletteSelect&&hide()),!1}if(IE&&container.find("*:not(input)").attr("unselectable","on"),applyOptions(),shouldReplace&&boundElement.after(replacer).hide(),allowEmpty||clearButton.hide(),flat)boundElement.after(container).hide();else{var appendTo="parent"===opts.appendTo?boundElement.parent():$(opts.appendTo);1!==appendTo.length&&(appendTo=$("body")),appendTo.append(container)}updateSelectionPaletteFromStorage(),offsetElement.bind("click.spectrum touchstart.spectrum",function(e){disabled||toggle(),e.stopPropagation(),$(e.target).is("input")||e.preventDefault()}),(boundElement.is(":disabled")||!0===opts.disabled)&&disable(),container.click(stopPropagation),textInput.change(setFromTextInput),textInput.bind("paste",function(){setTimeout(setFromTextInput,1)}),textInput.keydown(function(e){13==e.keyCode&&setFromTextInput()}),cancelButton.text(opts.cancelText),cancelButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),revert(),hide()}),clearButton.attr("title",opts.clearText),clearButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isEmpty=!0,move(),flat&&updateOriginalInput(!0)}),chooseButton.text(opts.chooseText),chooseButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),IE&&textInput.is(":focus")&&textInput.trigger("change"),isValid()&&(updateOriginalInput(!0),hide())}),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),toggleButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),opts.showPaletteOnly=!opts.showPaletteOnly,opts.showPaletteOnly||flat||container.css("left","-="+(pickerContainer.outerWidth(!0)+5)),applyOptions()}),draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=dragX/alphaWidth,isEmpty=!1,e.shiftKey&&(currentAlpha=Math.round(10*currentAlpha)/10),move()},dragStart,dragStop),draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),draggable(dragger,function(dragX,dragY,e){if(e.shiftKey){if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth,oldDragY=dragHeight-currentValue*dragHeight,furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y"}}else shiftMovementDirection=null;var setSaturation=!shiftMovementDirection||"x"===shiftMovementDirection,setValue=!shiftMovementDirection||"y"===shiftMovementDirection;setSaturation&&(currentSaturation=parseFloat(dragX/dragWidth)),setValue&&(currentValue=parseFloat((dragHeight-dragY)/dragHeight)),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),initialColor?(set(initialColor),updateUI(),currentPreferredFormat=opts.preferredFormat||tinycolor(initialColor).format,addColorToSelectionPalette(initialColor)):updateUI(),flat&&show();var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,paletteElementClick),initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:!0},paletteElementClick)}();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,offset:setOffset,set:function(c){set(c),updateOriginalInput()},get:get,destroy:destroy,container:container};return spect.id=spectrums.push(spect)-1,spect}function getOffset(picker,input){var dpWidth=picker.outerWidth(),dpHeight=picker.outerHeight(),inputHeight=input.outerHeight(),doc=picker[0].ownerDocument,docElem=doc.documentElement,viewWidth=docElem.clientWidth+$(doc).scrollLeft(),viewHeight=docElem.clientHeight+$(doc).scrollTop(),offset=input.offset();return offset.top+=inputHeight,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight-0):0),offset}function noop(){}function stopPropagation(e){e.stopPropagation()}function bind(func,obj){var slice=Array.prototype.slice,args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}}function draggable(element,onmove,onstart,onstop){function prevent(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function move(e){if(dragging){if(IE&&doc.documentMode<9&&!e.button)return stop();var t0=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0],pageX=t0&&t0.pageX||e.pageX,pageY=t0&&t0.pageY||e.pageY,dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth)),dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));hasTouch&&prevent(e),onmove.apply(element,[dragX,dragY,e])}}function start(e){(e.which?3==e.which:2==e.button)||dragging||!1!==onstart.apply(element,arguments)&&(dragging=!0,maxHeight=$(element).height(),maxWidth=$(element).width(),offset=$(element).offset(),$(doc).bind(duringDragEvents),$(doc.body).addClass("sp-dragging"),move(e),prevent(e))}function stop(){dragging&&($(doc).unbind(duringDragEvents),$(doc.body).removeClass("sp-dragging"),setTimeout(function(){onstop.apply(element,arguments)},0)),dragging=!1}onmove=onmove||function(){},onstart=onstart||function(){},onstop=onstop||function(){};var doc=document,dragging=!1,offset={},maxHeight=0,maxWidth=0,hasTouch="ontouchstart"in window,duringDragEvents={};duringDragEvents.selectstart=prevent,duringDragEvents.dragstart=prevent,duringDragEvents["touchmove mousemove"]=move,duringDragEvents["touchend mouseup"]=stop,$(element).bind("touchstart mousedown",start)}function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments,throttler=function(){timeout=null,func.apply(context,args)};debounce&&clearTimeout(timeout),!debounce&&timeout||(timeout=setTimeout(throttler,wait))}}function inputTypeColorSupport(){return $.fn.spectrum.inputTypeColorSupport()}var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=function(){function contains(str,substr){return!!~(""+str).indexOf(substr)}var elem=document.createElement("div"),style=elem.style;return style.cssText="background-color:rgba(0,0,0,.5)",contains(style.backgroundColor,"rgba")||contains(style.backgroundColor,"hsla")}(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),markup=function(){var gradientFix="";if(IE)for(var i=1;i<=6;i++)gradientFix+="<div class='sp-"+i+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();$.fn.spectrum=function(opts,extra){if("string"==typeof opts){var returnValue=this,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var spect=spectrums[$(this).data("spectrum.id")];if(spect){var method=spect[opts];if(!method)throw new Error("Spectrum: no such method: '"+opts+"'");"get"==opts?returnValue=spect.get():"container"==opts?returnValue=spect.container:"option"==opts?returnValue=spect.option.apply(spect,args):"destroy"==opts?(spect.destroy(),$(this).removeData("spectrum.id")):method.apply(spect,args)}}),returnValue}return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data()),spect=spectrum(this,options);$(this).data("spectrum.id",spect.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=draggable,$.fn.spectrum.defaults=defaultOpts,$.fn.spectrum.inputTypeColorSupport=function inputTypeColorSupport(){if(void 0===inputTypeColorSupport._cachedResult){var colorInput=$("<input type='color'/>")[0];inputTypeColorSupport._cachedResult="color"===colorInput.type&&""!==colorInput.value}return inputTypeColorSupport._cachedResult},$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){var colorInputs=$("input[type=color]");colorInputs.length&&!inputTypeColorSupport()&&colorInputs.spectrum({preferredFormat:"hex6"})},function(){function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")?(color.s=convertToPercentage(color.s),color.v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,color.s,color.v),ok=!0,format="hsv"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")&&(color.s=convertToPercentage(color.s),color.l=convertToPercentage(color.l),rgb=hslToRgb(color.h,color.s,color.l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6;return{r:255*[v,q,p,p,t,v][mod],g:255*[t,v,v,q,p,p][mod],b:255*[p,p,t,v,v,q][mod]}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a){return[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))].join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(-amount/100*255))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(-amount/100*255))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(-amount/100*255))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(mathRound(hsl.h)+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:!!(match=matchers.hex3.exec(color))&&{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}}var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random,tinycolor=function(color,opts){if(color=color||"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),
this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){secondHex8String=tinycolor(secondColor).toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0;return formatSet||!hasAlpha||"hex"!==format&&"hex6"!==format&&"hex3"!==format&&"name"!==format?("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString()):"name"===format&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var w1,rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,w=2*p-1,a=rgb2.a-rgb1.a;w1=w*a==-1?w:(w+a)/(1+w*a),w1=(w1+1)/2;var w2=1-w1,rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2),rgb1=c1.toRgb(),rgb2=c2.toRgb(),brightnessA=c1.getBrightness(),brightnessB=c2.getBrightness(),colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}},tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500},tinycolor.mostReadable=function(baseColor,colorList){for(var bestColor=null,bestScore=0,bestIsReadable=!1,i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]),readable=readability.brightness>125&&readability.color>500,score=readability.brightness/125*3+readability.color/500;(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore)&&(bestIsReadable=readable,bestScore=score,bestColor=tinycolor(colorList[i]))}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=function(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}(names),matchers=function(){var CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=tinycolor}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})})},{jquery:18}],20:[function(require,module,exports){!function(Math){function tinycolor(color,opts){if(color=color||"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++}function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,s=null,v=null,l=null,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(isValidCSSUnit(color.r)&&isValidCSSUnit(color.g)&&isValidCSSUnit(color.b)?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.v)?(s=convertToPercentage(color.s),v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,s,v),ok=!0,format="hsv"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.l)&&(s=convertToPercentage(color.s),l=convertToPercentage(color.l),rgb=hslToRgb(color.h,s,l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=Math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6;return{r:255*[v,q,p,p,t,v][mod],g:255*[t,v,v,q,p,p][mod],b:255*[p,p,t,v,v,q][mod]}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a,allow4Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16)),pad2(convertDecimalToHex(a))];return allow4Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)&&hex[3].charAt(0)==hex[3].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0)+hex[3].charAt(0):hex.join("")}function rgbaToArgbHex(r,g,b,a){return[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))].join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(-amount/100*255))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(-amount/100*255))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(-amount/100*255))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(hsl.h+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),Math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function isValidCSSUnit(color){return!!matchers.CSS_UNIT.exec(color)}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),a:convertHexToDecimal(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:(match=matchers.hex4.exec(color))?{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),a:convertHexToDecimal(match[4]+""+match[4]),format:named?"name":"hex8"}:!!(match=matchers.hex3.exec(color))&&{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}}function validateWCAG2Parms(parms){var level,size;return parms=parms||{level:"AA",size:"small"},level=(parms.level||"AA").toUpperCase(),size=(parms.size||"small").toLowerCase(),"AA"!==level&&"AAA"!==level&&(level="AA"),"small"!==size&&"large"!==size&&(size="small"),{level:level,size:size}}var trimLeft=/^\s+/,trimRight=/\s+$/,tinyCounter=0,mathRound=Math.round,mathMin=Math.min,mathMax=Math.max,mathRandom=Math.random;tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},getLuminance:function(){var RsRGB,GsRGB,BsRGB,R,G,B,rgb=this.toRgb();return RsRGB=rgb.r/255,GsRGB=rgb.g/255,BsRGB=rgb.b/255,R=RsRGB<=.03928?RsRGB/12.92:Math.pow((RsRGB+.055)/1.055,2.4),G=GsRGB<=.03928?GsRGB/12.92:Math.pow((GsRGB+.055)/1.055,2.4),B=BsRGB<=.03928?BsRGB/12.92:Math.pow((BsRGB+.055)/1.055,2.4),.2126*R+.7152*G+.0722*B},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(allow4Char){return rgbaToHex(this._r,this._g,this._b,this._a,allow4Char)},toHex8String:function(allow4Char){return"#"+this.toHex8(allow4Char)},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(secondColor){var hex8String="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String="#"+rgbaToArgbHex(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0;return formatSet||!hasAlpha||"hex"!==format&&"hex6"!==format&&"hex3"!==format&&"hex4"!==format&&"hex8"!==format&&"name"!==format?("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex4"===format&&(formattedString=this.toHex8String(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString()):"name"===format&&0===this._a?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100;return tinycolor({r:(rgb2.r-rgb1.r)*p+rgb1.r,g:(rgb2.g-rgb1.g)*p+rgb1.g,b:(rgb2.b-rgb1.b)*p+rgb1.b,a:(rgb2.a-rgb1.a)*p+rgb1.a})},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2);return(Math.max(c1.getLuminance(),c2.getLuminance())+.05)/(Math.min(c1.getLuminance(),c2.getLuminance())+.05)},tinycolor.isReadable=function(color1,color2,wcag2){var wcag2Parms,out,readability=tinycolor.readability(color1,color2);switch(out=!1,wcag2Parms=validateWCAG2Parms(wcag2),wcag2Parms.level+wcag2Parms.size){case"AAsmall":case"AAAlarge":out=readability>=4.5;break;case"AAlarge":out=readability>=3;break;case"AAAsmall":out=readability>=7}return out},tinycolor.mostReadable=function(baseColor,colorList,args){var readability,includeFallbackColors,level,size,bestColor=null,bestScore=0;args=args||{},includeFallbackColors=args.includeFallbackColors,level=args.level,size=args.size;for(var i=0;i<colorList.length;i++)(readability=tinycolor.readability(baseColor,colorList[i]))>bestScore&&(bestScore=readability,bestColor=tinycolor(colorList[i]));return tinycolor.isReadable(baseColor,bestColor,{level:level,size:size})||!includeFallbackColors?bestColor:(args.includeFallbackColors=!1,tinycolor.mostReadable(baseColor,["#fff","#000"],args))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=function(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}(names),matchers=function(){var CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();void 0!==module&&module.exports?module.exports=tinycolor:"function"==typeof define&&define.amd?define(function(){return tinycolor}):window.tinycolor=tinycolor}(Math)},{}],21:[function(require,module,exports){!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.twgl=factory():root.twgl=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1),__webpack_require__(10),__webpack_require__(11),__webpack_require__(12)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(twgl,m4,v3,primitives){"use strict";return twgl.m4=m4,twgl.v3=v3,twgl.primitives=primitives,twgl}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__
;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(2),__webpack_require__(5),__webpack_require__(7),__webpack_require__(6),__webpack_require__(8),__webpack_require__(3),__webpack_require__(9),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(attributes,draw,framebuffers,programs,textures,typedArrays,vertexArrays,utils){"use strict";function setDefaults(newDefaults){utils.copyExistingProperties(newDefaults,defaults),attributes.setDefaults_(newDefaults),textures.setDefaults_(newDefaults)}function addVertexArrayObjectSupport(gl){if(gl&&defaults.enableVertexArrayObjects&&utils.isWebGL1(gl)){var ext=gl.getExtension("OES_vertex_array_object");ext&&(gl.createVertexArray=function(){return ext.createVertexArrayOES()},gl.deleteVertexArray=function(v){ext.deleteVertexArrayOES(v)},gl.isVertexArray=function(v){return ext.isVertexArrayOES(v)},gl.bindVertexArray=function(v){ext.bindVertexArrayOES(v)},gl.VERTEX_ARRAY_BINDING=ext.VERTEX_ARRAY_BINDING_OES)}}function create3DContext(canvas,opt_attribs){for(var names=["webgl","experimental-webgl"],context=null,ii=0;ii<names.length&&!(context=canvas.getContext(names[ii],opt_attribs));++ii);return context}function getWebGLContext(canvas,opt_attribs){var gl=create3DContext(canvas,opt_attribs);return addVertexArrayObjectSupport(gl),gl}function createContext(canvas,opt_attribs){for(var names=["webgl2","webgl","experimental-webgl"],context=null,ii=0;ii<names.length&&!(context=canvas.getContext(names[ii],opt_attribs));++ii);return context}function getContext(canvas,opt_attribs){var gl=createContext(canvas,opt_attribs);return addVertexArrayObjectSupport(gl),gl}function resizeCanvasToDisplaySize(canvas,multiplier){multiplier=multiplier||1,multiplier=Math.max(1,multiplier);var width=canvas.clientWidth*multiplier|0,height=canvas.clientHeight*multiplier|0;return(canvas.width!==width||canvas.height!==height)&&(canvas.width=width,canvas.height=height,!0)}function notPrivate(name){return"_"!==name[name.length-1]}function copyPublicProperties(src,dst){return Object.keys(src).filter(notPrivate).forEach(function(key){dst[key]=src[key]}),dst}var defaults={enableVertexArrayObjects:!0},api={getContext:getContext,getWebGLContext:getWebGLContext,isWebGL1:utils.isWebGL1,isWebGL2:utils.isWebGL2,resizeCanvasToDisplaySize:resizeCanvasToDisplaySize,setDefaults:setDefaults},apis={attributes:attributes,draw:draw,framebuffers:framebuffers,programs:programs,textures:textures,typedArrays:typedArrays,vertexArrays:vertexArrays};return Object.keys(apis).forEach(function(name){var srcApi=apis[name];copyPublicProperties(srcApi,api),api[name]=copyPublicProperties(srcApi,{})}),api}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(3),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(typedArrays,utils){"use strict";function setAttributePrefix(prefix){defaults.attribPrefix=prefix}function setDefaults(newDefaults){utils.copyExistingProperties(newDefaults,defaults)}function setBufferFromTypedArray(gl,type,buffer,array,drawType){gl.bindBuffer(type,buffer),gl.bufferData(type,array,drawType||gl.STATIC_DRAW)}function createBufferFromTypedArray(gl,typedArray,type,drawType){if(typedArray instanceof WebGLBuffer)return typedArray;type=type||gl.ARRAY_BUFFER;var buffer=gl.createBuffer();return setBufferFromTypedArray(gl,type,buffer,typedArray,drawType),buffer}function isIndices(name){return"indices"===name}function getNormalizationForTypedArray(typedArray){return typedArray instanceof Int8Array||typedArray instanceof Uint8Array}function getNormalizationForTypedArrayType(typedArrayType){return typedArrayType===Int8Array||typedArrayType===Uint8Array}function getArray(array){return array.length?array:array.data}function guessNumComponentsFromName(name,length){var numComponents;if(numComponents=texcoordRE.test(name)?2:colorRE.test(name)?4:3,length%numComponents>0)throw"Can not guess numComponents for attribute '"+name+"'. Tried "+numComponents+" but "+length+" values is not evenly divisible by "+numComponents+". You should specify it.";return numComponents}function getNumComponents(array,arrayName){return array.numComponents||array.size||guessNumComponentsFromName(arrayName,getArray(array).length)}function makeTypedArray(array,name){if(typedArrays.isArrayBuffer(array))return array;if(typedArrays.isArrayBuffer(array.data))return array.data;Array.isArray(array)&&(array={data:array});var Type=array.type;return Type||(Type=isIndices(name)?Uint16Array:Float32Array),new Type(array.data)}function createAttribsFromArrays(gl,arrays){var attribs={};return Object.keys(arrays).forEach(function(arrayName){if(!isIndices(arrayName)){var buffer,type,normalization,numComponents,numValues,array=arrays[arrayName],attribName=array.attrib||array.name||array.attribName||defaults.attribPrefix+arrayName;if("number"==typeof array||"number"==typeof array.data){numValues=array.data||array;var arrayType=array.type||Float32Array,numBytes=numValues*arrayType.BYTES_PER_ELEMENT;type=typedArrays.getGLTypeForTypedArrayType(arrayType),normalization=void 0!==array.normalize?array.normalize:getNormalizationForTypedArrayType(arrayType),numComponents=array.numComponents||array.size||guessNumComponentsFromName(arrayName,numValues),buffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,buffer),gl.bufferData(gl.ARRAY_BUFFER,numBytes,array.drawType||gl.STATIC_DRAW)}else{var typedArray=makeTypedArray(array,arrayName);buffer=createBufferFromTypedArray(gl,typedArray,void 0,array.drawType),type=typedArrays.getGLTypeForTypedArray(typedArray),normalization=void 0!==array.normalize?array.normalize:getNormalizationForTypedArray(typedArray),numComponents=getNumComponents(array,arrayName),numValues=typedArray.length}attribs[attribName]={buffer:buffer,numComponents:numComponents,type:type,normalize:normalization,stride:array.stride||0,offset:array.offset||0,drawType:array.drawType}}}),gl.bindBuffer(gl.ARRAY_BUFFER,null),attribs}function setAttribInfoBufferFromArray(gl,attribInfo,array,offset){array=makeTypedArray(array),void 0!==offset?(gl.bindBuffer(gl.ARRAY_BUFFER,attribInfo.buffer),gl.bufferSubData(gl.ARRAY_BUFFER,offset,array)):setBufferFromTypedArray(gl,gl.ARRAY_BUFFER,attribInfo.buffer,array,attribInfo.drawType)}function getBytesPerValueForGLType(gl,type){return type===gl.BYTE?1:type===gl.UNSIGNED_BYTE?1:type===gl.SHORT?2:type===gl.UNSIGNED_SHORT?2:type===gl.INT?4:type===gl.UNSIGNED_INT?4:type===gl.FLOAT?4:0}function getNumElementsFromNonIndexedArrays(arrays){for(var key,ii=0;ii<positionKeys.length&&!((key=positionKeys[ii])in arrays);++ii);ii===positionKeys.length&&(key=Object.keys(arrays)[0]);var array=arrays[key],length=getArray(array).length,numComponents=getNumComponents(array,key),numElements=length/numComponents;if(length%numComponents>0)throw"numComponents "+numComponents+" not correct for length "+length;return numElements}function getNumElementsFromAttributes(gl,attribs){for(var key,ii=0;ii<positionKeys.length&&!((key=positionKeys[ii])in attribs)&&!((key=defaults.attribPrefix+key)in attribs);++ii);ii===positionKeys.length&&(key=Object.keys(attribs)[0]);var attrib=attribs[key];gl.bindBuffer(gl.ARRAY_BUFFER,attrib.buffer);var numBytes=gl.getBufferParameter(gl.ARRAY_BUFFER,gl.BUFFER_SIZE);gl.bindBuffer(gl.ARRAY_BUFFER,null);var bytesPerValue=getBytesPerValueForGLType(gl,attrib.type),totalElements=numBytes/bytesPerValue,numComponents=attrib.numComponents||attrib.size,numElements=totalElements/numComponents;if(numElements%1!=0)throw"numComponents "+numComponents+" not correct for length "+length;return numElements}function createBufferInfoFromArrays(gl,arrays){var bufferInfo={attribs:createAttribsFromArrays(gl,arrays)},indices=arrays.indices;return indices?(indices=makeTypedArray(indices,"indices"),bufferInfo.indices=createBufferFromTypedArray(gl,indices,gl.ELEMENT_ARRAY_BUFFER),bufferInfo.numElements=indices.length,bufferInfo.elementType=typedArrays.getGLTypeForTypedArray(indices)):bufferInfo.numElements=getNumElementsFromAttributes(gl,bufferInfo.attribs),bufferInfo}function createBufferFromArray(gl,array,arrayName){var type="indices"===arrayName?gl.ELEMENT_ARRAY_BUFFER:gl.ARRAY_BUFFER;return createBufferFromTypedArray(gl,makeTypedArray(array,arrayName),type)}function createBuffersFromArrays(gl,arrays){var buffers={};return Object.keys(arrays).forEach(function(key){buffers[key]=createBufferFromArray(gl,arrays[key],key)}),arrays.indices?(buffers.numElements=arrays.indices.length,buffers.elementType=typedArrays.getGLTypeForTypedArray(makeTypedArray(arrays.indices),"indices")):buffers.numElements=getNumElementsFromNonIndexedArrays(arrays),buffers}var defaults={attribPrefix:""},texcoordRE=/coord|texture/i,colorRE=/color|colour/i,positionKeys=["position","positions","a_position"];return{createAttribsFromArrays:createAttribsFromArrays,createBuffersFromArrays:createBuffersFromArrays,createBufferFromArray:createBufferFromArray,createBufferFromTypedArray:createBufferFromTypedArray,createBufferInfoFromArrays:createBufferInfoFromArrays,setAttribInfoBufferFromArray:setAttribInfoBufferFromArray,setAttributePrefix:setAttributePrefix,setDefaults_:setDefaults,getNumComponents_:getNumComponents,getArray_:getArray}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){"use strict";function getGLTypeForTypedArray(typedArray){if(typedArray instanceof Int8Array)return BYTE;if(typedArray instanceof Uint8Array)return UNSIGNED_BYTE;if(typedArray instanceof Uint8ClampedArray)return UNSIGNED_BYTE;if(typedArray instanceof Int16Array)return SHORT;if(typedArray instanceof Uint16Array)return UNSIGNED_SHORT;if(typedArray instanceof Int32Array)return INT;if(typedArray instanceof Uint32Array)return UNSIGNED_INT;if(typedArray instanceof Float32Array)return FLOAT;throw"unsupported typed array type"}function getGLTypeForTypedArrayType(typedArrayType){if(typedArrayType===Int8Array)return BYTE;if(typedArrayType===Uint8Array)return UNSIGNED_BYTE;if(typedArrayType===Uint8ClampedArray)return UNSIGNED_BYTE;if(typedArrayType===Int16Array)return SHORT;if(typedArrayType===Uint16Array)return UNSIGNED_SHORT;if(typedArrayType===Int32Array)return INT;if(typedArrayType===Uint32Array)return UNSIGNED_INT;if(typedArrayType===Float32Array)return FLOAT;throw"unsupported typed array type"}function getTypedArrayTypeForGLType(type){var CTOR=glTypeToTypedArray[type];if(!CTOR)throw"unknown gl type";return CTOR}function isArrayBuffer(a){return a&&a.buffer&&a.buffer instanceof ArrayBuffer}var BYTE=5120,UNSIGNED_BYTE=5121,SHORT=5122,UNSIGNED_SHORT=5123,INT=5124,UNSIGNED_INT=5125,FLOAT=5126,glTypeToTypedArray={},tt=glTypeToTypedArray;return tt[BYTE]=Int8Array,tt[UNSIGNED_BYTE]=Uint8Array,tt[SHORT]=Int16Array,tt[UNSIGNED_SHORT]=Uint16Array,tt[INT]=Int32Array,tt[UNSIGNED_INT]=Uint32Array,tt[FLOAT]=Float32Array,tt[32819]=Uint16Array,tt[32820]=Uint16Array,tt[33635]=Uint16Array,tt[5131]=Uint16Array,tt[33640]=Uint32Array,tt[35899]=Uint32Array,tt[35902]=Uint32Array,tt[36269]=Uint32Array,tt[34042]=Uint32Array,{getGLTypeForTypedArray:getGLTypeForTypedArray,getGLTypeForTypedArrayType:getGLTypeForTypedArrayType,getTypedArrayTypeForGLType:getTypedArrayTypeForGLType,isArrayBuffer:isArrayBuffer}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){"use strict";function shallowCopy(src){var dst={};return Object.keys(src).forEach(function(key){dst[key]=src[key]}),dst}function copyNamedProperties(names,src,dst){names.forEach(function(name){var value=src[name];void 0!==value&&(dst[name]=value)})}function copyExistingProperties(src,dst){Object.keys(dst).forEach(function(key){dst.hasOwnProperty(key)&&src.hasOwnProperty(key)&&(dst[key]=src[key])})}function isWebGL2(gl){return!!gl.texStorage2D}function isWebGL1(gl){return!gl.texStorage2D}return{copyExistingProperties:copyExistingProperties,copyNamedProperties:copyNamedProperties,shallowCopy:shallowCopy,isWebGL1:isWebGL1,isWebGL2:isWebGL2,error:window.console&&window.console.error&&"function"==typeof window.console.error?window.console.error.bind(window.console):function(){},warn:window.console&&window.console.warn&&"function"==typeof window.console.warn?window.console.warn.bind(window.console):function(){}}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(programs){"use strict";function drawBufferInfo(gl,bufferInfo,type,count,offset){type=void 0===type?gl.TRIANGLES:type;var indices=bufferInfo.indices,elementType=bufferInfo.elementType,numElements=void 0===count?bufferInfo.numElements:count;offset=void 0===offset?0:offset,elementType||indices?gl.drawElements(type,numElements,void 0===elementType?gl.UNSIGNED_SHORT:bufferInfo.elementType,offset):gl.drawArrays(type,offset,numElements)}function drawObjectList(gl,objectsToDraw){var lastUsedProgramInfo=null,lastUsedBufferInfo=null;objectsToDraw.forEach(function(object){if(!1!==object.active){var programInfo=object.programInfo,bufferInfo=object.vertexArrayInfo||object.bufferInfo,bindBuffers=!1,type=void 0===object.type?gl.TRIANGLES:object.type;programInfo!==lastUsedProgramInfo&&(lastUsedProgramInfo=programInfo,gl.useProgram(programInfo.program),bindBuffers=!0),(bindBuffers||bufferInfo!==lastUsedBufferInfo)&&(lastUsedBufferInfo&&lastUsedBufferInfo.vertexArrayObject&&!bufferInfo.vertexArrayObject&&gl.bindVertexArray(null),lastUsedBufferInfo=bufferInfo,programs.setBuffersAndAttributes(gl,programInfo,bufferInfo)),programs.setUniforms(programInfo,object.uniforms),drawBufferInfo(gl,bufferInfo,type,object.count,object.offset)}}),lastUsedBufferInfo.vertexArrayObject&&gl.bindVertexArray(null)}return{drawBufferInfo:drawBufferInfo,drawObjectList:drawObjectList}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(utils){"use strict";function getBindPointForSamplerType(gl,type){return typeMap[type].bindPoint}function floatSetter(gl,location){return function(v){gl.uniform1f(location,v)}}function floatArraySetter(gl,location){return function(v){gl.uniform1fv(location,v)}}function floatVec2Setter(gl,location){return function(v){gl.uniform2fv(location,v)}}function floatVec3Setter(gl,location){return function(v){gl.uniform3fv(location,v)}}function floatVec4Setter(gl,location){return function(v){gl.uniform4fv(location,v)}}function intSetter(gl,location){return function(v){gl.uniform1i(location,v)}}function intArraySetter(gl,location){return function(v){gl.uniform1iv(location,v)}}function intVec2Setter(gl,location){return function(v){gl.uniform2iv(location,v)}}function intVec3Setter(gl,location){return function(v){gl.uniform3iv(location,v)}}function intVec4Setter(gl,location){return function(v){gl.uniform4iv(location,v)}}function uintSetter(gl,location){return function(v){gl.uniform1ui(location,v)}}function uintArraySetter(gl,location){return function(v){gl.uniform1uiv(location,v)}}function uintVec2Setter(gl,location){return function(v){gl.uniform2uiv(location,v)}}function uintVec3Setter(gl,location){return function(v){gl.uniform3uiv(location,v)}}function uintVec4Setter(gl,location){return function(v){gl.uniform4uiv(location,v)}}function floatMat2Setter(gl,location){return function(v){gl.uniformMatrix2fv(location,!1,v)}}function floatMat3Setter(gl,location){return function(v){gl.uniformMatrix3fv(location,!1,v)}}function floatMat4Setter(gl,location){return function(v){gl.uniformMatrix4fv(location,!1,v)}}function floatMat23Setter(gl,location){return function(v){gl.uniformMatrix2x3fv(location,!1,v)}}function floatMat32Setter(gl,location){return function(v){gl.uniformMatrix3x2fv(location,!1,v)}}function floatMat24Setter(gl,location){return function(v){gl.uniformMatrix2x4fv(location,!1,v)}}function floatMat42Setter(gl,location){return function(v){gl.uniformMatrix4x2fv(location,!1,v)}}function floatMat34Setter(gl,location){return function(v){gl.uniformMatrix3x4fv(location,!1,v)}}function floatMat43Setter(gl,location){return function(v){gl.uniformMatrix4x3fv(location,!1,v)}}function samplerSetter(gl,type,unit,location){var bindPoint=getBindPointForSamplerType(gl,type);return utils.isWebGL2(gl)?function(textureOrPair){var texture=void 0,sampler=void 0;textureOrPair instanceof WebGLTexture?(texture=textureOrPair,sampler=null):(texture=textureOrPair.texture,sampler=textureOrPair.sampler),gl.uniform1i(location,unit),gl.activeTexture(gl.TEXTURE0+unit),gl.bindTexture(bindPoint,texture),gl.bindSampler(unit,sampler)}:function(texture){gl.uniform1i(location,unit),gl.activeTexture(gl.TEXTURE0+unit),gl.bindTexture(bindPoint,texture)}}function samplerArraySetter(gl,type,unit,location,size){for(var bindPoint=getBindPointForSamplerType(gl,type),units=new Int32Array(size),ii=0;ii<size;++ii)units[ii]=unit+ii;return utils.isWebGL2(gl)?function(textures){gl.uniform1iv(location,units),textures.forEach(function(textureOrPair,index){gl.activeTexture(gl.TEXTURE0+units[index]);var texture=void 0,sampler=void 0;textureOrPair instanceof WebGLTexture?(texture=textureOrPair,sampler=null):(texture=textureOrPair.texture,sampler=textureOrPair.sampler),gl.bindSampler(unit,sampler),gl.bindTexture(bindPoint,texture)})}:function(textures){gl.uniform1iv(location,units),textures.forEach(function(texture,index){gl.activeTexture(gl.TEXTURE0+units[index]),gl.bindTexture(bindPoint,texture)})}}function floatAttribSetter(gl,index){return function(b){gl.bindBuffer(gl.ARRAY_BUFFER,b.buffer),gl.enableVertexAttribArray(index),gl.vertexAttribPointer(index,b.numComponents||b.size,b.type||gl.FLOAT,b.normalize||!1,b.stride||0,b.offset||0)}}function intAttribSetter(gl,index){return function(b){gl.bindBuffer(gl.ARRAY_BUFFER,b.buffer),gl.enableVertexAttribArray(index),gl.vertexAttribIPointer(index,b.numComponents||b.size,b.type||gl.INT,b.stride||0,b.offset||0)}}function matAttribSetter(gl,index,typeInfo){var defaultSize=typeInfo.size,count=typeInfo.count;return function(b){gl.bindBuffer(gl.ARRAY_BUFFER,b.buffer);for(var numComponents=b.size||b.numComponents||defaultSize,size=numComponents/count,type=b.type||gl.FLOAT,typeInfo=typeMap[type],stride=typeInfo.size*numComponents,normalize=b.normalize||!1,offset=b.offset||0,rowOffset=stride/count,i=0;i<count;++i)gl.enableVertexAttribArray(index+i),gl.vertexAttribPointer(index+i,size,type,normalize,stride,offset+rowOffset*i)}}function addLineNumbers(src,lineOffset){return lineOffset=lineOffset||0,++lineOffset,src.split("\n").map(function(line,ndx){return ndx+lineOffset+": "+line}).join("\n")}function loadShader(gl,shaderSource,shaderType,opt_errorCallback){var errFn=opt_errorCallback||error,shader=gl.createShader(shaderType),lineOffset=0;if(spaceRE.test(shaderSource)&&(lineOffset=1,shaderSource=shaderSource.replace(spaceRE,"")),gl.shaderSource(shader,shaderSource),gl.compileShader(shader),!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){var lastError=gl.getShaderInfoLog(shader);return errFn(addLineNumbers(shaderSource,lineOffset)+"\n*** Error compiling shader: "+lastError),gl.deleteShader(shader),null}return shader}function getProgramOptions(opt_attribs,opt_locations,opt_errorCallback){if("function"==typeof opt_locations&&(opt_errorCallback=opt_locations,opt_locations=void 0),"function"==typeof opt_attribs)opt_errorCallback=opt_attribs,opt_attribs=void 0;else if(opt_attribs&&!Array.isArray(opt_attribs)){if(opt_attribs.errorCallback)return opt_attribs;var opt=opt_attribs;opt_errorCallback=opt.errorCallback,opt_attribs=opt.attribLocations;var transformFeedbackVaryings=opt.transformFeedbackVaryings}var options={errorCallback:opt_errorCallback||error,transformFeedbackVaryings:transformFeedbackVaryings};if(opt_attribs){var attribLocations={};Array.isArray(opt_attribs)?opt_attribs.forEach(function(attrib,ndx){attribLocations[attrib]=opt_locations?opt_locations[ndx]:ndx}):attribLocations=opt_attribs,options.attribLocations=attribLocations}return options}function createProgram(gl,shaders,opt_attribs,opt_locations,opt_errorCallback){var progOptions=getProgramOptions(opt_attribs,opt_locations,opt_errorCallback),program=gl.createProgram();shaders.forEach(function(shader){gl.attachShader(program,shader)}),progOptions.attribLocations&&Object.keys(progOptions.attribLocations).forEach(function(attrib){gl.bindAttribLocation(program,progOptions.attribLocations[attrib],attrib)});var varyings=progOptions.transformFeedbackVaryings;if(varyings&&(varyings.attribs&&(varyings=varyings.attribs),Array.isArray(varyings)||(varyings=Object.keys(varyings)),gl.transformFeedbackVaryings(program,varyings,progOptions.transformFeedbackMode||gl.SEPARATE_ATTRIBS)),gl.linkProgram(program),!gl.getProgramParameter(program,gl.LINK_STATUS)){var lastError=gl.getProgramInfoLog(program);return progOptions.errorCallback("Error in program linking:"+lastError),gl.deleteProgram(program),null}return program}function createShaderFromScript(gl,scriptId,opt_shaderType,opt_errorCallback){var shaderType,shaderSource="",shaderScript=document.getElementById(scriptId);if(!shaderScript)throw"*** Error: unknown script element"+scriptId;if(shaderSource=shaderScript.text,!opt_shaderType)if("x-shader/x-vertex"===shaderScript.type)shaderType=gl.VERTEX_SHADER;else if("x-shader/x-fragment"===shaderScript.type)shaderType=gl.FRAGMENT_SHADER;else if(shaderType!==gl.VERTEX_SHADER&&shaderType!==gl.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return loadShader(gl,shaderSource,opt_shaderType||shaderType,opt_errorCallback)}function createProgramFromScripts(gl,shaderScriptIds,opt_attribs,opt_locations,opt_errorCallback){for(var progOptions=getProgramOptions(opt_attribs,opt_locations,opt_errorCallback),shaders=[],ii=0;ii<shaderScriptIds.length;++ii){var shader=createShaderFromScript(gl,shaderScriptIds[ii],gl[defaultShaderType[ii]],progOptions.errorCallback);if(!shader)return null;shaders.push(shader)}return createProgram(gl,shaders,progOptions)}function createProgramFromSources(gl,shaderSources,opt_attribs,opt_locations,opt_errorCallback){for(var progOptions=getProgramOptions(opt_attribs,opt_locations,opt_errorCallback),shaders=[],ii=0;ii<shaderSources.length;++ii){var shader=loadShader(gl,shaderSources[ii],gl[defaultShaderType[ii]],progOptions.errorCallback);if(!shader)return null;shaders.push(shader)}return createProgram(gl,shaders,progOptions)}function createUniformSetters(gl,program){for(var textureUnit=0,uniformSetters={},numUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),ii=0;ii<numUniforms;++ii){var uniformInfo=gl.getActiveUniform(program,ii);if(!uniformInfo)break;var name=uniformInfo.name;"[0]"===name.substr(-3)&&(name=name.substr(0,name.length-3));var setter=function(program,uniformInfo){var location=gl.getUniformLocation(program,uniformInfo.name),isArray=uniformInfo.size>1&&"[0]"===uniformInfo.name.substr(-3),type=uniformInfo.type,typeInfo=typeMap[type];if(!typeInfo)throw"unknown type: 0x"+type.toString(16);if(typeInfo.bindPoint){var unit=textureUnit;return textureUnit+=uniformInfo.size,isArray?typeInfo.arraySetter(gl,type,unit,location,uniformInfo.size):typeInfo.setter(gl,type,unit,location,uniformInfo.size)}return typeInfo.arraySetter&&isArray?typeInfo.arraySetter(gl,location):typeInfo.setter(gl,location)}(program,uniformInfo);uniformSetters[name]=setter}return uniformSetters}function createTransformFeedbackInfo(gl,program){for(var info={},numVaryings=gl.getProgramParameter(program,gl.TRANSFORM_FEEDBACK_VARYINGS),ii=0;ii<numVaryings;++ii){var varying=gl.getTransformFeedbackVarying(program,ii);info[varying.name]={index:ii,type:varying.type,size:varying.size}}return info}function bindTransformFeedbackInfo(gl,transformFeedbackInfo,bufferInfo){transformFeedbackInfo.transformFeedbackInfo&&(transformFeedbackInfo=transformFeedbackInfo.transformFeedbackInfo),bufferInfo.attribs&&(bufferInfo=bufferInfo.attribs);for(var name in bufferInfo){var varying=transformFeedbackInfo[name];if(varying){var buf=bufferInfo[name];buf.offset?gl.bindBufferRange(gl.TRANSFORM_FEEDBACK_BUFFER,varying.index,buf.buffer,buf.offset,buf.size):gl.bindBufferBase(gl.TRANSFORM_FEEDBACK_BUFFER,varying.index,buf.buffer)}}}function unbindTransformFeedbackInfo(gl,transformFeedbackInfo,bufferInfo){transformFeedbackInfo.transformFeedbackInfo&&(transformFeedbackInfo=transformFeedbackInfo.transformFeedbackInfo),bufferInfo.attribs&&(bufferInfo=bufferInfo.attribs);for(var name in bufferInfo){var varying=transformFeedbackInfo[name];varying&&gl.bindBufferBase(gl.TRANSFORM_FEEDBACK_BUFFER,varying.index,null)}}function createTransformFeedback(gl,programInfo,bufferInfo){var tf=gl.createTransformFeedback();return gl.bindTransformFeedback(gl.TRANSFORM_FEEDBACK,tf),gl.useProgram(programInfo.program),bindTransformFeedbackInfo(gl,programInfo,bufferInfo),gl.bindTransformFeedback(gl.TRANSFORM_FEEDBACK,null),unbindTransformFeedbackInfo(gl,programInfo,bufferInfo),tf}function createUniformBlockSpecFromProgram(gl,program){for(var numUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),uniformData=[],uniformIndices=[],ii=0;ii<numUniforms;++ii){uniformIndices.push(ii),uniformData.push({});var uniformInfo=gl.getActiveUniform(program,ii);if(!uniformInfo)break;uniformData[ii].name=uniformInfo.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(pair){var pname=pair[0],key=pair[1];gl.getActiveUniforms(program,uniformIndices,gl[pname]).forEach(function(value,ndx){uniformData[ndx][key]=value})});var blockSpecs={},numUniformBlocks=gl.getProgramParameter(program,gl.ACTIVE_UNIFORM_BLOCKS);for(ii=0;ii<numUniformBlocks;++ii){var name=gl.getActiveUniformBlockName(program,ii),blockSpec={index:ii,usedByVertexShader:gl.getActiveUniformBlockParameter(program,ii,gl.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:gl.getActiveUniformBlockParameter(program,ii,gl.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:gl.getActiveUniformBlockParameter(program,ii,gl.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:gl.getActiveUniformBlockParameter(program,ii,gl.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};blockSpec.used=blockSpec.usedByVertexSahder||blockSpec.usedByFragmentShader,blockSpecs[name]=blockSpec}return{blockSpecs:blockSpecs,uniformData:uniformData}}function createUniformBlockInfoFromProgram(gl,program,uniformBlockSpec,blockName){var blockSpecs=uniformBlockSpec.blockSpecs,uniformData=uniformBlockSpec.uniformData,blockSpec=blockSpecs[blockName];if(!blockSpec)return warn("no uniform block object named:",blockName),{name:blockName,uniforms:{}};var array=new ArrayBuffer(blockSpec.size),buffer=gl.createBuffer(),uniformBufferIndex=blockSpec.index;gl.bindBuffer(gl.UNIFORM_BUFFER,buffer),gl.uniformBlockBinding(program,blockSpec.index,uniformBufferIndex);var prefix=blockName+".";arraySuffixRE.test(prefix)&&(prefix=prefix.replace(arraySuffixRE,"."));var uniforms={};return blockSpec.uniformIndices.forEach(function(uniformNdx){var data=uniformData[uniformNdx],typeInfo=typeMap[data.type],Type=typeInfo.Type,length=data.size*typeInfo.size,name=data.name;name.substr(0,prefix.length)===prefix&&(name=name.substr(prefix.length)),uniforms[name]=new Type(array,data.offset,length/Type.BYTES_PER_ELEMENT)}),{name:blockName,array:array,asFloat:new Float32Array(array),buffer:buffer,uniforms:uniforms}}function createUniformBlockInfo(gl,programInfo,blockName){return createUniformBlockInfoFromProgram(gl,programInfo.program,programInfo.uniformBlockSpec,blockName)}function bindUniformBlock(gl,programInfo,uniformBlockInfo){var uniformBlockSpec=programInfo.uniformBlockSpec||programInfo,blockSpec=uniformBlockSpec.blockSpecs[uniformBlockInfo.name];if(blockSpec){var bufferBindIndex=blockSpec.index;return gl.bindBufferRange(gl.UNIFORM_BUFFER,bufferBindIndex,uniformBlockInfo.buffer,uniformBlockInfo.offset||0,uniformBlockInfo.array.byteLength),!0}return!1}function setUniformBlock(gl,programInfo,uniformBlockInfo){bindUniformBlock(gl,programInfo,uniformBlockInfo)&&gl.bufferData(gl.UNIFORM_BUFFER,uniformBlockInfo.array,gl.DYNAMIC_DRAW)}function setBlockUniforms(uniformBlockInfo,values){var uniforms=uniformBlockInfo.uniforms;for(var name in values){var array=uniforms[name];if(array){var value=values[name];value.length?array.set(value):array[0]=value}}}function setUniforms(setters,values){for(var actualSetters=setters.uniformSetters||setters,numArgs=arguments.length,andx=1;andx<numArgs;++andx){var vals=arguments[andx];if(Array.isArray(vals))for(var numValues=vals.length,ii=0;ii<numValues;++ii)setUniforms(actualSetters,vals[ii]);else for(var name in vals){var setter=actualSetters[name];setter&&setter(vals[name])}}}function createAttributeSetters(gl,program){for(var attribSetters={},numAttribs=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),ii=0;ii<numAttribs;++ii){var attribInfo=gl.getActiveAttrib(program,ii);if(!attribInfo)break;var index=gl.getAttribLocation(program,attribInfo.name),typeInfo=attrTypeMap[attribInfo.type];attribSetters[attribInfo.name]=typeInfo.setter(gl,index,typeInfo)}return attribSetters}function setAttributes(setters,buffers){for(var name in buffers){var setter=setters[name];setter&&setter(buffers[name])}}function setBuffersAndAttributes(gl,programInfo,buffers){buffers.vertexArrayObject?gl.bindVertexArray(buffers.vertexArrayObject):(setAttributes(programInfo.attribSetters||programInfo,buffers.attribs),buffers.indices&&gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,buffers.indices))}function createProgramInfoFromProgram(gl,program){var uniformSetters=createUniformSetters(gl,program),attribSetters=createAttributeSetters(gl,program),programInfo={program:program,uniformSetters:uniformSetters,attribSetters:attribSetters};return utils.isWebGL2(gl)&&(programInfo.uniformBlockSpec=createUniformBlockSpecFromProgram(gl,program),programInfo.transformFeedbackInfo=createTransformFeedbackInfo(gl,program)),programInfo}function createProgramInfo(gl,shaderSources,opt_attribs,opt_locations,opt_errorCallback){var progOptions=getProgramOptions(opt_attribs,opt_locations,opt_errorCallback),good=!0;if(shaderSources=shaderSources.map(function(source){if(source.indexOf("\n")<0){var script=document.getElementById(source);script?source=script.text:(progOptions.errorCallback("no element with id: "+source),good=!1)}return source}),!good)return null;var program=createProgramFromSources(gl,shaderSources,progOptions);return program?createProgramInfoFromProgram(gl,program):null}var error=utils.error,warn=utils.warn,typeMap={};typeMap[5126]={Type:Float32Array,size:4,setter:floatSetter,arraySetter:floatArraySetter},typeMap[35664]={Type:Float32Array,size:8,setter:floatVec2Setter},typeMap[35665]={Type:Float32Array,size:12,setter:floatVec3Setter},typeMap[35666]={Type:Float32Array,size:16,setter:floatVec4Setter},typeMap[5124]={Type:Int32Array,size:4,setter:intSetter,arraySetter:intArraySetter},typeMap[35667]={Type:Int32Array,size:8,setter:intVec2Setter},typeMap[35668]={Type:Int32Array,size:12,setter:intVec3Setter},typeMap[35669]={Type:Int32Array,size:16,setter:intVec4Setter},typeMap[5125]={Type:Uint32Array,size:4,setter:uintSetter,arraySetter:uintArraySetter},typeMap[36294]={Type:Uint32Array,size:8,setter:uintVec2Setter},typeMap[36295]={Type:Uint32Array,size:12,
setter:uintVec3Setter},typeMap[36296]={Type:Uint32Array,size:16,setter:uintVec4Setter},typeMap[35670]={Type:Uint32Array,size:4,setter:intSetter,arraySetter:intArraySetter},typeMap[35671]={Type:Uint32Array,size:8,setter:intVec2Setter},typeMap[35672]={Type:Uint32Array,size:12,setter:intVec3Setter},typeMap[35673]={Type:Uint32Array,size:16,setter:intVec4Setter},typeMap[35674]={Type:Float32Array,size:16,setter:floatMat2Setter},typeMap[35675]={Type:Float32Array,size:36,setter:floatMat3Setter},typeMap[35676]={Type:Float32Array,size:64,setter:floatMat4Setter},typeMap[35685]={Type:Float32Array,size:24,setter:floatMat23Setter},typeMap[35686]={Type:Float32Array,size:32,setter:floatMat24Setter},typeMap[35687]={Type:Float32Array,size:24,setter:floatMat32Setter},typeMap[35688]={Type:Float32Array,size:48,setter:floatMat34Setter},typeMap[35689]={Type:Float32Array,size:32,setter:floatMat42Setter},typeMap[35690]={Type:Float32Array,size:48,setter:floatMat43Setter},typeMap[35678]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:3553},typeMap[35680]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:34067},typeMap[35679]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:32879},typeMap[35682]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:3553},typeMap[36289]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:35866},typeMap[36292]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:35866},typeMap[36293]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:34067},typeMap[36298]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:3553},typeMap[36299]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:32879},typeMap[36300]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:34067},typeMap[36303]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:35866},typeMap[36306]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:3553},typeMap[36307]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:32879},typeMap[36308]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:34067},typeMap[36311]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:35866};var attrTypeMap={};attrTypeMap[5126]={size:4,setter:floatAttribSetter},attrTypeMap[35664]={size:8,setter:floatAttribSetter},attrTypeMap[35665]={size:12,setter:floatAttribSetter},attrTypeMap[35666]={size:16,setter:floatAttribSetter},attrTypeMap[5124]={size:4,setter:intAttribSetter},attrTypeMap[35667]={size:8,setter:intAttribSetter},attrTypeMap[35668]={size:12,setter:intAttribSetter},attrTypeMap[35669]={size:16,setter:intAttribSetter},attrTypeMap[5125]={size:4,setter:intAttribSetter},attrTypeMap[36294]={size:8,setter:intAttribSetter},attrTypeMap[36295]={size:12,setter:intAttribSetter},attrTypeMap[36296]={size:16,setter:intAttribSetter},attrTypeMap[35670]={size:4,setter:intAttribSetter},attrTypeMap[35671]={size:8,setter:intAttribSetter},attrTypeMap[35672]={size:12,setter:intAttribSetter},attrTypeMap[35673]={size:16,setter:intAttribSetter},attrTypeMap[35674]={size:4,setter:matAttribSetter,count:2},attrTypeMap[35675]={size:9,setter:matAttribSetter,count:3},attrTypeMap[35676]={size:16,setter:matAttribSetter,count:4};var spaceRE=/^[ \t]*\n/,defaultShaderType=["VERTEX_SHADER","FRAGMENT_SHADER"],arraySuffixRE=/\[\d+\]\.$/;return{createAttributeSetters:createAttributeSetters,createProgram:createProgram,createProgramFromScripts:createProgramFromScripts,createProgramFromSources:createProgramFromSources,createProgramInfo:createProgramInfo,createProgramInfoFromProgram:createProgramInfoFromProgram,createUniformSetters:createUniformSetters,createUniformBlockSpecFromProgram:createUniformBlockSpecFromProgram,createUniformBlockInfoFromProgram:createUniformBlockInfoFromProgram,createUniformBlockInfo:createUniformBlockInfo,createTransformFeedback:createTransformFeedback,createTransformFeedbackInfo:createTransformFeedbackInfo,bindTransformFeedbackInfo:bindTransformFeedbackInfo,setAttributes:setAttributes,setBuffersAndAttributes:setBuffersAndAttributes,setUniforms:setUniforms,setUniformBlock:setUniformBlock,setBlockUniforms:setBlockUniforms,bindUniformBlock:bindUniformBlock}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(textures,utils){"use strict";function getAttachmentPointForFormat(format){return attachmentsByFormat[format]}function isRenderbufferFormat(format){return renderbufferFormats[format]}function createFramebufferInfo(gl,attachments,width,height){var target=gl.FRAMEBUFFER,fb=gl.createFramebuffer();gl.bindFramebuffer(target,fb),width=width||gl.drawingBufferWidth,height=height||gl.drawingBufferHeight,attachments=attachments||defaultAttachments;var colorAttachmentCount=0,framebufferInfo={framebuffer:fb,attachments:[],width:width,height:height};return attachments.forEach(function(attachmentOptions){var attachment=attachmentOptions.attachment,format=attachmentOptions.format,attachmentPoint=getAttachmentPointForFormat(format);if(attachmentPoint||(attachmentPoint=COLOR_ATTACHMENT0+colorAttachmentCount++),!attachment)if(isRenderbufferFormat(format))attachment=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,attachment),gl.renderbufferStorage(gl.RENDERBUFFER,format,width,height);else{var textureOptions=utils.shallowCopy(attachmentOptions);textureOptions.width=width,textureOptions.height=height,void 0===textureOptions.auto&&(textureOptions.auto=!1,textureOptions.min=textureOptions.min||gl.LINEAR,textureOptions.mag=textureOptions.mag||gl.LINEAR,textureOptions.wrapS=textureOptions.wrapS||textureOptions.wrap||gl.CLAMP_TO_EDGE,textureOptions.wrapT=textureOptions.wrapT||textureOptions.wrap||gl.CLAMP_TO_EDGE),attachment=textures.createTexture(gl,textureOptions)}if(attachment instanceof WebGLRenderbuffer)gl.framebufferRenderbuffer(target,attachmentPoint,gl.RENDERBUFFER,attachment);else{if(!(attachment instanceof WebGLTexture))throw"unknown attachment type";gl.framebufferTexture2D(target,attachmentPoint,attachmentOptions.texTarget||gl.TEXTURE_2D,attachment,attachmentOptions.level||0)}framebufferInfo.attachments.push(attachment)}),framebufferInfo}function resizeFramebufferInfo(gl,framebufferInfo,attachments,width,height){width=width||gl.drawingBufferWidth,height=height||gl.drawingBufferHeight,framebufferInfo.width=width,framebufferInfo.height=height,attachments=attachments||defaultAttachments,attachments.forEach(function(attachmentOptions,ndx){var attachment=framebufferInfo.attachments[ndx],format=attachmentOptions.format;if(attachment instanceof WebGLRenderbuffer)gl.bindRenderbuffer(gl.RENDERBUFFER,attachment),gl.renderbufferStorage(gl.RENDERBUFFER,format,width,height);else{if(!(attachment instanceof WebGLTexture))throw"unknown attachment type";textures.resizeTexture(gl,attachment,attachmentOptions,width,height)}})}function bindFramebufferInfo(gl,framebufferInfo,target){target=target||gl.FRAMEBUFFER,framebufferInfo?(gl.bindFramebuffer(target,framebufferInfo.framebuffer),gl.viewport(0,0,framebufferInfo.width,framebufferInfo.height)):(gl.bindFramebuffer(target,null),gl.viewport(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight))}var COLOR_ATTACHMENT0=36064,defaultAttachments=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],attachmentsByFormat={};attachmentsByFormat[34041]=33306,attachmentsByFormat[6401]=36128,attachmentsByFormat[36168]=36128,attachmentsByFormat[6402]=36096,attachmentsByFormat[33189]=36096;var renderbufferFormats={};return renderbufferFormats[32854]=!0,renderbufferFormats[32855]=!0,renderbufferFormats[36194]=!0,renderbufferFormats[34041]=!0,renderbufferFormats[33189]=!0,renderbufferFormats[6401]=!0,renderbufferFormats[36168]=!0,{bindFramebufferInfo:bindFramebufferInfo,createFramebufferInfo:createFramebufferInfo,resizeFramebufferInfo:resizeFramebufferInfo}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(3),__webpack_require__(4)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(typedArrays,utils){"use strict";function getBytesPerElementForInternalFormat(internalFormat,type){var info=textureInternalFormatInfo[internalFormat];if(!info)throw"unknown internal format";var bytesPerElement=info.bytesPerElementMap[type];if(void 0===bytesPerElement)throw"unknown internal format";return bytesPerElement}function getFormatAndTypeForInternalFormat(internalFormat){var info=textureInternalFormatInfo[internalFormat];if(!info)throw"unknown internal format";return{format:info.textureFormat,type:Array.isArray(info.type)?info.type[0]:info.type}}function isPowerOf2(value){return 0==(value&value-1)}function canGenerateMipmap(gl,width,height,internalFormat){if(!utils.isWebGL2(gl))return isPowerOf2(width)&&isPowerOf2(height);var info=textureInternalFormatInfo[internalFormat];if(!info)throw"unknown internal format";return info.colorRenderable&&info.textureFilterable}function canFilter(internalFormat){var info=textureInternalFormatInfo[internalFormat];if(!info)throw"unknown internal format";return info.textureFilterable}function getNumComponentsForFormat(format){var info=formatInfo[format];if(!info)throw"unknown format: "+format;return info.numColorComponents}function getTextureTypeForArrayType(gl,src,defaultType){return isArrayBuffer(src)?typedArrays.getGLTypeForTypedArray(src):defaultType||gl.UNSIGNED_BYTE}function guessDimensions(gl,target,width,height,numElements){if(numElements%1!=0)throw"can't guess dimensions";if(width||height){if(height){if(!width&&(width=numElements/height)%1)throw"can't guess dimensions"}else if((height=numElements/width)%1)throw"can't guess dimensions"}else{var size=Math.sqrt(numElements/(target===gl.TEXTURE_CUBE_MAP?6:1));size%1==0?(width=size,height=size):(width=numElements,height=1)}return{width:width,height:height}}function setDefaultTextureColor(color){defaults.textureColor=new Uint8Array([255*color[0],255*color[1],255*color[2],255*color[3]])}function setDefaults(newDefaults){utils.copyExistingProperties(newDefaults,defaults),newDefaults.textureColor&&setDefaultTextureColor(newDefaults.textureColor)}function savePackState(gl,options){void 0!==options.colorspaceConversion&&(lastPackState.colorspaceConversion=gl.getParameter(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL),gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,options.colorspaceConversion)),void 0!==options.premultiplyAlpha&&(lastPackState.premultiplyAlpha=gl.getParameter(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,options.premultiplyAlpha)),void 0!==options.flipY&&(lastPackState.flipY=gl.getParameter(gl.UNPACK_FLIP_Y_WEBGL),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,options.flipY))}function restorePackState(gl,options){void 0!==options.colorspaceConversion&&gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,lastPackState.colorspaceConversion),void 0!==options.premultiplyAlpha&&gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,lastPackState.premultiplyAlpha),void 0!==options.flipY&&gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,lastPackState.flipY)}function setTextureSamplerParameters(gl,target,parameteriFn,options){options.minMag&&(parameteriFn.call(gl,target,gl.TEXTURE_MIN_FILTER,options.minMag),parameteriFn.call(gl,target,gl.TEXTURE_MAG_FILTER,options.minMag)),options.min&&parameteriFn.call(gl,target,gl.TEXTURE_MIN_FILTER,options.min),options.mag&&parameteriFn.call(gl,target,gl.TEXTURE_MAG_FILTER,options.mag),options.wrap&&(parameteriFn.call(gl,target,gl.TEXTURE_WRAP_S,options.wrap),parameteriFn.call(gl,target,gl.TEXTURE_WRAP_T,options.wrap),(target===gl.TEXTURE_3D||target instanceof WebGLSamplerCtor)&&parameteriFn.call(gl,target,gl.TEXTURE_WRAP_R,options.wrap)),options.wrapR&&parameteriFn.call(gl,target,gl.TEXTURE_WRAP_R,options.wrapR),options.wrapS&&parameteriFn.call(gl,target,gl.TEXTURE_WRAP_S,options.wrapS),options.wrapT&&parameteriFn.call(gl,target,gl.TEXTURE_WRAP_T,options.wrapT),options.minLod&&parameteriFn.call(gl,target,gl.TEXTURE_MIN_LOD,options.minLod),options.maxLod&&parameteriFn.call(gl,target,gl.TEXTURE_MAX_LOD,options.maxLod),options.baseLevel&&parameteriFn.call(gl,target,gl.TEXTURE_BASE_LEVEL,options.baseLevel),options.maxLevel&&parameteriFn.call(gl,target,gl.TEXTURE_MAX_LEVEL,options.maxLevel)}function setTextureParameters(gl,tex,options){var target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex),setTextureSamplerParameters(gl,target,gl.texParameteri,options)}function setSamplerParameters(gl,sampler,options){setTextureSamplerParameters(gl,sampler,gl.samplerParameteri,options)}function createSampler(gl,options){var sampler=gl.createSampler();return setSamplerParameters(gl,sampler,options),sampler}function createSamplers(gl,samplerOptions){var samplers={};return Object.keys(samplerOptions).forEach(function(name){samplers[name]=createSampler(gl,samplerOptions[name])}),samplers}function make1Pixel(color){return color=color||defaults.textureColor,isArrayBuffer(color)?color:new Uint8Array([255*color[0],255*color[1],255*color[2],255*color[3]])}function setTextureFilteringForSize(gl,tex,options,width,height,internalFormat,type){options=options||defaults.textureOptions,internalFormat=internalFormat||gl.RGBA,type=type||gl.UNSIGNED_BYTE;var target=options.target||gl.TEXTURE_2D;if(width=width||options.width,height=height||options.height,gl.bindTexture(target,tex),canGenerateMipmap(gl,width,height,internalFormat,type))gl.generateMipmap(target);else{var filtering=canFilter(internalFormat,type)?gl.LINEAR:gl.NEAREST;gl.texParameteri(target,gl.TEXTURE_MIN_FILTER,filtering),gl.texParameteri(target,gl.TEXTURE_MAG_FILTER,filtering),gl.texParameteri(target,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(target,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)}}function getCubeFaceOrder(gl,options){return options=options||{},options.cubeFaceOrder||[gl.TEXTURE_CUBE_MAP_POSITIVE_X,gl.TEXTURE_CUBE_MAP_NEGATIVE_X,gl.TEXTURE_CUBE_MAP_POSITIVE_Y,gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,gl.TEXTURE_CUBE_MAP_POSITIVE_Z,gl.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function getCubeFacesWithNdx(gl,options){var faces=getCubeFaceOrder(gl,options),facesWithNdx=faces.map(function(face,ndx){return{face:face,ndx:ndx}});return facesWithNdx.sort(function(a,b){return a.face-b.face}),facesWithNdx}function setTextureFromElement(gl,tex,element,options){options=options||defaults.textureOptions;var target=options.target||gl.TEXTURE_2D,width=element.width,height=element.height,internalFormat=options.internalFormat||options.format||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),format=options.format||formatType.format,type=options.type||formatType.type;if(savePackState(gl,options),gl.bindTexture(target,tex),target===gl.TEXTURE_CUBE_MAP){var size,slices,imgWidth=element.width,imgHeight=element.height;if(imgWidth/6===imgHeight)size=imgHeight,slices=[0,0,1,0,2,0,3,0,4,0,5,0];else if(imgHeight/6===imgWidth)size=imgWidth,slices=[0,0,0,1,0,2,0,3,0,4,0,5];else if(imgWidth/3==imgHeight/2)size=imgWidth/3,slices=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(imgWidth/2!=imgHeight/3)throw"can't figure out cube map from element: "+(element.src?element.src:element.nodeName);size=imgWidth/2,slices=[0,0,1,0,0,1,1,1,0,2,1,2]}ctx.canvas.width=size,ctx.canvas.height=size,width=size,height=size,getCubeFacesWithNdx(gl,options).forEach(function(f){var xOffset=slices[2*f.ndx+0]*size,yOffset=slices[2*f.ndx+1]*size;ctx.drawImage(element,xOffset,yOffset,size,size,0,0,size,size),gl.texImage2D(f.face,0,internalFormat,format,type,ctx.canvas)}),ctx.canvas.width=1,ctx.canvas.height=1}else if(target===gl.TEXTURE_3D){var smallest=Math.min(element.width,element.height),largest=Math.max(element.width,element.height),depth=largest/smallest;if(depth%1!=0)throw"can not compute 3D dimensions of element";var xMult=element.width===largest?1:0,yMult=element.height===largest?1:0;gl.texImage3D(target,0,internalFormat,smallest,smallest,smallest,0,format,type,null),ctx.canvas.width=smallest,ctx.canvas.height=smallest;for(var d=0;d<depth;++d){var srcX=d*smallest*xMult,srcY=d*smallest*yMult,srcW=smallest,srcH=smallest,dstW=smallest,dstH=smallest;ctx.drawImage(element,srcX,srcY,srcW,srcH,0,0,dstW,dstH),gl.texSubImage3D(target,0,0,0,d,smallest,smallest,1,format,type,ctx.canvas)}ctx.canvas.width=0,ctx.canvas.height=0}else gl.texImage2D(target,0,internalFormat,format,type,element);restorePackState(gl,options),!1!==options.auto&&setTextureFilteringForSize(gl,tex,options,width,height,internalFormat,type),setTextureParameters(gl,tex,options)}function noop(){}function loadImage(url,crossOrigin,callback){function clearEventHandlers(){img.removeEventListener("error",onError),img.removeEventListener("load",onLoad),img=null}function onError(){var msg="couldn't load image: "+url;utils.error(msg),callback(msg,img),clearEventHandlers()}function onLoad(){callback(null,img),clearEventHandlers()}callback=callback||noop;var img=new Image;return crossOrigin=void 0!==crossOrigin?crossOrigin:defaults.crossOrigin,void 0!==crossOrigin&&(img.crossOrigin=crossOrigin),img.addEventListener("error",onError),img.addEventListener("load",onLoad),img.src=url,img}function setTextureTo1PixelColor(gl,tex,options){options=options||defaults.textureOptions;var target=options.target||gl.TEXTURE_2D;if(gl.bindTexture(target,tex),!1!==options.color){var color=make1Pixel(options.color);if(target===gl.TEXTURE_CUBE_MAP)for(var ii=0;ii<6;++ii)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+ii,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,color);else target===gl.TEXTURE_3D||target===gl.TEXTURE_2D_ARRAY?gl.texImage3D(target,0,gl.RGBA,1,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,color):gl.texImage2D(target,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,color)}}function loadTextureFromUrl(gl,tex,options,callback){return callback=callback||noop,options=options||defaults.textureOptions,setTextureTo1PixelColor(gl,tex,options),options=utils.shallowCopy(options),loadImage(options.src,options.crossOrigin,function(err,img){err?callback(err,tex,img):(setTextureFromElement(gl,tex,img,options),callback(null,tex,img))})}function loadCubemapFromUrls(gl,tex,options,callback){function uploadImg(faceTarget){return function(err,img){--numToLoad,err?errors.push(err):img.width!==img.height?errors.push("cubemap face img is not a square: "+img.src):(savePackState(gl,options),gl.bindTexture(target,tex),5===numToLoad?getCubeFaceOrder(gl).forEach(function(otherTarget){gl.texImage2D(otherTarget,0,internalFormat,format,type,img)}):gl.texImage2D(faceTarget,0,internalFormat,format,type,img),restorePackState(gl,options),gl.generateMipmap(target)),0===numToLoad&&callback(errors.length?errors:void 0,imgs,tex)}}callback=callback||noop;var urls=options.src;if(6!==urls.length)throw"there must be 6 urls for a cubemap";var internalFormat=options.internalFormat||options.format||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),format=options.format||formatType.format,type=options.type||gl.UNSIGNED_BYTE,target=options.target||gl.TEXTURE_2D;if(target!==gl.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";setTextureTo1PixelColor(gl,tex,options),options=utils.shallowCopy(options);var imgs,numToLoad=6,errors=[],faces=getCubeFaceOrder(gl,options);imgs=urls.map(function(url,ndx){return loadImage(url,options.crossOrigin,uploadImg(faces[ndx]))})}function loadSlicesFromUrls(gl,tex,options,callback){function uploadImg(slice){return function(err,img){if(--numToLoad,err)errors.push(err);else{if(savePackState(gl,options),gl.bindTexture(target,tex),firstImage){firstImage=!1,width=options.width||img.width,height=options.height||img.height,gl.texImage3D(target,0,internalFormat,width,height,depth,0,format,type,null);for(var s=0;s<depth;++s)gl.texSubImage3D(target,0,0,0,s,width,height,1,format,type,img)}else{var src=img;img.width===width&&img.height===height||(src=ctx.canvas,ctx.canvas.width=width,ctx.canvas.height=height,ctx.drawImage(img,0,0,width,height)),gl.texSubImage3D(target,0,0,0,slice,width,height,1,format,type,src),src===ctx.canvas&&(ctx.canvas.width=0,ctx.canvas.height=0)}restorePackState(gl,options),gl.generateMipmap(target)}0===numToLoad&&callback(errors.length?errors:void 0,imgs,tex)}}callback=callback||noop;var urls=options.src,internalFormat=options.internalFormat||options.format||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),format=options.format||formatType.format,type=options.type||gl.UNSIGNED_BYTE,target=options.target||gl.TEXTURE_2D_ARRAY;if(target!==gl.TEXTURE_3D&&target!==gl.TEXTURE_2D_ARRAY)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";setTextureTo1PixelColor(gl,tex,options),options=utils.shallowCopy(options);var imgs,numToLoad=urls.length,errors=[],width=options.width,height=options.height,depth=urls.length,firstImage=!0;imgs=urls.map(function(url,ndx){return loadImage(url,options.crossOrigin,uploadImg(ndx))})}function setTextureFromArray(gl,tex,src,options){options=options||defaults.textureOptions;var target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex);var width=options.width,height=options.height,depth=options.depth,internalFormat=options.internalFormat||options.format||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),format=options.format||formatType.format,type=options.type||getTextureTypeForArrayType(gl,src,formatType.type);if(isArrayBuffer(src))src instanceof Uint8ClampedArray&&(src=new Uint8Array(src.buffer));else{var Type=typedArrays.getTypedArrayTypeForGLType(type);src=new Type(src)}var bytesPerElement=getBytesPerElementForInternalFormat(internalFormat,type),numElements=src.byteLength/bytesPerElement;if(numElements%1)throw"length wrong size for format: "+glEnumToString(gl,format);var dimensions;if(target===gl.TEXTURE_3D)if(width||height||depth)!width||height&&depth?!height||width&&depth?(dimensions=guessDimensions(gl,target,width,height,numElements/depth),width=dimensions.width,height=dimensions.height):(dimensions=guessDimensions(gl,target,width,depth,numElements/height),width=dimensions.width,depth=dimensions.height):(dimensions=guessDimensions(gl,target,height,depth,numElements/width),height=dimensions.width,depth=dimensions.height);else{var size=Math.cbrt(numElements);if(size%1!=0)throw"can't guess cube size of array of numElements: "+numElements;width=size,height=size,depth=size}else dimensions=guessDimensions(gl,target,width,height,numElements),width=dimensions.width,height=dimensions.height;return gl.pixelStorei(gl.UNPACK_ALIGNMENT,options.unpackAlignment||1),savePackState(gl,options),target===gl.TEXTURE_CUBE_MAP?function(){var elementsPerElement=bytesPerElement/src.BYTES_PER_ELEMENT,faceSize=numElements/6*elementsPerElement;getCubeFacesWithNdx(gl,options).forEach(function(f){var offset=faceSize*f.ndx,data=src.subarray(offset,offset+faceSize);gl.texImage2D(f.face,0,internalFormat,width,height,0,format,type,data)})}():target===gl.TEXTURE_3D?gl.texImage3D(target,0,internalFormat,width,height,depth,0,format,type,src):gl.texImage2D(target,0,internalFormat,width,height,0,format,type,src),restorePackState(gl,options),{width:width,height:height,depth:depth,type:type}}function setEmptyTexture(gl,tex,options){var target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex);var internalFormat=options.internalFormat||options.format||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),format=options.format||formatType.format,type=options.type||formatType.type;if(savePackState(gl,options),target===gl.TEXTURE_CUBE_MAP)for(var ii=0;ii<6;++ii)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+ii,0,internalFormat,options.width,options.height,0,format,type,null);else target===gl.TEXTURE_3D?gl.texImage3D(target,0,internalFormat,options.width,options.height,options.depth,0,format,type,null):gl.texImage2D(target,0,internalFormat,options.width,options.height,0,format,type,null);restorePackState(gl,options)}function createTexture(gl,options,callback){callback=callback||noop,options=options||defaults.textureOptions;var tex=gl.createTexture(),target=options.target||gl.TEXTURE_2D,width=options.width||1,height=options.height||1,internalFormat=options.internalFormat||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),type=options.type||formatType.type;gl.bindTexture(target,tex),target===gl.TEXTURE_CUBE_MAP&&(gl.texParameteri(target,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(target,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE));var src=options.src;if(src)if("function"==typeof src&&(src=src(gl,options)),"string"==typeof src)loadTextureFromUrl(gl,tex,options,callback);else if(isArrayBuffer(src)||Array.isArray(src)&&("number"==typeof src[0]||Array.isArray(src[0])||isArrayBuffer(src[0]))){var dimensions=setTextureFromArray(gl,tex,src,options);width=dimensions.width,height=dimensions.height,type=dimensions.type}else if(Array.isArray(src)&&"string"==typeof src[0])target===gl.TEXTURE_CUBE_MAP?loadCubemapFromUrls(gl,tex,options,callback):loadSlicesFromUrls(gl,tex,options,callback);else{if(!(src instanceof HTMLElement))throw"unsupported src type";setTextureFromElement(gl,tex,src,options),width=src.width,height=src.height}else setEmptyTexture(gl,tex,options);return!1!==options.auto&&setTextureFilteringForSize(gl,tex,options,width,height,internalFormat,type),setTextureParameters(gl,tex,options),tex}function resizeTexture(gl,tex,options,width,height){width=width||options.width,height=height||options.height;var target=options.target||gl.TEXTURE_2D;gl.bindTexture(target,tex);var type,internalFormat=options.internalFormat||options.format||gl.RGBA,formatType=getFormatAndTypeForInternalFormat(internalFormat),format=options.format||formatType.format,src=options.src;if(type=src&&(isArrayBuffer(src)||Array.isArray(src)&&"number"==typeof src[0])?options.type||getTextureTypeForArrayType(gl,src,formatType.type):options.type||formatType.type,target===gl.TEXTURE_CUBE_MAP)for(var ii=0;ii<6;++ii)gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+ii,0,format,width,height,0,format,type,null);else gl.texImage2D(target,0,format,width,height,0,format,type,null)}function isAsyncSrc(src){return"string"==typeof src||Array.isArray(src)&&"string"==typeof src[0]}function createTextures(gl,textureOptions,callback){function callCallbackIfReady(){0===numDownloading&&setTimeout(function(){callback(errors.length?errors:void 0,textures,images)},0)}callback=callback||noop;var numDownloading=0,errors=[],textures={},images={};return Object.keys(textureOptions).forEach(function(name){var onLoadFn,options=textureOptions[name];isAsyncSrc(options.src)&&(onLoadFn=function(err,tex,img){images[name]=img,--numDownloading,err&&errors.push(err),callCallbackIfReady()},++numDownloading),textures[name]=createTexture(gl,options,onLoadFn)}),callCallbackIfReady(),textures}var defaults={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},isArrayBuffer=typedArrays.isArrayBuffer,ctx=document.createElement("canvas").getContext("2d"),RGB=6407,RG=33319,formatInfo={},f=formatInfo;f[6406]={numColorComponents:1},f[6409]={numColorComponents:1},f[6410]={numColorComponents:2},f[RGB]={numColorComponents:3},f[6408]={numColorComponents:4},f[6403]={numColorComponents:1},f[36244]={numColorComponents:1},f[RG]={numColorComponents:2},f[33320]={numColorComponents:2},f[RGB]={numColorComponents:3},f[36248]={numColorComponents:3},f[6408]={numColorComponents:4},f[36249]={numColorComponents:4},f[6402]={numColorComponents:1},f[34041]={numColorComponents:2};var textureInternalFormatInfo={};!function(){var t=textureInternalFormatInfo;t[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},t[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},t[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[5121,5131,36193,5126]},t[RGB]={textureFormat:RGB,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[5121,5131,36193,5126,33635]},t[6408]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[5121,5131,36193,5126,32819,32820]},t[33321]={textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:1,type:5121},t[36756]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:1,type:5120},t[33325]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[5126,5131]},t[33326]={textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:4,type:5126},t[33330]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5121},t[33329]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5120},t[33332]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5123},t[33331]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5122},t[33334]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},t[33333]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5124},t[33323]={textureFormat:RG,colorRenderable:!0,textureFilterable:!0,bytesPerElement:2,type:5121},t[36757]={textureFormat:RG,colorRenderable:!1,textureFilterable:!0,bytesPerElement:2,type:5120},t[33327]={textureFormat:RG,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[5126,5131]},t[33328]={textureFormat:RG,colorRenderable:!1,textureFilterable:!1,bytesPerElement:8,type:5126},t[33336]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5121},t[33335]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5120},t[33338]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5123},t[33337]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5122},t[33340]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5125},t[33339]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5124},t[32849]={textureFormat:RGB,colorRenderable:!0,textureFilterable:!0,bytesPerElement:3,type:5121},t[35905]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5121},t[36194]={textureFormat:RGB,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[5121,33635]},t[36758]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5120},t[35898]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35899]},t[35901]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35902]},t[34843]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[5126,5131]},t[34837]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5126},t[36221]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5121},t[36239]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5120},t[36215]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5123},t[36233]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5122},t[36209]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5125},
t[36227]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5124},t[32856]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},t[35907]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},t[36759]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:4,type:5120},t[32855]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[5121,32820,33640]},t[32854]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[5121,32819]},t[32857]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:33640},t[34842]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[5126,5131]},t[34836]={textureFormat:6408,colorRenderable:!1,textureFilterable:!1,bytesPerElement:16,type:5126},t[36220]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5121},t[36238]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5120},t[36975]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:33640},t[36214]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5123},t[36232]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5122},t[36226]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5124},t[36208]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5125},t[33189]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5123,5125]},t[33190]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},t[36012]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5126},t[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:34042},t[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:36269},Object.keys(t).forEach(function(internalFormat){var info=t[internalFormat];if(info.bytesPerElementMap={},Array.isArray(info.bytesPerElement))info.bytesPerElement.forEach(function(bytesPerElement,ndx){var type=info.type[ndx];info.bytesPerElementMap[type]=bytesPerElement});else{var type=info.type;info.bytesPerElementMap[type]=info.bytesPerElement}})}();var glEnumToString=function(){function init(gl){if(!enums){enums={};for(var key in gl)"number"==typeof gl[key]&&(enums[gl[key]]=key)}}var enums;return function(gl,value){return init(gl),enums[value]||"0x"+value.toString(16)}}(),lastPackState={},WebGLSamplerCtor=window.WebGLSampler||function(){};return{setDefaults_:setDefaults,createSampler:createSampler,createSamplers:createSamplers,setSamplerParameters:setSamplerParameters,createTexture:createTexture,setEmptyTexture:setEmptyTexture,setTextureFromArray:setTextureFromArray,loadTextureFromUrl:loadTextureFromUrl,setTextureFromElement:setTextureFromElement,setTextureFilteringForSize:setTextureFilteringForSize,setTextureParameters:setTextureParameters,setDefaultTextureColor:setDefaultTextureColor,createTextures:createTextures,resizeTexture:resizeTexture,getNumComponentsForFormat:getNumComponentsForFormat,getBytesPerElementForInternalFormat:getBytesPerElementForInternalFormat}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(programs){"use strict";function createVertexArrayInfo(gl,programInfos,bufferInfo){var vao=gl.createVertexArray();return gl.bindVertexArray(vao),programInfos.length||(programInfos=[programInfos]),programInfos.forEach(function(programInfo){programs.setBuffersAndAttributes(gl,programInfo,bufferInfo)}),gl.bindVertexArray(null),{numElements:bufferInfo.numElements,elementType:bufferInfo.elementType,vertexArrayObject:vao}}function createVAOAndSetAttributes(gl,setters,attribs,indices){var vao=gl.createVertexArray();return gl.bindVertexArray(vao),programs.setAttributes(setters,attribs),indices&&gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,indices),gl.bindVertexArray(null),vao}function createVAOFromBufferInfo(gl,programInfo,bufferInfo){return createVAOAndSetAttributes(gl,programInfo.attribSetters||programInfo,bufferInfo.attribs,bufferInfo.indices)}return{createVertexArrayInfo:createVertexArrayInfo,createVAOAndSetAttributes:createVAOAndSetAttributes,createVAOFromBufferInfo:createVAOFromBufferInfo}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(11)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(v3){"use strict";function setDefaultType(ctor){var oldType=MatType;return MatType=ctor,oldType}function negate(m,dst){return dst=dst||new MatType(16),dst[0]=-m[0],dst[1]=-m[1],dst[2]=-m[2],dst[3]=-m[3],dst[4]=-m[4],dst[5]=-m[5],dst[6]=-m[6],dst[7]=-m[7],dst[8]=-m[8],dst[9]=-m[9],dst[10]=-m[10],dst[11]=-m[11],dst[12]=-m[12],dst[13]=-m[13],dst[14]=-m[14],dst[15]=-m[15],dst}function copy(m,dst){return dst=dst||new MatType(16),dst[0]=m[0],dst[1]=m[1],dst[2]=m[2],dst[3]=m[3],dst[4]=m[4],dst[5]=m[5],dst[6]=m[6],dst[7]=m[7],dst[8]=m[8],dst[9]=m[9],dst[10]=m[10],dst[11]=m[11],dst[12]=m[12],dst[13]=m[13],dst[14]=m[14],dst[15]=m[15],dst}function identity(dst){return dst=dst||new MatType(16),dst[0]=1,dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=1,dst[6]=0,dst[7]=0,dst[8]=0,dst[9]=0,dst[10]=1,dst[11]=0,dst[12]=0,dst[13]=0,dst[14]=0,dst[15]=1,dst}function transpose(m,dst){if((dst=dst||new MatType(16))===m){var t;return t=m[1],m[1]=m[4],m[4]=t,t=m[2],m[2]=m[8],m[8]=t,t=m[3],m[3]=m[12],m[12]=t,t=m[6],m[6]=m[9],m[9]=t,t=m[7],m[7]=m[13],m[13]=t,t=m[11],m[11]=m[14],m[14]=t,dst}var m00=m[0],m01=m[1],m02=m[2],m03=m[3],m10=m[4],m11=m[5],m12=m[6],m13=m[7],m20=m[8],m21=m[9],m22=m[10],m23=m[11],m30=m[12],m31=m[13],m32=m[14],m33=m[15];return dst[0]=m00,dst[1]=m10,dst[2]=m20,dst[3]=m30,dst[4]=m01,dst[5]=m11,dst[6]=m21,dst[7]=m31,dst[8]=m02,dst[9]=m12,dst[10]=m22,dst[11]=m32,dst[12]=m03,dst[13]=m13,dst[14]=m23,dst[15]=m33,dst}function inverse(m,dst){dst=dst||new MatType(16);var m00=m[0],m01=m[1],m02=m[2],m03=m[3],m10=m[4],m11=m[5],m12=m[6],m13=m[7],m20=m[8],m21=m[9],m22=m[10],m23=m[11],m30=m[12],m31=m[13],m32=m[14],m33=m[15],tmp_0=m22*m33,tmp_1=m32*m23,tmp_2=m12*m33,tmp_3=m32*m13,tmp_4=m12*m23,tmp_5=m22*m13,tmp_6=m02*m33,tmp_7=m32*m03,tmp_8=m02*m23,tmp_9=m22*m03,tmp_10=m02*m13,tmp_11=m12*m03,tmp_12=m20*m31,tmp_13=m30*m21,tmp_14=m10*m31,tmp_15=m30*m11,tmp_16=m10*m21,tmp_17=m20*m11,tmp_18=m00*m31,tmp_19=m30*m01,tmp_20=m00*m21,tmp_21=m20*m01,tmp_22=m00*m11,tmp_23=m10*m01,t0=tmp_0*m11+tmp_3*m21+tmp_4*m31-(tmp_1*m11+tmp_2*m21+tmp_5*m31),t1=tmp_1*m01+tmp_6*m21+tmp_9*m31-(tmp_0*m01+tmp_7*m21+tmp_8*m31),t2=tmp_2*m01+tmp_7*m11+tmp_10*m31-(tmp_3*m01+tmp_6*m11+tmp_11*m31),t3=tmp_5*m01+tmp_8*m11+tmp_11*m21-(tmp_4*m01+tmp_9*m11+tmp_10*m21),d=1/(m00*t0+m10*t1+m20*t2+m30*t3);return dst[0]=d*t0,dst[1]=d*t1,dst[2]=d*t2,dst[3]=d*t3,dst[4]=d*(tmp_1*m10+tmp_2*m20+tmp_5*m30-(tmp_0*m10+tmp_3*m20+tmp_4*m30)),dst[5]=d*(tmp_0*m00+tmp_7*m20+tmp_8*m30-(tmp_1*m00+tmp_6*m20+tmp_9*m30)),dst[6]=d*(tmp_3*m00+tmp_6*m10+tmp_11*m30-(tmp_2*m00+tmp_7*m10+tmp_10*m30)),dst[7]=d*(tmp_4*m00+tmp_9*m10+tmp_10*m20-(tmp_5*m00+tmp_8*m10+tmp_11*m20)),dst[8]=d*(tmp_12*m13+tmp_15*m23+tmp_16*m33-(tmp_13*m13+tmp_14*m23+tmp_17*m33)),dst[9]=d*(tmp_13*m03+tmp_18*m23+tmp_21*m33-(tmp_12*m03+tmp_19*m23+tmp_20*m33)),dst[10]=d*(tmp_14*m03+tmp_19*m13+tmp_22*m33-(tmp_15*m03+tmp_18*m13+tmp_23*m33)),dst[11]=d*(tmp_17*m03+tmp_20*m13+tmp_23*m23-(tmp_16*m03+tmp_21*m13+tmp_22*m23)),dst[12]=d*(tmp_14*m22+tmp_17*m32+tmp_13*m12-(tmp_16*m32+tmp_12*m12+tmp_15*m22)),dst[13]=d*(tmp_20*m32+tmp_12*m02+tmp_19*m22-(tmp_18*m22+tmp_21*m32+tmp_13*m02)),dst[14]=d*(tmp_18*m12+tmp_23*m32+tmp_15*m02-(tmp_22*m32+tmp_14*m02+tmp_19*m12)),dst[15]=d*(tmp_22*m22+tmp_16*m02+tmp_21*m12-(tmp_20*m12+tmp_23*m22+tmp_17*m02)),dst}function multiply(a,b,dst){dst=dst||new MatType(16);var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=b[0],b01=b[1],b02=b[2],b03=b[3],b10=b[4],b11=b[5],b12=b[6],b13=b[7],b20=b[8],b21=b[9],b22=b[10],b23=b[11],b30=b[12],b31=b[13],b32=b[14],b33=b[15];return dst[0]=a00*b00+a10*b01+a20*b02+a30*b03,dst[1]=a01*b00+a11*b01+a21*b02+a31*b03,dst[2]=a02*b00+a12*b01+a22*b02+a32*b03,dst[3]=a03*b00+a13*b01+a23*b02+a33*b03,dst[4]=a00*b10+a10*b11+a20*b12+a30*b13,dst[5]=a01*b10+a11*b11+a21*b12+a31*b13,dst[6]=a02*b10+a12*b11+a22*b12+a32*b13,dst[7]=a03*b10+a13*b11+a23*b12+a33*b13,dst[8]=a00*b20+a10*b21+a20*b22+a30*b23,dst[9]=a01*b20+a11*b21+a21*b22+a31*b23,dst[10]=a02*b20+a12*b21+a22*b22+a32*b23,dst[11]=a03*b20+a13*b21+a23*b22+a33*b23,dst[12]=a00*b30+a10*b31+a20*b32+a30*b33,dst[13]=a01*b30+a11*b31+a21*b32+a31*b33,dst[14]=a02*b30+a12*b31+a22*b32+a32*b33,dst[15]=a03*b30+a13*b31+a23*b32+a33*b33,dst}function setTranslation(a,v,dst){return dst=dst||identity(),a!==dst&&(dst[0]=a[0],dst[1]=a[1],dst[2]=a[2],dst[3]=a[3],dst[4]=a[4],dst[5]=a[5],dst[6]=a[6],dst[7]=a[7],dst[8]=a[8],dst[9]=a[9],dst[10]=a[10],dst[11]=a[11]),dst[12]=v[0],dst[13]=v[1],dst[14]=v[2],dst[15]=1,dst}function getTranslation(m,dst){return dst=dst||v3.create(),dst[0]=m[12],dst[1]=m[13],dst[2]=m[14],dst}function getAxis(m,axis,dst){dst=dst||v3.create();var off=4*axis;return dst[0]=m[off+0],dst[1]=m[off+1],dst[2]=m[off+2],dst}function setAxis(a,v,axis,dst){dst!==a&&(dst=copy(a,dst));var off=4*axis;return dst[off+0]=v[0],dst[off+1]=v[1],dst[off+2]=v[2],dst}function perspective(fieldOfViewYInRadians,aspect,zNear,zFar,dst){dst=dst||new MatType(16);var f=Math.tan(.5*Math.PI-.5*fieldOfViewYInRadians),rangeInv=1/(zNear-zFar);return dst[0]=f/aspect,dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=f,dst[6]=0,dst[7]=0,dst[8]=0,dst[9]=0,dst[10]=(zNear+zFar)*rangeInv,dst[11]=-1,dst[12]=0,dst[13]=0,dst[14]=zNear*zFar*rangeInv*2,dst[15]=0,dst}function ortho(left,right,bottom,top,near,far,dst){return dst=dst||new MatType(16),dst[0]=2/(right-left),dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=2/(top-bottom),dst[6]=0,dst[7]=0,dst[8]=0,dst[9]=0,dst[10]=-1/(far-near),dst[11]=0,dst[12]=(right+left)/(left-right),dst[13]=(top+bottom)/(bottom-top),dst[14]=-near/(near-far),dst[15]=1,dst}function frustum(left,right,bottom,top,near,far,dst){dst=dst||new MatType(16);var dx=right-left,dy=top-bottom,dz=near-far;return dst[0]=2*near/dx,dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=2*near/dy,dst[6]=0,dst[7]=0,dst[8]=(left+right)/dx,dst[9]=(top+bottom)/dy,dst[10]=far/dz,dst[11]=-1,dst[12]=0,dst[13]=0,dst[14]=near*far/dz,dst[15]=0,dst}function lookAt(eye,target,up,dst){dst=dst||new MatType(16);var xAxis=tempV3a,yAxis=tempV3b,zAxis=tempV3c;return v3.normalize(v3.subtract(eye,target,zAxis),zAxis),v3.normalize(v3.cross(up,zAxis,xAxis),xAxis),v3.normalize(v3.cross(zAxis,xAxis,yAxis),yAxis),dst[0]=xAxis[0],dst[1]=xAxis[1],dst[2]=xAxis[2],dst[3]=0,dst[4]=yAxis[0],dst[5]=yAxis[1],dst[6]=yAxis[2],dst[7]=0,dst[8]=zAxis[0],dst[9]=zAxis[1],dst[10]=zAxis[2],dst[11]=0,dst[12]=eye[0],dst[13]=eye[1],dst[14]=eye[2],dst[15]=1,dst}function translation(v,dst){return dst=dst||new MatType(16),dst[0]=1,dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=1,dst[6]=0,dst[7]=0,dst[8]=0,dst[9]=0,dst[10]=1,dst[11]=0,dst[12]=v[0],dst[13]=v[1],dst[14]=v[2],dst[15]=1,dst}function translate(m,v,dst){dst=dst||new MatType(16);var v0=v[0],v1=v[1],v2=v[2],m00=m[0],m01=m[1],m02=m[2],m03=m[3],m10=m[4],m11=m[5],m12=m[6],m13=m[7],m20=m[8],m21=m[9],m22=m[10],m23=m[11],m30=m[12],m31=m[13],m32=m[14],m33=m[15];return m!==dst&&(dst[0]=m00,dst[1]=m01,dst[2]=m02,dst[3]=m03,dst[4]=m10,dst[5]=m11,dst[6]=m12,dst[7]=m13,dst[8]=m20,dst[9]=m21,dst[10]=m22,dst[11]=m23),dst[12]=m00*v0+m10*v1+m20*v2+m30,dst[13]=m01*v0+m11*v1+m21*v2+m31,dst[14]=m02*v0+m12*v1+m22*v2+m32,dst[15]=m03*v0+m13*v1+m23*v2+m33,dst}function rotationX(angleInRadians,dst){dst=dst||new MatType(16);var c=Math.cos(angleInRadians),s=Math.sin(angleInRadians);return dst[0]=1,dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=c,dst[6]=s,dst[7]=0,dst[8]=0,dst[9]=-s,dst[10]=c,dst[11]=0,dst[12]=0,dst[13]=0,dst[14]=0,dst[15]=1,dst}function rotateX(m,angleInRadians,dst){dst=dst||new MatType(16);var m10=m[4],m11=m[5],m12=m[6],m13=m[7],m20=m[8],m21=m[9],m22=m[10],m23=m[11],c=Math.cos(angleInRadians),s=Math.sin(angleInRadians);return dst[4]=c*m10+s*m20,dst[5]=c*m11+s*m21,dst[6]=c*m12+s*m22,dst[7]=c*m13+s*m23,dst[8]=c*m20-s*m10,dst[9]=c*m21-s*m11,dst[10]=c*m22-s*m12,dst[11]=c*m23-s*m13,m!==dst&&(dst[0]=m[0],dst[1]=m[1],dst[2]=m[2],dst[3]=m[3],dst[12]=m[12],dst[13]=m[13],dst[14]=m[14],dst[15]=m[15]),dst}function rotationY(angleInRadians,dst){dst=dst||new MatType(16);var c=Math.cos(angleInRadians),s=Math.sin(angleInRadians);return dst[0]=c,dst[1]=0,dst[2]=-s,dst[3]=0,dst[4]=0,dst[5]=1,dst[6]=0,dst[7]=0,dst[8]=s,dst[9]=0,dst[10]=c,dst[11]=0,dst[12]=0,dst[13]=0,dst[14]=0,dst[15]=1,dst}function rotateY(m,angleInRadians,dst){dst=dst||new MatType(16);var m00=m[0],m01=m[1],m02=m[2],m03=m[3],m20=m[8],m21=m[9],m22=m[10],m23=m[11],c=Math.cos(angleInRadians),s=Math.sin(angleInRadians);return dst[0]=c*m00-s*m20,dst[1]=c*m01-s*m21,dst[2]=c*m02-s*m22,dst[3]=c*m03-s*m23,dst[8]=c*m20+s*m00,dst[9]=c*m21+s*m01,dst[10]=c*m22+s*m02,dst[11]=c*m23+s*m03,m!==dst&&(dst[4]=m[4],dst[5]=m[5],dst[6]=m[6],dst[7]=m[7],dst[12]=m[12],dst[13]=m[13],dst[14]=m[14],dst[15]=m[15]),dst}function rotationZ(angleInRadians,dst){dst=dst||new MatType(16);var c=Math.cos(angleInRadians),s=Math.sin(angleInRadians);return dst[0]=c,dst[1]=s,dst[2]=0,dst[3]=0,dst[4]=-s,dst[5]=c,dst[6]=0,dst[7]=0,dst[8]=0,dst[9]=0,dst[10]=1,dst[11]=0,dst[12]=0,dst[13]=0,dst[14]=0,dst[15]=1,dst}function rotateZ(m,angleInRadians,dst){dst=dst||new MatType(16);var m00=m[0],m01=m[1],m02=m[2],m03=m[3],m10=m[4],m11=m[5],m12=m[6],m13=m[7],c=Math.cos(angleInRadians),s=Math.sin(angleInRadians);return dst[0]=c*m00+s*m10,dst[1]=c*m01+s*m11,dst[2]=c*m02+s*m12,dst[3]=c*m03+s*m13,dst[4]=c*m10-s*m00,dst[5]=c*m11-s*m01,dst[6]=c*m12-s*m02,dst[7]=c*m13-s*m03,m!==dst&&(dst[8]=m[8],dst[9]=m[9],dst[10]=m[10],dst[11]=m[11],dst[12]=m[12],dst[13]=m[13],dst[14]=m[14],dst[15]=m[15]),dst}function axisRotation(axis,angleInRadians,dst){dst=dst||new MatType(16);var x=axis[0],y=axis[1],z=axis[2],n=Math.sqrt(x*x+y*y+z*z);x/=n,y/=n,z/=n;var xx=x*x,yy=y*y,zz=z*z,c=Math.cos(angleInRadians),s=Math.sin(angleInRadians),oneMinusCosine=1-c;return dst[0]=xx+(1-xx)*c,dst[1]=x*y*oneMinusCosine+z*s,dst[2]=x*z*oneMinusCosine-y*s,dst[3]=0,dst[4]=x*y*oneMinusCosine-z*s,dst[5]=yy+(1-yy)*c,dst[6]=y*z*oneMinusCosine+x*s,dst[7]=0,dst[8]=x*z*oneMinusCosine+y*s,dst[9]=y*z*oneMinusCosine-x*s,dst[10]=zz+(1-zz)*c,dst[11]=0,dst[12]=0,dst[13]=0,dst[14]=0,dst[15]=1,dst}function axisRotate(m,axis,angleInRadians,dst){dst=dst||new MatType(16);var x=axis[0],y=axis[1],z=axis[2],n=Math.sqrt(x*x+y*y+z*z);x/=n,y/=n,z/=n;var xx=x*x,yy=y*y,zz=z*z,c=Math.cos(angleInRadians),s=Math.sin(angleInRadians),oneMinusCosine=1-c,r00=xx+(1-xx)*c,r01=x*y*oneMinusCosine+z*s,r02=x*z*oneMinusCosine-y*s,r10=x*y*oneMinusCosine-z*s,r11=yy+(1-yy)*c,r12=y*z*oneMinusCosine+x*s,r20=x*z*oneMinusCosine+y*s,r21=y*z*oneMinusCosine-x*s,r22=zz+(1-zz)*c,m00=m[0],m01=m[1],m02=m[2],m03=m[3],m10=m[4],m11=m[5],m12=m[6],m13=m[7],m20=m[8],m21=m[9],m22=m[10],m23=m[11];return dst[0]=r00*m00+r01*m10+r02*m20,dst[1]=r00*m01+r01*m11+r02*m21,dst[2]=r00*m02+r01*m12+r02*m22,dst[3]=r00*m03+r01*m13+r02*m23,dst[4]=r10*m00+r11*m10+r12*m20,dst[5]=r10*m01+r11*m11+r12*m21,dst[6]=r10*m02+r11*m12+r12*m22,dst[7]=r10*m03+r11*m13+r12*m23,dst[8]=r20*m00+r21*m10+r22*m20,dst[9]=r20*m01+r21*m11+r22*m21,dst[10]=r20*m02+r21*m12+r22*m22,dst[11]=r20*m03+r21*m13+r22*m23,m!==dst&&(dst[12]=m[12],dst[13]=m[13],dst[14]=m[14],dst[15]=m[15]),dst}function scaling(v,dst){return dst=dst||new MatType(16),dst[0]=v[0],dst[1]=0,dst[2]=0,dst[3]=0,dst[4]=0,dst[5]=v[1],dst[6]=0,dst[7]=0,dst[8]=0,dst[9]=0,dst[10]=v[2],dst[11]=0,dst[12]=0,dst[13]=0,dst[14]=0,dst[15]=1,dst}function scale(m,v,dst){dst=dst||new MatType(16);var v0=v[0],v1=v[1],v2=v[2];return dst[0]=v0*m[0],dst[1]=v0*m[1],dst[2]=v0*m[2],dst[3]=v0*m[3],dst[4]=v1*m[4],dst[5]=v1*m[5],dst[6]=v1*m[6],dst[7]=v1*m[7],dst[8]=v2*m[8],dst[9]=v2*m[9],dst[10]=v2*m[10],dst[11]=v2*m[11],m!==dst&&(dst[12]=m[12],dst[13]=m[13],dst[14]=m[14],dst[15]=m[15]),dst}function transformPoint(m,v,dst){dst=dst||v3.create();var v0=v[0],v1=v[1],v2=v[2],d=v0*m[3]+v1*m[7]+v2*m[11]+m[15];return dst[0]=(v0*m[0]+v1*m[4]+v2*m[8]+m[12])/d,dst[1]=(v0*m[1]+v1*m[5]+v2*m[9]+m[13])/d,dst[2]=(v0*m[2]+v1*m[6]+v2*m[10]+m[14])/d,dst}function transformDirection(m,v,dst){dst=dst||v3.create();var v0=v[0],v1=v[1],v2=v[2];return dst[0]=v0*m[0]+v1*m[4]+v2*m[8],dst[1]=v0*m[1]+v1*m[5]+v2*m[9],dst[2]=v0*m[2]+v1*m[6]+v2*m[10],dst}function transformNormal(m,v,dst){dst=dst||v3.create();var mi=inverse(m),v0=v[0],v1=v[1],v2=v[2];return dst[0]=v0*mi[0]+v1*mi[1]+v2*mi[2],dst[1]=v0*mi[4]+v1*mi[5]+v2*mi[6],dst[2]=v0*mi[8]+v1*mi[9]+v2*mi[10],dst}var MatType=Float32Array,tempV3a=v3.create(),tempV3b=v3.create(),tempV3c=v3.create();return{axisRotate:axisRotate,axisRotation:axisRotation,create:identity,copy:copy,frustum:frustum,getAxis:getAxis,getTranslation:getTranslation,identity:identity,inverse:inverse,lookAt:lookAt,multiply:multiply,negate:negate,ortho:ortho,perspective:perspective,rotateX:rotateX,rotateY:rotateY,rotateZ:rotateZ,rotateAxis:axisRotate,rotationX:rotationX,rotationY:rotationY,rotationZ:rotationZ,scale:scale,scaling:scaling,setAxis:setAxis,setDefaultType:setDefaultType,setTranslation:setTranslation,transformDirection:transformDirection,transformNormal:transformNormal,transformPoint:transformPoint,translate:translate,translation:translation,transpose:transpose}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){"use strict";function setDefaultType(ctor){var oldType=VecType;return VecType=ctor,oldType}function create(x,y,z){var dst=new VecType(3);return x&&(dst[0]=x),y&&(dst[1]=y),z&&(dst[2]=z),dst}function add(a,b,dst){return dst=dst||new VecType(3),dst[0]=a[0]+b[0],dst[1]=a[1]+b[1],dst[2]=a[2]+b[2],dst}function subtract(a,b,dst){return dst=dst||new VecType(3),dst[0]=a[0]-b[0],dst[1]=a[1]-b[1],dst[2]=a[2]-b[2],dst}function lerp(a,b,t,dst){return dst=dst||new VecType(3),dst[0]=(1-t)*a[0]+t*b[0],dst[1]=(1-t)*a[1]+t*b[1],dst[2]=(1-t)*a[2]+t*b[2],dst}function mulScalar(v,k,dst){return dst=dst||new VecType(3),dst[0]=v[0]*k,dst[1]=v[1]*k,dst[2]=v[2]*k,dst}function divScalar(v,k,dst){return dst=dst||new VecType(3),dst[0]=v[0]/k,dst[1]=v[1]/k,dst[2]=v[2]/k,dst}function cross(a,b,dst){return dst=dst||new VecType(3),dst[0]=a[1]*b[2]-a[2]*b[1],dst[1]=a[2]*b[0]-a[0]*b[2],dst[2]=a[0]*b[1]-a[1]*b[0],dst}function dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function length(v){return Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])}function lengthSq(v){return v[0]*v[0]+v[1]*v[1]+v[2]*v[2]}function normalize(a,dst){dst=dst||new VecType(3);var lenSq=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],len=Math.sqrt(lenSq);return len>1e-5?(dst[0]=a[0]/len,dst[1]=a[1]/len,dst[2]=a[2]/len):(dst[0]=0,dst[1]=0,dst[2]=0),dst}function negate(v,dst){return dst=dst||new VecType(3),dst[0]=-v[0],dst[1]=-v[1],dst[2]=-v[2],dst}function copy(v,dst){return dst=dst||new VecType(3),dst[0]=v[0],dst[1]=v[1],dst[2]=v[2],dst}function multiply(a,b,dst){return dst=dst||new VecType(3),dst[0]=a[0]*b[0],dst[1]=a[1]*b[1],dst[2]=a[2]*b[2],dst}function divide(a,b,dst){return dst=dst||new VecType(3),dst[0]=a[0]/b[0],dst[1]=a[1]/b[1],dst[2]=a[2]/b[2],dst}var VecType=Float32Array;return{add:add,copy:copy,create:create,cross:cross,divide:divide,divScalar:divScalar,dot:dot,lerp:lerp,length:length,lengthSq:lengthSq,mulScalar:mulScalar,multiply:multiply,negate:negate,normalize:normalize,setDefaultType:setDefaultType,subtract:subtract}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(2),__webpack_require__(4),__webpack_require__(10),__webpack_require__(11)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(attributes,utils,m4,v3){"use strict";function augmentTypedArray(typedArray,numComponents){var cursor=0;return typedArray.push=function(){for(var ii=0;ii<arguments.length;++ii){var value=arguments[ii];if(value instanceof Array||value.buffer&&value.buffer instanceof ArrayBuffer)for(var jj=0;jj<value.length;++jj)typedArray[cursor++]=value[jj];else typedArray[cursor++]=value}},typedArray.reset=function(opt_index){cursor=opt_index||0},typedArray.numComponents=numComponents,Object.defineProperty(typedArray,"numElements",{get:function(){return this.length/this.numComponents|0}}),typedArray}function createAugmentedTypedArray(numComponents,numElements,opt_type){return augmentTypedArray(new(opt_type||Float32Array)(numComponents*numElements),numComponents)}function allButIndices(name){return"indices"!==name}function deindexVertices(vertices){function expandToUnindexed(channel){for(var srcBuffer=vertices[channel],numComponents=srcBuffer.numComponents,dstBuffer=createAugmentedTypedArray(numComponents,numElements,srcBuffer.constructor),ii=0;ii<numElements;++ii)for(var ndx=indices[ii],offset=ndx*numComponents,jj=0;jj<numComponents;++jj)dstBuffer.push(srcBuffer[offset+jj]);newVertices[channel]=dstBuffer}var indices=vertices.indices,newVertices={},numElements=indices.length;return Object.keys(vertices).filter(allButIndices).forEach(expandToUnindexed),newVertices}function flattenNormals(vertices){if(vertices.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var normals=vertices.normal,numNormals=normals.length,ii=0;ii<numNormals;ii+=9){var nax=normals[ii+0],nay=normals[ii+1],naz=normals[ii+2],nbx=normals[ii+3],nby=normals[ii+4],nbz=normals[ii+5],ncx=normals[ii+6],ncy=normals[ii+7],ncz=normals[ii+8],nx=nax+nbx+ncx,ny=nay+nby+ncy,nz=naz+nbz+ncz,length=Math.sqrt(nx*nx+ny*ny+nz*nz);nx/=length,ny/=length,nz/=length,normals[ii+0]=nx,normals[ii+1]=ny,normals[ii+2]=nz,normals[ii+3]=nx,normals[ii+4]=ny,normals[ii+5]=nz,normals[ii+6]=nx,normals[ii+7]=ny,normals[ii+8]=nz}return vertices}function applyFuncToV3Array(array,matrix,fn){for(var len=array.length,tmp=new Float32Array(3),ii=0;ii<len;ii+=3)fn(matrix,[array[ii],array[ii+1],array[ii+2]],tmp),array[ii]=tmp[0],array[ii+1]=tmp[1],array[ii+2]=tmp[2]}function transformNormal(mi,v,dst){dst=dst||v3.create();var v0=v[0],v1=v[1],v2=v[2];return dst[0]=v0*mi[0]+v1*mi[1]+v2*mi[2],dst[1]=v0*mi[4]+v1*mi[5]+v2*mi[6],dst[2]=v0*mi[8]+v1*mi[9]+v2*mi[10],dst}function reorientDirections(array,matrix){return applyFuncToV3Array(array,matrix,m4.transformDirection),array}function reorientNormals(array,matrix){return applyFuncToV3Array(array,m4.inverse(matrix),transformNormal),array}function reorientPositions(array,matrix){return applyFuncToV3Array(array,matrix,m4.transformPoint),array}function reorientVertices(arrays,matrix){return Object.keys(arrays).forEach(function(name){var array=arrays[name];name.indexOf("pos")>=0?reorientPositions(array,matrix):name.indexOf("tan")>=0||name.indexOf("binorm")>=0?reorientDirections(array,matrix):name.indexOf("norm")>=0&&reorientNormals(array,matrix)}),arrays}function createXYQuadVertices(size,xOffset,yOffset){return size=size||2,xOffset=xOffset||0,yOffset=yOffset||0,size*=.5,{position:{numComponents:2,data:[xOffset+-1*size,yOffset+-1*size,xOffset+1*size,yOffset+-1*size,xOffset+-1*size,yOffset+1*size,xOffset+1*size,yOffset+1*size]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function createPlaneVertices(width,depth,subdivisionsWidth,subdivisionsDepth,matrix){width=width||1,depth=depth||1,subdivisionsWidth=subdivisionsWidth||1,subdivisionsDepth=subdivisionsDepth||1,matrix=matrix||m4.identity();for(var numVertices=(subdivisionsWidth+1)*(subdivisionsDepth+1),positions=createAugmentedTypedArray(3,numVertices),normals=createAugmentedTypedArray(3,numVertices),texcoords=createAugmentedTypedArray(2,numVertices),z=0;z<=subdivisionsDepth;z++)for(var x=0;x<=subdivisionsWidth;x++){var u=x/subdivisionsWidth,v=z/subdivisionsDepth;positions.push(width*u-.5*width,0,depth*v-.5*depth),normals.push(0,1,0),texcoords.push(u,v)}for(var numVertsAcross=subdivisionsWidth+1,indices=createAugmentedTypedArray(3,subdivisionsWidth*subdivisionsDepth*2,Uint16Array),z=0;z<subdivisionsDepth;z++)for(var x=0;x<subdivisionsWidth;x++)indices.push((z+0)*numVertsAcross+x,(z+1)*numVertsAcross+x,(z+0)*numVertsAcross+x+1),indices.push((z+1)*numVertsAcross+x,(z+1)*numVertsAcross+x+1,(z+0)*numVertsAcross+x+1);return reorientVertices({position:positions,normal:normals,texcoord:texcoords,indices:indices},matrix)}function createSphereVertices(radius,subdivisionsAxis,subdivisionsHeight,opt_startLatitudeInRadians,opt_endLatitudeInRadians,opt_startLongitudeInRadians,opt_endLongitudeInRadians){if(subdivisionsAxis<=0||subdivisionsHeight<=0)throw Error("subdivisionAxis and subdivisionHeight must be > 0");opt_startLatitudeInRadians=opt_startLatitudeInRadians||0,opt_endLatitudeInRadians=opt_endLatitudeInRadians||Math.PI,opt_startLongitudeInRadians=opt_startLongitudeInRadians||0,opt_endLongitudeInRadians=opt_endLongitudeInRadians||2*Math.PI;for(var latRange=opt_endLatitudeInRadians-opt_startLatitudeInRadians,longRange=opt_endLongitudeInRadians-opt_startLongitudeInRadians,numVertices=(subdivisionsAxis+1)*(subdivisionsHeight+1),positions=createAugmentedTypedArray(3,numVertices),normals=createAugmentedTypedArray(3,numVertices),texcoords=createAugmentedTypedArray(2,numVertices),y=0;y<=subdivisionsHeight;y++)for(var x=0;x<=subdivisionsAxis;x++){var u=x/subdivisionsAxis,v=y/subdivisionsHeight,theta=longRange*u,phi=latRange*v,sinTheta=Math.sin(theta),cosTheta=Math.cos(theta),sinPhi=Math.sin(phi),cosPhi=Math.cos(phi),ux=cosTheta*sinPhi,uy=cosPhi,uz=sinTheta*sinPhi;positions.push(radius*ux,radius*uy,radius*uz),normals.push(ux,uy,uz),texcoords.push(1-u,v)}for(var numVertsAround=subdivisionsAxis+1,indices=createAugmentedTypedArray(3,subdivisionsAxis*subdivisionsHeight*2,Uint16Array),x=0;x<subdivisionsAxis;x++)for(var y=0;y<subdivisionsHeight;y++)indices.push((y+0)*numVertsAround+x,(y+0)*numVertsAround+x+1,(y+1)*numVertsAround+x),indices.push((y+1)*numVertsAround+x,(y+0)*numVertsAround+x+1,(y+1)*numVertsAround+x+1);return{position:positions,normal:normals,texcoord:texcoords,indices:indices}}function createCubeVertices(size){size=size||1;for(var k=size/2,cornerVertices=[[-k,-k,-k],[+k,-k,-k],[-k,+k,-k],[+k,+k,-k],[-k,-k,+k],[+k,-k,+k],[-k,+k,+k],[+k,+k,+k]],faceNormals=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],uvCoords=[[1,0],[0,0],[0,1],[1,1]],positions=createAugmentedTypedArray(3,24),normals=createAugmentedTypedArray(3,24),texcoords=createAugmentedTypedArray(2,24),indices=createAugmentedTypedArray(3,12,Uint16Array),f=0;f<6;++f){for(var faceIndices=CUBE_FACE_INDICES[f],v=0;v<4;++v){var position=cornerVertices[faceIndices[v]],normal=faceNormals[f],uv=uvCoords[v];positions.push(position),normals.push(normal),texcoords.push(uv)}var offset=4*f;indices.push(offset+0,offset+1,offset+2),indices.push(offset+0,offset+2,offset+3)}return{position:positions,normal:normals,texcoord:texcoords,indices:indices}}function createTruncatedConeVertices(bottomRadius,topRadius,height,radialSubdivisions,verticalSubdivisions,opt_topCap,opt_bottomCap){if(radialSubdivisions<3)throw Error("radialSubdivisions must be 3 or greater");if(verticalSubdivisions<1)throw Error("verticalSubdivisions must be 1 or greater");for(var topCap=void 0===opt_topCap||opt_topCap,bottomCap=void 0===opt_bottomCap||opt_bottomCap,extra=(topCap?2:0)+(bottomCap?2:0),numVertices=(radialSubdivisions+1)*(verticalSubdivisions+1+extra),positions=createAugmentedTypedArray(3,numVertices),normals=createAugmentedTypedArray(3,numVertices),texcoords=createAugmentedTypedArray(2,numVertices),indices=createAugmentedTypedArray(3,radialSubdivisions*(verticalSubdivisions+extra)*2,Uint16Array),vertsAroundEdge=radialSubdivisions+1,slant=Math.atan2(bottomRadius-topRadius,height),cosSlant=Math.cos(slant),sinSlant=Math.sin(slant),start=topCap?-2:0,end=verticalSubdivisions+(bottomCap?2:0),yy=start;yy<=end;++yy){var ringRadius,v=yy/verticalSubdivisions,y=height*v;yy<0?(y=0,v=1,ringRadius=bottomRadius):yy>verticalSubdivisions?(y=height,v=1,ringRadius=topRadius):ringRadius=bottomRadius+yy/verticalSubdivisions*(topRadius-bottomRadius),-2!==yy&&yy!==verticalSubdivisions+2||(ringRadius=0,v=0),y-=height/2;for(var ii=0;ii<vertsAroundEdge;++ii){var sin=Math.sin(ii*Math.PI*2/radialSubdivisions),cos=Math.cos(ii*Math.PI*2/radialSubdivisions);positions.push(sin*ringRadius,y,cos*ringRadius),normals.push(yy<0||yy>verticalSubdivisions?0:sin*cosSlant,yy<0?-1:yy>verticalSubdivisions?1:sinSlant,yy<0||yy>verticalSubdivisions?0:cos*cosSlant),texcoords.push(ii/radialSubdivisions,1-v)}}for(var yy=0;yy<verticalSubdivisions+extra;++yy)for(var ii=0;ii<radialSubdivisions;++ii)indices.push(vertsAroundEdge*(yy+0)+0+ii,vertsAroundEdge*(yy+0)+1+ii,vertsAroundEdge*(yy+1)+1+ii),indices.push(vertsAroundEdge*(yy+0)+0+ii,vertsAroundEdge*(yy+1)+1+ii,vertsAroundEdge*(yy+1)+0+ii);return{position:positions,normal:normals,texcoord:texcoords,indices:indices}}function expandRLEData(rleData,padding){padding=padding||[];for(var data=[],ii=0;ii<rleData.length;ii+=4){var runLength=rleData[ii],element=rleData.slice(ii+1,ii+4);element.push.apply(element,padding);for(var jj=0;jj<runLength;++jj)data.push.apply(data,element)}return data}function create3DFVertices(){var positions=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],texcoords=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],normals=expandRLEData([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),colors=expandRLEData([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),numVerts=positions.length/3,arrays={position:createAugmentedTypedArray(3,numVerts),texcoord:createAugmentedTypedArray(2,numVerts),normal:createAugmentedTypedArray(3,numVerts),color:createAugmentedTypedArray(4,numVerts,Uint8Array),indices:createAugmentedTypedArray(3,numVerts/3,Uint16Array)};arrays.position.push(positions),arrays.texcoord.push(texcoords),
arrays.normal.push(normals),arrays.color.push(colors);for(var ii=0;ii<numVerts;++ii)arrays.indices.push(ii);return arrays}function createCresentVertices(verticalRadius,outerRadius,innerRadius,thickness,subdivisionsDown,startOffset,endOffset){function lerp(a,b,s){return a+(b-a)*s}function createArc(arcRadius,x,normalMult,normalAdd,uMult,uAdd){for(var z=0;z<=subdivisionsDown;z++){var uBack=x/(subdivisionsThick-1),v=z/subdivisionsDown,xBack=2*(uBack-.5),angle=(startOffset+v*offsetRange)*Math.PI,s=Math.sin(angle),c=Math.cos(angle),radius=lerp(verticalRadius,arcRadius,s),px=xBack*thickness,py=c*verticalRadius,pz=s*radius;positions.push(px,py,pz);var n=v3.add(v3.multiply([0,s,c],normalMult),normalAdd);normals.push(n),texcoords.push(uBack*uMult+uAdd,v)}}function createSurface(leftArcOffset,rightArcOffset){for(var z=0;z<subdivisionsDown;++z)indices.push(leftArcOffset+z+0,leftArcOffset+z+1,rightArcOffset+z+0),indices.push(leftArcOffset+z+1,rightArcOffset+z+1,rightArcOffset+z+0)}if(subdivisionsDown<=0)throw Error("subdivisionDown must be > 0");startOffset=startOffset||0,endOffset=endOffset||1;for(var subdivisionsThick=2,offsetRange=endOffset-startOffset,numVertices=2*(subdivisionsDown+1)*(2+subdivisionsThick),positions=createAugmentedTypedArray(3,numVertices),normals=createAugmentedTypedArray(3,numVertices),texcoords=createAugmentedTypedArray(2,numVertices),x=0;x<subdivisionsThick;x++){var uBack=2*(x/(subdivisionsThick-1)-.5);createArc(outerRadius,x,[1,1,1],[0,0,0],1,0),createArc(outerRadius,x,[0,0,0],[uBack,0,0],0,0),createArc(innerRadius,x,[1,1,1],[0,0,0],1,0),createArc(innerRadius,x,[0,0,0],[uBack,0,0],0,1)}var indices=createAugmentedTypedArray(3,2*subdivisionsDown*(2+subdivisionsThick),Uint16Array),numVerticesDown=subdivisionsDown+1;return createSurface(0*numVerticesDown,4*numVerticesDown),createSurface(5*numVerticesDown,7*numVerticesDown),createSurface(6*numVerticesDown,2*numVerticesDown),createSurface(3*numVerticesDown,1*numVerticesDown),{position:positions,normal:normals,texcoord:texcoords,indices:indices}}function createCylinderVertices(radius,height,radialSubdivisions,verticalSubdivisions,topCap,bottomCap){return createTruncatedConeVertices(radius,radius,height,radialSubdivisions,verticalSubdivisions,topCap,bottomCap)}function createTorusVertices(radius,thickness,radialSubdivisions,bodySubdivisions,startAngle,endAngle){if(radialSubdivisions<3)throw Error("radialSubdivisions must be 3 or greater");if(bodySubdivisions<3)throw Error("verticalSubdivisions must be 3 or greater");startAngle=startAngle||0,endAngle=endAngle||2*Math.PI;for(var range=endAngle-startAngle,radialParts=radialSubdivisions+1,bodyParts=bodySubdivisions+1,numVertices=radialParts*bodyParts,positions=createAugmentedTypedArray(3,numVertices),normals=createAugmentedTypedArray(3,numVertices),texcoords=createAugmentedTypedArray(2,numVertices),indices=createAugmentedTypedArray(3,radialSubdivisions*bodySubdivisions*2,Uint16Array),slice=0;slice<bodyParts;++slice)for(var v=slice/bodySubdivisions,sliceAngle=v*Math.PI*2,sliceSin=Math.sin(sliceAngle),ringRadius=radius+sliceSin*thickness,ny=Math.cos(sliceAngle),y=ny*thickness,ring=0;ring<radialParts;++ring){var u=ring/radialSubdivisions,ringAngle=startAngle+u*range,xSin=Math.sin(ringAngle),zCos=Math.cos(ringAngle),x=xSin*ringRadius,z=zCos*ringRadius,nx=xSin*sliceSin,nz=zCos*sliceSin;positions.push(x,y,z),normals.push(nx,ny,nz),texcoords.push(u,1-v)}for(var slice=0;slice<bodySubdivisions;++slice)for(var ring=0;ring<radialSubdivisions;++ring){var nextRingIndex=1+ring,nextSliceIndex=1+slice;indices.push(radialParts*slice+ring,radialParts*nextSliceIndex+ring,radialParts*slice+nextRingIndex),indices.push(radialParts*nextSliceIndex+ring,radialParts*nextSliceIndex+nextRingIndex,radialParts*slice+nextRingIndex)}return{position:positions,normal:normals,texcoord:texcoords,indices:indices}}function createDiscVertices(radius,divisions,stacks,innerRadius,stackPower){if(divisions<3)throw Error("divisions must be at least 3");stacks=stacks||1,stackPower=stackPower||1,innerRadius=innerRadius||0;for(var numVertices=(divisions+1)*(stacks+1),positions=createAugmentedTypedArray(3,numVertices),normals=createAugmentedTypedArray(3,numVertices),texcoords=createAugmentedTypedArray(2,numVertices),indices=createAugmentedTypedArray(3,stacks*divisions*2,Uint16Array),firstIndex=0,radiusSpan=radius-innerRadius,pointsPerStack=divisions+1,stack=0;stack<=stacks;++stack){for(var stackRadius=innerRadius+radiusSpan*Math.pow(stack/stacks,stackPower),i=0;i<=divisions;++i){var theta=2*Math.PI*i/divisions,x=stackRadius*Math.cos(theta),z=stackRadius*Math.sin(theta);if(positions.push(x,0,z),normals.push(0,1,0),texcoords.push(1-i/divisions,stack/stacks),stack>0&&i!==divisions){var a=firstIndex+(i+1),b=firstIndex+i,c=firstIndex+i-pointsPerStack,d=firstIndex+(i+1)-pointsPerStack;indices.push(a,b,c),indices.push(a,c,d)}}firstIndex+=divisions+1}return{position:positions,normal:normals,texcoord:texcoords,indices:indices}}function randInt(range){return Math.random()*range|0}function makeRandomVertexColors(vertices,options){options=options||{};var numElements=vertices.position.numElements,vcolors=createAugmentedTypedArray(4,numElements,Uint8Array),rand=options.rand||function(ndx,channel){return channel<3?randInt(256):255};if(vertices.color=vcolors,vertices.indices)for(var ii=0;ii<numElements;++ii)vcolors.push(rand(ii,0),rand(ii,1),rand(ii,2),rand(ii,3));else for(var numVertsPerColor=options.vertsPerColor||3,numSets=numElements/numVertsPerColor,ii=0;ii<numSets;++ii)for(var color=[rand(ii,0),rand(ii,1),rand(ii,2),rand(ii,3)],jj=0;jj<numVertsPerColor;++jj)vcolors.push(color);return vertices}function createBufferFunc(fn){return function(gl){var arrays=fn.apply(this,Array.prototype.slice.call(arguments,1));return attributes.createBuffersFromArrays(gl,arrays)}}function createBufferInfoFunc(fn){return function(gl){var arrays=fn.apply(null,Array.prototype.slice.call(arguments,1));return attributes.createBufferInfoFromArrays(gl,arrays)}}function copyElements(src,dst,dstNdx,offset){offset=offset||0;for(var length=src.length,ii=0;ii<length;++ii)dst[dstNdx+ii]=src[ii]+offset}function createArrayOfSameType(srcArray,length){var arraySrc=getArray(srcArray),newArray=new arraySrc.constructor(length),newArraySpec=newArray;return arraySrc.numComponents&&arraySrc.numElements&&augmentTypedArray(newArray,arraySrc.numComponents),srcArray.data&&(newArraySpec={data:newArray},utils.copyNamedProperties(arraySpecPropertyNames,srcArray,newArraySpec)),newArraySpec}function concatVertices(arrayOfArrays){function getLengthOfCombinedArrays(name){for(var arraySpec,length=0,ii=0;ii<arrayOfArrays.length;++ii){var arrays=arrayOfArrays[ii],arrayInfo=arrays[name];length+=getArray(arrayInfo).length,arraySpec&&!arrayInfo.data||(arraySpec=arrayInfo)}return{length:length,spec:arraySpec}}function copyArraysToNewArray(name,base,newArray){for(var baseIndex=0,offset=0,ii=0;ii<arrayOfArrays.length;++ii){var arrays=arrayOfArrays[ii],arrayInfo=arrays[name],array=getArray(arrayInfo);"indices"===name?(copyElements(array,newArray,offset,baseIndex),baseIndex+=base[ii]):copyElements(array,newArray,offset),offset+=array.length}}for(var baseName,names={},ii=0;ii<arrayOfArrays.length;++ii){var arrays=arrayOfArrays[ii];Object.keys(arrays).forEach(function(name){names[name]||(names[name]=[]),baseName||"indices"===name||(baseName=name);var arrayInfo=arrays[name],numComponents=getNumComponents(arrayInfo,name),array=getArray(arrayInfo),numElements=array.length/numComponents;names[name].push(numElements)})}var base=names[baseName],newArrays={};return Object.keys(names).forEach(function(name){var info=getLengthOfCombinedArrays(name),newArraySpec=createArrayOfSameType(info.spec,info.length);copyArraysToNewArray(name,base,getArray(newArraySpec)),newArrays[name]=newArraySpec}),newArrays}function duplicateVertices(arrays){var newArrays={};return Object.keys(arrays).forEach(function(name){var arraySpec=arrays[name],srcArray=getArray(arraySpec),newArraySpec=createArrayOfSameType(arraySpec,srcArray.length);copyElements(srcArray,getArray(newArraySpec),0),newArrays[name]=newArraySpec}),newArrays}var getArray=attributes.getArray_,getNumComponents=attributes.getNumComponents_,CUBE_FACE_INDICES=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]],arraySpecPropertyNames=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];return{create3DFBufferInfo:createBufferInfoFunc(create3DFVertices),create3DFBuffers:createBufferFunc(create3DFVertices),create3DFVertices:create3DFVertices,createAugmentedTypedArray:createAugmentedTypedArray,createCubeBufferInfo:createBufferInfoFunc(createCubeVertices),createCubeBuffers:createBufferFunc(createCubeVertices),createCubeVertices:createCubeVertices,createPlaneBufferInfo:createBufferInfoFunc(createPlaneVertices),createPlaneBuffers:createBufferFunc(createPlaneVertices),createPlaneVertices:createPlaneVertices,createSphereBufferInfo:createBufferInfoFunc(createSphereVertices),createSphereBuffers:createBufferFunc(createSphereVertices),createSphereVertices:createSphereVertices,createTruncatedConeBufferInfo:createBufferInfoFunc(createTruncatedConeVertices),createTruncatedConeBuffers:createBufferFunc(createTruncatedConeVertices),createTruncatedConeVertices:createTruncatedConeVertices,createXYQuadBufferInfo:createBufferInfoFunc(createXYQuadVertices),createXYQuadBuffers:createBufferFunc(createXYQuadVertices),createXYQuadVertices:createXYQuadVertices,createCresentBufferInfo:createBufferInfoFunc(createCresentVertices),createCresentBuffers:createBufferFunc(createCresentVertices),createCresentVertices:createCresentVertices,createCylinderBufferInfo:createBufferInfoFunc(createCylinderVertices),createCylinderBuffers:createBufferFunc(createCylinderVertices),createCylinderVertices:createCylinderVertices,createTorusBufferInfo:createBufferInfoFunc(createTorusVertices),createTorusBuffers:createBufferFunc(createTorusVertices),createTorusVertices:createTorusVertices,createDiscBufferInfo:createBufferInfoFunc(createDiscVertices),createDiscBuffers:createBufferFunc(createDiscVertices),createDiscVertices:createDiscVertices,deindexVertices:deindexVertices,flattenNormals:flattenNormals,makeRandomVertexColors:makeRandomVertexColors,reorientDirections:reorientDirections,reorientNormals:reorientNormals,reorientPositions:reorientPositions,reorientVertices:reorientVertices,concatVertices:concatVertices,duplicateVertices:duplicateVertices}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}])})},{}],22:[function(require,module,exports){(function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;return arguments.length<3&&(memo=obj[keys?keys[index]:index],index+=dir),iterator(obj,iteratee,memo,keys,index,length)}}function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&index<length;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length)return idx=sortedIndex(array,item),array[idx]===item?idx:-1;if(item!==item)return idx=predicateFind(slice.call(array,i,length),_.isNaN),idx>=0?idx+i:-1;for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir)if(array[idx]===item)return idx;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";for(_.has(obj,prop)&&!_.contains(keys,prop)&&keys.push(prop);nonEnumIdx--;)(prop=nonEnumerableProps[nonEnumIdx])in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)&&keys.push(prop)}var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};void 0!==exports?(void 0!==module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||null==obj)return obj;for(var index=1;index<length;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;i<l;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results},_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;if(void 0!==(key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context))&&-1!==key)return obj[key]},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1},_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){return isArrayLike(obj)||(obj=_.values(obj)),("number"!=typeof fromIndex||guard)&&(fromIndex=0),_.indexOf(obj,item,fromIndex)>=0},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)(value=obj[i])>result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){((computed=iteratee(value,index,list))>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)(value=obj[i])<result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){((computed=iteratee(value,index,list))<lastComputed||computed===1/0&&result===1/0)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;index<length;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(isArrayLike(obj)||(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=cb(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=cb(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):isArrayLike(obj)?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:_.initial(array,array.length-n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:_.rest(array,Math.max(0,array.length-n))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;for(output.length+=len;j<len;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1)},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;isSorted?(i&&seen===computed||result.push(value),seen=computed):iteratee?_.contains(seen,computed)||(seen.push(computed),result.push(value)):_.contains(result,value)||result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0))},_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);i<length;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;j<argsLength&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(array){for(var length=array&&_.max(array,getLength).length||0,result=Array(length),index=0;index<length;index++)result[index]=_.pluck(array,index);return result},_.object=function(list,values){for(var result={},i=0,length=getLength(list);i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.findIndex=createPredicateIndexFinder(1),_.findLastIndex=createPredicateIndexFinder(-1),_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=getLength(array);low<high;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex),_.lastIndexOf=createIndexFinder(-1,_.findLastIndex),_.range=function(start,stop,step){null==stop&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;idx<length;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return _.isObject(result)?result:self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound},_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;i<length;i++)args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound},_.bindAll=function(obj){var i,key,length=arguments.length;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=_.partial(_.delay,_,1),_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;last<wait&&last>=0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.before=function(times,func){var memo;return function(){return--times>0&&(memo=func.apply(this,arguments)),times<=1&&(func=null),memo}},_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=_.keys(obj),length=keys.length,results={},index=0;index<length;index++)currentKey=keys[index],results[currentKey]=iteratee(obj[currentKey],currentKey,obj);return results},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=createAssigner(_.allKeys),_.extendOwn=_.assign=createAssigner(_.keys),_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=_.keys(obj),i=0,length=keys.length;i<length;i++)if(key=keys[i],predicate(obj[key],key,obj))return key},_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;_.isFunction(oiteratee)?(keys=_.allKeys(obj),iteratee=optimizeCb(oiteratee,context)):(keys=flatten(arguments,!1,!1,1),iteratee=function(value,key,obj){return key in obj},obj=Object(obj));for(var i=0,length=keys.length;i<length;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=createAssigner(_.allKeys,!0),_.create=function(prototype,props){var result=baseCreate(prototype);return props&&_.extendOwn(result,props),result},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[],bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;if(aStack.push(a),bStack.push(b),areArrays){if((length=a.length)!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=_.keys(a);if(length=keys.length,_.keys(b).length!==length)return!1;for(;length--;)if(key=keys[length],!_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}return aStack.pop(),bStack.pop(),!0};_.isEqual=function(a,b){return eq(a,b)},_.isEmpty=function(obj){return null==obj||(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))?0===obj.length:0===_.keys(obj).length)},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return!0===obj||!1===obj||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=property,_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}},_.matcher=_.matches=function(attrs){return attrs=_.extendOwn({},attrs),function(obj){return _.isMatch(obj,attrs)}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]
},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property,fallback){var value=null==object?void 0:object[property];return void 0===value&&(value=fallback),_.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||/(.)^/).source,(settings.interpolate||/(.)^/).source,(settings.evaluate||/(.)^/).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(/\\|'|\r|\n|\u2028|\u2029/g,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}],23:[function(require,module,exports){let app=angular.module("WebGLVolumeRendererClient",["semantic-ui","rzModule"]);app.controller("master-controller",require("./ng-controllers/master-controller")),app.directive("linksAndViewsView",require("./ng-directives/links-and-views-view")),app.directive("tfWidget",require("./ng-directives/transfer-function-view")),app.directive("datasetManagerView",require("./ng-directives/dataset-view")),app.directive("cameraSettingsView",require("./ng-directives/camera-settings-view")),app.directive("globalControlPanel",require("./ng-directives/global-control-panel-view")),app.directive("localControlPanel",require("./ng-directives/local-control-panel-view")),setTimeout(()=>{window.dispatchEvent(new Event("resize"))},1e3),module.exports=app},{"./ng-controllers/master-controller":29,"./ng-directives/camera-settings-view":31,"./ng-directives/dataset-view":32,"./ng-directives/global-control-panel-view":33,"./ng-directives/links-and-views-view":34,"./ng-directives/local-control-panel-view":35,"./ng-directives/transfer-function-view":36}],24:[function(require,module,exports){let controller=(require("../../core/environment"),function($scope,$timeout){$scope.cameraMode="perspective",$scope.setCameraMode=(mode=>{$scope.cameraMode=mode}),$scope.alignCamera=(align=>{}),$scope.resetZoom=(()=>{}),$scope.DOMReady=(()=>{})});module.exports=controller},{"../../core/environment":38}],25:[function(require,module,exports){let Environment=require("../../core/environment"),WSClient=require("../../client2server/websocket-client"),GET=WSClient.GET,Settings=require("../../core/settings").WSClient,Timeouts=Settings.Timeouts,controller=(new FileReader,function($scope,$timeout){let loaderElement=null,statusElement=null,setLoaderVisibility=visible=>{loaderElement.style.display=visible?"block":"none"},setStatusVisibility=visible=>{statusElement.style.display=visible?"block":"none"};$scope.loaderText="...",$scope.loadAutomatically=Settings.loadAutomaticallyByDefault,$scope.selectedDataset="one",$scope.datasets=["one","two","three"];let fetchDatasets=()=>{setStatusVisibility(!1);$scope.loaderText="Getting list of datasets...";setLoaderVisibility(!0);GET({type:"dataset-list"},!0,Timeouts.getDatasetList).then(list=>{$scope.loaderText="Successfully fetched dataset list";setLoaderVisibility(!1);$scope.datasets=list;$scope.selectedDataset=list[0];$scope.$apply();$scope.loadAutomatically&&$scope.loadSelectedDataset();return}).catch(e=>{setLoaderVisibility(!1)})};$scope.$watch("selectedDataset",(newValue,oldValue)=>{newValue!==oldValue&&setStatusVisibility(!1);$scope.loadAutomatically&&$scope.loadSelectedDataset()}),$scope.loadSelectedDataset=(()=>{setStatusVisibility(!1);let base="Getting dataset "+$scope.selectedDataset+" ... ";$scope.loaderText=base+" header";setLoaderVisibility(!0);GET({type:"dataset",dataset:$scope.selectedDataset,field:"header"},!0,Timeouts.getDatasetHeader).then(header=>{$scope.loaderText=base+" isovalues";$scope.$apply();GET({type:"dataset",dataset:$scope.selectedDataset,field:"isovalues"},!1,Timeouts.getDatasetIsovalues).then(arraybuffer=>{$scope.loaderText="Successfully fetched dataset "+$scope.selectedDataset;$scope.$apply();setTimeout(()=>{setLoaderVisibility(!1);setStatusVisibility(!0)},2e3);let isovalues=new Int16Array(arraybuffer);Environment.notifyDatasetWasLoaded($scope.selectedDataset,header,isovalues);return}).catch(e=>{$scope.loaderText="Timed out getting isovalues (timeout = "+Timeouts.getDatasetIsovalues+" ms)";$scope.$apply()})}).catch(e=>{$scope.loaderText="Timed out getting header... (max wait = "+Timeouts.getDatasetHeader+" ms)";$scope.$apply();setLoaderVisibility(!1)})}),$scope.DOMReady=(()=>{loaderElement=document.getElementById("dataset-manager-view-status");statusElement=document.getElementById("dataset-manager-status2");fetchDatasets()})});module.exports=controller},{"../../client2server/websocket-client":37,"../../core/environment":38,"../../core/settings":57}],26:[function(require,module,exports){let controller=(require("../../core/environment"),require("../../client2server/websocket-client").GET,function($scope){$scope.DOMReady=(()=>{}),$scope.onOpenTFEditorPane=(()=>{setTimeout(function(){window.dispatchEvent(new Event("resizeTFEditor"))},200)})});module.exports=controller},{"../../client2server/websocket-client":37,"../../core/environment":38}],27:[function(require,module,exports){let InitMiniatureSplitviewManager=require("../../widgets/split-view/view-splitter-master-controller").init,LinkableModels=require("../../core/linkable-models").Models,Environment=require("../../core/environment"),controller=function($scope){let viewID2LinkerKey={1:LinkableModels.TRANSFER_FUNCTION.name,2:LinkableModels.CAMERA.name,3:LinkableModels.SLICER.name,4:LinkableModels.THRESHOLDS.name},callbacks={linkChanged:Environment.notifyLinkChanged,layoutChanged:Environment.notifyLayoutChanged,viewTypeChanged:Environment.notifyViewTypeChanged},objController=null;$scope.addViewText="Adding...",$scope.MainViewMode="ADD",$scope.addView=(()=>{$scope.MainViewMode="ADD";objController.changeAddRemoveState("ADD");$scope.addViewText="Adding..."}),$scope.removeView=(()=>{$scope.MainViewMode="REMOVE";objController.changeAddRemoveState("REMOVE");$scope.addViewText="Deleting..."}),$scope.changeView=(()=>{objController.changeAddRemoveState("EDIT");$scope.MainViewMode="EDIT"}),$scope.isGlobal={1:!1,2:!1,3:!1,4:!1},$scope.toggleGlobal=(id=>{$scope.isGlobal[id]=!$scope.isGlobal[id];Environment.notifyModelPointsToGlobalChanged(viewID2LinkerKey[id],$scope.isGlobal[id])}),$scope.DOMReady=(()=>{objController=InitMiniatureSplitviewManager(callbacks);Environment.ready("LinksAndViewsController")});let linkStates={[LinkableModels.TRANSFER_FUNCTION.name]:"LINK-ADD",[LinkableModels.CAMERA.name]:"LINK-ADD",[LinkableModels.SLICER.name]:"LINK-ADD",[LinkableModels.THRESHOLDS.name]:"LINK-ADD"};$scope.linkStates=linkStates,$scope.isActiveLinker=((id,on)=>"LINK-ADD"===linkStates[viewID2LinkerKey[id]]),$scope.isAddMode=(()=>isAddMode),$scope.isChangeViewMode=(()=>isChangeViewMode),$scope.getLinkerState=(id=>{let key=viewID2LinkerKey[id];return"LINK-ADD"===linkStates[key]?"Adding...":"Deleting..."}),$scope.setLinkerState=((id,state)=>{let key=viewID2LinkerKey[id];objController.changeLinkerState(key,state);linkStates[key]=state});()=>{for(let id in viewID2LinkerKey){let key=viewID2LinkerKey[id],state=linkStates[key];"LINK-ADD"===state&&$(".view-splitter-button.id-"+id+"-on").addClass("linkbtn-highlight")}}};module.exports=controller},{"../../core/environment":38,"../../core/linkable-models":41,"../../widgets/split-view/view-splitter-master-controller":75}],28:[function(require,module,exports){let controller=(require("../../core/environment"),require("../../client2server/websocket-client").GET,function($scope){$scope.DOMReady=(()=>{})});module.exports=controller},{"../../client2server/websocket-client":37,"../../core/environment":38}],29:[function(require,module,exports){module.exports=function($scope){let isControlsHidden=!1,showControls=()=>{};()=>{};$scope.toggleShowControls=(()=>{showControls();isControlsHidden=!isControlsHidden}),$(".panel-left").resizable({handleSelector:".splitter",resizeHeight:!1,onDrag:()=>{window.dispatchEvent(new Event("resize"))}}),$(".panel-top").resizable({handleSelector:".splitter-horizontal",resizeWidth:!1})}},{}],30:[function(require,module,exports){let TF_INTERACTION_MODES={1:"Select",2:"TF"};require("jquery");require("spectrum-colorpicker");let TransferFunctionEditor=require("../../widgets/transfer-function/transfer-function-editor-v2"),Environment=require("../../core/environment"),controller=function($scope,$timeout){let tfEditor=null;$scope.thresholdSlider={minValue:0,maxValue:4095,options:{floor:0,ceil:4095,step:1,onChange:()=>{Environment.notifyIsoThresholdChanged($scope.name,$scope.thresholdSlider.minValue,$scope.thresholdSlider.maxValue)}}},$scope.displayOptions={showHistogram:!0,showHistogramSelection:!0,showTransferFunction:!0,show3DSelectionHistogram:!1},$scope.displayOptionsChanged=function(){tfEditor.render()},$scope.gradientMagSlider={weighting:100,minValue:0,options:{floor:0,ceil:100,step:1,precision:0,draggableRange:!1,showSelectionBar:!1,hideLimitLabels:!1,readOnly:!1,disabled:!1,showTicks:!1,showTicksValues:!1}},$scope.curvatureSlider={weighting:100,minValue:0,options:{floor:0,ceil:100,step:1,precision:0,draggableRange:!1,showSelectionBar:!1,hideLimitLabels:!1,readOnly:!1,disabled:!1,showTicks:!1,showTicksValues:!1}},$scope.onChange=(()=>{alert("SCOPEchange")}),this.onChange=(()=>{alert("THISchange")}),window["MYSCOPE"+$scope.$id]=$scope,$scope.interactionMode=2,$scope.getInteractionMode=function(){return TF_INTERACTION_MODES[$scope.interactionMode]},$scope.DOMReady=(()=>{tfEditor=new TransferFunctionEditor($scope.displayOptions,$scope.getInteractionMode,$scope.$id,$scope.name);tfEditor.notifyModelDidChange();tfEditor.render();$scope.$watch("displayOptions",(newV,oldV)=>{tfEditor.render()},!0);Environment.TransferFunctionManager.notifyTFPointsToCanvasWithID($scope.name,$scope.$id);Environment.ready("TransferFunctionController")}),$scope.renderTFEditor=(()=>{tfEditor.render()}),$scope.clearTFEditor=(()=>{tfEditor._clear()})};module.exports=controller},{"../../core/environment":38,"../../widgets/transfer-function/transfer-function-editor-v2":77,jquery:18,"spectrum-colorpicker":19}],31:[function(require,module,exports){let cameraSettingsViewController=require("../ng-controllers/camera-settings-view-controller"),directive=function($timeout){return{restrict:"E",scope:{},replace:!0,transclude:!0,controller:cameraSettingsViewController,link:function(scope,element,attrs){$timeout(function(){scope.DOMReady()},0)},templateUrl:"src/angular-assets/ng-templates/camera-settings-view-template.html"}};module.exports=directive},{"../ng-controllers/camera-settings-view-controller":24}],32:[function(require,module,exports){let datasetViewController=require("../ng-controllers/dataset-view-controller"),directive=function($timeout){return{restrict:"E",scope:{},replace:!0,controller:datasetViewController,link:function(scope,element,attrs){$timeout(function(){scope.DOMReady()},0)},templateUrl:"src/angular-assets/ng-templates/dataset-view-template.html"}};module.exports=directive},{"../ng-controllers/dataset-view-controller":25}],33:[function(require,module,exports){let globalControlPanelController=require("../ng-controllers/global-control-panel-controller"),directive=function($timeout){return{restrict:"E",scope:{},replace:!0,controller:globalControlPanelController,link:function(scope,element,attrs){$timeout(function(){scope.DOMReady()},0)},templateUrl:"src/angular-assets/ng-templates/global-control-panel-template.html"}};module.exports=directive},{"../ng-controllers/global-control-panel-controller":26}],34:[function(require,module,exports){let localController=require("../ng-controllers/links-and-views-controller"),directive=function($timeout){return{restrict:"E",scope:{},controller:localController,link:function(scope,element,attrs){$timeout(function(){scope.DOMReady()},0)},templateUrl:"src/angular-assets/ng-templates/links-and-views-view-template.html"}};module.exports=directive},{"../ng-controllers/links-and-views-controller":27}],35:[function(require,module,exports){let localControlPanelController=require("../ng-controllers/local-control-panel-controller"),directive=function($timeout){return{restrict:"E",scope:{},controller:localControlPanelController,link:function(scope,element,attrs){$timeout(function(){scope.DOMReady()},0)},templateUrl:"src/angular-assets/ng-templates/local-control-panel-template.html"}};module.exports=directive},{"../ng-controllers/local-control-panel-controller":28}],36:[function(require,module,exports){let localController=require("../ng-controllers/transfer-function-view-controller"),Environment=require("../../core/environment"),directive=function($timeout){return{scope:{name:"@"},link:function(scope,element,attrs){$timeout(function(){Environment.TransferFunctionManager.addTransferFunction(scope.name),scope.DOMReady()},0)},transclude:!0,replace:!0,controller:localController,templateUrl:"src/angular-assets/ng-templates/transfer-function-view-template.html"}};module.exports=directive},{"../../core/environment":38,"../ng-controllers/transfer-function-view-controller":30}],37:[function(require,module,exports){function get(resource,doStringify,maxWait){return expectedType=doStringify?"stringjson":"blob",new Promise(function(resolve,reject){_send({type:"get",resource:resource,doStringify:doStringify});let fail=setTimeout(()=>{reject("Timed out")},maxWait);messageReceived=(()=>{clearTimeout(fail);return resolve(cache)})})}require("blob-to-buffer");let socket=(require("../main"),new WebSocket("ws://localhost:8081")),expect=null,cache=null;const _send=json=>{expect=json;socket.send(JSON.stringify(json));time=Date.now()};let time=-1;socket.onopen=(open=>{}),socket.onclose=(close=>{});let reader=(size=>{},new FileReader),expectedType="blob";socket.onmessage=(message=>{switch(expectedType){case"blob":reader.onloadend=(event=>{let buf=event.target.result;cache=buf;messageReceived()}),reader.readAsArrayBuffer(message.data);break;case"stringjson":cache=JSON.parse(message.data),messageReceived()}});let messageReceived=null;module.exports={GET:get}},{"../main":66,"blob-to-buffer":2}],38:[function(require,module,exports){let ViewManager=require("../core/views/view-manager"),DatasetManager=require("../datasets&selections/dataset-manager"),LinksAndLayout=require("../widgets/split-view/view-splitter-master-controller"),modes=require("./interaction-modes"),TransferFunctionManager=(modes.Interactions,modes.CameraModes,require("../widgets/transfer-function/transfer-function-manager"));require("../widgets/transfer-function/transfer-function"),require("../client2server/websocket-client");class Environment{constructor(){this.DatasetManager=new DatasetManager,this.links=LinksAndLayout.read().links,this.layout=LinksAndLayout.read().layout,this.ViewManager=null,this.TransferFunctionManager=new TransferFunctionManager(this),this.listeners={TFModelDidChange:{GLOBAL:null,LOCAL:null},DatasetDidChange:{GLOBAL:null,LOCAL:null}},this.notifyLinkChanged=(propertyKey=>{this.ViewManager.linkChanged(propertyKey)}),this.notifyIsoThresholdChanged=((editorName,newMin,newMax)=>{}),this.notifyModelPointsToGlobalChanged=((modelName,pointToGlobal)=>{this.ViewManager.setModelPointsToGlobal(modelName,pointToGlobal)}),this.notifyLayoutChanged=(event=>{switch(event.action){case"CELL_ADDED":this._initNewView(event.id);break;case"CELL_REMOVED":this._removeView(event.id)}}),this.notifyViewTypeChanged=((cellID,newType)=>{this.ViewManager.viewTypeChanged(cellID,newType)}),this.notifyDatasetWasLoaded=((name,header,isovalues)=>{this.DatasetManager.addDataset({name:name,header:header,isovalues:isovalues});this.ViewManager.datasetDidChange();this._notifyListeners("DatasetDidChange","LOCAL");this._notifyListeners("DatasetDidChange","GLOBAL")}),this.notifyDatasetWasRead=(()=>{this.DatasetManager.clearDataset()}),this.readyElements=[],window.addEventListener("keydown",event=>{switch(event.key){case"1":this.ViewManager.refresh();break;case"2":this.ViewManager._init()}})}ready(from){switch(this.readyElements.push(from),from){case"LinksAndViewsController":this.ViewManager=new ViewManager(this,LinksAndLayout.getAddRemoveView)}}_initNewView(id){this.ViewManager.addNewView(id),this.TransferFunctionManager.addTransferFunction(id)}_removeView(id){this.ViewManager.removeView(id),this.TransferFunctionManager.removeTransferFunction(id)}getTransferFunctionForViewWithCellID(cellID){if(this.GlobalOverrideLocals.TransferFunction)return this.TransferFunctionManager.getTransferFunction("GLOBAL");let masterID=this.links.getMasterCellIDForModel("TransferFunction",cellID);return this.TransferFunctionManager.getTransferFunction(masterID)}notifyTransferFunctionDidChangeAtEditor(tfEditorKey){this.ViewManager.transferFunctionDidChangeForSubviewID(tfEditorKey)}getHistogramForTFEditor(tfEditorKey){let cellID=this.TransferFunctionManager.getReferencedCellIDForTFKey(tfEditorKey);return this.DatasetManager.getHistogramForCellID(cellID)}getHistogramSelectionsForTFEditor(tfEditorKey){let cellID=this.TransferFunctionManager.getReferencedCellIDForTFKey(tfEditorKey);return this.DatasetManager.getHistogramSelectionForCellID(cellID)}get3DViewSelectionsHistogramForTFEditor(tfEditorKey){let cellID=this.TransferFunctionManager.getReferencedCellIDForTFKey(tfEditorKey);return this.DatasetManager.getViewSelectionForCellID(cellID)}getTransferFunctionForTFEditor(tfEditorKey){return this.TransferFunctionManager.test(),this.TransferFunctionManager.getTransferFunctionForTFEditorKey(tfEditorKey)}getActiveDataset(cellID){return this.DatasetManager.getDataset(cellID)}listen(channel,key,handle){this.listeners[channel][key]=handle}_notifyListeners(channel,key){this.listeners[channel][key]()}}let env=new Environment;window.TheEnvironment=env,module.exports=env},{"../client2server/websocket-client":37,"../core/views/view-manager":60,"../datasets&selections/dataset-manager":62,"../widgets/split-view/view-splitter-master-controller":75,"../widgets/transfer-function/transfer-function":79,"../widgets/transfer-function/transfer-function-manager":78,"./interaction-modes":40}],39:[function(require,module,exports){let _=require("underscore");class InteractionModeManager{constructor(){this.allModes={Slicer:["add","remove","rotate","move"],Sphere:[""],Volume:["rotate","zoom","move","select-point","select-ray","measure"]},this.modes={Slicer:"rotate",Sphere:null,Volume:"zoom"},this.verifyMode=!0}setInteractionMode(category,mode){let lowercasemode=mode.toLowerCase();lowercasemode=lowercasemode.split(" ")[0],this.verifyMode&&_.contains(this.allModes[category],lowercasemode),this.modes[category]=lowercasemode}getInteractionMode(category){return this.modes[category]}getInteractionModeGetterForCategory(category){return()=>this.getInteractionMode(category)}}module.exports=new InteractionModeManager},{underscore:22}],40:[function(require,module,exports){module.exports={Interactions:{MOVE:"Move",ROTATE:"Rotate",SHOOT_RAY:"Shoot Ray",SELECT_POINT:"Select Point",SELECT_CELL:"Select Cell",MEASURE:"Measure"},CameraModes:{PERSPECTIVE:"Perspective",ORTHO:"Orthographic"},SlicerModes:{ADD:"Add Slice",MOVE:"Move Slice",PIN_TO_SPHERE:"Pin to sphere",DELETE:"Delete"},SphereModes:{ROTATE:"Rotate Sphere",ADD:"Add... ",REMOVE:"Remove... ",AddRemove:{SLICE:"Slice",RAY:"Ray",LIGHT:"Spotlight"},MOVE:"Move... ",SELECT:"Select... ",MoveSelect:{RAY:"Ray",SPOTLIGHT:"Spotlight"},PIN:"Pin... ",UNPIN:"Unpin... ",PinUnpin:{SLICE:"Slice",RAY:"Ray",SPOTLIGHT:"Spotlight"}}}},{}],41:[function(require,module,exports){let TransferFunction=require("../widgets/transfer-function/transfer-function"),Camera=require("./models/camera-orbiter-v2"),Slicer=require("./models/slicer-model"),Thresholds=(require("./models/sphere-model"),require("./models/thresholds")),LinkableModels={TRANSFER_FUNCTION:{name:"TRANSFER_FUNCTION",class:TransferFunction},CAMERA:{name:"CAMERA",class:Camera},SLICER:{name:"Slicer",class:Slicer},THRESHOLDS:{name:"Thresholds",class:Thresholds}},modelsList=[];for(let key in LinkableModels)modelsList.push(LinkableModels[key].name);module.exports={ModelsList:modelsList,Models:LinkableModels}},{"../widgets/transfer-function/transfer-function":79,"./models/camera-orbiter-v2":42,"./models/slicer-model":45,"./models/sphere-model":46,"./models/thresholds":47}],42:[function(require,module,exports){let twgl=require("twgl.js"),m4=twgl.m4,v3=twgl.v3,glmvec4=require("gl-matrix").vec4,_=(require("gl-matrix").quat,require("underscore"));class Camera{constructor(args){this.radius=args.radius||5.2,this.theta=args.theta||Math.PI/3,this.phi=args.phi||Math.PI/3,this.target=args.target||v3.create(0,0,0),this.projectionSettings=args.projectionSettings||{fieldOfViewRadians:Math.PI/10,aspectRatio:1,zNear:.5,zFar:15},this.ROT_SPEED_X=args.ROT_SPEED_X||3.5,this.ROT_SPEED_Y=args.ROT_SPEED_Y||3.5,this.PAN_SPEED_X=args.PAN_SPEED_X||1.8,this.PAN_SPEED_Y=args.PAN_SPEED_Y||1.8,this.ZOOM_SPEED=args.ZOOM_SPEED||3.5,this.projection=null,this.view=null,this.translationVec=v3.create(0,0,0),this._updateViewMatrix(),this.setPerspective({}),this.mouseCache={isDrag:!1,mousedown:!1,mx:-1,my:-1,uv:null},this.upDir=1,this.rotate(1e-6,1e-6)}rotate(dTheta,dPhi){this.upDir>0?this.theta+=this.ROT_SPEED_X*dTheta:this.theta-=this.ROT_SPEED_X*dTheta,this.phi+=this.ROT_SPEED_Y*dPhi;let _2PI=2*Math.PI;this.phi>_2PI?this.phi-=_2PI:this.phi<-_2PI&&(this.phi+=_2PI),0<this.phi&&this.phi<Math.PI||-_2PI<this.phi&&this.phi<-Math.PI?this.upDir=1:this.upDir=-1,this._updateViewMatrix()}zoom(dist){this.radius-=dist*this.ZOOM_SPEED,this._updateViewMatrix()}pan(dx,dy){this.translationVec[0]+=dx*this.PAN_SPEED_X,this.translationVec[1]-=dy*this.PAN_SPEED_Y}tick(){}getEyePosition(){let x=this.radius*Math.sin(this.phi)*Math.sin(this.theta),y=this.radius*Math.cos(this.phi),z=this.radius*Math.sin(this.phi)*Math.cos(this.theta);return v3.create(x,y,z)}toCartesian(){let eye=this.getEyePosition(),look=v3.normalize(eye),worldUp=v3.create(0,this.upDir,0),right=v3.cross(look,worldUp);return{eye:eye,right:right,up:v3.cross(look,right),target:this.target}}setPerspective(args){this.projection=m4.perspective(args.fieldOfViewRadians||this.projectionSettings.fieldOfViewRadians,args.aspectRatio||this.projectionSettings.aspectRatio,args.zNear||this.projectionSettings.zNear,args.zFar||this.projectionSettings.zFar)}_updateViewMatrix(){let c=this.toCartesian();this.view=m4.inverse(m4.lookAt(c.eye,c.target,c.up))}getWorldViewProjectionMatrix(aspectRatio){return aspectRatio&&this.setPerspective({aspectRatio:aspectRatio}),m4.multiply(m4.translation(this.translationVec),m4.multiply(this.projection,this.view))}__unproject(devX,devY,devZ){let inverseVP=m4.inverse(m4.multiply(this.projection,this.view)),homogenous=glmvec4.fromValues(devX,devY,devZ,1),p=glmvec4.transformMat4(homogenous,homogenous,inverseVP),w=p[3];return v3.create(p[0]/w,p[1]/w,p[2]/w)}getRayFromMouseClick(vp01){let device={x:2*vp01.x-1,y:-(2*vp01.y-1)},p0=this.__unproject(device.x,device.y,-1),p1=this.__unproject(device.x,device.y,1),homogenous=glmvec4.fromValues(device.x,device.y,-1,1),inverseView=m4.inverse(this.view),inverseP=m4.inverse(this.projection),rayFromEye=glmvec4.transformMat4(glmvec4.create(),homogenous,inverseP);rayFromEye[2]=-1,rayFromEye[3]=1;let rayFromEyeWORLD=glmvec4.transformMat4(glmvec4.create(),rayFromEye,inverseView);rayFromEyeWORLD=v3.negate(v3.normalize(v3.create(rayFromEyeWORLD[0],rayFromEyeWORLD[1],rayFromEyeWORLD[2])));let rayV2=v3.normalize(v3.subtract(p1,p0));return new Ray(this.getEyePosition(),rayV2,this.size)}}module.exports=Camera;class Ray{constructor(eye,dir,bbSize){this.eye=eye,this.dir=dir,this.bbSize=bbSize}intersectsLine(p0,p1,threshold){let eye1=this.eye,eye2=v3.add(this.eye,this.dir),dist1=this._closestDistanceBetweenLines(eye1,eye2,p0,p1),dist2=this._closestDistanceBetweenLines(eye1,eye2,p1,p0);Math.abs(dist1),Math.abs(dist2)}intersectsPlaneV2(p0,n){let p0_minus_eye=v3.subtract(p0,this.eye),top=v3.dot(p0_minus_eye,n),dir_dot_n=v3.dot(v3.normalize(this.dir),n);if(0===dir_dot_n)return null;{let distance=top/dir_dot_n,intersectPoint=v3.add(this.eye,v3.mulScalar(v3.normalize(this.dir),distance));return{distance:distance,point:intersectPoint}}}intersectsPlane(p0,dx,dy,dz){let planeNormal=v3.normalize(v3.create(dx,dy,dz)),dirN=v3.normalize(this.dir),dist=-v3.dot(planeNormal,p0),dotproduct=v3.dot(dirN,planeNormal),normalDotOrigin=v3.dot(this.eye,planeNormal);if(0!==dotproduct){var k=-(normalDotOrigin+dist)/dotproduct;if(k<0)return null;let v0=v3.mulScalar(dirN,k);return v3.add(this.eye,v0)}return normalDotOrigin+dist===0?v3.copy(this.eye):null}getDistanceFromPointToLine(x0,x1,x2){let x0_x1=v3.subtract(x0,x1),x0_x2=v3.subtract(x0,x2),x2_x1=v3.subtract(x2,x1);return v3.length(v3.cross(x0_x1,x0_x2))/v3.length(x2_x1)}intersectsLinePlanes(p0,direction,bbSize){let halfSize=bbSize/2,clampminmax=i=>i<-halfSize?-halfSize:i>halfSize?halfSize:i,to01=i=>{let i1=clampminmax(i);return(i1+halfSize)/bbSize},getClosestIntersection=(p,n1,n2,lineDir)=>{let getOffsetCoordIndexFromNormal=(planeNormal,lineDirection)=>{let w1=v3.create(1,1,1);let w2=v3.subtract(w1,planeNormal);let w3=v3.subtract(w2,lineDirection);let index=_.indexOf(w3,1);return index};let intersect1=this.intersectsPlaneV2(p,n1),intersect2=this.intersectsPlaneV2(p,n2);let lx0=p,lx1=v3.add(p,lineDir);let dist1=this.getDistanceFromPointToLine(intersect1.point,lx0,lx1),dist2=this.getDistanceFromPointToLine(intersect2.point,lx0,lx1);if(dist1<dist2){let coordIndex=getOffsetCoordIndexFromNormal(n1,lineDir);return{distance:intersect1.distance,intersectOffset:to01(intersect1.point[coordIndex]),point:intersect1.point}}{let coordIndex=getOffsetCoordIndexFromNormal(n2,lineDir);return{distance:intersect2.distance,intersectOffset:to01(intersect2.point[coordIndex]),point:intersect2.point}}};switch(direction){case"X":return getClosestIntersection(p0,v3.create(0,0,1),v3.create(0,1,0),v3.create(1,0,0));case"Y":return getClosestIntersection(p0,v3.create(0,0,1),v3.create(1,0,0),v3.create(0,1,0));case"Z":return getClosestIntersection(p0,v3.create(0,1,0),v3.create(1,0,0),v3.create(0,0,1))}}intersectsQuad(p0,p1,p2,p3){}_closestDistanceBetweenLines(a0,a1,b0,b1,settings){let v1=v3.normalize(v3.subtract(a1,a0)),v2=v3.normalize(v3.subtract(b1,b0)),v1Xv2=v3.cross(v1,v2);if(0===v3.length(v1Xv2))return 1/0;let a0_b0=v3.subtract(a0,b0),v1Xv2_dot_a0_b0=v3.dot(v1Xv2,a0_b0);return 0===v1Xv2_dot_a0_b0?0:v1Xv2_dot_a0_b0/v3.length(v1Xv2)}}},{"gl-matrix":4,"twgl.js":21,underscore:22}],43:[function(require,module,exports){let m4=(require("twgl.js"),require("twgl.js").m4),v3=require("twgl.js").v3,Transformations=require("./transformations");class OrbiterCamera{constructor(eye,projectionSettings){this.eye=eye||v3.create(1,2,-2),this.target=v3.create(0,0,0),this.baseTarget=v3.create(0,0,0),this.up=v3.create(0,1,0),this.projectionSettings=projectionSettings||{fieldOfViewRadians:Math.PI/6,aspectRatio:1,zNear:.5,zFar:7},this.zoom=1,this.projection=null,this.modelTransformation=new Transformations,this.setPerspective(),this.mouseCache={isDrag:!1,mx:-1,my:-1,uv:null}}mouse(event){if("mousedown"===event.type)return this.mouseCache.isDrag=!0,this.mouseCache.mx=event.pos.x,void(this.mouseCache.my=event.pos.y);if("mouseup"===event.type)return void(this.mouseCache.isDrag=!1);if(this.mouseCache.isDrag){let dx=event.pos.x-this.mouseCache.mx,dy=event.pos.y-this.mouseCache.my;this.mouseCache.mx=event.pos.x,this.mouseCache.my=event.pos.y,dx*=12.5,dy*=5;let fwd=v3.subtract(this.target,this.eye),sideways=v3.cross(fwd,this.up),sidewaysN=v3.normalize(sideways),length=v3.length(fwd),moveSideways=v3.mulScalar(sidewaysN,-dx),moveVertically=v3.mulScalar(this.up,dy);switch(event.button){case 0:v3.add(this.eye,moveVertically,this.eye),v3.add(this.eye,moveSideways,this.eye);let newLen=v3.length(v3.subtract(this.target,this.eye)),diff=length-newLen;v3.subtract(this.eye,v3.mulScalar(v3.normalize(fwd),diff),this.eye);let newFWD=v3.subtract(this.target,this.eye);this.up=v3.negate(v3.normalize(v3.cross(newFWD,sideways)));break;case 1:v3.add(this.eye,moveVertically,this.eye),v3.add(this.eye,moveSideways,this.eye),v3.add(this.target,moveVertically,this.target),v3.add(this.target,moveSideways,this.target)}}}setAspectRatio(aspectRatio){this.setPerspective(aspectRatio)}setPerspective(aspectRatio){this.projection=m4.perspective(this.projectionSettings.fieldOfViewRadians,aspectRatio||this.projectionSettings.aspectRatio,this.projectionSettings.zNear,this.projectionSettings.zFar)}getPerspectiveMatrix(){return this.projection}getLookAt(){return m4.lookAt(this.eye,this.target,this.up)}getViewMatrix(){return m4.inverse(this.getLookAt())}getViewInverseMatrix(){return this.getLookAt()}getWorldMatrix(){return this.modelTransformation.getTransformation()}getViewProjectionMatrix(){return m4.multiply(this.getPerspectiveMatrix(),this.getViewMatrix())}getWorldInverseTranspose(){return m4.transpose(m4.inverse(this.getWorldMatrix()))}getWorldViewProjectionMatrix(aspectRatio){aspectRatio&&this.setPerspective(aspectRatio);let modelToWorld=this.modelTransformation.getTransformation(),worldToProjection=this.getViewProjectionMatrix();return m4.multiply(worldToProjection,modelToWorld)}getModelTransformation(){return this.modelTransformation}}module.exports=OrbiterCamera},{"./transformations":48,"twgl.js":21}],44:[function(require,module,exports){let twgl=require("twgl.js"),primitives=twgl.primitives,m4=twgl.m4,v3=twgl.v3,Settings=require("../settings").Views.Slicer,SLICERBUFFERS=null,genXYQuadVertexInfo=(p0,translate)=>{let x=p0[0],y=p0[1],z=p0[2];return{normal:"Z",p0:p0,p1:[-x,y,z],p2:[-x,-y,z],p3:[x,-y,z],offset:0,translate:translate||0}},genXZQuadVertexInfo=(p0,translate)=>{let x=p0[0],y=p0[1],z=p0[2];return{normal:"Y",p0:p0,p1:[x,y,-z],
p2:[-x,y,-z],p3:[-x,y,z],offset:0,translate:translate||0}},genYZQuadVertexInfo=(p0,translate)=>{let x=p0[0],y=p0[1],z=p0[2];return{normal:"X",p0:p0,p1:[x,y,-z],p2:[x,-y,-z],p3:[x,-y,z],offset:0,translate:translate||0}},rotateFromYTo=((normalAxis,p0)=>{switch(normalAxis){case"X":return genYZQuadVertexInfo(p0);case"Y":return genXZQuadVertexInfo(p0);case"Z":return genXYQuadVertexInfo(p0);default:return-1}},newDirection=>{switch(newDirection){case"X":return m4.rotationZ(Math.PI/2);case"Y":return m4.identity();case"Z":return m4.rotationX(Math.PI/2)}}),rotateFromXYTo=(newNormal,transDir)=>{let angle=-transDir*Math.PI/2;switch(newNormal){case"X":return m4.rotationY(angle);case"Y":return m4.rotationX(angle);case"Z":return m4.rotationX(-1===transDir?0:Math.PI)}},translateQuadVerticesToEdge=(normal,direction,offset)=>{let tx="X"===normal?direction*offset:0,ty="Y"===normal?direction*offset:0,tz="Z"===normal?-direction*offset:0;let translateVec=v3.create(tx,ty,tz);return m4.translation(translateVec)},translateCylinderVerticesToEdge=(alongAxis,direction,offset)=>{let translateVec=null;switch(alongAxis){case"X":translateVec=v3.create(0,direction[0]*offset,direction[1]*offset);break;case"Y":translateVec=v3.create(direction[0]*offset,0,direction[1]*offset);break;case"Z":translateVec=v3.create(direction[0]*offset,direction[1]*offset,0)}return m4.translation(translateVec)},genSlicerBuffers=size=>{if(SLICERBUFFERS)return SLICERBUFFERS;let quads={};let rails={};let faces={};let faceInfo={};let getRailInfo=id=>rails[id];let getCubeFaceInfo=id=>faceInfo[id];let half=size/2;this.quadID=-1;this.qCounts={X:0,Y:0,Z:0};let p0s=[[-half,-half,-half],[half,half,half]];let translateDirs=[-1,1];quads[0]=genYZQuadVertexInfo(p0s[0],-1);quads[1]=genYZQuadVertexInfo(p0s[0],-1);quads[2]=genXZQuadVertexInfo(p0s[0],-1);quads[3]=genXZQuadVertexInfo(p0s[0],-1);quads[4]=genXYQuadVertexInfo(p0s[0],-1);quads[5]=genXYQuadVertexInfo(p0s[0],-1);let id=6;for(let i=0;i<p0s.length;i++){let p0=p0s[i];p0[0],p0[1],p0[2];faceInfo[id]={normal:"X",direction:translateDirs[i]},faces[id++]=genYZQuadVertexInfo(p0,translateDirs[i]),faceInfo[id]={normal:"Y",direction:translateDirs[i]},faces[id++]=genXZQuadVertexInfo(p0,translateDirs[i]),faceInfo[id]={normal:"Z",direction:translateDirs[i]},faces[id++]=genXYQuadVertexInfo(p0,translateDirs[i])}p0s=[[-size,-size,-size],[-size,size,size],[size,size,-size],[size,-size,size]];translateDirs=[[-1,-1],[-1,1],[1,-1],[1,1]];for(let i=0;i<p0s.length;i++){let p0=p0s[i],x=p0[0],y=p0[1],z=p0[2],p1=[-x,y,z],p2=[x,-y,z],p3=[x,y,-z];rails[id++]={p0:p0,p1:p1,direction:"X",translate:translateDirs[i]},rails[id++]={p0:p0,p1:p2,direction:"Y",translate:translateDirs[i]},rails[id++]={p0:p0,p1:p3,direction:"Z",translate:translateDirs[i]}}let Vertices={};let RailVertices={},RailVerticesPB={},CubeFaceVertices={},SliceVertices={};let a_position=[],a_direction=[],a_id=[],indices=[];let a_positionCubeFace=[],a_directionCubeFace=[],a_idCubeFace=[],indicesCubeFace=[];let a_positionSlices=[],a_directionSlices=[],a_idSlices=[],indicesSlices=[];let a_positionRails=[],a_directionRails=[],a_idRails=[],indicesRails=[];let a_positionRailsPB=[],a_directionRailsPB=[],a_idRailsPB=[],indicesRailsPB=[];let getDirectionIndex=normal=>{switch(normal){case"X":return 0;case"Y":return 1;case"Z":return 2;default:return-1}};for(let id in rails){let rail=rails[id],direction=getDirectionIndex(rail.direction),railverts=primitives.createCylinderVertices(Settings.RailRadiusDisplayMode,size,Settings.RailRadialSubdivisions,Settings.RailVerticalSubdivisions,!0,!0),numVerts=railverts.position.length/3;railverts.direction=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),railverts.direction.fill(direction),railverts.id=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),railverts.id.fill(id);let rotate=rotateFromYTo(rail.direction),translate=translateCylinderVerticesToEdge(rail.direction,rail.translate,size/2),rotateThenTranslate=m4.multiply(translate,rotate);primitives.reorientVertices(railverts,rotateThenTranslate);let indexOffset=a_position.length/3;a_position.push(...railverts.position),a_direction.push(...railverts.direction),a_id.push(...railverts.id),indices.push(...railverts.indices.map(i=>i+indexOffset));let railIndexOffset=a_positionRails.length/3;a_positionRails.push(...railverts.position),a_directionRails.push(...railverts.direction),a_idRails.push(...railverts.id),indicesRails.push(...railverts.indices.map(i=>i+railIndexOffset))}for(let id in rails){let rail=rails[id],direction=getDirectionIndex(rail.direction),railverts=primitives.createCylinderVertices(Settings.RailRadiusPickingBufferMode,size,Settings.RailRadialSubdivisions,Settings.RailVerticalSubdivisions,!0,!0),numVerts=railverts.position.length/3;railverts.direction=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),railverts.direction.fill(direction),railverts.id=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),railverts.id.fill(id);let rotate=rotateFromYTo(rail.direction),translate=translateCylinderVerticesToEdge(rail.direction,rail.translate,size/2*Settings.RailOutwardsFactorPickingBuffer),rotateThenTranslate=m4.multiply(translate,rotate);primitives.reorientVertices(railverts,rotateThenTranslate);let railIndexOffset=a_positionRailsPB.length/3;a_positionRailsPB.push(...railverts.position),a_directionRailsPB.push(...railverts.direction),a_idRailsPB.push(...railverts.id),indicesRailsPB.push(...railverts.indices.map(i=>i+railIndexOffset))}for(let id in faces){let face=faces[id],direction=getDirectionIndex(face.normal),cubefvs={},vbo=primitives.createAugmentedTypedArray(3,4,Float32Array);vbo.push(face.p0),vbo.push(face.p1),vbo.push(face.p2),vbo.push(face.p3);let ibo=primitives.createAugmentedTypedArray(3,4,Int16Array);ibo.push([0,1,2]),ibo.push([0,2,3]),cubefvs.position=vbo,cubefvs.indices=ibo;let numVerts=cubefvs.position.length/3;cubefvs.direction=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),cubefvs.direction.fill(direction),cubefvs.id=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),cubefvs.id.fill(id);let rotate=rotateFromXYTo(face.normal,face.translate),translate=translateQuadVerticesToEdge(face.normal,face.translate,size/2);m4.multiply(translate,rotate);"X"===face.normal&&1===face.translate?cubefvs.indices=cubefvs.indices.reverse():"X"!==face.normal&&-1===face.translate&&(cubefvs.indices=cubefvs.indices.reverse());let indexOffset=a_position.length/3;a_position.push(...cubefvs.position),a_direction.push(...cubefvs.direction),a_id.push(...cubefvs.id),indices.push(...cubefvs.indices.map(i=>i+indexOffset));let cubeFaceIndexOffset=a_positionCubeFace.length/3;a_positionCubeFace.push(...cubefvs.position),a_directionCubeFace.push(...cubefvs.direction),a_idCubeFace.push(...cubefvs.id),indicesCubeFace.push(...cubefvs.indices.map(i=>i+cubeFaceIndexOffset))}for(let id in quads){let quad=quads[id],direction=getDirectionIndex(quad.normal),quadfvs={},vbo=primitives.createAugmentedTypedArray(3,4,Float32Array);vbo.push(quad.p0),vbo.push(quad.p1),vbo.push(quad.p2),vbo.push(quad.p3);let ibo=primitives.createAugmentedTypedArray(3,4,Int16Array);ibo.push([0,1,2]),ibo.push([0,2,3]),quadfvs.position=vbo,quadfvs.indices=ibo;let numVerts=quadfvs.position.length/3;quadfvs.direction=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),quadfvs.direction.fill(direction),quadfvs.id=primitives.createAugmentedTypedArray(1,numVerts,Int16Array),quadfvs.id.fill(id);let rotate=rotateFromXYTo(quad.normal,quad.translate),translate=translateQuadVerticesToEdge(quad.normal,quad.translate,size/2);m4.multiply(translate,rotate);"X"===quad.normal&&1===quad.translate?quadfvs.indices=quadfvs.indices.reverse():"X"!==quad.normal&&-1===quad.translate&&(quadfvs.indices=quadfvs.indices.reverse());let indexOffset=a_position.length/3;a_position.push(...quadfvs.position),a_direction.push(...quadfvs.direction),a_id.push(...quadfvs.id),indices.push(...quadfvs.indices.map(i=>i+indexOffset));let slicesIndexOffset=a_positionSlices.length/3;a_positionSlices.push(...quadfvs.position),a_directionSlices.push(...quadfvs.direction),a_idSlices.push(...quadfvs.id),indicesSlices.push(...quadfvs.indices.map(i=>i+slicesIndexOffset))}a_position.length;Vertices={position:{numComponents:3,data:new Float32Array(a_position)},direction:{numComponents:1,data:new Int16Array(a_direction)},id:{numComponents:1,data:new Int16Array(a_id)},indices:{numComponents:3,data:new Int16Array(indices)}};RailVertices={position:{numComponents:3,data:new Float32Array(a_positionRails)},direction:{numComponents:1,data:new Int16Array(a_directionRails)},id:{numComponents:1,data:new Int16Array(a_idRails)},indices:{numComponents:3,data:new Int16Array(indicesRails)}};RailVerticesPB={position:{numComponents:3,data:new Float32Array(a_positionRailsPB)},direction:{numComponents:1,data:new Int16Array(a_directionRailsPB)},id:{numComponents:1,data:new Int16Array(a_idRailsPB)},indices:{numComponents:3,data:new Int16Array(indicesRailsPB)}};CubeFaceVertices={position:{numComponents:3,data:new Float32Array(a_positionCubeFace)},direction:{numComponents:1,data:new Int16Array(a_directionCubeFace)},id:{numComponents:1,data:new Int16Array(a_idCubeFace)},indices:{numComponents:3,data:new Int16Array(indicesCubeFace)}};SliceVertices={position:{numComponents:3,data:new Float32Array(a_positionSlices)},direction:{numComponents:1,data:new Int16Array(a_directionSlices)},id:{numComponents:1,data:new Int16Array(a_idSlices)},indices:{numComponents:3,data:new Int16Array(indicesSlices)}};SLICERBUFFERS={Vertices:Vertices,CubeFaceVertices:CubeFaceVertices,RailVertices:RailVertices,RailPickingBufferVertices:RailVerticesPB,SliceVertices:SliceVertices,IDInfo:{getRailInfo:getRailInfo,getCubeFaceInfo:getCubeFaceInfo,isRail:id=>11<id,isFace:id=>6<=id&&id<=11,isSlice:id=>id<6}};return SLICERBUFFERS};module.exports=genSlicerBuffers},{"../settings":57,"twgl.js":21}],45:[function(require,module,exports){let twgl=require("twgl.js"),CameraV2=(twgl.primitives,twgl.m4,twgl.v3,require("./camera-orbiter-v2")),MouseHandler=require("../mouse-handler"),getSlicerBuffers=(require("./camera-orbiter"),require("./slicer-model-buffers")),BufferInfo=getSlicerBuffers(1),IDInfo=BufferInfo.IDInfo,GetInteractionMode=require("../interaction-modes-v2").getInteractionModeGetterForCategory("Slicer"),Settings=require("../settings").Views.Slicer;class SlicerModel{constructor(gl,viewManager,myID){this.viewManager=viewManager,window["HID"+myID]=(id=>{this.slicerBox.highlightID(id);this._refreshUniforms()}),this.gl=gl,this.pickingBuffer=viewManager.getPickingBufferInfo("SlicerPicking",myID),this.myID=myID,this.camera=new CameraV2({radius:5.2,theta:0,phi:0,projectionSettings:{fieldOfViewRadians:Math.PI/10,aspectRatio:1,zNear:.5,zFar:18},ROT_SPEED_X:3.5,ROT_SPEED_Y:3.5}),this.slicerBox=new LabeledSlicerBox(1),this.uniforms={u_HighlightID:-1,u_SliceOffsets:[-1,-1,-1,-1,-1,-1],u_WorldViewProjection:-1,u_IntersectionPointDebug:[0,0,0]},this.attribArrays={},this._refreshUniforms(),this._genAttribArrays(),this.mouseHandler=new MouseHandler({clickTimeout:150}),this._bindMouseHandler()}getSliceOffsets(axis){switch(axis){case"X":return[this.uniforms.u_SliceOffsets[0],this.uniforms.u_SliceOffsets[1]].sort((a,b)=>a>b);case"Y":return[this.uniforms.u_SliceOffsets[2],this.uniforms.u_SliceOffsets[3]].sort((a,b)=>a>b);case"Z":return[this.uniforms.u_SliceOffsets[4],this.uniforms.u_SliceOffsets[5]].sort((a,b)=>a>b)}}_refreshUniforms(){for(let key in this.slicerBox.uniforms)this.uniforms[key]=this.slicerBox.uniforms[key];this.uniforms.u_WorldViewProjection=this.camera.getWorldViewProjectionMatrix()}_genAttribArrays(){this.attribArrays=getSlicerBuffers(1)}mouse(event){this.mouseHandler.handle(event)}_bindMouseHandler(){let gl=this.gl,debugDisplayPickingBuffer=()=>{let pb=this.pickingBuffer.get();let dest=new Uint8Array(4*pb.width*pb.height);pb.readPixels(0,0,pb.width,pb.height,gl.RGBA,gl.UNSIGNED_BYTE,dest,0);let debugcanvas=document.getElementById("debugcanvas");let gl2=debugcanvas.getContext("2d");debugcanvas.width=pb.width;debugcanvas.height=pb.height;gl2.clearRect(0,0,gl2.canvas.width,gl2.canvas.height);let imagedata=new ImageData(new Uint8ClampedArray(dest),pb.width,pb.height);gl2.putImageData(imagedata,0,0)},readPBPixels=(mx,my)=>{this.pickingBuffer.refresh();let pb=this.pickingBuffer.get();let dest=new Uint8Array(4);pb.readPixels(mx*pb.width,(1-my)*pb.height,1,1,gl.RGBA,gl.UNSIGNED_BYTE,dest,0);let id=dest[0]-1;let railOffset=dest[1]/255;return{id:id,railOffset:railOffset}},dragInfo={railInfo:null};(x,y)=>{let ray=this.camera.getRayFromMouseClick({x:x,y:y});let p0=dragInfo.railInfo.p0,p1=dragInfo.railInfo.p1,direction=dragInfo.railInfo.direction;let p=null;switch(direction){case"X":p=p0[0]<p1[0]?p0:p1;break;case"Y":p=p0[1]<p1[1]?p0:p1;break;case"Z":p=p0[2]<p1[2]?p0:p1}let intersectInfo=ray.intersectsLinePlanes(p,direction,1);let intersectionOffset=intersectInfo.intersectOffset;this.uniforms.u_IntersectionPointDebug=new Float32Array([intersectInfo.point[0],intersectInfo.point[0],intersectInfo.point[0]]);return intersectionOffset};this.mouseHandler.on("mouseenter",null,state=>{let interactionMode=GetInteractionMode();interactionMode}),this.mouseHandler.on("mouseout",null,state=>{this.dragInfo.railinfo=null;this.slicerBox.highlightID(-1)}),this.mouseHandler.on("click","left",state=>{let interactionMode=GetInteractionMode();let pb=readPBPixels(state.x,state.y);let id=pb.id;switch(interactionMode){case"add":IDInfo.isFace(id)&&(this.slicerBox.addSliceFromCubeFace(id),this.slicerBox.highlightID(id));break;case"remove":IDInfo.isSlice(id)&&this.slicerBox.removeSlice(id)}this._refreshUniforms();return;let ray=this.camera.getRayFromMouseClick({x:state.x,y:state.y});this.slicerBox.highlightIntersected(ray);this._refreshUniforms()}),this.mouseHandler.on("mousedown","left",state=>{let interactionMode=GetInteractionMode();let pb=readPBPixels(state.x,state.y);let id=pb.id;if(IDInfo.isRail(id)){let railInfo=IDInfo.getRailInfo(id);dragInfo.railInfo=railInfo;let offset=pb.railOffset;return this.slicerBox.initiateDragIfHit(railInfo.direction,offset,id),this._refreshUniforms(),this.pickingBuffer.refresh(),void debugDisplayPickingBuffer()}switch(interactionMode){case"rotate":break;case"add":IDInfo.isFace(id)&&this.slicerBox.addSliceFromCubeFace(id)}}),this.mouseHandler.on("mouseup","left",state=>{if(dragInfo.railInfo)return dragInfo.railInfo=null,void this.slicerBox.endDrag()}),this.mouseHandler.on("mousemove","left",state=>{}),this.mouseHandler.on("drag","left",state=>{let pb=readPBPixels(state.x,state.y);if(IDInfo.isRail(pb.id)&&this.slicerBox.isDragActive()){let offset=pb.railOffset;this.slicerBox.dragActiveSlicesAlongAxis(offset),this._refreshUniforms(),this.viewManager.notifySlicesDidChange(this.myID)}else this.camera.rotate(state.dx,state.dy),this._refreshUniforms(),this.viewManager.requestAnimationFrame(["Slicer"],this.myID)})}}module.exports=SlicerModel;class LabeledSlicerBox{constructor(size){this.size=size,this.uniforms={u_Size:this.size,u_HighlightID:-1,u_SliceOffsets:[.2,.8,.2,.8,.2,.8],u_RayDir:[0,0,-1],u_PickingRayOrigin:[0,0,10],u_DraggedSliceIndices:[-1,-1],u_ActiveDragRailID:-1},this.qCounts={X:0,Y:0,Z:0},this.draggedSliceIndex=-1,this.draggedSliceIndices=null,this.activeDrag=!1,this.dragOffset=0}_getOffsetIndex(normal){if(this.qCounts[normal]>=2)return-1;switch(normal){case"X":return 0+this.qCounts[normal];case"Y":return 2+this.qCounts[normal];case"Z":return 4+this.qCounts[normal];default:return-1}}_getOffsetStartIndex(normal){switch(normal){case"X":return 0;case"Y":return 2;case"Z":return 4;default:return-1}}_getNormal(id){return id<2?"X":id<4?"Y":"Z"}addSliceFromCubeFace(fromCubeFace){let info=this._cubeFaceIDToNormalAndStartOffset(fromCubeFace),index=this._getOffsetIndex(info.normal);if(-1!==index)return this.moveSliceToOffset(index,info.offset),index}_cubeFaceIDToNormalAndStartOffset(cubefaceID){let info=IDInfo.getCubeFaceInfo(cubefaceID);return{startOffset:-1===info.direction?.02:.98,normal:info.normal}}_getDirectionIndex(normal){switch(normal){case"X":return 0;case"Y":return 1;case"Z":return 2;default:return-1}}_directionIndexToDirection(index){switch(index){case 0:return"X";case 1:return"Y";case 2:return"Z";default:return-1}}getSlicesAtAxisAndOffset(alongAxis,offset){let id1=this._getOffsetStartIndex(alongAxis),id2=id1+1,offset1=this.uniforms.u_SliceOffsets[id1],offset2=this.uniforms.u_SliceOffsets[id2],dist1=Math.abs(offset1-offset),dist2=Math.abs(offset2-offset),snap1=dist1<=Settings.SelectSliceSnapThreshold,snap2=dist2<=Settings.SelectSliceSnapThreshold;return snap1||snap2?dist1<dist2?{hit:!0,ids:[id1,-1]}:{hit:!0,ids:[id2,-1]}:(offset1<offset2?offset1<offset&&offset<offset2:offset2<offset&&offset<offset1)?{hit:!0,ids:[id1,id2]}:{hit:!1}}highlightPotentialDragIfHit(alongAxis,offset){let slices=this.getSlicesAtAxisAndOffset(alongAxis,offset);slices.hit&&(this.activeDrag=!1,this.draggedSliceIndices=slices.ids,this.uniforms.u_DraggedSliceIndices=slices.ids)}initiateDragIfHit(alongAxis,offset,id){let slices=this.getSlicesAtAxisAndOffset(alongAxis,offset);slices.hit&&(this.uniforms.u_ActiveDragRailID=id,this.activeDrag=!0,this.draggedSliceIndices=slices.ids,this.uniforms.u_DraggedSliceIndices=slices.ids,this.dragOffset=offset)}endDrag(){this.uniforms.u_ActiveDragRailID=-1,this.draggedSliceIndices=null,this.uniforms.u_DraggedSliceIndices=[-1,-1],this.dragOffset=-1,this.activeDrag=!1}isDragActive(){return this.activeDrag}dragActiveSlicesAlongAxis(newOffset){if(this.draggedSliceIndices){let deltaOffset=newOffset-this.dragOffset;for(let sliceID of this.draggedSliceIndices)this.uniforms.u_SliceOffsets[sliceID]+=deltaOffset;this.dragOffset=newOffset}}removeSlice(id){this.uniforms.u_SliceOffsets[id]=-1;let normal=this._getNormal(id);this.qCounts[normal]--}getUniforms(){return this.uniforms}highlightID(id){this.uniforms.u_HighlightID=id}highlightIntersected(ray){this.uniforms.u_PickingRayOrigin=ray.eye,this.uniforms.u_RayDir=ray.dir}}},{"../interaction-modes-v2":39,"../mouse-handler":49,"../settings":57,"./camera-orbiter":43,"./camera-orbiter-v2":42,"./slicer-model-buffers":44,"twgl.js":21}],46:[function(require,module,exports){class SphereModel{constructor(){}mouse(event){}}module.exports=SphereModel},{}],47:[function(require,module,exports){class Thresholds{constructor(){this.minmax=[-1/0,1/0]}setMin(min){this.minmax[0]=min}setMax(max){this.max[1]=max}}module.exports=Thresholds},{}],48:[function(require,module,exports){let twgl=require("twgl.js"),m4=twgl.m4,v3=twgl.v3;class Transformations{constructor(){this.rotation=m4.identity(),this.translation=m4.identity(),this.scale=m4.identity(),this.qRot=this.transformation=m4.identity()}getTransformation(){return m4.multiply(this.scale,this.rotation,this.transformation),m4.multiply(this.translation,this.transformation,this.transformation),this.transformation}rotateFromEye(rx,ry,eyePos,up){let yAxis=up,eyeToCenter=v3.mulScalar(v3.normalize(eyePos),-1),xAxis=v3.normalize(v3.cross(yAxis,eyeToCenter));m4.axisRotate(this.rotation,yAxis,rx,this.rotation),m4.axisRotate(this.rotation,xAxis,ry,this.rotation)}rotateXY(dx,dy){this.rotateX(dx),this.rotateY(dy)}rotateX(radians){m4.rotateX(this.rotation,radians,this.rotation)}rotateY(radians){m4.rotateY(this.rotation,radians,this.rotation)}rotateZ(radians){m4.rotateZ(this.rotation,radians,this.rotation)}translate(dx,dy,dz){m4.translate(this.translation,[dx,dy,dz],this.translation)}scale(sxy){m4.scale(this.scale,[sxy,sxy,0],this.scale)}}module.exports=Transformations},{"twgl.js":21}],49:[function(require,module,exports){class MouseHandler{constructor(config){this.isDrag=!1,this.clickTimeout=config.clickTimeout||300,this.timers={click:-1e6},this.callbacks={click:{},mouseup:{},mousedown:{},mousemove:{}},this.state={x0:-1,y0:-1,x:-1,y:-1,dx:-1,dy:-1}}reset(){this.isDrag=!1}handle(event){this.state.x0=this.state.x,this.state.y0=this.state.y,this.state.x=event.pos.x,this.state.y=event.pos.y,this.state.dx=this.state.x-this.state.x0,this.state.dy=this.state.y-this.state.y0,"mousedown"===event.type?(this.timers.click=Date.now(),this.isDrag=!0,this._notifyIfExists("mousedown",event.button)):"mouseup"===event.type?(this.isDrag=!1,Date.now()-this.timers.click<=this.clickTimeout?this._notifyIfExists("click",event.button):this._notifyIfExists("mouseup",event.button)):"mousemove"===event.type?this.isDrag?this._notifyIfExists("drag",event.button):this._notifyIfExists("mousemove",event.button):"mouseout"===event.type&&(this.isDrag=!1)}__stringToButtonCode(buttonCode){switch(buttonCode){case"left":return 0;case"middle":return 1;case"right":return 2;default:return-1}}_notifyIfExists(event,buttonCode){this.callbacks[event]&&this.callbacks[event][buttonCode]&&this.callbacks[event][buttonCode](this.state)}on(event,button,callback){let buttonCode=this.__stringToButtonCode(button);this.callbacks[event]||(this.callbacks[event]={}),button?this.callbacks[event][buttonCode]=callback:this.callbacks[event].any=callback}}module.exports=MouseHandler},{}],50:[function(require,module,exports){let twgl=require("twgl.js"),_=(twgl.m4,require("underscore"));class ConfigurableRenderer{constructor(gl,initialConfig){this.steps=[],this.gl=gl,this.viewport=null,void 0!==initialConfig&&this.configure(initialConfig)}setViewport(viewport){this.viewport=viewport}configure(config){config.viewport&&(this.viewport=config.viewport),this.steps=config.steps,this.uniforms=config.uniforms}modifyConfig(newOptions){for(let stepIndex in newOptions)for(let configKey in newOptions[stepIndex])this.steps[stepIndex][configKey]=newOptions[stepIndex][configKey]}_applyViewport(){this.gl.viewport(this.viewport.x0,this.viewport.y0,this.viewport.width,this.viewport.height)}_applyScissorViewport(){this.gl.scissor(this.viewport.x0,this.viewport.y0,this.viewport.width,this.viewport.height)}_applySubViewport(svp01,fbinfo){if(fbinfo){let subX0=svp01.x0*fbinfo.width,subY0=svp01.y0*fbinfo.height,subWidth=svp01.width*fbinfo.width,subHeight=svp01.height*fbinfo.height;this.gl.viewport(subX0,subY0,subWidth,subHeight)}else{let subX0=this.viewport.x0+svp01.x0*this.viewport.width,subY0=this.viewport.y0+svp01.y0*this.viewport.height,subWidth=svp01.width*this.viewport.width,subHeight=svp01.height*this.viewport.height;this.gl.viewport(subX0,subY0,subWidth,subHeight)}}_renderStep(step){let gl=this.gl;for(let step of this.steps){let programInfo=step.programInfo;gl.useProgram(programInfo.program),step.frameBufferInfo||this._applyViewport(),twgl.setBuffersAndAttributes(gl,programInfo,step.bufferInfo),twgl.setUniforms(programInfo,this.uniforms);let applyGLSettings=()=>{for(let func in step.glSettings){let args=step.glSettings[func];if(_.contains(["enable","disable","clear"],func))for(let arg of args)gl[func].call(gl,arg);else gl[func].apply(gl,args)}};step.frameBufferInfo?(twgl.bindFramebufferInfo(gl,step.frameBufferInfo),step.subViewport&&this._applySubViewport(step.subViewport,step.frameBufferInfo),applyGLSettings(),gl.drawElements(gl.TRIANGLES,step.bufferInfo.numElements,gl.UNSIGNED_SHORT,0)):(gl.bindFramebuffer(gl.FRAMEBUFFER,null),this._applyViewport(),step.subViewport&&this._applySubViewport(step.subViewport),applyGLSettings(),gl.drawElements(gl.TRIANGLES,step.bufferInfo.numElements,gl.UNSIGNED_SHORT,0))}}render(needsFullUpdate){this.gl;if(needsFullUpdate)for(let step of this.steps)this._renderStep(step)}}module.exports=ConfigurableRenderer},{"twgl.js":21,underscore:22}],51:[function(require,module,exports){let twgl=require("twgl.js"),createCuboidVertices=require("../../geometry/box");class BufferManager{constructor(gl){this.gl=gl,this.bufferObjects={}}createBoundingBoxBufferInfo(name,width,height,depth){let arrays=createCuboidVertices(width,height,depth);this.bufferObjects[name]=twgl.createBufferInfoFromArrays(this.gl,arrays)}getBufferInfo(name){return this.bufferObjects[name]}createBufferInfoFromArrays(arrays,name){this.bufferObjects[name]=twgl.createBufferInfoFromArrays(this.gl,arrays)}createFullScreenQuad(name){this.bufferObjects[name]=twgl.primitives.createXYQuadBufferInfo(this.gl)}hasBuffer(name){return this.bufferObjects.hasOwnProperty(name)}}module.exports=BufferManager},{"../../geometry/box":65,"twgl.js":21}],52:[function(require,module,exports){let VolumeViewTypes={"3D View":"Basic","Slice View":"Slice","Surface View":"Surface"};class ConfigurationManager{constructor(viewManager){this.VM=viewManager,this.activeConfigurations={0:{Volume:"Basic",Slicer:"Basic",SlicerPicking:"Basic"}},this.configurations={Volume:{Basic:id=>this._generateBasicVolumeConfigForSubview(id),Slice:id=>this._generateBasicVolumeConfigForSubview(id),Surface:id=>this._generateBasicVolumeConfigForSubview(id)},Slicer:{Basic:id=>this._generateBasicSlicerConfigForSubview(id)},SlicerPicking:{Basic:id=>this._generateSlicerPickingBufferConfigForSubview(id)},Sphere:{}}}setVolumeViewTypeForSubview(newType,subviewID){let configName=VolumeViewTypes[newType];this.configureSubview(subviewID,{Volume:configName})}_getConfigurationForSubview(category,name,subviewID){if(this.configurations.hasOwnProperty(category)&&this.configurations[category].hasOwnProperty(name))return this.configurations[category][name](subviewID)}configureSubview(id,configurations){let VM=this.VM,subview=VM.subviews[id];for(let category in configurations){let configName=configurations[category],config=this._getConfigurationForSubview(category,configName,id);subview.configureRenderer(category,config)}}configureOffscreenSubview(id,configurations){let VM=this.VM,subview=VM.offscreenSubviews[id];for(let category in configurations){let configName=configurations[category],config=this._getConfigurationForSubview(category,configName,id);subview.configureRenderer(category,config)}}addSubview(id){for(let category in this.configurations){let configName=this.configurations[category],config=this._getConfigurationForSubview(category,configName,id);subview.configureRenderer(category,config)}}_generateBasicSlicerConfigForSubview(subviewID){let VM=this.VM,gl=VM.masterContext;VM.modelSyncManager.getActiveModel("Slicer",subviewID),VM.uniformManagerSlicer.getUniformBundle(subviewID);return{uniforms:VM.uniformManagerSlicer.getUniformBundle(subviewID),steps:[{programInfo:VM.shaderManager.getProgramInfo("SlicerBasic"),frameBufferInfo:null,bufferInfo:VM.bufferManager.getBufferInfo("SlicerBuffer"),glSettings:{enable:[gl.DEPTH_TEST,gl.BLEND],clear:[gl.DEPTH_BUFFER_BIT],disable:[gl.CULL_FACE],blendFunc:[gl.SRC_ALPHA,gl.ONE]}}]}}_generateSlicerPickingBufferConfigForSubview(subviewID){let VM=this.VM,gl=VM.masterContext;VM.modelSyncManager.getActiveModel("Slicer",subviewID);return{uniforms:VM.uniformManagerSlicer.getUniformBundle(subviewID),steps:[{programInfo:VM.shaderManager.getProgramInfo("SlicerPicking"),frameBufferInfo:VM.FBAndTextureManager.getFrameBuffer("SlicerPicking"),bufferInfo:VM.bufferManager.getBufferInfo("SlicerCubeFaceBuffer"),glSettings:{enable:[gl.DEPTH_TEST],cullFace:[gl.BACK],depthFunc:[gl.LESS],disable:[gl.BLEND,gl.CULL_FACE],clear:[gl.COLOR_BUFFER_BIT,gl.DEPTH_BUFFER_BIT]}},{programInfo:VM.shaderManager.getProgramInfo("SlicerPicking"),frameBufferInfo:VM.FBAndTextureManager.getFrameBuffer("SlicerPicking"),bufferInfo:VM.bufferManager.getBufferInfo("SlicerRailPBBuffer"),glSettings:{enable:[gl.DEPTH_TEST,gl.CULL_FACE],clear:[gl.DEPTH_BUFFER_BIT],cullFace:[gl.BACK],depthFunc:[gl.LESS],disable:[gl.BLEND]}}]}}_generateBasicVolumeConfigForSubview(subviewID){let VM=this.VM,gl=VM.masterContext,buffer=VM.bufferManager.getBufferInfo("VolumeBB"),fullScreenQuadBuffer=VM.bufferManager.getBufferInfo("FullScreenQuadBuffer"),uniforms=VM.uniformManagerVolume.getUniformBundle(subviewID),VolumeImageFB=VM.FBAndTextureManager.getFrameBuffer("VolumeImageTexture"+subviewID);return{uniforms:uniforms,steps:[{programInfo:VM.shaderManager.getProgramInfo("PositionToRGB"),frameBufferInfo:VM.FBAndTextureManager.getFrameBuffer("BackFace"),bufferInfo:buffer,glSettings:{clear:[gl.DEPTH_BUFFER_BIT|gl.COLOR_BUFFER_BIT],disable:[gl.BLEND],enable:[gl.CULL_FACE,gl.DEPTH_TEST],cullFace:[gl.FRONT]}},{programInfo:VM.shaderManager.getProgramInfo("BasicVolume"),frameBufferInfo:VolumeImageFB,bufferInfo:buffer,glSettings:{clear:[gl.COLOR_BUFFER_BIT],cullFace:[gl.BACK]}},{programInfo:VM.shaderManager.getProgramInfo("VolImage2Quad"),frameBufferInfo:null,bufferInfo:fullScreenQuadBuffer,glSettings:{}}]}}}module.exports=ConfigurationManager},{}],53:[function(require,module,exports){let twgl=require("twgl.js");require("../environment");class FrameBufferAndTextureManager{constructor(gl,environmentRef){this.gl=gl,this.env=environmentRef,this.framebuffers={},this.textures={},this.transferFunctionTextures={}}getTexture(name){return this.textures[name],this.textures[name]}getFrameBuffer(name){return this.framebuffers[name],this.framebuffers[name]}createDEBUG2DTexture(name){let gl=this.gl;this.textures[name]=twgl.createTexture(gl,{min:gl.NEAREST,mag:gl.NEAREST,src:[255,255,255,255,192,192,192,255,192,192,192,255,255,255,255,255]})}create2DTextureFB(detail){let gl=this.gl;this.textures[detail.name]=twgl.createTexture(gl,{target:gl.TEXTURE_2D,width:detail.width||gl.drawingBufferWidth,height:detail.height||gl.drawingBufferHeight,min:gl.LINEAR,mag:gl.LINEAR,internalFormat:gl.RGBA,format:gl.RGBA,type:gl.UNSIGNED_BYTE,wrap:gl.CLAMP_TO_EDGE});let framebuffer=twgl.createFramebufferInfo(gl,[{attach:gl.COLOR_ATTACTMENT0,format:gl.RGBA,type:gl.UNSIGNED_BYTE,target:gl.TEXTURE_2D,level:0,attachment:this.textures[detail.name]}],detail.width,detail.height);return twgl.bindFramebufferInfo(gl),this.framebuffers[detail.name]=framebuffer,framebuffer}create2DPickingBufferFB(name,pickingFunction){let fb=this.create2DTextureFB({name:name,width:1024,height:1024});pickingFunction&&(fb.pick=pickingFunction);let gl=this.gl;fb.readPixels=((x,y,w,h,format,type,dst,offset)=>{gl.bindFramebuffer(gl.FRAMEBUFFER,fb.framebuffer);gl.readPixels(x,y,w,h,format,type,dst,offset)})}createGridPos2Isovalue3DTexture(detail){let gl=this.gl;this.textures[detail.name]=twgl.createTexture(gl,{target:gl.TEXTURE_3D,width:detail.cols,height:detail.rows,depth:detail.slices,internalFormat:gl.R16I,format:gl.RED_INTEGER,type:gl.SHORT,src:detail.isovalues,wrapS:gl.CLAMP_TO_EDGE,wrapT:gl.CLAMP_TO_EDGE,wrapR:gl.CLAMP_TO_EDGE,premultiplyAlpha:!1})}createTransferFunction2DTexture(tfEditorKey){let gl=this.gl,subviewID=this.env.TransferFunctionManager.getReferencedCellIDForTFKey(tfEditorKey),info=this.env.TransferFunctionManager.getCanvasForTFKey(tfEditorKey),isoToColorData=info.canvas,bounds=info.textureBounds,imgdata=isoToColorData.getContext("2d").getImageData(bounds.x,bounds.y,bounds.width,1),buffer=imgdata.data;this.transferFunctionTextures[subviewID]=twgl.createTexture(gl,{target:gl.TEXTURE_2D,internalFormat:gl.RGBA,width:bounds.width,height:1,src:buffer,premultiplyAlpha:!1})}getTransferFunction2DTexture(subviewID){return this.transferFunctionTextures[subviewID]?this.transferFunctionTextures[subviewID]:this.transferFunctionTextures.GLOBAL}}module.exports=FrameBufferAndTextureManager},{"../environment":38,"twgl.js":21}],54:[function(require,module,exports){let _=require("underscore"),ReadViewSplitter=require("../../widgets/split-view/view-splitter-master-controller").read(),getMasterCellIDForModel=ReadViewSplitter.links.getMasterCellIDForModel,getAllCellIDs=ReadViewSplitter.layout.getAllCellIDs,AllModels=require("../linkable-models").Models;class ModelSyncManager{constructor(viewManager){this.gl=viewManager.masterContext,this.viewManager=viewManager,this.classes={},this.defaultModels={},this.linkedModels={},this.pointsToGlobal={},this.virtuals=[];for(let key in AllModels){let model=AllModels[key];this.addModel(model.name,model.class)}}addModel(modelName,Class){let subviewIDs=getAllCellIDs();this.classes[modelName]=Class,this.defaultModels[modelName]={},this.linkedModels[modelName]={},this.pointsToGlobal[modelName]=!1,this.defaultModels[modelName].GLOBAL=new Class(this.gl,this.viewManager,"GLOBAL")
;for(let subviewID of subviewIDs)this.defaultModels[modelName][subviewID]=new Class(this.gl,this.viewManager,subviewID),this.linkedModels[modelName][subviewID]=subviewID}getActiveModels(subviewID){let models={};for(let modelName in this.defaultModels)models[modelName]=null,models[modelName]=this.getActiveModel(modelName,subviewID);return models}getSubviewIDsLinkedWith(subviewID,modelName){let activeModelID=this._getActiveModelSubviewID(modelName,subviewID);return this.getSubviewIDsLinkedWithMaster(activeModelID,modelName)}getSubviewIDsLinkedWithMaster(masterSubviewID,modelName){let subviewIDs=[],allIDs=getAllCellIDs();for(let cellID of allIDs)this._getActiveModelSubviewID(modelName,cellID)===masterSubviewID&&subviewIDs.push(cellID);return subviewIDs}_getActiveModelSubviewID(modelName,subviewID){return this.pointsToGlobal[modelName]?"GLOBAL":this.linkedModels[modelName][subviewID]}getActiveModel(modelName,subviewID){let activeModelSubviewID=this._getActiveModelSubviewID(modelName,subviewID);return this.defaultModels[modelName][activeModelSubviewID]}removeSubview(subviewID){for(let modelName in this.defaultModels)delete this.defaultModels[modelName][subviewID],delete this.linkedModels[modelName][subviewID];let subviewIDs=getAllCellIDs();for(let theSubviewID of subviewIDs)for(let modelName in this.linkedModels)this.linkedModels[modelName][theSubviewID]===subviewID&&(this.linkedModels[modelName][theSubviewID]=theSubviewID);this.syncWithLinkGroup()}addSubview(subviewID){for(let modelName in this.defaultModels)this.defaultModels[modelName][subviewID]=new this.classes[modelName](this.gl,this.viewManager,subviewID),this.linkedModels[modelName][subviewID]="TRANSFER_FUNCTION"===modelName?"GLOBAL":subviewID}addVirtualSubview(virtualSubviewID,pointsTo){for(let modelName in this.defaultModels)this.linkedModels[modelName][virtualSubviewID]=pointsTo||0;this.virtuals.push(virtualSubviewID)}linkVirtualSubviewTo(virtualSubviewID,subviewID){if(this.isVirtual(virtualSubviewID))throw new Error("Expected virtual subview ID");if(this.isVirtual(subviewID))throw new Error("Expected non-virtual subview ID");for(let modelName in this.defaultModels)this.linkedModels[modelName][virtualSubviewID]=subviewID}isVirtual(subviewID){return _.contains(this.virtuals,subviewID)}syncWithLinkGroup(){let subviewIDs=getAllCellIDs();for(let modelKey in this.defaultModels)for(let subviewID of subviewIDs)this.isVirtual(subviewID)||(this.linkedModels[modelKey][subviewID]=getMasterCellIDForModel(modelKey,subviewID))}updateSyncForModelKey(modelKey){let subviewIDs=getAllCellIDs();for(let subviewID of subviewIDs)this.linkedModels[modelKey][subviewID]=getMasterCellIDForModel(modelKey,subviewID)}getModel(modelName,subviewID){return this.defaultModels[modelName][subviewID]}_getModels(subviewID){let models={};for(let modelKey in this.defaultModels)modelKey[modelKey]=this.defaultModels[modelKey][subviewID];return models}setModelPointsToGlobal(modelName,doesPointToGlobal){this.pointsToGlobal[modelName]=doesPointToGlobal}}module.exports=ModelSyncManager},{"../../widgets/split-view/view-splitter-master-controller":75,"../linkable-models":41,underscore:22}],55:[function(require,module,exports){let glsl=require("glslify"),twgl=require("twgl.js"),BUILTIN_PROGRAMS={BasicVolume:"BasicVolume",PositionToRGB:"PositionToRGB",DebugCube:"DebugCube",DebugVolume:"DebugVolume",TextureToBBColor:"TextureToBBColor",TextureBackMinusFront:"TextureBackMinusFront",SlicerBasic:"SlicerBasic",SlicerPicking:"SlicerPicking",Texture2Quad:"Texture2Quad",VolImage2Quad:"VolImage2Quad"};class ShaderManager{constructor(gl){this.gl=gl,this.programs={},this.vertexShaders={},this.fragmentShaders={},this.vertexShaders.BasicVolume=glsl(["#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\n// world coords -> bounding box coords -> tex coords\n// [-1,1]       -> [-0.5,0.5]          -> [0,1]\nvec3 Model2NormalizedBBCoord_0_to_1_1540259130(vec3 modelPosition, vec3 boundingBox) {\n    return (modelPosition / boundingBox) + vec3(0.5);//\n}\n\nvec2 Proj2ScreenCoords_0_to_1_1604150559(vec4 projectedPosition) {\n    vec2 texCoord = projectedPosition.xy / projectedPosition.w;\n    texCoord.x = 0.5 * texCoord.x + 0.5;\n    texCoord.y = 0.5 * texCoord.y + 0.5;\n    return texCoord;\n}\n\nuniform mat4 u_WorldViewProjection;\nuniform vec3 u_BoundingBoxNormalized;\nuniform float u_AspectRatio;\n\nuniform vec2 u_SliceX;\nuniform vec2 u_SliceY;\nuniform vec2 u_SliceZ;\n\nin vec4 a_position;\nout vec3 v_gridPosition; // [0,1] position within the bounding box coords\nout vec2 v_screenCoord;\n\nvoid main() {\n    // [0,1] turn into [-1,1] of BB coords]\n    \n    vec3 sliceMin = vec3(u_SliceX.x, u_SliceY.x, u_SliceZ.x);\n    vec3 sliceMax = vec3(u_SliceX.y, u_SliceY.y, u_SliceZ.y);\n    \n    // [0,1] -> [-1,1]\n    sliceMin *= 2.0;\n    sliceMax *= 2.0;\n    \n    sliceMin -= vec3(1.0);\n    sliceMax -= vec3(1.0);\n    \n    sliceMin *= u_BoundingBoxNormalized;    \n    sliceMax *= u_BoundingBoxNormalized;\n    \n    vec3 slicedPos = clamp(a_position.xyz, sliceMin, sliceMax);\n\n//    vec3 gridCoord3D_0_to_1 = Model2NormalizedBBCoord_0_to_1(a_position.xyz, u_BoundingBoxNormalized);\n    vec3 gridCoord3D_0_to_1 = Model2NormalizedBBCoord_0_to_1_1540259130(slicedPos, u_BoundingBoxNormalized);\n\n    v_gridPosition = gridCoord3D_0_to_1;\n\n    vec4 projPos = (u_WorldViewProjection * vec4(slicedPos,1.0));\n    projPos.x /= u_AspectRatio;\n\n    v_screenCoord = Proj2ScreenCoords_0_to_1_1604150559(projPos);\n\n    gl_Position = projPos;\n}\n\n// w/h = w0/h0 = ar => w = h*ar\n"]),this.fragmentShaders.BasicVolume=glsl(["#version 300 es\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp isampler3D;\n#define GLSLIFY 1\n // Ints\n\n//uniform sampler2D u_TexCoordToRayOrigin;\nuniform sampler2D u_TexCoordToRayEndPoint;\n\nuniform isampler3D u_ModelXYZToIsoValue; // Texcoords -> (x,y,z) coords, start point of rays\nuniform sampler2D u_IsoValueToColorOpacity;\n\nuniform vec3 u_BoundingBoxNormalized;\nuniform float u_AlphaCorrectionExponent; // Calculate it @ CPU\nuniform float u_SamplingRate;\nuniform ivec2 u_IsoMinMax;\n\nin vec3 v_gridPosition; // Same as ray start position\nin vec4 v_projPosition;\nin vec2 v_screenCoord;\n\nout vec4 outColor;\n\nconst int MAX_STEPS = 1000;\n\nbool isWithinMinMax(int isovalue) {\n    return u_IsoMinMax.x <= isovalue && isovalue <= u_IsoMinMax.y;\n}\n\nfloat getNormalizedIsovalue(vec3 modelPosition) {\n    //vec3 gridPosition = (modelPosition, u_BoundingBoxNormalized);\n    int iso = int(texture(u_ModelXYZToIsoValue, modelPosition).r);\n    \n    //if(isWithinMinMax(iso))\n        return float(iso) / 32735.0;\n    //else \n    //    return -1.0;\n}\n\nvoid main() {\n    vec3 backfaceGridPos = texture(u_TexCoordToRayEndPoint, v_screenCoord).rgb;\n    vec3 front2Back = (backfaceGridPos - v_gridPosition);\n\n    float rayLength = length(front2Back);\n    vec3 ray = normalize(front2Back);\n\n    float delta = u_SamplingRate;\n    vec3 deltaRay = delta * ray;\n\n    vec3 currentPos = v_gridPosition;\n\n    float accumulatedAlpha = 0.0;\n    vec3 accumulatedColor = vec3(0.0);\n    float accumulatedLength = 0.0;\n\n    float isovalue; // normalized\n\n    vec3 color;\n    highp float alpha;\n    highp float alphaIn;\n    vec4 isoRGBA;\n\n    float alphaCorrection = 0.1;\n\n//    for(int i = 0; i < u_Steps; i++) {\n    for(int i = 0; i < MAX_STEPS; i++) {\n        //vec2 isoAndGradientMag = getIsovalueAndGradientMagnitude(currentPos);\n        isovalue = getNormalizedIsovalue(currentPos);\n        if(isovalue == -1.0)\n            continue; // Skip isovalue because threshold!\n        //gradientMagnitude = isoAndGradientMag.g;\n\n        // find color&Opacity via TF\n        isoRGBA = texture(u_IsoValueToColorOpacity, vec2(isovalue, 0.5));\n\n        alpha = isoRGBA.a * alphaCorrection;\n        color = isoRGBA.rgb;\n\n        // Accumulate color and opacity\n        accumulatedColor += (1.0 - accumulatedAlpha) * color * alpha;\n        accumulatedAlpha += alpha;\n\n        //alphaIn = isoRGBA.a;\n        //alphaIn = 1.0 - pow((1.0 - accumulatedAlpha), u_AlphaCorrectionExponent);\n\n        //accumulatedColor = accumulatedColor + (1.0 - accumulatedAlpha) * alpha * color;\n        //accumulatedAlpha = accumulatedAlpha + (1.0 - accumulatedAlpha) * alpha;\n\n        // Increment step & accumulated length\n        currentPos += deltaRay;\n        accumulatedLength += delta;\n\n        // Stop if opacity reached\n        if(accumulatedLength >= rayLength || accumulatedAlpha >= 1.0)\n            break;\n    }\n\n    //vec3 isovalueLookup = currentPos - vec3(0.5);\n    /////vec2 isoAndGradientMag = getIsovalueAndGradientMagnitude(currentPos);\n    ////isovalue = isoAndGradientMag.r;\n    //vec4 colorTest = texture(u_IsoValueToColorOpacity, vec2(currentPos.x,0));\n    //vec3 colorTestRGB = colorTest.rgb;\n    //float colorTestA = colorTest.a;\n\n    ///isovalue = getNormalizedIsovalue(v_gridPosition);\n    /////float alph = iso2RGBA.a;\n    ///\n    ///alpha = texture(u_IsoValueToColorOpacity, vec2(0.5,0.5)).a;\n    ///isovalue = getNormalizedIsovalue(vec3(v_gridPosition.xy, alpha));\n    ///\n    ///vec4 iso2RGBA = texture(u_IsoValueToColorOpacity, vec2(isovalue, 0.5));\n///\n\n    outColor = vec4(accumulatedColor, accumulatedAlpha);\n    //outColor = vec4(v_gridPosition, 1.0);\n    //outColor = vec4(backfaceGridPos, 1.0);\n//    outColor = vec4(ray, 1.0);\n    //outColor = iso2RGBA; \n    //outColor = vec4(vec3(alph),1.0);\n    //outColor = vec4(vec3(isovalue/2.0),1.0);\n    //outColor = vec4(texture(u_IsoValueToColorOpacity, vec2(0.2, 0.5)).rg, 0.5, 1.0);\n    //outColor = vec4(backfaceGridPos, 1.0);\n\n    //outColor = theDirection;\n    //outColor = vec4(texture(u_TexCoordToRayDirection, texCoord).rgb, 1.0);\n    //outColor = v_gridPosition + vec4(0.5,0.5,0.5,0);\n    //outColor = normalize(theDirection);\n    //outColor = backface;\n\n    //outColor = colorTest;\n    //outColor = texture(u_TexCoordToRayOrigin, texCoord); // WORKS!!!\n    //outColor = isohalfRGBA;\n    //outColor = vec4(vec3(isovalueNormalized),1); // WORKS!\n    //outColor = vec4(xNormalized, yNormalized, 0.5, 1);\n    //outColor = vec4(1,1,1,1);\n    //outColor = vec4(0.3,0.4,0.2,1);\n    //outColor = v_gridPosition + vec4(0.5,0.5,0.5,0);\n    //outColor = isovalue;\n    //outColor = vec4(colorTestRGB, 1);\n    //outColor = vec4(rayDirectionNormalized,1);\n}\n"]),this.vertexShaders.PositionToRGB=glsl(["#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n// world coords -> bounding box coords -> tex coords\n// [-1,1]       -> [-0.5,0.5]          -> [0,1]\nvec3 Model2NormalizedBBCoord_0_to_1_1540259130(vec3 modelPosition, vec3 boundingBox) {\n    return (modelPosition / boundingBox) + vec3(0.5);//\n}\n\nuniform mat4 u_WorldViewProjection;\nuniform vec3 u_BoundingBoxNormalized;\n//uniform float u_AspectRatio;\n\nin vec4 a_position;\nout vec4 v_gridPosition; // [0,1] position within the bounding box coords\n\nvoid main() {\n\n    vec3 gridCoord3D_0_to_1 = Model2NormalizedBBCoord_0_to_1_1540259130(a_position.xyz, u_BoundingBoxNormalized);\n\n    v_gridPosition = vec4(gridCoord3D_0_to_1,1.0);\n\n    vec4 projPos = (u_WorldViewProjection * a_position);\n    //projPos.x /= u_AspectRatio;\n\n    gl_Position = projPos;// vec4(projPos.x/u_AspectRatio, projPos.y, projPos.z, projPos.w);\n}\n"]),this.fragmentShaders.PositionToRGB=glsl(["#version 300 es\nprecision mediump float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nin vec4 v_gridPosition;\nout vec4 outColor;\n\nvoid main() {\n    outColor = v_gridPosition;\n}\n"]),this.vertexShaders.DebugCube=glsl(["#version 300 es\n#define GLSLIFY 1\nuniform mat4 u_WorldViewProjection;\nuniform vec3 u_LightWorldPos;\nuniform mat4 u_World;\nuniform mat4 u_ViewInverse;\nuniform mat4 u_WorldInverseTranspose;\nuniform float u_AspectRatio;\n\nin vec4 a_position;\nin vec3 a_normal;\nin vec2 a_texcoord;\n\nout vec4 v_position;\nout vec2 v_texCoord;\nout vec3 v_normal;\nout vec3 v_surfaceToLight;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_texCoord = a_texcoord;\n    v_position = (u_WorldViewProjection * a_position);\n    v_normal = (u_WorldInverseTranspose * vec4(a_normal, 0)).xyz;\n    v_surfaceToLight = u_LightWorldPos - (u_World * a_position).xyz;\n    v_surfaceToView = (u_ViewInverse[3] - (u_World * a_position)).xyz;\n    gl_Position = vec4(v_position.x/u_AspectRatio, v_position.y, v_position.z, v_position.w);\n}\n"]),this.fragmentShaders.DebugCube=glsl(["#version 300 es\n\nprecision mediump float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nin vec4 v_position;\nin vec2 v_texCoord;\nin vec3 v_normal;\nin vec3 v_surfaceToLight;\nin vec3 v_surfaceToView;\n\nuniform vec4 u_LightColor;\nuniform vec4 u_Ambient;\nuniform sampler2D u_Diffuse;\nuniform vec4 u_Specular;\nuniform float u_Shininess;\nuniform float u_SpecularFactor;\n\nvec4 lit(float l ,float h, float m) {\nreturn vec4(1.0,\nmax(l, 0.0),\n(l > 0.0) ? pow(max(0.0, h), m) : 0.0,\n1.0);\n}\n\nout vec4 outColor;\n\nvoid main() {\n    vec4 diffuseColor = texture(u_Diffuse, v_texCoord);\n    vec3 a_normal = normalize(v_normal);\n    vec3 surfaceToLight = normalize(v_surfaceToLight);\n    vec3 surfaceToView = normalize(v_surfaceToView);\n    vec3 halfVector = normalize(surfaceToLight + surfaceToView);\n\n    vec4 litR = lit(dot(a_normal, surfaceToLight),\n                    dot(a_normal, halfVector), u_Shininess);\n\n    outColor = vec4((\n    u_LightColor * (diffuseColor * litR.y + diffuseColor * u_Ambient +\n    u_Specular * litR.z * u_SpecularFactor)).rgb,\n    diffuseColor.a);\n\n}\n"]),this.vertexShaders.DebugVolume=glsl(["#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n// world coords -> bounding box coords -> tex coords\n// [-1,1]       -> [-0.5,0.5]          -> [0,1]\nvec3 Model2NormalizedBBCoord_0_to_1_1540259130(vec3 modelPosition, vec3 boundingBox) {\n    return (modelPosition / boundingBox) + vec3(0.5);//\n}\n\nuniform mat4 u_WorldViewProjection;\nuniform vec3 u_BoundingBoxNormalized;\nuniform float u_AspectRatio;\n\nin vec4 a_position;\nout vec4 v_position; // [0,1] position within the bounding box coords\n\nvoid main() {\n\n    vec3 gridCoord3D_0_to_1 = Model2NormalizedBBCoord_0_to_1_1540259130(a_position.xyz, u_BoundingBoxNormalized);\n\n    v_position = vec4(gridCoord3D_0_to_1,1.0);\n\n    vec4 projPos = (u_WorldViewProjection * a_position);\n    gl_Position = vec4(projPos.x/u_AspectRatio, projPos.y, projPos.z, projPos.w);\n}\n"]),this.fragmentShaders.DebugVolume=glsl(["#version 300 es\nprecision mediump float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nin vec4 v_position;\nout vec4 outColor;\n\nvoid main() {\n    outColor = vec4(0.7,0.1,0.9,1.0);//v_position;\n}\n"]),this.vertexShaders.TextureToBBColor=glsl(["#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nuniform mat4 u_WorldViewProjection;\nuniform vec3 u_BoundingBoxNormalized;\nuniform float u_AspectRatio;\n\nin vec4 a_position;\nout vec4 v_projPosition;\n\nvoid main() {\n\n    vec4 projPos = (u_WorldViewProjection * a_position);\n    projPos.x /= u_AspectRatio;\n\n    v_projPosition = projPos;\n\n    gl_Position = projPos;//vec4(projPos.x/u_AspectRatio, projPos.y, projPos.z, projPos.w);\n}\n"]),this.fragmentShaders.TextureToBBColor=glsl(["#version 300 es\nprecision mediump float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nvec2 Proj2ScreenCoords_0_to_1_1540259130(vec4 projectedPosition) {\n    vec2 texCoord = projectedPosition.xy / projectedPosition.w;\n    texCoord.x = 0.5 * texCoord.x + 0.5;\n    texCoord.y = 0.5 * texCoord.y + 0.5;\n    return texCoord;\n}\n\nuniform sampler2D u_TexCoordToRayOrigin;\n\nin vec4 v_projPosition;\nout vec4 outColor;\n\nvoid main() {\n\n    vec2 screenCoord = Proj2ScreenCoords_0_to_1_1540259130(v_projPosition);\n    //outColor = vec4(screenCoord, 0.5, 1.0);//\n    outColor = vec4(texture(u_TexCoordToRayOrigin, screenCoord).rgb, 1.0); //v_position;\n}\n"]),this.vertexShaders.TextureBackMinusFront=glsl(["#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n// world coords -> bounding box coords -> tex coords\n// [-1,1]       -> [-0.5,0.5]          -> [0,1]\nvec3 Model2NormalizedBBCoord_0_to_1_1540259130(vec3 modelPosition, vec3 boundingBox) {\n    return (modelPosition / boundingBox) + vec3(0.5);//\n}\n\nvec2 Proj2ScreenCoords_0_to_1_1604150559(vec4 projectedPosition) {\n    vec2 texCoord = projectedPosition.xy / projectedPosition.w;\n    texCoord.x = 0.5 * texCoord.x + 0.5;\n    texCoord.y = 0.5 * texCoord.y + 0.5;\n    return texCoord;\n}\n\nuniform mat4 u_WorldViewProjection;\nuniform vec3 u_BoundingBoxNormalized;\nuniform float u_AspectRatio;\n\nin vec4 a_position;\nout vec3 v_gridPosition; // [0,1] position within the bounding box coords\nout vec2 v_screenCoord;\n\nvoid main() {\n\n    vec3 gridCoord3D_0_to_1 = Model2NormalizedBBCoord_0_to_1_1540259130(a_position.xyz, u_BoundingBoxNormalized);\n\n    v_gridPosition = gridCoord3D_0_to_1;\n\n    vec4 projPos = (u_WorldViewProjection * a_position);\n    projPos.x /= u_AspectRatio;\n\n    v_screenCoord = Proj2ScreenCoords_0_to_1_1604150559(projPos);\n\n    gl_Position = projPos;\n}\n"]),this.fragmentShaders.TextureBackMinusFront=glsl(["#version 300 es\nprecision mediump float;\nprecision mediump sampler2D;\n#define GLSLIFY 1\n\nuniform sampler2D u_TexCoordToRayEndPoint;\n\nin vec3 v_gridPosition;\nin vec2 v_screenCoord;\n\nout vec4 outColor;\n\nvoid main() {\n\n    vec3 backPosRGB = texture(u_TexCoordToRayEndPoint, v_screenCoord).rgb;\n    vec3 front2back = backPosRGB - v_gridPosition;\n\n    outColor = vec4(front2back, 1.0);\n}\n"]),this.vertexShaders.SlicerBasic=glsl(["#version 300 es\nprecision highp float;\nprecision mediump int;\n#define GLSLIFY 1\n\n/*\nconst int NONE = -1;\nconst int BB_FACE = 0;\nconst int RAIL = 1;\nconst int Slice = 2;\n\nconst int X_DIR = 0;\nconst int Y_DIR = 1;\nconst int Z_DIR = 2;\n*/\n\nuniform mat4 u_WorldViewProjection;\n\n// TODO make into uniforms\nconst vec3 u_DirectionColors[3] = vec3[3](\n    vec3(1.0, 0.0, 0.0),\n    vec3(0.0, 1.0, 0.0),\n    vec3(0.0, 0.0, 1.0)\n);\n\n//DISCARD!\n\nconst vec2 u_SelectionModeOpacities = vec2(0.5, 1.0); //[unselected, selected]\n\n/*\nuniform int u_HighlightedType; // -1, 0, 1 or 2\n// -1 = NONE\n// 0 = BB face\n// 1 = rail\n// 2 = Slice\n*/\nuniform float u_Size;\nuniform int u_HighlightID;\nuniform float u_SliceOffsets[6]; // [x1,x2,y1,y2,z1,z2]\n//uniform int u_SliceOffsetIndices[6]; // [0,5] id(index) -> offset index [0,5]\n// If offset index is -1, means it is not in use at the moment\n// Slice id is from 0 to 5\n\nin vec4 a_position;\n//in int a_type;\nin int a_direction;\nin int a_id; // id of BB face / rail / Slice,\n//NOTE: max 6 Slices, id in range [0,5]\n\n//out int v_direction;\nflat out vec4 v_color; // calc color here! No interpolation needed (nor allowed in glsl es3)\nflat out int v_direction;\nflat out int v_id;\nflat out int v_discardMe;\nout vec3 v_position;\n\nbool isSlice() {\n    return 0 <= a_id && a_id <= 5;\n}\n\nbool isFace() {\n    return 6 <= a_id && a_id <= 11;\n}\n\n// Slice base position is always at the most negative coord allowed on respective axis\n/*\nmat4 displaceSlice() {\n    //int offsetIndex = u_SliceOffsetIndices[id];\n\n\n    // Assume start pos is [0,0,0]\n    float offset01 = u_SliceOffsets[a_id]; // Start pos: [-size/2, -size/2, -size/2]\n    float offset = offset01; // [0,1] -> [-size/2, size/2]\n\n    if(a_id < 2) // X, YZ plane, i.e translate along X-axis\n        return mat4(\n            1.0, 0.0, 0.0, offset,\n            0.0, 1.0, 0.0, 0.0,\n            0.0, 0.0, 1.0, 0.0,\n            0.0, 0.0, 0.0, 1.0\n        );\n    else if(a_id < 4) // Y, XZ plane, translate along Y axis\n        return mat4(\n            1.0, 0.0, 0.0, 0.0,\n            0.0, 1.0, 0.0, offset,\n            0.0, 0.0, 1.0, 0.0,\n            0.0, 0.0, 0.0, 1.0\n        );\n    else // Z, XY plane, translate along Z axis\n        return mat4(\n            1.0, 0.0, 0.0, 0.0,\n            0.0, 1.0, 0.0, 0.0,\n            0.0, 0.0, 1.0, offset,\n            0.0, 0.0, 0.0, 1.0\n        );\n}\n*/\n\nvec3 translateSlice() {\n    float offset01 = u_SliceOffsets[a_id]; // Start pos: [-size/2, -size/2, -size/2]\n    float offset = offset01 * u_Size; // [0,1] -> [-size/2, size/2]\n\n    if(a_id < 2) // X, YZ plane, i.e translate along X-axis\n        return vec3(offset, 0.0, 0.0);\n    else if(a_id < 4) // Y, XZ plane, translate along Y axis\n        return vec3(0.0, offset, 0.0);\n    else // Z, XY plane, translate along Z axis\n        return vec3(0.0, 0.0, offset);\n}\n\nvoid main() {\n    v_direction = a_direction;\n    v_id = a_id;\n    v_discardMe = 0; // default: do not discard the Slice\n\n    // 2. Set position\n    if(isSlice()) { // Slice, then displace by offset.\n\n        if(u_SliceOffsets[a_id] < 0.0) {\n            v_discardMe = 1;\n        } else {\n/*\n            mat4 displaceByOffset = displaceSlice();\n*/\n            vec3 translateByOffset = translateSlice();\n\n            vec4 tpos = a_position + vec4(translateByOffset, 0.0);\n\n            gl_Position = u_WorldViewProjection * tpos;\n            v_position = vec3(tpos);\n\n            //gl_Position = u_WorldViewProjection * displaceByOffset * a_position;\n            //v_position = vec3(displaceByOffset * a_position);\n        }\n\n    } else if(isFace()) {\n        v_discardMe = 1; // hide faces\n        gl_Position = u_WorldViewProjection * a_position;\n        v_position = vec3(a_position);\n    }\n    else {\n        gl_Position = u_WorldViewProjection * a_position;\n        v_position = vec3(a_position);\n    }\n}\n\n"]),this.fragmentShaders.SlicerBasic=glsl(["#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nconst vec3 u_DirectionColors[3] = vec3[3](\n    vec3(1.0, 0.0, 0.0),\n    vec3(0.0, 1.0, 0.0),\n    vec3(0.0, 0.0, 1.0)\n);\n\nconst vec3 u_SliceColors[6] = vec3[6](\n    vec3(1.0, 0.0, 0.0),\n    vec3(1.0, 1.0, 0.0),\n    vec3(0.5, 0.5, 1.0),\n    vec3(0.7, 0.4, 0.0),\n    vec3(0.9, 0.1, 4.0),\n    vec3(0.1, 0.5, 1.0)\n);\n\n//DISCARD!\n\nconst vec2 u_SelectionModeOpacities = vec2(0.1, 1.0); //[unselected, selected]\n\n/*\nuniform int u_HighlightedType; // -1, 0, 1 or 2\n// -1 = NONE\n// 0 = BB face\n// 1 = rail\n// 2 = quad\n*/\nuniform int u_HighlightID;\nuniform float u_SliceOffsets[6]; // [x1,x2,y1,y2,z1,z2]\nuniform int u_QuadOffsetIndices[6]; // [0,5] id(index) -> offset index [0,5]\nuniform float u_Size;\n\nuniform vec3 u_PickingRayOrigin;\nuniform vec3 u_RayDir;\nuniform vec3 u_IntersectionPointDebug;\nuniform ivec2 u_DraggedSliceIndices;\n\nflat in vec4 v_color;\n\nflat in int v_direction;\nflat in int v_id;\nflat in int v_discardMe;\n\nin vec3 v_position;\n\nout vec4 outColor;\n\nbool isSlice() {\n    return 0 <= v_id && v_id <= 5;\n}\n\nbool isFace() {\n    return 6 <= v_id && v_id <= 11;\n}\n\nvoid main() {\n    if(v_discardMe == 1)\n        discard;\n\n    vec3 myColor = u_DirectionColors[v_direction];\n\n    if(isFace()) {\n        myColor = u_SliceColors[v_id - 6];\n    }\n\n    bool isHighlighted = v_id == u_HighlightID;\n\n    if(isSlice()) {\n        myColor = u_SliceColors[v_id];\n        bool isDrag1 = (u_DraggedSliceIndices.x == v_id);\n        bool isDrag2 = (u_DraggedSliceIndices.y == v_id);\n        isHighlighted = isHighlighted || isDrag1;\n        isHighlighted = isHighlighted || isDrag2;\n    }\n\n    int opacityIndex = isHighlighted ? 1 : 0;\n\n    float myOpacity = u_SelectionModeOpacities[opacityIndex];\n\n    // Debugging only\n    vec3 vpos01 = ((v_position / vec3(u_Size)) / 2.0) + vec3(0.5);\n\n    vec3 v01 = v_position - u_PickingRayOrigin;\n    vec3 v02 = v_position - (u_PickingRayOrigin + u_Size*u_RayDir);\n    vec3 v21 = (u_Size*u_RayDir);\n\n    float dist = length(cross(v01, v02))/length(v21);\n\n    outColor = vec4(myColor, myOpacity);\n\n    if(dist < 0.04)\n        outColor = vec4(0.1,1.0,0.6,1.0);\n}\n"]),this.vertexShaders.SlicerPicking=glsl(["#version 300 es\nprecision highp float;\nprecision mediump int;\n#define GLSLIFY 1\n\n// world coords -> bounding box coords -> tex coords\n// [-1,1]       -> [-0.5,0.5]          -> [0,1]\nvec3 Model2NormalizedBBCoord_0_to_1_1540259130(vec3 modelPosition, vec3 boundingBox) {\n    return (modelPosition / boundingBox) + vec3(0.5);//\n}\n\nuniform mat4 u_WorldViewProjection;\nuniform float u_SliceOffsets[6]; // [x1,x2,y1,y2,z1,z2]\nuniform float u_Size;\nuniform int u_ActiveDragRailID;\n\nin vec4 a_position;\nin int a_id;\nin int a_direction;\n\nout vec3 v_position01;\nout vec3 v_position;\n\nflat out int v_id;\nflat out int v_discardMe;\nflat out int v_direction;\n\nbool isSlice() {\n    return 0 <= a_id && a_id <= 5;\n}\n\nvec3 translateSlice() {\n    float offset01 = u_SliceOffsets[a_id]; // Start pos: [-size/2, -size/2, -size/2]\n    float offset = offset01 * u_Size; // [0,1] -> [-size/2, size/2]\n\n    if(a_id < 2) // X, YZ plane, i.e translate along X-axis\n        return vec3(offset, 0.0, 0.0);\n    else if(a_id < 4) // Y, XZ plane, translate along Y axis\n        return vec3(0.0, offset, 0.0);\n    else // Z, XY plane, translate along Z axis\n        return vec3(0.0, 0.0, offset);\n}\n\nvoid main() {\n    v_id = a_id;\n    v_direction = a_direction;\n    v_position01 = Model2NormalizedBBCoord_0_to_1_1540259130(a_position.xyz, vec3(u_Size));\n\n    if(u_ActiveDragRailID > 11 && u_ActiveDragRailID != a_id) {\n        v_discardMe = 1;\n    }\n\n    if(isSlice()) { // Slice, then displace by offset.\n\n        if(u_SliceOffsets[a_id] < 0.0) {\n            v_discardMe = 1;\n        } else {\n            vec3 translateByOffset = translateSlice();\n\n            vec4 tpos = a_position + vec4(translateByOffset, 0.0);\n\n            gl_Position = u_WorldViewProjection * tpos;\n            v_position = vec3(tpos);\n        }\n    }\n    else {\n        gl_Position = u_WorldViewProjection * a_position;\n        v_position = vec3(a_position);\n    }\n}\n\n"]),this.fragmentShaders.SlicerPicking=glsl(["#version 300 es\nprecision highp float;\nprecision mediump int;\n#define GLSLIFY 1\n\nconst float MAX_IDS = 255.0;\n\n//uniform vec3 u_PickingRayOrigin;\n//uniform vec3 u_RayDir;\n//uniform float u_Size;\n\nin vec3 v_position01;\nin vec3 v_position;\n\nflat in int v_id;\nflat in int v_discardMe;\nflat in int v_direction;\n\nout vec4 outColor;\n\nbool isRail() {\n    return v_id > 11;\n}\n\nfloat getRailOffset() {\n    return v_position01[v_direction];\n}\n\nvoid main() {\n    if(v_discardMe == 1)\n        discard;\n\n    float r = float(v_id + 1) / 255.0; // offset it by 1 to avoid having 0 be highlighted by default.\n    float g = 0.0;\n\n    if(isRail()) {\n        g = getRailOffset();\n    }\n\n/* // Debug only, will show mouse loc @ output\n    vec3 vpos01 = ((v_position / vec3(u_Size)) / 2.0) + vec3(0.5);\n\n    vec3 v01 = v_position - u_PickingRayOrigin;\n    vec3 v02 = v_position - (u_PickingRayOrigin + u_Size*u_RayDir);\n    vec3 v21 = (u_Size*u_RayDir);\n\n    float dist = length(cross(v01, v02))/length(v21);\n*/\n\n    // Encode ID into the red component\n    outColor = vec4(r,g,0.0,1.0);\n\n    // DEBUG ONLY!!!\n    //if(dist < 0.08)\n    //    outColor = vec4(0.5,1.0,1.0,1.0);\n\n}\n"]),this.vertexShaders.Texture2Quad=glsl(["#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec2 Proj2ScreenCoords_0_to_1_1540259130(vec4 projectedPosition) {\n    vec2 texCoord = projectedPosition.xy / projectedPosition.w;\n    texCoord.x = 0.5 * texCoord.x + 0.5;\n    texCoord.y = 0.5 * texCoord.y + 0.5;\n    return texCoord;\n}\n\nin vec4 a_position;\nout vec2 v_screenPosition;\n\nvoid main() {\n    v_screenPosition = Proj2ScreenCoords_0_to_1_1540259130(vec4(a_position.xyz, 1.0));\n\n    gl_Position = a_position;\n}\n\n"]),this.fragmentShaders.Texture2Quad=glsl(["#version 300 es\nprecision highp float;\nprecision highp sampler2D;\n#define GLSLIFY 1\n\nuniform sampler2D u_QuadTexture;\n\nin vec2 v_screenPosition;\nout vec4 outColor;\n\nvoid main() {\n\n    vec4 texColor = texture(u_QuadTexture, v_screenPosition);\n\n    outColor = vec4(texColor.xyz,1.0);\n}\n"]),this.vertexShaders.VolImage2Quad=glsl(["#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec2 Proj2ScreenCoords_0_to_1_1540259130(vec4 projectedPosition) {\n    vec2 texCoord = projectedPosition.xy / projectedPosition.w;\n    texCoord.x = 0.5 * texCoord.x + 0.5;\n    texCoord.y = 0.5 * texCoord.y + 0.5;\n    return texCoord;\n}\n\nin vec4 a_position;\nout vec2 v_screenPosition;\n\nvoid main() {\n    v_screenPosition = Proj2ScreenCoords_0_to_1_1540259130(vec4(a_position.xyz, 1.0));\n\n    gl_Position = a_position;\n}\n\n"]),this.fragmentShaders.VolImage2Quad=glsl(["#version 300 es\nprecision highp float;\nprecision highp sampler2D;\n#define GLSLIFY 1\n\nuniform sampler2D u_VolumeImageTexture;\n\nin vec2 v_screenPosition;\nout vec4 outColor;\n\nvoid main() {\n\n    vec4 texColor = texture(u_VolumeImageTexture, v_screenPosition);\n\n    outColor = vec4(texColor.xyz,1.0);\n}\n"]),this._initBuiltinPrograms()}_initBuiltinPrograms(){for(let program in BUILTIN_PROGRAMS)this.createProgramFromShaders({name:program,vShaderName:program,fShaderName:program})}createProgramFromShaders(detail){this.vertexShaders[detail.vShaderName],this.fragmentShaders[detail.fShaderName];this.programs[detail.name]=twgl.createProgramInfo(this.gl,[this.vertexShaders[detail.vShaderName],this.fragmentShaders[detail.fShaderName]])}getProgramInfo(name){return this.programs[name]}getListOfPrograms(){return this.programs.keys()}getAvailableShadersSets(){return BUILTIN_PROGRAMS}}module.exports=ShaderManager},{glslify:14,"twgl.js":21}],56:[function(require,module,exports){class UniformManager{constructor(){this.shared={},this.unique={},this.uniforms={}}addShared(name,getter){this.shared[name]=getter}addUnique(name,getter){this.unique[name]=getter}uniqueUniformDidChange(name,subviewID){this._setUniform(subviewID,name,this._getUniqueUniform(name,subviewID))}sharedUniformDidChange(name){let newValue=this._getSharedUniform(name);for(let subviewID in this.uniforms)this._setUniform(subviewID,name,newValue)}updateAll(){for(let uniformName in this.shared)this.sharedUniformDidChange(uniformName);for(let uniformName in this.unique)for(let subviewID in this.uniforms)this.uniqueUniformDidChange(uniformName,subviewID)}addSubview(subviewID){this._bundleUniformsForSubview(subviewID)}removeSubview(subviewID){delete this.uniforms[subviewID]}getUniformBundle(subviewID){return this.uniforms[subviewID]}_bundleUniformsForSubview(subviewID){let bundle={};for(let uniformName in this.shared)bundle[uniformName]=this._getSharedUniform(uniformName);for(let uniformName in this.unique)bundle[uniformName]=this._getUniqueUniform(uniformName,subviewID);this.uniforms[subviewID]=bundle}_getUniqueUniform(uniformName,subviewID){return this.unique[uniformName](subviewID)}_getSharedUniform(uniformName){return this.shared[uniformName]()}_setUniform(subviewID,uniformName,value){this.uniforms[subviewID][uniformName]=value}}module.exports=UniformManager},{}],57:[function(require,module,exports){let d3=require("d3"),SplitViewIconSet=require("../widgets/split-view/icon-set"),SETTINGS={Widgets:{TransferFunction:{Editor:{Resolution:{width:400,height:200},Layout:{leftAxisWidthPercentage:.07,bottomAxisHeightPercentage:.25,isoValueAxisHeightPercentage:.11,contentTopPaddingPercentage:.2,texturePreviewHeightPercentage:.2},TransferFunctionDisplay:{curve:d3.curveLinear,circleRadius:6},ColorGradientDisplay:{triangleSize:45,crossSize:45,trianglesGroupTranslateY:-10,crossTranslateY:17}}},LinkerAndSplitterView:{maxRows:10,maxColumns:10,showIDs:!1,bottomTopThresholdPercentage:.2,colors:{LINKS:["red","green","white","aqua","brown","gold"],REMOVE:"red",ADD:"green",SELECT:"green",EDIT:"darkblue"},showIconsOnLinkingViews:!1,showIconsOnAddRemoveView:!0,showIconsOnSelectView:!0,icons:new SplitViewIconSet({Icons:{
"Surface View":"../client/images/icons/skull-icon.png","Slice View":"../client/images/icons/icon-slicer.png","3D Volume":"../client/images/icons/3d-icon-skull.png"},defaultIcon:"3D Volume"})}},WSClient:{Timeouts:{getDatasetList:1e4,getDatasetHeader:1e4,getDatasetIsovalues:1e5},loadAutomaticallyByDefault:!1},Views:{ViewManager:{WindowsOverlay:{Options:{showIDs:!0,bottomTopThresholdPercentage:.1},SubcellLayout:{changeLayoutThresholdMultiplier:2.2,standardSizeMultiplier:.7}}},Slicer:{SelectSliceSnapThreshold:.25,RailRadiusDisplayMode:.05,RailRadiusPickingBufferMode:.11,RailRadialSubdivisions:7,RailVerticalSubdivisions:5,RailOutwardsFactorPickingBuffer:1},ContextMenus:{Volume:{Rotate:"../client/images/icons/rotate.png",Move:"../client/images/icons/move.png",Zoom:"../client/images/icons/zoom.png",Measure:"../client/images/icons/ruler.png"},Slicer:{Rotate:"../client/images/icons/rotate.png",Zoom:"../client/images/icons/zoom.png","Add Slice":"../client/images/icons/add.png","Remove Slice":"../client/images/icons/remove.png","Move Slice":"../client/images/icons/move-slice.png"}}}};module.exports=SETTINGS},{"../widgets/split-view/icon-set":68,d3:3}],58:[function(require,module,exports){let ContextMenus=require("../settings").Views.ContextMenus,menus={},callbacks={},notify=null,bundle={};name=>{notify(name)};for(let ContextMenu in ContextMenus){menus[ContextMenu]=[];let MenuItems=ContextMenus[ContextMenu];for(let itemName in MenuItems){let itemIMGPath=MenuItems[itemName];menus[ContextMenu].push({name:itemName,img:itemIMGPath,title:itemName,fun:()=>{callbacks[ContextMenu](itemName)}})}bundle[ContextMenu]={menu:menus[ContextMenu],listen:handle=>{callbacks[ContextMenu]=handle}}}module.exports=bundle},{"../settings":57}],59:[function(require,module,exports){let ConfigurableRenderer=require("../rendering/configurable-renderer");class Subview{constructor(webGLContext){this.gl=webGLContext,this.uniforms=null,this.needsUpdate={Volume:!0,Slicer:!0,Sphere:!1},this.needsFullUpdate={Volume:!0,Slicer:!0,Sphere:!1},this.renderers={Volume:new ConfigurableRenderer(this.gl),Slicer:new ConfigurableRenderer(this.gl),SlicerPicking:new ConfigurableRenderer(this.gl),Sphere:null},this.viewports={Volume:null,Slicer:null,Sphere:null}}getAspectRatio(){let total=this.viewports.Volume;return total?total.width/total.height:1}renderSpecific(name,configTweak){this.renderers[name].render(configTweak)}notifyNeedsUpdate(name,fullUpdate){this.needsUpdate[name]=!0,void 0!==fullUpdate&&(this.needsFullUpdate[name]=fullUpdate)}render(){this.needsUpdate.Volume&&(this.renderers.Volume.render(this.needsFullUpdate.Volume),this.renderers.Slicer.render(),this.needsUpdate.Volume=!1,this.needsFullUpdate.Volume=!1,this.needsUpdate.Slicer=!1),this.needsUpdate.Slicer&&(this.needsUpdate.Slicer=!1),this.needsUpdate.SlicerPicking&&(this.needsUpdate.SlicerPicking=!1)}notifyEventDidHappen(subcellName,event){}setUniforms(uniforms){this.uniforms=uniforms}configureRenderer(rendererName,config){this.renderers[rendererName].configure(config)}setViewports(viewports){this.viewports=viewports;for(let vp of viewports)this.renderers[vp.name]&&this.renderers[vp.name].setViewport(vp),this.viewports[vp.name]=vp}}module.exports=Subview},{"../rendering/configurable-renderer":50}],60:[function(require,module,exports){let d3=require("d3"),Subview=require("./subview"),MiniatureSplitViewOverlay=require("../../widgets/split-view/miniature-split-view-overlay"),SubcellLayout=require("../../widgets/split-view/subcell-layout"),Models=require("../linkable-models").Models,ConfigurationManager=require("../resource-managers/configuration-manager"),ShaderManager=require("../resource-managers/shader-manager"),FBAndTextureManager=require("../resource-managers/frame-buffer-and-texture-manager"),ModelSyncManager=require("../resource-managers/model-sync-manager"),UniformManager=require("../resource-managers/uniform-manager"),BufferManager=require("../resource-managers/buffer-manager"),VolumeEventHandlerDelegate=require("./volume-event-handler-delegate"),GetSlicerBufferAttribArrays=require("../models/slicer-model-buffers"),Settings=require("../settings").Views.ViewManager,OverlaySettings=Settings.WindowsOverlay,twgl=require("twgl.js"),createCuboidVertices=require("../../geometry/box");require("glslify"),require("../interaction-modes-v2");class ViewManager{constructor(environmentRef,getAddRemoveView){this.env=environmentRef,this.canvasContainer=d3.select("#webgl-canvas-container"),this.masterCanvas=document.getElementById("webgl-master-canvas"),this.masterContext=this.masterCanvas.getContext("webgl2",{premultipliedAlpha:!1,alpha:!0,depth:!0}),this.masterContext.getExtension("EXT_color_buffer_float"),this.masterContext.getExtension("OES_texture_float"),twgl.setDefaults({attribPrefix:"a_"}),twgl.resizeCanvasToDisplaySize(this.masterContext.canvas),this.subviews={},this.localControllerSelectedSubviewID=0,this.configurationManager=new ConfigurationManager(this),this.modelSyncManager=new ModelSyncManager(this),this.shaderManager=new ShaderManager(this.masterContext),this.FBAndTextureManager=new FBAndTextureManager(this.masterContext,environmentRef),this.uniformManagerVolume=new UniformManager,this.uniformManagerSlicer=new UniformManager,this.uniformManagerUnitQuad=new UniformManager,this.bufferManager=new BufferManager(this.masterContext),this.volumeEventHandler=new VolumeEventHandlerDelegate(this,{clickTimeout:150});let eventListenerOverlayCallback=(cellID,subcellName,event)=>{switch(subcellName){case"Volume":this.volumeEventHandler.handle(event,cellID),this.uniformManagerVolume.updateAll();break;case"Slicer":this.modelSyncManager.getActiveModel(Models.SLICER.name,cellID).mouse(event),this.uniformManagerSlicer.updateAll()}if("Sphere"===subcellName)return},overlayConfig={containerID:"webgl-canvas-container",coverMe:this.masterCanvas,miniatureSplitViewGetter:getAddRemoveView,options:{showIDs:OverlaySettings.Options.showIDs,bottomTopThresholdPercentage:OverlaySettings.Options.bottomTopThresholdPercentage},subcellLayout:new SubcellLayout({changeLayoutThresholdMultiplier:OverlaySettings.SubcellLayout.changeLayoutThresholdMultiplier,standardSizeMultiplier:OverlaySettings.SubcellLayout.standardSizeMultiplier}),listener:eventListenerOverlayCallback};this.splitviewOverlay=new MiniatureSplitViewOverlay(overlayConfig),window.addEventListener("resize",()=>{this._resize()},!1),this._debugDoRefresh=!0,setTimeout(()=>{},1e3)}_init(){this._genTextures(),this._genFrameBuffersAndTextureTargets(),this._genBuffers(),this._bindUniformManagers(),this.addNewView(0),this.requestAnimationFrame()}notifySlicesDidChange(id){this.uniformManagerSlicer.updateAll(),this.uniformManagerVolume.updateAll(),this.notifyNeedsUpdateForModel(Models.SLICER.name,id,["Volume","Slicer"]),this.requestAnimationFrame()}_genTextures(){let dataset=this.env.getActiveDataset("GLOBAL");if(dataset){let h=dataset.header;this.FBAndTextureManager.createGridPos2Isovalue3DTexture({name:"u_ModelXYZToIsoValue",cols:h.cols,rows:h.rows,slices:h.slices,isovalues:dataset.isovalues}),this.FBAndTextureManager.createTransferFunction2DTexture("GLOBAL")}}_genFrameBuffersAndTextureTargets(){this.FBAndTextureManager.create2DTextureFB({name:"FrontFace"}),this.FBAndTextureManager.create2DTextureFB({name:"BackFace"}),this.FBAndTextureManager.create2DPickingBufferFB("SlicerPicking")}_genVolumeBoundingBoxBuffer(){this.boundingBoxBuffer=twgl.createBufferInfoFromArrays(this.masterContext,{position:vertices.position,indices:vertices.indices,normal:vertices.normal,texcoord:vertices.texcoord})}_genBuffers(){let dataset=this.env.getActiveDataset("GLOBAL"),bb=dataset.header.normalizedBB,vertices=createCuboidVertices(bb.width,bb.height,bb.depth);this.bufferManager.createBufferInfoFromArrays(vertices,"VolumeBB"),this.bufferManager.createFullScreenQuad("FullScreenQuadBuffer");this.bufferManager.getBufferInfo("DebugCubeBuffer");this.bufferManager.createBoundingBoxBufferInfo("DebugCubeBuffer",1,.5,.7);let slicerBufferAttribArrays=GetSlicerBufferAttribArrays();this.bufferManager.createBufferInfoFromArrays(slicerBufferAttribArrays.Vertices,"SlicerBuffer"),this.bufferManager.createBufferInfoFromArrays(slicerBufferAttribArrays.CubeFaceVertices,"SlicerCubeFaceBuffer"),this.bufferManager.createBufferInfoFromArrays(slicerBufferAttribArrays.RailVertices,"SlicerRailBuffer"),this.bufferManager.createBufferInfoFromArrays(slicerBufferAttribArrays.SliceVertices,"SlicerSliceBuffer"),this.bufferManager.createBufferInfoFromArrays(slicerBufferAttribArrays.RailPickingBufferVertices,"SlicerRailPBBuffer")}_initDebug(){this.FBAndTextureManager.createDEBUG2DTexture("DebugTex"),this._bindUniformManagerDebug(),this.bufferManager.createBoundingBoxBufferInfo("DebugCubeBuffer",1,.5,.7);this.bufferManager.getBufferInfo("DebugCubeBuffer");this.addNewView(0),this.refresh()}setModelPointsToGlobal(modelName,pointToGlobal){this.modelSyncManager.setModelPointsToGlobal(modelName,pointToGlobal)}getPickingBufferInfo(name,id){return{get:()=>this.FBAndTextureManager.getFrameBuffer(name),refresh:()=>{this._renderPickingBuffer(name,id)}}}_renderPickingBuffer(name,id){"GLOBAL"===id&&(id=Object.keys(this.subviews)[0]),this.uniformManagerSlicer.updateAll(),this.subviews[id].renderSpecific(name)}_generateDebugConfigurationForSubview(subviewID){let buffer=this.bufferManager.getBufferInfo("VolumeBB");return{uniforms:this.uniformManagerVolume.getUniformBundle(subviewID),steps:[{programInfo:this.shaderManager.getProgramInfo("PositionToRGB"),frameBufferInfo:this.FBAndTextureManager.getFrameBuffer("BackFace"),bufferInfo:buffer,glSettings:{cullFace:"FRONT"}},{programInfo:this.shaderManager.getProgramInfo("BasicVolume"),frameBufferInfo:null,bufferInfo:buffer,glSettings:{cullFace:"BACK"}}]}}_bindUniformManagerDebug(){let gl=this.masterContext,tex=twgl.createTexture(gl,{min:gl.NEAREST,mag:gl.NEAREST,src:[255,255,255,255,192,192,192,255,192,192,192,255,255,255,255,255]}),uniforms={u_LightWorldPos:[1,8,-10],u_LightColor:[1,.8,.8,1],u_Ambient:[0,0,0,1],u_Specular:[1,1,1,1],u_Shininess:50,u_SpecularFactor:1,u_Diffuse:tex};this.uniformManagerVolume.addUnique("u_LightWorldPos",subviewID=>uniforms.u_LightWorldPos),this.uniformManagerVolume.addUnique("u_LightColor",subviewID=>uniforms.u_LightColor),this.uniformManagerVolume.addShared("u_Ambient",()=>uniforms.u_Ambient),this.uniformManagerVolume.addShared("u_Specular",()=>uniforms.u_Specular),this.uniformManagerVolume.addShared("u_Shininess",()=>uniforms.u_Shininess),this.uniformManagerVolume.addShared("u_SpecularFactor",()=>uniforms.u_SpecularFactor),this.uniformManagerVolume.addShared("u_BoundingBoxNormalized",()=>new Float32Array([1,.5,.7])),this.uniformManagerVolume.addShared("u_Diffuse",()=>this.FBAndTextureManager.getTexture("DebugTex")),this.uniformManagerVolume.addUnique("u_ViewInverse",subviewID=>this.modelSyncManager.getActiveModel(Models.CAMERA.name,subviewID).getLookAt()),this.uniformManagerVolume.addUnique("u_World",subviewID=>this.modelSyncManager.getActiveModel(Models.CAMERA.name,subviewID).getWorldMatrix()),this.uniformManagerVolume.addUnique("u_WorldInverseTranspose",subviewID=>this.modelSyncManager.getActiveModel(Models.CAMERA.name,subviewID).getWorldInverseTranspose()),this.uniformManagerVolume.addUnique("u_WorldViewProjection",subviewID=>this.modelSyncManager.getActiveModel(Models.CAMERA.name,subviewID).getWorldViewProjectionMatrix()),this.uniformManagerVolume.addUnique("u_AspectRatio",subviewID=>this.subviews[subviewID].getAspectRatio())}viewTypeChanged(subviewID,newType){}datasetDidChange(){this._init(),Environment.notifyDatasetWasRead()}transferFunctionDidChange(tfKey){this.FBAndTextureManager.createTransferFunction2DTexture(tfKey),this.uniformManagerVolume.updateAll()}_bindUniformManagers(){this._bindUniformManagerVolume(),this._bindUniformManagerSlicer()}_bindUniformManagerUnitQuad(){this.uniformManagerUnitQuad.addUnique("u_QuadTexture",subviewID=>this.FBAndTextureManager.getTexture("UnitQuadTexture"+subviewID))}_bindUniformManagerSlicer(){this.uniformManagerSlicer.addUnique("u_WorldViewProjection",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_WorldViewProjection}),this.uniformManagerSlicer.addUnique("u_SliceOffsets",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_SliceOffsets}),this.uniformManagerSlicer.addUnique("u_QuadOffsetIndices",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_QuadOffsetIndices}),this.uniformManagerSlicer.addUnique("u_HighlightID",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_HighlightID}),this.uniformManagerSlicer.addUnique("u_PickingRayOrigin",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_PickingRayOrigin}),this.uniformManagerSlicer.addUnique("u_RayDir",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_RayDir}),this.uniformManagerSlicer.addUnique("u_Size",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_Size}),this.uniformManagerSlicer.addUnique("u_IntersectionPointDebug",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_IntersectionPointDebug}),this.uniformManagerSlicer.addUnique("u_DraggedSliceIndices",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_DraggedSliceIndices}),this.uniformManagerSlicer.addUnique("u_ActiveDragRailID",subviewID=>{let slicerModel=this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return slicerModel.uniforms.u_ActiveDragRailID})}_bindUniformManagerVolume(){this.uniformManagerVolume.addShared("u_BoundingBoxNormalized",()=>{let nbb=this.env.getActiveDataset("GLOBAL").header.normalizedBB;return new Float32Array([nbb.width,nbb.height,nbb.depth])}),this.FBAndTextureManager.createDEBUG2DTexture("DebugTex"),this.FBAndTextureManager.create2DTextureFB({width:this.masterCanvas.width,height:this.masterCanvas.height,name:"DebugTex2"}),this.uniformManagerVolume.addShared("u_TexCoordToRayOrigin",()=>this.FBAndTextureManager.getTexture("FrontFace")),this.uniformManagerVolume.addShared("u_TexCoordToRayEndPoint",()=>this.FBAndTextureManager.getTexture("BackFace")),this.uniformManagerVolume.addShared("u_ModelXYZToIsoValue",()=>this.FBAndTextureManager.getTexture("u_ModelXYZToIsoValue")),this.uniformManagerVolume.addShared("u_AlphaCorrectionExponent",()=>1),this.uniformManagerVolume.addShared("u_SamplingRate",()=>{let d=this.env.getActiveDataset("GLOBAL");if(!d)return.1;let h=d.header;let m=Math.max(h.cols,h.rows,h.slices);return 1/m}),this.uniformManagerVolume.addUnique("u_WorldViewProjection",subviewID=>{let aspectRatio=this.subviews[subviewID].getAspectRatio();return this.modelSyncManager.getActiveModel(Models.CAMERA.name,subviewID).getWorldViewProjectionMatrix(aspectRatio)}),this.uniformManagerVolume.addUnique("u_AspectRatio",subviewID=>this.subviews[subviewID].getAspectRatio()),this.uniformManagerVolume.addUnique("u_IsoValueToColorOpacity",subviewID=>{let activeModel=this.modelSyncManager.getActiveModel(Models.TRANSFER_FUNCTION.name,subviewID);return this.FBAndTextureManager.getTransferFunction2DTexture(activeModel)}),this.uniformManagerVolume.addUnique("u_IsoMinMax",subviewID=>this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID).minmax),this.uniformManagerVolume.addUnique("u_SliceX",subviewID=>this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID).getSliceOffsets("X")),this.uniformManagerVolume.addUnique("u_SliceY",subviewID=>this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID).getSliceOffsets("Y")),this.uniformManagerVolume.addUnique("u_SliceZ",subviewID=>this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID).getSliceOffsets("Z")),this.uniformManagerVolume.addUnique("u_VolumeImageTexture",subviewID=>this.FBAndTextureManager.getTexture("VolumeImageTexture"+subviewID))}linkChanged(modelKey){this.modelSyncManager.updateSyncForModelKey(modelKey)}_generateBasicSlicerConfigForSubview(subviewID){let gl=this.masterContext;this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return this.uniformManagerSlicer.getUniformBundle(subviewID).u_QuadTexture=this.FBAndTextureManager.getTexture("UnitQuadTexture"),{uniforms:this.uniformManagerSlicer.getUniformBundle(subviewID),steps:[{programInfo:this.shaderManager.getProgramInfo("SlicerBasic"),frameBufferInfo:null,bufferInfo:this.bufferManager.getBufferInfo("SlicerBuffer"),glSettings:{enable:[gl.DEPTH_TEST],clear:[gl.DEPTH_BUFFER_BIT],disable:[gl.CULL_FACE],enable:[gl.BLEND],blendFunc:[gl.SRC_ALPHA,gl.ONE]}}]}}_generateSlicerPickingBufferConfigForSubview(subviewID){let gl=this.masterContext;this.modelSyncManager.getActiveModel(Models.SLICER.name,subviewID);return{uniforms:this.uniformManagerSlicer.getUniformBundle(subviewID),steps:[{programInfo:this.shaderManager.getProgramInfo("SlicerPicking"),frameBufferInfo:this.FBAndTextureManager.getFrameBuffer("SlicerPicking"),bufferInfo:this.bufferManager.getBufferInfo("SlicerCubeFaceBuffer"),glSettings:{enable:[gl.DEPTH_TEST],cullFace:[gl.BACK],depthFunc:[gl.LESS],disable:[gl.BLEND,gl.CULL_FACE],clear:[gl.COLOR_BUFFER_BIT,gl.DEPTH_BUFFER_BIT]}},{programInfo:this.shaderManager.getProgramInfo("SlicerPicking"),frameBufferInfo:this.FBAndTextureManager.getFrameBuffer("SlicerPicking"),bufferInfo:this.bufferManager.getBufferInfo("SlicerRailPBBuffer"),glSettings:{enable:[gl.DEPTH_TEST,gl.CULL_FACE],clear:[gl.DEPTH_BUFFER_BIT],cullFace:[gl.BACK],depthFunc:[gl.LESS],disable:[gl.BLEND]}}]}}_generateBasicVolumeConfigForSubview(subviewID){let buffer=this.bufferManager.getBufferInfo("VolumeBB");return{uniforms:this.uniformManagerVolume.getUniformBundle(subviewID),steps:[{programInfo:this.shaderManager.getProgramInfo("PositionToRGB"),frameBufferInfo:null,bufferInfo:buffer,glSettings:{cullFace:"BACK"}},{programInfo:this.shaderManager.getProgramInfo("PositionToRGB"),frameBufferInfo:null,bufferInfo:buffer,glSettings:{cullFace:"FRONT"}},{programInfo:this.shaderManager.getProgramInfo("BasicVolume"),frameBufferInfo:null,bufferInfo:buffer,glSettings:{cullFace:"BACK"}}]}}updateUniformsForModel(subviewID,modelName){}uniformsDidChangeForSubview(subviewID){}addNewView(id,initialConfigurations){this.FBAndTextureManager.create2DTextureFB({name:"VolumeImageTexture"+id}),this.subviews[id]=new Subview(this.masterContext),this.modelSyncManager.addSubview(id,this),this.uniformManagerVolume.addSubview(id),this.uniformManagerSlicer.addSubview(id),this.configurationManager.configureSubview(id,initialConfigurations||{Volume:"Basic",Slicer:"Basic",SlicerPicking:"Basic"}),this.syncWithLayout()}removeView(id){delete this.subviews[id],this.modelSyncManager.removeSubview(id),this.uniformManagerVolume.removeSubview(id),this.syncWithLayout()}syncWithLayout(){let normalizedViewports=this.splitviewOverlay.render(),canv=this.masterContext.canvas,width=canv.width,height=canv.height,canvasViewports={};for(let subviewID in normalizedViewports)canvasViewports[subviewID]=normalizedViewports[subviewID].map(normalized=>normalized.denormalize(width,height));for(let subviewID in this.subviews)this.subviews[subviewID].setViewports(canvasViewports[subviewID])}_resize(){this.syncWithLayout()}_debugRotateCube(subviewID){let cam=this.modelSyncManager.getActiveModel(Models.CAMERA.name,subviewID);subviewID%6==0?cam.getModelTransformation().rotateZ(-.007):subviewID%2==0?cam.getModelTransformation().rotateY(.007):subviewID%3==0&&cam.getModelTransformation().rotateX(.007),this.uniformManagerVolume.updateAll()}__applyViewportPercentages(gl,args){gl.viewport(args[0]*gl.canvas.width,args[1]*gl.canvas.height,args[2]*gl.canvas.width,args[3]*gl.canvas.height)}refresh(){this.masterContext;for(let subviewID in this.subviews){let view=this.subviews[subviewID];view&&view.render()}}transferFunctionDidChangeForSubviewID(tfEditorKey){if(0!==Object.keys(this.subviews).length){this.FBAndTextureManager.createTransferFunction2DTexture(tfEditorKey),this.uniformManagerVolume.updateAll();let needsUpdateSubviewIDs=[];needsUpdateSubviewIDs="GLOBAL"===tfEditorKey?this.modelSyncManager.getSubviewIDsLinkedWithMaster("GLOBAL",Models.TRANSFER_FUNCTION.name):this.modelSyncManager.getSubviewIDsLinkedWith(this.localControllerSelectedSubviewID,Models.TRANSFER_FUNCTION.name),this._notifySubviewsNeedUpdate("Volume",needsUpdateSubviewIDs,!0),needsUpdateSubviewIDs.length>0&&this.requestAnimationFrame(["Volume"])}}_notifySubviewsNeedUpdate(rendererName,subviewIDs,fullUpdate){for(let subviewID of subviewIDs)this.subviews[subviewID].notifyNeedsUpdate(rendererName,fullUpdate);for(let subviewID in this.subviews)this.subviews[subviewID].notifyNeedsUpdate(rendererName)}_notifyAllSubviewsNeedUpdate(rendererName){}notifyNeedsUpdateForModel(model,sourceSubview,toUpdate){if(0!==Object.keys(this.subviews).length){let needsUpdateSubviewIDs=this.modelSyncManager.getSubviewIDsLinkedWith(sourceSubview,model);for(let rendererKey of toUpdate)this._notifySubviewsNeedUpdate(rendererKey,needsUpdateSubviewIDs,!0)}}_notifyNeedsUpdate(name,subviewID){for(let theSubviewID in this.subviews)this.subviews[theSubviewID].notifyNeedsUpdate(name)}requestAnimationFrame(renderers,subviewID){window.requestAnimationFrame(this.refresh.bind(this))}_updateTextures(subviewID){let TFModelID=this.modelSyncManager.getActiveModel(Models.TRANSFER_FUNCTION.name,subviewID);Environment.TransferFunctionManager.checkNeedsUpdate(TFModelID)&&this.FBAndTextureManager.createTransferFunction2DTexture("GLOBAL")}__DEBUGRefreshView0(){this.subviews[0].refresh()}}module.exports=ViewManager},{"../../geometry/box":65,"../../widgets/split-view/miniature-split-view-overlay":70,"../../widgets/split-view/subcell-layout":73,"../interaction-modes-v2":39,"../linkable-models":41,"../models/slicer-model-buffers":44,"../resource-managers/buffer-manager":51,"../resource-managers/configuration-manager":52,"../resource-managers/frame-buffer-and-texture-manager":53,"../resource-managers/model-sync-manager":54,"../resource-managers/shader-manager":55,"../resource-managers/uniform-manager":56,"../settings":57,"./subview":59,"./volume-event-handler-delegate":61,d3:3,glslify:14,"twgl.js":21}],61:[function(require,module,exports){let MouseHandler=require("../mouse-handler"),Models=require("../linkable-models").Models,GetInteractionMode=require("../interaction-modes-v2").getInteractionModeGetterForCategory("Volume");class VolumeEventHandlerDelegate{constructor(viewManager){this.viewManager=viewManager,this.modelSyncManager=viewManager.modelSyncManager,this.mouseHandler=new MouseHandler({clickTimeout:150}),this._bindMouseHandler(),this.activeSubviewID=0}_bindMouseHandler(){this.mouseHandler.on("mouseenter",null,state=>{}),this.mouseHandler.on("mouseout",null,state=>{}),this.mouseHandler.on("click","left",state=>{let interactionMode=GetInteractionMode();interactionMode}),this.mouseHandler.on("mousedown","left",state=>{let interactionMode=GetInteractionMode();interactionMode});let getCamera=()=>this.modelSyncManager.getActiveModel(Models.CAMERA.name,this.activeSubviewID),update=()=>{this.viewManager.notifyNeedsUpdateForModel(Models.CAMERA.name,this.activeSubviewID,["Volume"]);this.viewManager.requestAnimationFrame()};this.mouseHandler.on("drag","left",state=>{let interactionMode=GetInteractionMode();switch(interactionMode){case"move":getCamera().pan(state.dx,state.dy),update();break;case"zoom":getCamera().zoom(state.dx+state.dy),update();break;case"rotate":getCamera().rotate(state.dx,state.dy),update()}}),this.mouseHandler.on("mouseup","left",state=>{let interactionMode=GetInteractionMode();interactionMode}),this.mouseHandler.on("mousemove","left",state=>{})}handle(event,subviewID){this.activeSubviewID=subviewID,this.mouseHandler.handle(event)}}module.exports=VolumeEventHandlerDelegate},{"../interaction-modes-v2":39,"../linkable-models":41,"../mouse-handler":49}],62:[function(require,module,exports){let VolumeDataset=require("./volume-dataset"),SelectionManager=require("./selection");class DatasetManager{constructor(){this.cellID2Dataset={GLOBAL:null},this.datasets={},this.histogramSelections=new SelectionManager,this.viewSelections_POINTS=new SelectionManager}getHistogramForCellID(cellID){return this.cellID2Dataset[cellID]?this.datasets[this.cellID2Dataset[cellID]].histogram:null}clearDataset(){for(let key in this.datasets)delete this.datasets[key]}getHistogramSelectionForCellID(cellID){return this.cellID2Dataset[cellID]?this.histogramSelections.getSelections(cellID):null}getViewSelectionForCellID(cellID,type){if(this.cellID2Dataset[cellID])switch(type){case"Points":return this.viewSelections_POINTS.getSelections(cellID);default:return null}return null}addDataset(args){this.cellID2Dataset.GLOBAL=args.name,this.datasets[args.name]=new VolumeDataset(args.header,args.isovalues)}getDataset(cellID){return this.datasets[this.cellID2Dataset[cellID]]}removeDataset(key){delete this.datasets[key]}addHistogramSelection(cellID,min,max){this.cellID2Dataset[cellID]&&this.histogramSelections.select(cellID,[min,max])}addViewSelectionPoint(cellID,point){this.cellID2Dataset[cellID]&&this.viewSelections_POINTS.select(cellID,{x:x,y:y,z:z})}}module.exports=DatasetManager},{"./selection":63,"./volume-dataset":64}],63:[function(require,module,exports){class SelectionManager{constructor(){this.indices={},this.selections=[]}select(cellID,selection){this.selections.push(selection),this.indices[cellID]||(this.indices[cellID]=[]),this.indices[cellID].push(this.selections.length-1)}getSelections(cellID){return{indices:this.indices[cellID],selections:this.selections}}}module.exports=SelectionManager},{}],64:[function(require,module,exports){let d3=require("d3");class VolumeDataset{constructor(header,isovalues){this.header=header,this.isovalues=isovalues,this.histogram=[],this.gradient=[],this.gradientMagnitudes=[],this.isovaluesAndGradientMagnitudes=[],this.calculateHistogram()}setIsoValues(isovalues){this.isovalues=isovalues,this.calculateHistogram()}setHeader(header){this.header=header}setGradient(gradient){this.gradient=gradient}getHistogram(){return this.histogram}calculateHistogram(){d3.max(this.isovalues);this.histogram=new Uint16Array(4096);let i=-1;for(i=0;i<this.isovalues.length;i++){let isoValue=this.isovalues[i]/8;++this.histogram[isoValue]}}}module.exports=VolumeDataset},{d3:3}],65:[function(require,module,exports){function augmentTypedArray(typedArray,numComponents){var cursor=0;return typedArray.push=function(){for(var ii=0;ii<arguments.length;++ii){var value=arguments[ii];if(value instanceof Array||value.buffer&&value.buffer instanceof ArrayBuffer)for(var jj=0;jj<value.length;++jj)typedArray[cursor++]=value[jj];else typedArray[cursor++]=value}},typedArray.reset=function(opt_index){cursor=opt_index||0},typedArray.numComponents=numComponents,Object.defineProperty(typedArray,"numElements",{get:function(){return this.length/this.numComponents|0}}),typedArray}function createAugmentedTypedArray(numComponents,numElements,opt_type){return augmentTypedArray(new(opt_type||Float32Array)(numComponents*numElements),numComponents)}function createCuboidVertices(width,height,depth){width=width||1,height=height||1,depth=depth||1;let kx=width/2,ky=height/2,kz=depth/2;for(var cornerVertices=[[-kx,-ky,-kz],[+kx,-ky,-kz],[-kx,+ky,-kz],[+kx,+ky,-kz],[-kx,-ky,+kz],[+kx,-ky,+kz],[-kx,+ky,+kz],[+kx,+ky,+kz]],faceNormals=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],uvCoords=[[1,0],[0,0],[0,1],[1,1]],positions=createAugmentedTypedArray(3,24),normals=createAugmentedTypedArray(3,24),texcoords=createAugmentedTypedArray(2,24),indices=createAugmentedTypedArray(3,12,Uint16Array),f=0;f<6;++f){for(var faceIndices=CUBE_FACE_INDICES[f],v=0;v<4;++v){var position=cornerVertices[faceIndices[v]],normal=faceNormals[f],uv=uvCoords[v];positions.push(position),normals.push(normal),texcoords.push(uv)}var offset=4*f;indices.push(offset+0,offset+1,offset+2),indices.push(offset+0,offset+2,offset+3)}return{position:positions,normal:normals,texcoord:texcoords,indices:indices}}var CUBE_FACE_INDICES=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];module.exports=createCuboidVertices},{}],66:[function(require,module,exports){function printEnvironment(){}require("./angular-assets/main-controller"),require("./client2server/websocket-client");require("./core/environment");module.exports={printEnvironment:printEnvironment}},{"./angular-assets/main-controller":23,"./client2server/websocket-client":37,"./core/environment":38}],67:[function(require,module,exports){let Icons=require("../../core/settings").Widgets.LinkerAndSplitterView.icons.icons,menu=[],notify=null;name=>{notify(name)};for(let iconName in Icons){let iconIMGPath=Icons[iconName];menu.push({name:iconName,img:iconIMGPath,title:iconName,fun:()=>{notify(iconName)}})}module.exports={menu:menu,listen:handle=>{notify=handle}}},{"../../core/settings":57}],68:[function(require,module,exports){class SplitViewIconSet{constructor(args){this.defaultIconName=args.defaultIcon,this.icons=args.Icons,this.subviewID2IconName={0:args.defaultIcon}}getIconClassName(id){return""}getIconName(id){return this.subviewID2IconName[id]}getIconPath(id){return this.getIcon(this.subviewID2IconName[id])}addCell(id){this.subviewID2IconName[id]=this.defaultIconName}removeCell(id){delete this.subviewID2IconName[id]}getIcon(name){return this.icons[name]}setIcon(id,iconName){this.subviewID2IconName[id]=iconName}}module.exports=SplitViewIconSet},{}],69:[function(require,module,exports){let _=require("underscore"),UniqueIndexBag=require("./unique-index-bag");class LinkGrouper{constructor(maxGroups){this.links=[];for(let i=0;i<maxGroups;i++)this.links[i]=[];this.groupIndices=new UniqueIndexBag(maxGroups)}getLinks(){let theLinks=[];for(let link of this.links)0!==link.length&&theLinks.push(link);return theLinks}getMasterCellIDs(){let ids=[];for(let linkGroup of this.links)ids.push(linkGroup[0]);return ids}getMasterCellID(cellID){let groupIndex=this.getLinkGroupIndexOfMember(cellID);return-1!==groupIndex?this.links[groupIndex][0]:cellID}addMemberToGroup(groupIndex,id){this.links[groupIndex].push(id)}addNewLinkGroup(initialMember){let index=this.groupIndices.getIndex();return this.links[index]=[initialMember],index}getNextGroupIndex(){return this.groupIndices.peekAtNextIndex()}ungroupMember(id){if(this.isMemberGrouped(id)&&-1!==id){let index=this.getLinkGroupIndexOfMember(id);2===this.links[index].length?this.removeLinkGroup(index):this.links[index]=_.without(this.links[index],id)}}addGroupIfDoesntExistForMemberWithId(id){return this.isMemberGrouped(id)?-1:this.addNewLinkGroup(id)}removeLinkGroup(index){this.links[index]=[],this.groupIndices.returnIndex(index)}removeIfContainsOnlyOneMember(memberID){let index=this.getLinkGroupIndexOfMember(memberID);1===this.links[index].length&&this.removeLinkGroup(index)}getLinkGroupIndexOfMember(id){for(let i=0;i<this.links.length;i++)if(_.contains(this.links[i],id))return i;return-1}isMemberGrouped(id){return-1!==this.getLinkGroupIndexOfMember(id)}isMembersInSameGroup(id1,id2){return this.isMemberGrouped(id1)&&this.getLinkGroupIndexOfMember(id1)===this.getLinkGroupIndexOfMember(id2)}printMe(){for(let linkGrp of this.links)for(let id of linkGrp);}}module.exports=LinkGrouper},{"./unique-index-bag":74,underscore:22}],70:[function(require,module,exports){let d3=require("d3"),menuInfos=require("../../core/views/context-menu-configs"),InteractionModeManager=require("../../core/interaction-modes-v2");class MiniatureSplitViewOverlay{constructor(args){this.options={showIDs:args.options.showIDs,bottomTopThresholdPercentage:args.options.bottomTopThresholdPercentage},
this.listener=args.listener,this.getMiniatureSplitView=args.miniatureSplitViewGetter,this.parent=document.getElementById(args.containerID),this.coverMe=args.coverMe,this.svg=d3.select(this.parent).append("svg").attr("class","webgl-master-canvas-overlay-svg"),this.group=this.svg.append("g"),this.subcellLayout=args.subcellLayout}render(){let self=this,widthTotal=this.coverMe.clientWidth,heightTotal=this.coverMe.clientHeight,splitView=this.getMiniatureSplitView(),cells=splitView.layout.getLayoutCells();this.group.selectAll("*").remove();let rects=this.group.selectAll(".cell").data(cells).enter().append("rect").attr("x",cellInfo=>cellInfo.x0*widthTotal).attr("y",cellInfo=>cellInfo.y0*heightTotal).attr("width",cellInfo=>cellInfo.width*widthTotal).attr("height",cellInfo=>cellInfo.height*heightTotal).attr("cellID",cellInfo=>cellInfo.id).attr("class","subview-cell"),scaleAndNormalize=(mouse,subcellX0,subcellY0,subcellWidth,subcellHeight)=>({x:mouse[0]/subcellWidth,y:mouse[1]/subcellHeight}),rendererCells={};rects.each(function(d){let cell=d3.select(this);cell.selectAll("*").remove();let cellX0=cell.attr("x"),cellY0=cell.attr("y"),cellWidth=cell.attr("width"),cellHeight=cell.attr("height"),cellID=cell.attr("cellID"),group=self.group.append("g").attr("transform","translate("+cellX0+","+cellY0+")"),subcells=self.subcellLayout.calculateLayout({cellWidth:cellWidth,cellHeight:cellHeight});rendererCells[cellID]=subcells.map(subcell=>subcell.toViewportCoordinates({x:parseFloat(cellX0),y:parseFloat(cellY0)})).map(subcell=>subcell.normalize(widthTotal,heightTotal)),group.selectAll(".subview-subcell").data(subcells).enter().append("g").attr("transform",subcell=>"translate("+subcell.x0+","+subcell.y0+")").append("rect").attr("width",subcell=>subcell.width).attr("height",subcell=>subcell.height).attr("class",subcell=>"subview-subcell-"+subcell.name).on("mousemove",function(subcell){d3.event.stopPropagation();let pos=d3.mouse(this.parentNode),xy=scaleAndNormalize(pos,subcell.x0,subcell.y0,subcell.width,subcell.height);self._handleEvent(cellID,subcell.name,{type:"mousemove",pos:xy,button:d3.event.button})}).on("mousedown",function(subcell){let pos=d3.mouse(this),xy=scaleAndNormalize(pos,subcell.x0,subcell.y0,subcell.width,subcell.height);self._handleEvent(cellID,subcell.name,{type:"mousedown",pos:xy,button:d3.event.button})}).on("mouseup",function(subcell){let pos=d3.mouse(this),xy=scaleAndNormalize(pos,subcell.x0,subcell.y0,subcell.width,subcell.height);self._handleEvent(cellID,subcell.name,{type:"mouseup",pos:xy,button:d3.event.button})}).on("mouseenter",function(subcell){let pos=d3.mouse(this),xy=scaleAndNormalize(pos,subcell.x0,subcell.y0,subcell.width,subcell.height);self._handleEvent(cellID,subcell.name,{type:"mouseenter",pos:xy,button:d3.event.button})}).on("mouseout",function(subcell){let pos=d3.mouse(this),xy=scaleAndNormalize(pos,subcell.x0,subcell.y0,subcell.width,subcell.height);self._handleEvent(cellID,subcell.name,{type:"mouseout",pos:xy,button:d3.event.button})})}),rects.remove();let hasContextMenu=["Volume","Slicer"];for(let ctxOwner of hasContextMenu)$(".subview-subcell-"+ctxOwner).contextMenu(menuInfos[ctxOwner].menu,{triggerOn:"click"}),menuInfos[ctxOwner].listen(item=>{InteractionModeManager.setInteractionMode(ctxOwner,item)});return rendererCells}_handleEvent(cellID,subcellName,event){this.listener(cellID,subcellName,event)}}module.exports=MiniatureSplitViewOverlay},{"../../core/interaction-modes-v2":39,"../../core/views/context-menu-configs":58,d3:3}],71:[function(require,module,exports){let menuInfo=require("./context-menu-config");const _=require("underscore"),SplitBox=require("./splitbox"),d3=require("d3"),LinkGrouper=require("./link-group");require("./icon-set");let IDCACHE=-1;d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var firstChild=this.parentNode.firstChild;firstChild&&this.parentNode.insertBefore(this,firstChild)})};class MiniatureSplitView{constructor(args){if(!args||!args.divID)throw new Error("Args or divID is null... args: "+args);this.properties={divID:args.divID,aspectRatio:args.aspectRatio,state:args.state,canLink:args.canLink,canAddRemove:args.canAddRemove,canSelect:args.canSelect,showIDs:args.showIDs,showIcons:args.showIcons,bottomTopThresholdPercentage:args.bottomTopThresholdPercentage,colors:args.colors},args.dispatcher&&(this.dispatcher=args.dispatcher),this.parent=$("#"+this.properties.divID),this.layout=new SplitBox(args.maxRows,args.maxColumns,args.aspectRatio),this.icons=args.icons,this.linkCache={start:{row:-1,col:-1},end:{row:-1,col:-1}},this.linkGrouper=new LinkGrouper(this.properties.colors.LINKS.length),this.linkLineCache={x1:0,x2:0,y1:0,y2:0,color:"black"},this.cache={},this.linkChangedCallback={},this.viewTypeChangedCallback={},args.canSelect&&this.changeState("SELECT"),this.selected=-1}setViewTypeChangedCallback(handle){this.viewTypeChangedCallback=handle}setSplitbox(splitbox){this.layout=new SplitBox(this.properties.maxRows,this.properties.maxColumns,this.properties.aspectRatio)}clear(){this.parent.html("")}refresh(){this.clear(),this.render()}render(){let svg=d3.select("#"+this.properties.divID).append("svg").attr("width","100%").attr("height","100%"),width=this.parent.width(),height=this.parent.height();void 0===width&&void 0===height&&(width=this.parent.parent.width(),height=this.parent.parent.height());let self=this,current=5;svg.append("rect").attr("x",width).attr("y",height).attr("width",0).attr("height",0).attr("opacity",1).attr("class","halfRect").on("mouseout",function(){self.hideHalfRect()});let masterCellIDs=this.linkGrouper.getMasterCellIDs();if(svg.selectAll(".splitview-rect").data(this.layout.flattenedLayoutPercentages).enter().append(this.properties.showIcons?"image":"rect").attr("class",function(d){let iconClass=self.properties.showIcons?self.icons.getIconClassName(d.cellID):"";return"id-"+d.cellID+" miniature-splitview-rect "+iconClass}).attr("x",function(d){return d.x0*width}).attr("y",function(d){return d.y0*height}).attr("width",function(d){return d.widthN*width}).attr("height",function(d){return d.heightN*height}).attr("xlink:href",d=>self.icons.getIconPath(d.cellID)).classed("linkgroup-master-cell",d=>{let isMaster=this.properties.canLink&&_.contains(masterCellIDs,d.cellID);return isMaster}).classed("highlight-cell",d=>this.selected===d.cellID).on("mouseenter",function(d){IDCACHE=d.cellID}).on("mousemove",function(d){if(!(current-- >0)){current=5;let mouse=d3.mouse(this),x=mouse[0],y=mouse[1],rectWidth=width*d.widthN,halfRectWidth=rectWidth/2,rectHeight=height*d.heightN,x0Whole=d.x0*width,isLeft=x<halfRectWidth+x0Whole,x0H=d.x0*width+(isLeft?0:halfRectWidth),y0=d.y0*height;switch(self.properties.state){case"REMOVE":case"EDIT":case"SELECT":self.showRectAt(x0Whole,y0,rectWidth,rectHeight);break;case"ADD":let vCutOff=self.properties.bottomTopThresholdPercentage*rectHeight,topCutoff=vCutOff+y0,bottomCutoff=y0+rectHeight-vCutOff,isTop=y<topCutoff,isBottom=y>bottomCutoff,topOrBot=isTop?"top":isBottom?"bottom":"";topOrBot?self.showRectAt(0,isTop?y0:bottomCutoff,width,vCutOff,d.cellID):self.showRectAt(x0H,y0,halfRectWidth,rectHeight,d.cellID);break;case"LINK-ADD":self.showRectAt(x0Whole,y0,rectWidth,rectHeight,d.cellID);break;case"LINK-IN-PROGRESS":self.showRectAt(x0Whole,y0,rectWidth,rectHeight,self.linkCache.start.id),self.anchorLinkLineEndTo(x,y)}}}).on("mouseleave",function(d){self.hideHalfRect()}).on("click",function(d){let mouse=d3.mouse(this),x=mouse[0],y=mouse[1],halfRectWidth=width*d.widthN/2,rectHeight=height*d.heightN,x0Whole=d.x0*width,isLeft=x<halfRectWidth+x0Whole,y0=(d.x0,d.y0*height),vCutOff=self.properties.bottomTopThresholdPercentage*rectHeight,topCutoff=vCutOff+y0,bottomCutoff=y0+rectHeight-vCutOff,isTop=y<topCutoff,isBottom=y>bottomCutoff,topOrBot=isTop?"top":isBottom?"bottom":"",direction=""!==topOrBot?topOrBot:isLeft?"left":"right";self.mouseClick(d.rowIndex,d.cellIndex,direction,x0Whole+halfRectWidth,y0+rectHeight/2,x,y)}),this.properties.showIDs&&svg.selectAll(".splitview-label").data(this.layout.flattenedLayoutPercentages).enter().append("text").text(function(d){return d.cellID}).attr("x",function(d){return d.x0*width+width*d.widthN/2}).attr("y",function(d){return d.y0*height+height*d.heightN/2}),this.properties.canLink){svg.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0).attr("class","linker-line").moveToBack();this.drawLinkLineFromCache(),this.applyLinkageColors()}if(this.properties.showIcons){let sel=$("image.miniature-splitview-rect");sel.contextMenu(menuInfo.menu,{triggerOn:"click"}),menuInfo.listen(name=>{this.notifyViewTypeChanged(name,IDCACHE)})}}notifyViewTypeChanged(newType,cellID){newType!==this.icons.getIconName(cellID)&&(this.icons.setIcon(cellID,newType),this.viewTypeChangedCallback(cellID,newType),this.dispatcher("refresh",[]))}showRectAt(x0,y0,rectWidth,rectHeight,cellID){let path="#"+this.properties.divID+">svg>rect.halfRect";d3.select(path).attr("x",x0).attr("y",y0).attr("width",rectWidth).attr("height",rectHeight).attr("fill",this.getColor(cellID))}getLinkageColor(cellID){let prevState=this.properties.state;this.properties.state="LINK-ADD";let linkedColor=this.getColor(cellID);return this.properties.state=prevState,linkedColor}getColor(cellID){if(_.contains(["LINK-ADD","LINK-IN-PROGRESS"],this.properties.state)){let index=this.linkGrouper.getLinkGroupIndexOfMember(cellID);return-1===index?this.properties.colors.LINKS[this.linkGrouper.getNextGroupIndex()]:this.properties.colors.LINKS[index]}return this.properties.colors[this.properties.state]}hideHalfRect(){d3.select("#"+this.properties.divID+">svg>rect.halfRect").attr("width",0).attr("height",0)}anchorLinkLineStartTo(x,y){d3.select("#"+this.properties.divID+">svg>line.linker-line").attr("x1",x).attr("y1",y)}anchorLinkLineEndTo(x,y){d3.select("#"+this.properties.divID+">svg>line.linker-line").attr("x2",x).attr("y2",y)}drawLinkLineFromCache(){d3.select("#"+this.properties.divID+">svg>line.linker-line").attr("x1",this.linkLineCache.x1).attr("y1",this.linkLineCache.y1).attr("x2",this.linkLineCache.x2).attr("y2",this.linkLineCache.y2).attr("stroke","black")}applyLinkageColors(){for(let linkGroup of this.linkGrouper.links)for(let cellID of linkGroup){let color=this.getLinkageColor(cellID);d3.select("#"+this.properties.divID+">svg>rect.id-"+cellID+".miniature-splitview-rect").attr("fill",color)}}updateLinkLineCache(x1,y1,x2,y2,id){this.linkLineCache={x1:x1,y1:y1,x2:x2,y2:y2}}unlinkCellID(id){this.linkGrouper.ungroupMember(id)}selectCellID(id){this.selected=id,this.refresh(),setTimeout(()=>{this.selected=-1;this.refresh()},2e3)}setSelected(id){this.selected=id,this.refresh()}mouseClick(row,col,direction,centerX,centerY,mouseX,mouseY){let id=-1;switch(this.properties.state){case"SELECT":id=this.layout.getCellID(row,col),this.dispatcher("selectCellID",[id]);break;case"EDIT":id=this.layout.getCellID(row,col);break;case"ADD":return"left"===direction||"right"===direction?(id=this.layout.addCellToRow(row,col,"left"===direction),this.icons.addCell(id)):(id=this.layout.addRowAt(row,"top"===direction),this.icons.addCell(id)),void this.dispatcher("refresh",[]);case"REMOVE":return id=this.layout.removeCellAt(row,col),this.icons.removeCell(id),this.dispatcher("unlinkCellID",[id]),this.dispatcher("refresh",[]),void this.linkDidChange();case"LINK-ADD":if(1===this.layout.getNumberOfActiveCells())return;id=this.layout.getCellID(row,col),this.linkCache.start={id:id},this.linkGrouper.addGroupIfDoesntExistForMemberWithId(id),this.updateLinkLineCache(centerX,centerY,mouseX,mouseY,this.linkCache.start.id),this.anchorLinkLineStartTo(centerX,centerY),this.anchorLinkLineEndTo(mouseX,mouseY),this.properties.state="LINK-IN-PROGRESS";break;case"LINK-IN-PROGRESS":if((id=this.layout.getCellID(row,col))===this.linkCache.start.id){this.properties.state="LINK-ADD",this.linkGrouper.removeIfContainsOnlyOneMember(id),this.flushLinkCache();break}if(this.linkGrouper.isMembersInSameGroup(id,this.linkCache.start.id)){this.properties.state="LINK-ADD",this.flushLinkCache();break}this.linkCache.end={id:this.layout.getCellID(row,col)},this.consumeLinkCache(),this.properties.state="LINK-ADD",this.flushLinkCache(),this.linkDidChange();break;case"LINK-REMOVE":this.linkGrouper.ungroupMember(this.layout.getCellID(row,col)),this.linkDidChange()}this.clear(),this.render()}flushLinkCache(){this.linkCache={start:{id:-1},end:{id:-1}},this.linkLineCache={x1:0,y1:0,x2:0,y2:0}}consumeLinkCache(){let groupIndexOfStart=this.linkGrouper.getLinkGroupIndexOfMember(this.linkCache.start.id);if(-1===groupIndexOfStart){let groupIndex=this.linkGrouper.addNewLinkGroup(this.linkCache.start.id);this.linkGrouper.addMemberToGroup(groupIndex,this.linkCache.end.id)}else this.linkGrouper.ungroupMember(this.linkCache.end.id),this.linkGrouper.addMemberToGroup(groupIndexOfStart,this.linkCache.end.id);this.flushLinkCache()}changeState(newState){this.properties.state=newState}getParentBounds(){let innerWidth=parent.width(),innerHeight=parent.height(),outerWidth=parent.outerWidth(),outerHeight=parent.outerHeight(),paddingX=(outerWidth-innerWidth)/2,paddingY=(outerHeight-innerHeight)/2;return{x0:paddingX,y0:paddingY,x1:paddingX+innerWidth,y1:paddingY+innerHeight,width:innerWidth,height:innerHeight}}linkDidChange(){this.linkChangedCallback.callback&&this.linkChangedCallback.callback(this.linkChangedCallback.key)}setLinkChangedCallback(key,callback){this.linkChangedCallback={key:key,callback:callback}}}module.exports=MiniatureSplitView},{"./context-menu-config":67,"./icon-set":68,"./link-group":69,"./splitbox":72,d3:3,underscore:22}],72:[function(require,module,exports){let _=require("underscore"),UniqueIndexBag=require("./unique-index-bag");class SplitBox{constructor(maxRows,maxColumns,aspectRatio){this.maxRows=maxRows,this.maxColumns=maxColumns,this.aspectRatio=aspectRatio,this.rows=[[]],this.cellIDs=new UniqueIndexBag(maxRows*maxColumns),this.rows[0][0]=this.cellIDs.getIndex(),this.numCells=1,this.layoutPercentages=null,this.flattenedLayoutPercentages=null,this.calculateLayoutPercentages(),this.changeListener=null}setChangeListener(listener){this.changeListener=listener}_notifyEvent(event){this.changeListener&&this.changeListener(event)}getLayoutCells(){let cells=[],cellHeight=1/this.rows.length;for(let r=0;r<this.rows.length;r++){let row=this.rows[r],cellWidth=1/row.length;for(let c=0;c<row.length;c++){let x0=c*cellWidth,y0=r*cellHeight,cellID=row[c];cells.push({id:cellID,x0:x0,y0:y0,width:cellWidth,height:cellHeight})}}return cells}addCellToRow(row,cell,isLeft){if(!(this.rows[row].length>=this.maxColumns)){let insertionPoint=isLeft?cell:cell+1,id=this.cellIDs.getIndex();return this.rows[row].splice(insertionPoint,0,id),this.calculateLayoutPercentages(),this.layoutDidChange(),this._notifyEvent({action:"CELL_ADDED",id:id}),id}}getCellID(row,col){return this.rows[row][col]}getLocationOfCellWithID(id){for(let rowIndex=0;rowIndex<this.rows.length;rowIndex++)for(let colIndex=0;colIndex<row.length;colIndex++)if(row[colIndex]==id)return{row:rowIndex,col:colIndex};return null}removeCellWithID(id){let loc=this.getLocationOfCellWithID(id);this.removeCellAt(loc.row,loc.col),this._notifyEvent({action:"CELL_REMOVED",id:id})}getNumberOfActiveCells(){let numCells=0;for(let row of this.rows)for(let cell of row)numCells++;return numCells}getActiveCellIDs(){return this.cellIDs.getIndicesInUse()}getNumberOfNonEmptyRows(){let numRows=0;for(let row of this.rows)row.length>0&&numRows++;return numRows}removeCellAt(row,cell){if(1===this.getNumberOfActiveCells())return-1;let id=this.rows[row][cell];return 1===this.rows[row].length?this.rows.splice(row,1):this.rows[row].splice(cell,1),this.calculateLayoutPercentages(),this.layoutDidChange(),this.cellIDs.returnIndex(id),this._notifyEvent({action:"CELL_REMOVED",id:id}),id}addRowAt(fromRow,isOnTop){if(!(this.rows.length>=this.maxRows)){let insertionPoint=isOnTop?fromRow:fromRow+1,id=this.cellIDs.getIndex();return this.rows[insertionPoint]?this.rows.splice(insertionPoint,0,[id]):this.rows[insertionPoint]=[id],this.calculateLayoutPercentages(),this.layoutDidChange(),this._notifyEvent({action:"CELL_ADDED",id:id}),id}}calculateLayoutPercentages(){let theRows=[];for(let i=0;i<this.rows.length;i++){let row=this.rows[i];0!==row.length&&theRows.push({rowIndex:i,row:row})}_.sortBy(theRows,rowInfo=>-rowInfo.row.length);let allSameLength=!0,len=theRows[0].length;for(let rowInfo of theRows)rowInfo.length!==len&&(allSameLength=!1);let totalWidth=this.aspectRatio.width,totalHeight=this.aspectRatio.height,remainingHeight=this.aspectRatio.height,aspect=totalWidth/remainingHeight,results=[];for(let rowInfo of theRows){let row=rowInfo.row,index=rowInfo.rowIndex,length=row.length,width=totalWidth/length,height=0;height=allSameLength?totalHeight/theRows.length:width/aspect,remainingHeight-=height,results[index]={rowIndex:index,offsetY:totalHeight-remainingHeight-height,cellWidth:width,cellHeight:height,numCells:length}}this.layoutPercentages=results,this.calculateFlattenedLayoutPercentages()}calculateFlattenedLayoutPercentages(){let toRender=[];for(let row of this.layoutPercentages)for(let cellIndex=0;cellIndex<row.numCells;cellIndex++)toRender.push({cellID:this.rows[row.rowIndex][cellIndex],rowIndex:row.rowIndex,cellIndex:cellIndex,x0:this.normalizeX(row.cellWidth*cellIndex),y0:this.normalizeY(row.offsetY),widthN:this.normalizeX(row.cellWidth),heightN:this.normalizeY(row.cellHeight)});this.flattenedLayoutPercentages=toRender}normalizeX(x){return x/this.aspectRatio.width}normalizeY(y){return y/this.aspectRatio.height}getRowAndCellAtNormalizedPosition(normalizedX,normalizedY){let rowIndex=_getRowFromNormalizedYPosition(normalizedY);return{row:rowIndex,cell:_getCellFromNormalizedXPosition(normalizedX,rowIndex)}}_getRowFromNormalizedYPosition(normalizedY){for(let i=0;i<this.layoutPercentages.length;i++){let rowLayout=this.layoutPercentages[i];if(rowLayout!==undfined){let normalizedY0=rowLayout.offsetY/this.aspectRatio.height,normalizedHeight=rowLayout.cellHeight/this.aspectRatio.height,normalizedY1=normalizedY0+normalizedHeight;if(normalizedY0<=normalizedY&&normalizedY<normalizedY1)return i}}}_getCellFromNormalizedXPosition(normalizedX,rowIndex){let rowLayout=this.layoutPercentages[rowIndex],cellWidth=rowLayout.cellWidth;for(let cellIndex=0;cellIndex<rowLayout.numCells;cellIndex++){let normalizedX0=cellIndex*cellWidth,normalizedX1=(cellIndex+1)*cellWidth;if(normalizedX0<=normalizedX&&normalizedX<normalizedX1)return cellIndex}}layoutDidChange(){this.callback&&this.callback(this)}setLayoutDidChangeCallback(callback){this.callback=callback}}module.exports=SplitBox},{"./unique-index-bag":74,underscore:22}],73:[function(require,module,exports){class Subcell{constructor(info){this.name=info.name,this.x0=info.x0,this.y0=info.y0,this.width=info.width,this.height=info.height,this.z=info.z}toViewportCoordinates(parentOffset){return new Subcell({name:this.name,x0:this.x0+parentOffset.x,y0:this.y0+parentOffset.y,width:this.width,height:this.height,z:this.z})}normalize(parentWidth,parentHeight){let x=this.x0/parentWidth,y=this.y0/parentHeight,h=this.height/parentHeight,w=this.width/parentWidth;return new Subcell({name:this.name,x0:x,y0:1-y-h,width:w,height:h,z:this.z})}denormalize(parentWidth,parentHeight){return new Subcell({name:this.name,x0:this.x0*parentWidth,y0:this.y0*parentHeight,width:this.width*parentWidth,height:this.height*parentHeight,z:this.z})}}class SubcellLayout{constructor(config){this.changeLayoutThresholdMultiplier=config.changeLayoutThresholdMultiplier,this.standardSizeMultiplier=config.standardSizeMultiplier}calculateLayout(cellInfo){let cellWidth=cellInfo.cellWidth,cellHeight=cellInfo.cellHeight,subcells=[new Subcell({name:"Volume",x0:0,y0:0,width:cellWidth,height:cellHeight,z:0})];if(cellWidth>cellHeight*this.changeLayoutThresholdMultiplier){let subcellHeight=cellHeight/2,offsetX=cellWidth-subcellHeight;subcells.push(new Subcell({name:"Sphere",x0:offsetX,y0:0,width:subcellHeight,height:subcellHeight,z:2})),subcells.push(new Subcell({name:"Slicer",x0:offsetX,y0:subcellHeight,width:subcellHeight,height:subcellHeight,z:2}))}else if(cellHeight>cellWidth*this.changeLayoutThresholdMultiplier){let subcellWidth=cellWidth/2,offsetY=cellHeight-subcellWidth;subcells.push(new Subcell({name:"Sphere",x0:0,y0:offsetY,width:subcellWidth,height:subcellWidth,z:2})),subcells.push(new Subcell({name:"Slicer",x0:subcellWidth,y0:offsetY,width:subcellWidth,height:subcellWidth,z:2}))}else{let widthHeight=Math.min(cellWidth,cellHeight),subcellWH=this.standardSizeMultiplier*widthHeight/2,offsetX=cellWidth-subcellWH,offsetY=cellHeight-2*subcellWH;subcells.push(new Subcell({name:"Sphere",x0:offsetX,y0:offsetY,width:subcellWH,height:subcellWH,z:2})),subcells.push(new Subcell({name:"Slicer",x0:offsetX,y0:offsetY+subcellWH,width:subcellWH,height:subcellWH,z:2}))}return subcells=subcells.sort((a,b)=>a.z-b.z)}}module.exports=SubcellLayout},{}],74:[function(require,module,exports){let _=require("underscore");class UniqueIndexBag{constructor(size){this.indices=[],this.size=size;for(let i=size-1;i>=0;i--)this.indices.push(i)}getIndicesInUse(){let inUse=[];for(let i=0;i<this.size;i++)_.contains(this.indices,i)||inUse.push(i);return inUse}getIndex(){return this.indices.pop()}peekAtNextIndex(){let next=this.getIndex();return this.indices.push(next),next}returnIndex(i){this.indices.push(i),this.indices.sort((i1,i2)=>i1<i2)}}module.exports=UniqueIndexBag},{underscore:22}],75:[function(require,module,exports){let _=require("underscore"),MiniatureSplitView=require("./miniature-split-view"),LinkableModels=require("../../core/linkable-models").Models,BaseSettings=require("../../core/settings").Widgets.LinkerAndSplitterView,divIDs={ADD:"lvw-add-view",linkers:{[LinkableModels.TRANSFER_FUNCTION.name]:"lvw-link-view-1",[LinkableModels.CAMERA.name]:"lvw-link-view-2",[LinkableModels.SLICER.name]:"lvw-link-view-3",[LinkableModels.THRESHOLDS.name]:"lvw-link-view-4"},SELECT:"lvw-select-view"};window.addEventListener("resize",()=>{dispatch("refresh")},!1);let views={ADD:null,linkers:{}},getLinkGroupingsForProperty=key=>views.linkers[key].linkGroup.getLinks(),getLayout=()=>views.ADD.layout,getAddRemoveView=()=>views.ADD,getNumberOfSubviews=()=>views.ADD.layout.getNumberOfActiveCells(),changeLinkerState=(key,newState)=>{views.linkers[key].changeState(newState)},changeAddRemoveState=newState=>{views.ADD.changeState(newState)},getAllLinkGroupings=()=>{let groupings={};for(let key in LinkableModels)groupings[key]=views.linkers[LinkableModels[key].name];return groupings},getAllLinkModels=()=>{let propertyNames=[];for(let key in LinkableModels)propertyNames.push(LinkableModels[LinkableModels[key].name]);return propertyNames},init=callbacks=>{views.ADD=genAddRemoveView(divIDs.ADD,viewSettings);views.ADD.setViewTypeChangedCallback(callbacks.viewTypeChanged);views.ADD.render();let splitbox=views.ADD.layout;splitbox.setChangeListener(callbacks.layoutChanged);for(let key in LinkableModels){let model=LinkableModels[key],divID=divIDs.linkers[model.name];views.linkers[model.name]=genLinkingView(divID,viewSettings),delete views.linkers[model.name].layout,views.linkers[model.name].layout=splitbox,views.linkers[model.name].setLinkChangedCallback(model.name,callbacks.linkChanged),views.linkers[model.name].render()}let isMinimized=!0;let selectDIV=document.getElementById(divIDs.SELECT);let btnDIV=document.getElementById("lvw-select-view-btn");let btnDIVIcon=document.querySelector("#lvw-select-view-btn > i");let updateSelectDiv=()=>{selectDIV.classList=isMinimized?"minimized":"";btnDIV.classList="ui icon button "+(isMinimized?"minimized":"");btnDIVIcon.classList=isMinimized?"expand icon":"compress icon";views.SELECT.refresh()};btnDIV.addEventListener("click",()=>{isMinimized=!isMinimized;updateSelectDiv()});views.SELECT=genSelectView(divIDs.SELECT,viewSettings);views.SELECT.layout=splitbox;views.SELECT.setViewTypeChangedCallback(callbacks.viewTypeChanged);views.SELECT.render();setTimeout(()=>{dispatch("refresh")},300);return{getLinkGroupingsForProperty:getLinkGroupingsForProperty,getAllLinkGroupings:getAllLinkGroupings,getLayout:getLayout,getNumberOfSubviews:getNumberOfSubviews,changeLinkerState:changeLinkerState,changeAddRemoveState:changeAddRemoveState}},getAllCellIDs=()=>getLayout().getActiveCellIDs(),getMasterCellIDForModel=(key,cellID)=>views.linkers[key].linkGrouper.getMasterCellID(cellID),read=()=>({links:{getMasterCellIDForModel:getMasterCellIDForModel,getAllModels:getAllLinkModels},layout:{getLayout:getLayout,getNumberOfSubviews:getNumberOfSubviews,getAllCellIDs:getAllCellIDs}}),dispatch=(event,args)=>{if("selectCellID"===event){views.ADD[event].apply(views.ADD,args);for(let view in views.linkers){let theView=views.linkers[view],fn=theView[event];fn.apply(theView,args)}views.SELECT.setSelected(args[0])}else{views.ADD[event].apply(views.ADD,args),views.SELECT[event].apply(views.SELECT,args);for(let view in views.linkers){let theView=views.linkers[view],fn=theView[event];fn.apply(theView,args)}}},viewSettings={divID:"",maxRows:BaseSettings.maxRows,maxColumns:BaseSettings.maxColumns,aspectRatio:{width:8,height:3},showIDs:BaseSettings.showIDs,state:"ADD",canLink:!0,canAddRemove:!1,bottomTopThresholdPercentage:BaseSettings.bottomTopThresholdPercentage,colors:BaseSettings.colors,icons:BaseSettings.icons},genLinkingView=(divID,settings)=>{let customSettings=_.clone(settings);customSettings.divID=divID;customSettings.canLink=!0;customSettings.canAddRemove=!1;customSettings.state="LINK-ADD";customSettings.receiveLayoutChanges=!0;customSettings.showIcons=BaseSettings.showIconsOnLinkingViews;return new MiniatureSplitView(customSettings)},genAddRemoveView=(divID,settings)=>{let customSettings=_.clone(settings);customSettings.divID=divID;customSettings.canLink=!1;customSettings.canAddRemove=!0;customSettings.dispatcher=dispatch;customSettings.showIcons=BaseSettings.showIconsOnAddRemoveView;return new MiniatureSplitView(customSettings)},genSelectView=(divID,settings)=>{let customSettings=_.clone(settings);customSettings.divID=divID;customSettings.canLink=!1;customSettings.canAddRemove=!1;customSettings.canSelect=!0;customSettings.dispatcher=dispatch;customSettings.showIcons=BaseSettings.showIconsOnSelectView;return new MiniatureSplitView(customSettings)};module.exports={init:init,read:read,getAddRemoveView:getAddRemoveView}},{"../../core/linkable-models":41,"../../core/settings":57,"./miniature-split-view":71,underscore:22}],76:[function(require,module,exports){require("tinycolor2");class ColorGradient{constructor(controlPoints){this.gradient=[]}addControlPoint(point){let index=this._findInsertionIndexForOffset(point.offset);return this.gradient.splice(index,0,{color:point.color,offset:point.offset}),index}removeControlPoint(offset){let deletionPoint=this._findInsertionIndexForOffset(offset);return-1!==deletionPoint&&(this.removeControlPointAtIndex(deletionPoint),!0)}removeControlPointAtIndex(index){this.gradient.splice(index,1)}setColorAt(index,newColor){index<0||(this.gradient[index].color=newColor)}moveControlPoint(index,newOffset){if(!(index<0)){let elem=this.gradient[index];return this.gradient.splice(index,1),this.addControlPoint({color:elem.color,offset:newOffset})}}_findFirstIndexBiggerThan(offset){let index=-1;for(let i=0;i<this.gradient.length;i++)if(this.gradient[i].offset>=offset){index=i;break}return index}_findInsertionIndexForOffset(offset){if(0===this.gradient.length)return 0;for(let i=0;i<this.gradient.length;i++)if(this.gradient[i].offset>offset)return i;return this.gradient.length}}module.exports=ColorGradient},{tinycolor2:20}],77:[function(require,module,exports){let d3=require("d3"),$=(require("../../core/environment").VolumeDataset,require("jquery")),Environment=(require("./color-gradient"),require("../../core/environment")),TFEditorSettings=require("../../core/settings").Widgets.TransferFunction.Editor;class TransferFunctionEditor{constructor(displayOptions,getInteractionMode,$scope$id,EnvironmentTFKey){this.svgContainer=document.querySelector(".tf-d3-container.ng-id-"+$scope$id),this.$scope$id=$scope$id,this.EnvironmentTFKey=EnvironmentTFKey,this.tfModel=null,this.histogram=null,this.histogramSelectionRef=null,this.colorGradientObject=null,this.controlPoints=null,this.notifyDatasetDidChange=(()=>{this._updateDatasetModel()}),this.notifyTFModelDidChange=(()=>{this._updateTFModel()}),Environment.listen("TFModelDidChange",EnvironmentTFKey,this.notifyTFModelDidChange),Environment.listen("DatasetDidChange",EnvironmentTFKey,this.notifyDatasetDidChange),this.container=null,this.svgMain=null,this.eventListenerRect=null,this.histogramSelectionGroup=null,this.histogramGroup=null,this.transferFunctionGroup=null,this.transferFunctionControlPointGroup=null,this.canvas=null,this.canvasContext=null,this.colorGradientRect=null,this.colorGradientRectContainer=null,this.colorGradientControlPointsGroup=null,this.defs=null,this.isovalueAxis=null,this.opacityAxis=null,this.colorPicker=null,this.getInteractionMode=getInteractionMode,this.originalSize={total:{width:-1,height:-1},content:{width:-1,height:-1}},this.scale={x:1,y:1},this.scales={content:{x:null,y:null},total:{x:null,y:null}},this.displayOptions=displayOptions,this.dragged=null,this.selectedControlPoint=null,this.transferFunctionSelection={p1:{x:-1,y:-1},p2:{x:-1,y:-1}},this.colorGradientState={selectedIndex:-1,isAwaitingColorSelection:!1},this.colorGradientControlPointsState={selectedIndex:-1,isDragging:!1},this._init($scope$id),this._resize(),window.addEventListener("resize",()=>{this._resize()},!1),window.addEventListener("resizeTFEditor",()=>{this._resize()},!1),d3.select(window).on("keydown",()=>{this._keydown()})}_getModel(){return Environment.getTransferFunctionForTFEditor(this.EnvironmentTFKey)}_getHistogram(){return Environment.getHistogramForTFEditor(this.EnvironmentTFKey)}_getHistogramSelections(){Environment.getHistogramSelectionsForTFEditor(this.EnvironmentTFKey)}_get3DViewSelectionHistogram(){Environment.get3DViewSelectionsHistogramForTFEditor(this.EnvironmentTFKey)}_updateTFModel(){this.tfModel=this._getModel(),this.colorGradientObject=this.tfModel.colorGradient,this.controlPoints=this.tfModel.controlPoints}_updateDatasetModel(){this.histogram=this._getHistogram(),this.histogramSelection=this._getHistogramSelections(),this.viewSelectionHistogram=this._get3DViewSelectionHistogram()}notifyModelDidChange(){this._updateTFModel()}_init(){this.container=document.querySelector(".tf-editor-container.ng-id-"+this.$scope$id),this.canvas=d3.select(this.container).append("canvas").attr("class","tf-editor-background-canvas ng-id"+this.$scope$id).attr("width",400).attr("height",400),Environment.TransferFunctionManager.notifyTFPointsToCanvasWithID(this.EnvironmentTFKey,this.$scope$id),this.svgMain=d3.select(this.container).append("svg").attr("class","tf-editor-svg-container");let res=TFEditorSettings.Resolution,sizes=this._getSizesFromTotal(res.width,res.height);this.originalSize.total=sizes.total,this.originalSize.content=sizes.content,this.histogramGroup=this.svgMain.append("g").attr("class","tf-editor-full-histogram-group"),this.histogramSelectionGroup=this.svgMain.append("g").attr("class","tf-editor-3d-selection-histogram-group"),this.transferFunctionGroup=this.svgMain.append("g").attr("class","tf-editor-tf-view-group"),this.eventListenerRect=this.svgMain.append("rect").attr("class","tf-editor-event-listener-rect").on("mousedown",()=>{d3.event.stopPropagation();this._mousedown()}).on("mouseup",()=>{d3.event.stopPropagation();this._mouseup()}).on("mousemove",()=>{d3.event.stopPropagation();this._mousemove()}),this.transferFunctionControlPointGroup=this.svgMain.append("g");let self=this;this.colorGradientRectContainer=this.svgMain.append("g"),
this.colorGradientRect=this.colorGradientRectContainer.append("rect").attr("class","tf-editor-color-gradient-axis").on("mousedown",function(){d3.event.stopPropagation(),self._colorGradientMouseDown(d3.mouse(this))}).on("mouseup",function(){d3.event.stopPropagation(),self._colorGradientMouseUp(d3.mouse(this))}).on("mousemove",function(){d3.event.stopPropagation(),self._colorGradientMouseMove(d3.mouse(this))}).attr("width",sizes.content.width).attr("height",sizes.bottomAxis.colorGradientRect.height),this.colorGradientControlPointsGroup=this.colorGradientRectContainer.append("g").attr("class","tf-editor-color-gradient-control-points"),$(this.colorGradientRect.node()).on("click",function(){return!1}),$(this.colorGradientRect.node()).on("mouseup",function(){return!1}),$(this.colorGradientRect.node()).on("mousemove",function(){return!1}),this.isovalueAxis=this.svgMain.append("g").attr("class","tf-editor-axis-isovalue"),this.opacityAxis=this.svgMain.append("g").attr("class","tf-editor-axis-opacity"),this.defs=this.svgMain.append("defs"),this.colorGradient=this.defs.append("linearGradient").attr("id","linear-gradient-"+this.$scope$id),$(".tf-editor-color-picker-container.ng-id-"+this.$scope$id+">input").spectrum({}),this.colorPicker=$(".tf-editor-color-picker-container.ng-id-"+this.$scope$id+">input"),this.colorPicker.spectrum({move:tinycolor=>{this._colorPicked(tinycolor,!1);return!1},change:tinycolor=>{this._colorPicked(tinycolor,!0);return!1},hide:tinycolor=>{this._colorNotPicked()}})}_colorNotPicked(){-1!==this.colorGradientState.selectedIndex&&(this.colorGradientObject.removeControlPointAtIndex(this.colorGradientState.selectedIndex),this.colorGradientState.selectedIndex=-1,this.colorGradientState.isAwaitingColorSelection=!1,this._refreshColorGradient())}_colorPicked(tinycolor,isFinal){let rgb=this.colorPicker.spectrum("get").toHexString();this.colorGradientObject.setColorAt(this.colorGradientState.selectedIndex,rgb),this._refreshColorGradient(),isFinal&&(this.colorGradientState.selectedIndex=-1,this.colorGradientState.isAwaitingColorSelection=!1)}_resize(){this.sizes=this._getSizes(),this.scale={x:this.sizes.total.width/this.originalSize.total.width,y:this.sizes.total.height/this.originalSize.total.height},this.scales.content.x=d3.scaleLinear().domain([0,1]).range([0,this.sizes.content.width]),this.scales.content.y=d3.scaleLinear().domain([1,0]).range([0,this.sizes.content.height]),this.scales.total.x=d3.scaleLinear().domain([0,1]).range([0,this.sizes.total.width]),this.scales.total.y=d3.scaleLinear().domain([1,0]).range([0,this.sizes.total.height]);let circleRadius=TFEditorSettings.TransferFunctionDisplay.circleRadius;this.eventListenerRect.attr("x",this.sizes.content.x0-2*circleRadius).attr("y",this.sizes.content.y0-2*circleRadius).attr("width",this.sizes.content.width+4*circleRadius).attr("height",this.sizes.content.height+4*circleRadius),this.histogramSelectionGroup.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.content.y0+") scale("+this.scale.x+", "+this.scale.y+")"),this.histogramGroup.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.content.y0+")scale("+this.scale.x+", "+this.scale.y+")"),this.transferFunctionGroup.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.content.y0+")"),this.transferFunctionControlPointGroup.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.content.y0+")"),this._refreshTransferFunctionSplinesAndControlPoints();let texturePreviewHeightPercentage=TFEditorSettings.Layout.texturePreviewHeightPercentage;this.canvas.style("left",this.sizes.content.x0).style("top",this.sizes.content.y0-this.sizes.content.height*texturePreviewHeightPercentage).style("width",this.sizes.content.width).style("height",this.sizes.content.height*(1+texturePreviewHeightPercentage)),this.colorGradientRectContainer.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.bottomAxis.colorGradientRect.y0+")scale("+this.scale.x+", "+this.scale.y+")"),this.colorGradientControlPointsGroup.attr("transform","translate(0, -8)"),this.isovalueAxis.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.bottomAxis.isovalues.y0+")scale("+this.scale.x+", "+this.scale.y+")"),this.opacityAxis.attr("transform","translate("+this.sizes.content.x0+", "+this.sizes.content.y0+")scale("+this.scale.x+", "+this.scale.y+")")}_getSizesFromTotal(totalWidth,totalHeight){let layout=TFEditorSettings.Layout,contentY0=layout.contentTopPaddingPercentage*totalHeight,contentWidth=(1-layout.leftAxisWidthPercentage)*totalWidth,contentHeight=(1-layout.bottomAxisHeightPercentage-layout.contentTopPaddingPercentage)*totalHeight,bottomAxisY0=contentY0+contentHeight,bottomAxisIsovaluesHeight=layout.isoValueAxisHeightPercentage*totalHeight;return{total:{width:totalWidth,height:totalHeight},content:{x0:layout.leftAxisWidthPercentage*totalWidth,y0:contentY0,width:contentWidth,height:contentHeight},bottomAxis:{isovalues:{y0:bottomAxisY0,height:bottomAxisIsovaluesHeight},colorGradientRect:{y0:bottomAxisY0+bottomAxisIsovaluesHeight,height:totalHeight-(bottomAxisY0+bottomAxisIsovaluesHeight)}}}}_getSizes(){let totalWidthPX=this.svgMain.style("width"),totalHeightPX=this.svgMain.style("height"),totalWidth=parseFloat(totalWidthPX.replace("px","")),totalHeight=.9*parseFloat(totalHeightPX.replace("px",""));return this._getSizesFromTotal(totalWidth,totalHeight)}_clear(){this._clearHistogramSelection(),this._clearHistogram(),this._clearTransferFunction()}_clearHistogramSelection(){this.histogramSelectionGroup.selectAll("*").remove()}_clearHistogram(){this.histogramGroup.selectAll("*").remove()}_clearTransferFunction(){this.transferFunctionGroup.selectAll("*").remove(),this.transferFunctionControlPointGroup.selectAll("*").remove()}_clearColorGradient(){this.colorGradientControlPointsGroup.selectAll("*").remove()}_refreshHistogram(){this._clearHistogram(),this._renderHistogram()}_refreshHistogramSelection(){this._clearHistogramSelection(),this._renderHistogramSelection()}_refreshTransferFunction(){this._clearTransferFunction(),this._renderTransferFunction(),this._renderColorGradientOntoCanvas()}_refreshTransferFunctionSplinesAndControlPoints(){this._clearTransferFunction(),this._renderTransferFunction()}_refreshColorGradient(){this._clearColorGradient(),this._renderColorGradientRect(),this._renderColorGradientControlPoints(this._getSizes()),this._renderColorGradientOntoCanvas()}_refreshColorGradientExceptPoints(){this._renderColorGradientRect(),this._renderColorGradientOntoCanvas()}render(){this._clear();let sizes=this._getSizes();this._renderHistogramSelection(sizes),this._renderHistogram(sizes),this._renderTransferFunction(),this._renderColorGradient(sizes),this._renderColorGradientOntoCanvas(sizes),this._renderAxes(sizes)}_notifyTFDidChange(){Environment.notifyTransferFunctionDidChangeAtEditor(this.EnvironmentTFKey)}_renderHistogramSelection(sizes){if(this.displayOptions.showHistogramSelection){let histogram=this._getHistogramSelections();if(histogram&&0!==histogram.length){let yDomain=d3.extent(histogram),yRange=[this.originalSize.content.height,0],xDomain=[0,histogram.length-1],xRange=[0,this.originalSize.content.width],yScale=d3.scaleLinear().domain(yDomain).range(yRange),xScale=d3.scaleLinear().domain(xDomain).range(xRange),line=d3.line().curve(TFEditorSettings.TransferFunctionDisplay.curve).x((isovalue,i)=>xScale(i)).y((isovalue,i)=>yScale(isovalue)),area=d3.area().curve(TFEditorSettings.TransferFunctionDisplay.curve).x((isovalue,i)=>xScale(i)).y1((isovalue,i)=>yScale(isovalue)).y0(yRange[0]);this.histogramSelectionGroup.append("path").datum(histogram).attr("d",line).attr("class","tf-editor-3d-selection-histogram-line"),this.histogramSelectionGroup.append("path").datum(histogram).attr("d",area).attr("class","tf-editor-3d-selection-histogram-area")}}}_renderHistogram(sizes){if(this.displayOptions.showHistogram){let histogram=this._getHistogram();if(histogram&&0!==histogram.length){let yDomain=d3.extent(histogram),yRange=[this.originalSize.content.height,0];yDomain[0]+=1,yDomain[1]+=1;let xDomain=[0,histogram.length-1],xRange=[0,this.originalSize.content.width],yScale=d3.scaleLog().domain(yDomain).range(yRange),xScale=d3.scaleLinear().domain(xDomain).range(xRange),line=d3.line().curve(TFEditorSettings.TransferFunctionDisplay.curve).x((isovalue,i)=>xScale(i)).y((isovalue,i)=>{let y=yScale(isovalue+1);return y}),area=d3.area().curve(TFEditorSettings.TransferFunctionDisplay.curve).x((isovalue,i)=>xScale(i)).y1((isovalue,i)=>{let y=yScale(isovalue+1);return yScale(y)}).y0(yRange[0]);this.histogramGroup.append("path").datum(histogram).attr("d",line).attr("class","tf-editor-histogram-line"),this.histogramGroup.append("path").datum(histogram).attr("d",area).attr("class","tf-editor-histogram-area")}}}_renderTransferFunction(){this.displayOptions.showTransferFunction&&null!==this.controlPoints&&0!==this.controlPoints.length&&(this._renderControlPointSplines(),this._renderControlPoints())}_renderControlPointSplines(){this.displayOptions.showTransferFunction&&(this.splines=d3.line().curve(TFEditorSettings.TransferFunctionDisplay.curve).x(d=>this.scales.content.x(d[0])).y(d=>this.scales.content.y(d[1])),this.transferFunctionGroup.append("path").datum(this.controlPoints).attr("class","tf-splineline").attr("d",this.splines))}_renderControlPoints(){if(this.displayOptions.showTransferFunction){let circles=this.transferFunctionControlPointGroup.selectAll(".circle").data(this.controlPoints),self=this,circleRadius=TFEditorSettings.TransferFunctionDisplay.circleRadius;circles.enter().append("circle").attr("r",circleRadius).attr("class","tf-editor-control-point").on("mousedown",d=>{this.selected=this.dragged=d;this._mousedown()}).on("mouseup",()=>{this._mouseup()}).on("mouseenter",function(){d3.select(this).classed("selected",!0)}).on("mouseout",function(d){d3.select(this).classed("selected",self.selected===d),self.selected===d&&(self._clearTransferFunction(),self._renderTransferFunction())}).attr("cx",d=>this.scales.content.x(d[0])).attr("cy",d=>this.scales.content.y(d[1])).classed("selected",d=>d===this.selected).attr("r",circleRadius),circles.attr("cx",d=>this.scales.content.x(d[0])).attr("cy",d=>this.scales.content.y(d[1])),circles.exit().remove()}}_renderColorOpacityBitmap(){}_renderColorGradient(sizes){this.colorGradientObject&&0!==this.colorGradientObject.gradient.length&&(this._renderColorGradientRect(),this._renderColorGradientControlPoints(sizes))}_renderColorGradientRect(){let sorted=(this.colorGradientObject.gradient,this.colorGradientObject.gradient.sort((a,b)=>a.offset-b.offset));this.defs.remove(),this.defs=this.svgMain.append("defs"),this.colorGradient=this.defs.append("linearGradient").attr("id","linear-gradient-"+this.$scope$id),this.colorGradient.selectAll("stop").data(sorted).enter().append("stop").attr("offset",d=>d.offset+"%").attr("stop-color",d=>d.color).exit().remove(),this.colorGradientRect.style("fill","url(#linear-gradient-"+this.$scope$id+")")}getTextureBounds(){let canvasNode=this.canvas.node();return{x:0,y:0,width:canvasNode.width,height:canvasNode.height*TFEditorSettings.Layout.texturePreviewHeightPercentage}}_renderColorGradientOntoCanvas(sizes){this.colorGradientObject&&(this._renderColorGradientCanvas(sizes),this._renderColorGradientTexture(sizes))}_renderColorGradientTexture(sizes){let canvasNode=this.canvas.node(),context=canvasNode.getContext("2d",{alpha:!0}),tWidth=(d3.line().curve(TFEditorSettings.TransferFunctionDisplay.curve).x(d=>x(d[0])).y(d=>y(d[1])),canvasNode.width),tHeight=canvasNode.height*TFEditorSettings.Layout.texturePreviewHeightPercentage,x1=tWidth,y0=tHeight/2,y1=y0,colorGradient=context.createLinearGradient(0,y0,x1,y1),opacityGradient=context.createLinearGradient(0,y0,x1,y1);for(let point of this.colorGradientObject.gradient)colorGradient.addColorStop(point.offset/100,point.color);for(let point of this.controlPoints){let opacity=parseInt(Math.round(255*point[1]));opacityGradient.addColorStop(point[0],"rgba("+opacity+", "+opacity+","+opacity+",1)")}context.fillStyle=opacityGradient,context.fillRect(0,0,tWidth,tHeight);let imgData=context.getImageData(0,0,tWidth,tHeight),data=imgData.data,width=imgData.width,opacities=new Uint8ClampedArray(width);for(let i=0;i<4*width;i+=4)opacities[i/4]=data[i];context.fillStyle=colorGradient,context.fillRect(0,0,tWidth,tHeight);let imgData2=context.getImageData(0,0,tWidth,tHeight),data2=imgData2.data,height=imgData2.height;for(let i=3;i<data2.length;i+=4){let opacityAdjust=opacities[parseInt(i/4)%width];data2[i]=opacityAdjust}context.putImageData(new ImageData(data2,width,height),0,0),Environment.TransferFunctionManager.notifyDiscreteTFDidChange(this.EnvironmentTFKey,this.getTextureBounds()),this._notifyTFDidChange()}_renderColorGradientCanvas(sizes){let canvasNode=this.canvas.node(),context=canvasNode.getContext("2d",{alpha:!0}),offsetY=(d3.line().curve(TFEditorSettings.TransferFunctionDisplay.curve).x(d=>x(d[0])).y(d=>y(d[1])),canvasNode.height*TFEditorSettings.Layout.texturePreviewHeightPercentage),cWidth=canvasNode.width,cHeight=canvasNode.height-offsetY,x1C=cWidth,y0C=cHeight/2,y1C=y0C,x0O=cWidth/2,x1O=cWidth/2,y0O=canvasNode.height,y1O=offsetY,colorGradient=context.createLinearGradient(0,y0C,x1C,y1C),opacityGradient=context.createLinearGradient(x0O,y0O,x1O,y1O);for(let point of this.colorGradientObject.gradient)colorGradient.addColorStop(point.offset/100,point.color);let dummyControlPoints=[[0,1],[1,0]];for(let point of dummyControlPoints){let opacity=parseInt(Math.round(255*point[1]));opacityGradient.addColorStop(point[0],"rgba("+opacity+", "+opacity+","+opacity+",1)")}context.fillStyle=opacityGradient,context.fillRect(0,offsetY,1,cHeight);let imgData=context.getImageData(0,offsetY,1,cHeight),data=imgData.data,opacities=(imgData.width,new Uint8ClampedArray(cHeight)),cHeightRGBA=4*cHeight;for(let i=0;i<cHeightRGBA;i+=4)opacities[i/4]=data[cHeightRGBA-i];context.fillStyle=colorGradient,context.fillRect(0,offsetY,canvasNode.width,cHeight);let imgData2=context.getImageData(0,offsetY,canvasNode.width,cHeight),data2=imgData2.data,rowWidth=(imgData2.height,4*cWidth);for(let row=0;row<cHeight;row++)for(let col=3;col<4*cWidth;col+=4){let rowOffset=row*rowWidth;data2[rowOffset+col]=opacities[row]}let newImageData=new ImageData(data2,canvasNode.width,cHeight);context.putImageData(newImageData,0,offsetY,0,0,canvasNode.width,cHeight)}_renderColorGradientControlPoints(sizes){let triangle=d3.symbol().type(d3.symbolTriangle).size(TFEditorSettings.ColorGradientDisplay.triangleSize),cross=d3.symbol().type(d3.symbolCross).size(TFEditorSettings.ColorGradientDisplay.crossSize),groups=this.colorGradientControlPointsGroup.selectAll(".node").data(this.colorGradientObject.gradient).enter().append("g").attr("transform",d=>"translate("+d.offset*this.originalSize.content.width/100+", 0)scale(1,-1)").attr("class",".tf-editor-color-gradient-symbols"),self=this,draggedIndex=-1,draggedGlyphIndex=-1,prevX=-1,time=Date.now(),cgRectHeight=parseFloat(this.colorGradientRect.attr("height")),crossTY=TFEditorSettings.ColorGradientDisplay.crossTranslateY,ty=cgRectHeight+crossTY,crossYOffset=-1*ty;groups.append("path").style("stroke","black").style("fill",d=>"red").attr("d",cross).on("mousedown",(d,i)=>{this.colorGradientObject.removeControlPointAtIndex(i);this._refreshColorGradient()}).attr("transform","translate(0, "+crossYOffset+") rotate(45)").attr("id",(d,i)=>self.$scope$id+"-tf-color-gradient-cross-"+i),groups.append("path").style("stroke","black").style("fill",d=>d.color).attr("d",triangle).on("mousedown",(d,i)=>{let dt=Date.now()-time;dt<500?(this.colorGradientState.selectedIndex=i,this.colorGradientState.isAwaitingColorSelection=!0,this.colorPicker.spectrum("toggle"),time-=500):time=Date.now()}).call(d3.drag().on("start",function(d,i){d3.select(this).raise().classed("dragged",!0),draggedIndex=i,draggedGlyphIndex=i,prevX=d3.event.x}).on("drag",function(d){let mouse=d3.mouse(self.colorGradientRectContainer.node()),manualX=(self.scales.content.x.invert(mouse[0]),100*self.scale.x*mouse[0]/self.sizes.content.width),newOffset=manualX;self.colorGradientObject.gradient[draggedIndex].offset;draggedIndex=self.colorGradientObject.moveControlPoint(draggedIndex,newOffset);let dx=d3.event.x-prevX;d3.select(this).attr("transform","translate("+dx+", 0)scale(1,1)"),self._refreshColorGradientExceptPoints()}).on("end",function(d){d3.select(this).raise().classed("dragged",!1),draggedIndex=-1,prevX=-1,self._refreshColorGradient()})).exit().remove()}_renderAxes(sizes){if(this.histogram){let xScale=d3.scaleLinear().domain([0,this.histogram.length||4095]).range([0,this.originalSize.content.width]),yScale=d3.scaleLinear().domain([0,1]).range([this.originalSize.content.height,0]);d3.line().x((count,isovalue)=>yScale(isovalue)).y((count,isovalue)=>xScale(count));this.isovalueAxis.call(d3.axisBottom(xScale).ticks(10)),this.opacityAxis.call(d3.axisLeft(yScale).ticks(10))}}_colorGradientMouseDown(mouse){let sizes=this.sizes;mouse[0],sizes.content.width}_colorGradientMouseUp(mouse){let sizes=(d3.mouse(this.colorGradientRectContainer.node()),this.sizes),offsetX=this.scale.x*mouse[0]/sizes.content.width*100;this.scale.y,mouse[1],sizes.bottomAxis.colorGradientRect.height,this.scales.content.x.invert(mouse[0]),this.scales.content.y.invert(mouse[1]);this.colorGradientState.selectedIndex=this.colorGradientObject.addControlPoint({color:"white",offset:offsetX}),this.colorGradientState.isAwaitingColorSelection=!0,this.colorPicker.spectrum("toggle")}_colorGradientMouseMove(mouse){if(!this.colorGradientState.isAwaitingColorSelection&&-1!==this.colorGradientState.selectedIndex){let sizes=this.sizes,offsetX2=(this.scale.x,mouse[0],sizes.content.width,this.scales.content.x.invert(mouse[0]));this.scale.x,mouse[0],sizes.content.width,this.scale.y,mouse[1],sizes.bottomAxis.colorGradientRect.height;this.colorGradientState.selectedIndex=this.colorGradientObject.moveControlPoint(this.colorGradientState.selectedIndex,offsetX2),this._refreshColorGradient()}}_mousedown(){if(!this.colorGradientState.isAwaitingColorSelection){switch(this.getInteractionMode()){case"Select":break;case"TF":if(this.dragged)return;let mouse=d3.mouse(this.transferFunctionGroup.node()),mouseX=mouse[0],mouseY=mouse[1],mouseXNormalized=this.scales.content.x.invert(mouseX),mouseYNormalized=this.scales.content.y.invert(mouseY),mouseNormalized=[mouseXNormalized,mouseYNormalized];this.controlPoints.push(this.selected=this.dragged=mouseNormalized),this._refreshTransferFunction()}this.render()}}_mouseup(){if(!this.colorGradientState.isAwaitingColorSelection){switch(this.getInteractionMode()){case"Select":break;case"TF":if(!this.dragged)return;this.dragged=null,this._refreshTransferFunction()}}}_mousemove(){if(!this.colorGradientState.isAwaitingColorSelection){let clamp01=num=>num<0?0:num>1?1:num;switch(this.getInteractionMode()){case"Select":break;case"TF":if(!this.dragged)return;let m=d3.mouse(this.transferFunctionGroup.node());this.dragged[0]=clamp01(this.scales.content.x.invert(m[0])),this.dragged[1]=clamp01(this.scales.content.y.invert(m[1])),this._refreshTransferFunction()}}}_keydown(){if(this.selected&&"TF"===this.getInteractionMode())switch(d3.event.keyCode){case 8:case 46:this._removeSelectedControlPoint()}}_removeSelectedControlPoint(){let i=this.controlPoints.indexOf(this.selected);this.controlPoints.splice(i,1),this.selected=this.controlPoints.length?this.controlPoints[i>0?i-1:0]:null,this._refreshTransferFunction()}}module.exports=TransferFunctionEditor},{"../../core/environment":38,"../../core/settings":57,"./color-gradient":76,d3:3,jquery:18}],78:[function(require,module,exports){let TransferFunction=require("./transfer-function");class TransferFunctionManager{constructor(environment){this.env=environment,this.tfs={GLOBAL:new TransferFunction,0:new TransferFunction,1:null,2:null},this.needsUpdate={GLOBAL:!1},this.textureBounds={GLOBAL:null},this.canvasPointers={},this.activeEditorTFs={GLOBAL:"GLOBAL",LOCAL:0},this.globalOverrideLocal=!1}getReferencedCellIDForTFKey(tfEditorKey){return this.activeEditorTFs[tfEditorKey]}checkNeedsUpdateCellID(cellID){return this.globalOverrideLocal?this._checkNeedsUpdateEditorKey("GLOBAL"):this.activeEditorTFs.LOCAL===cellID&&this._checkNeedsUpdateEditorKey("LOCAL")}_checkNeedsUpdateEditorKey(key){return!!this.needsUpdate[key]&&(this.needsUpdate[key]=!1,!0)}notifyDiscreteTFDidChange(key,textureBounds){this.needsUpdate[key]=!0,this.textureBounds[key]=textureBounds}addTransferFunction(id){this.tfs[id]=new TransferFunction}removeTransferFunction(id){delete this.tfs[id]}test(){}getTransferFunctionForTFEditorKey(tfEditorKey,splines){let active=this.activeEditorTFs[tfEditorKey],tf=this.tfs[active];return splines&&(tf.splines=splines),this.tfs[active]}getCanvasForTFKey(key){return{canvas:this.canvasPointers[key],textureBounds:this.textureBounds[key]}}notifyTFPointsToCanvasWithID(key,ngid){this.canvasPointers[key]||(this.canvasPointers[key]=document.querySelector(".tf-editor-background-canvas.ng-id"+ngid))}}module.exports=TransferFunctionManager},{"./transfer-function":79}],79:[function(require,module,exports){let d3=require("d3"),ColorGradient=require("./color-gradient");class TransferFunction{constructor(){this.controlPoints=[],this.colorGradient=new ColorGradient,this.opacityAxis=null,this.splines=null,this.curve=d3.curveLinear()}}module.exports=TransferFunction},{"./color-gradient":76,d3:3}]},{},[66]);
